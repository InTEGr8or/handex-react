var Gn=Object.defineProperty;var Yn=(e,t,r)=>t in e?Gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var J=(e,t,r)=>Yn(e,typeof t!="symbol"?t+"":t,r);import{R as ke,j as ne,r as me,c as Li,b as Xn,i as Jn,g as li}from"./index-Q1am_xbY.js";const Ie={Terminal:"terminal",Line:"terminal-line",Output:"terminal-output",Input:"terminal-input",TerminalGame:"terminal-game",Prompt:"prompt",Head:"head",Tail:"tail",LogPrefix:"log-prefix",LogTime:"log-time",NextChars:"nextChars",NextCharsRate:"nextCharsRate",WholePhraseChords:"wholePhraseChords",ChordImageHolder:"chord-image-holder",TestArea:"testArea",SvgCharacter:"svgCharacter",TestMode:"testMode",chordified:"chordified",pangrams:"pangrams",chordSection:"chord-section",voiceMode:"voiceMode",videoSection:"video-section",allChordsList:"allChordsList",errorCount:"errorCount",Phrase:"phrase",Timer:"timer",TimerSvg:"timerSvg",CharTimes:"charTimes",WPM:"wpm"},kt={CharTime:"char-time",Command:"command"};class Zn{constructor(){J(this,"previousTimestamp",0);J(this,"keystrokes");this.keystrokes=[]}getKeystrokes(){return this.keystrokes}clearKeystrokes(){this.keystrokes=[]}saveKeystrokes(t){let r=this.getWPMs();return localStorage.setItem(kt.CharTime+"_"+t,JSON.stringify(r.charWpms)),r.wpmAverage}addKeystroke(t){let r={character:t,durationMilliseconds:0};return this.previousTimestamp>0&&(r.durationMilliseconds=performance.now()-this.previousTimestamp),this.previousTimestamp=performance.now(),this.keystrokes.push(r),r}getWPMs(){let t=this.keystrokes.map(this.getWPM);const r=t.filter(o=>o.durationMilliseconds>1);let n=r.reduce((o,p)=>o+p.wpm,0)/r.length;return n=Math.round(n*1e3)/1e3,{wpmAverage:n,charWpms:t}}getWPM(t){let r={character:t.character,wpm:0,durationMilliseconds:0};if(t.durationMilliseconds>0){r.durationMilliseconds=t.durationMilliseconds;let i=t.durationMilliseconds/6e4;if(i>0){let n=1/i;r.wpm=n/5}r.wpm=Math.round(r.wpm*1e3)/1e3}return r}}class Qn{saveCommandHistory(){}setItem(t,r){localStorage.setItem(t,r)}loadCommandHistory(){return[]}}function Wr(e){return new DOMParser().parseFromString(e,"text/html").body.firstChild}var Hs={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(globalThis,()=>(()=>{var r={4567:function(p,s,a){var c=this&&this.__decorate||function(h,u,g,E){var x,R=arguments.length,y=R<3?u:E===null?E=Object.getOwnPropertyDescriptor(u,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(h,u,g,E);else for(var A=h.length-1;A>=0;A--)(x=h[A])&&(y=(R<3?x(y):R>3?x(u,g,y):x(u,g))||y);return R>3&&y&&Object.defineProperty(u,g,y),y},_=this&&this.__param||function(h,u){return function(g,E){u(g,E,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const d=a(9042),m=a(9924),S=a(844),b=a(4725),v=a(2585),l=a(3656);let f=s.AccessibilityManager=class extends S.Disposable{constructor(h,u,g,E){super(),this._terminal=h,this._coreBrowserService=g,this._renderService=E,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let x=0;x<this._terminal.rows;x++)this._rowElements[x]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[x]);if(this._topBoundaryFocusListener=x=>this._handleBoundaryFocus(x,0),this._bottomBoundaryFocusListener=x=>this._handleBoundaryFocus(x,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new m.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(x=>this._handleResize(x.rows))),this.register(this._terminal.onRender(x=>this._refreshRows(x.start,x.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(x=>this._handleChar(x))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(x=>this._handleTab(x))),this.register(this._terminal.onKey(x=>this._handleKey(x.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,l.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,S.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(h){for(let u=0;u<h;u++)this._handleChar(" ")}_handleChar(h){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==h&&(this._charsToAnnounce+=h):this._charsToAnnounce+=h,h===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=d.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(h){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(h)||this._charsToConsume.push(h)}_refreshRows(h,u){this._liveRegionDebouncer.refresh(h,u,this._terminal.rows)}_renderRows(h,u){const g=this._terminal.buffer,E=g.lines.length.toString();for(let x=h;x<=u;x++){const R=g.lines.get(g.ydisp+x),y=[],A=(R==null?void 0:R.translateToString(!0,void 0,void 0,y))||"",O=(g.ydisp+x+1).toString(),U=this._rowElements[x];U&&(A.length===0?(U.innerText="Â ",this._rowColumns.set(U,[0,1])):(U.textContent=A,this._rowColumns.set(U,y)),U.setAttribute("aria-posinset",O),U.setAttribute("aria-setsize",E))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(h,u){const g=h.target,E=this._rowElements[u===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(u===0?"1":`${this._terminal.buffer.lines.length}`)||h.relatedTarget!==E)return;let x,R;if(u===0?(x=g,R=this._rowElements.pop(),this._rowContainer.removeChild(R)):(x=this._rowElements.shift(),R=g,this._rowContainer.removeChild(x)),x.removeEventListener("focus",this._topBoundaryFocusListener),R.removeEventListener("focus",this._bottomBoundaryFocusListener),u===0){const y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{const y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(u===0?-1:1),this._rowElements[u===0?1:this._rowElements.length-2].focus(),h.preventDefault(),h.stopImmediatePropagation()}_handleSelectionChange(){var A;if(this._rowElements.length===0)return;const h=document.getSelection();if(!h)return;if(h.isCollapsed)return void(this._rowContainer.contains(h.anchorNode)&&this._terminal.clearSelection());if(!h.anchorNode||!h.focusNode)return void console.error("anchorNode and/or focusNode are null");let u={node:h.anchorNode,offset:h.anchorOffset},g={node:h.focusNode,offset:h.focusOffset};if((u.node.compareDocumentPosition(g.node)&Node.DOCUMENT_POSITION_PRECEDING||u.node===g.node&&u.offset>g.offset)&&([u,g]=[g,u]),u.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(u={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(u.node))return;const E=this._rowElements.slice(-1)[0];if(g.node.compareDocumentPosition(E)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(g={node:E,offset:((A=E.textContent)==null?void 0:A.length)??0}),!this._rowContainer.contains(g.node))return;const x=({node:O,offset:U})=>{const H=O instanceof Text?O.parentNode:O;let B=parseInt(H==null?void 0:H.getAttribute("aria-posinset"),10)-1;if(isNaN(B))return console.warn("row is invalid. Race condition?"),null;const j=this._rowColumns.get(H);if(!j)return console.warn("columns is null. Race condition?"),null;let q=U<j.length?j[U]:j.slice(-1)[0]+1;return q>=this._terminal.cols&&(++B,q=0),{row:B,column:q}},R=x(u),y=x(g);if(R&&y){if(R.row>y.row||R.row===y.row&&R.column>=y.column)throw new Error("invalid range");this._terminal.select(R.column,R.row,(y.row-R.row)*this._terminal.cols-R.column+y.column)}}_handleResize(h){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let u=this._rowContainer.children.length;u<this._terminal.rows;u++)this._rowElements[u]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[u]);for(;this._rowElements.length>h;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const h=this._coreBrowserService.mainDocument.createElement("div");return h.setAttribute("role","listitem"),h.tabIndex=-1,this._refreshRowDimensions(h),h}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let h=0;h<this._terminal.rows;h++)this._refreshRowDimensions(this._rowElements[h])}}_refreshRowDimensions(h){h.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s.AccessibilityManager=f=c([_(1,v.IInstantiationService),_(2,b.ICoreBrowserService),_(3,b.IRenderService)],f)},3614:(p,s)=>{function a(m){return m.replace(/\r?\n/g,"\r")}function c(m,S){return S?"\x1B[200~"+m+"\x1B[201~":m}function _(m,S,b,v){m=c(m=a(m),b.decPrivateModes.bracketedPasteMode&&v.rawOptions.ignoreBracketedPasteMode!==!0),b.triggerDataEvent(m,!0),S.value=""}function d(m,S,b){const v=b.getBoundingClientRect(),l=m.clientX-v.left-10,f=m.clientY-v.top-10;S.style.width="20px",S.style.height="20px",S.style.left=`${l}px`,S.style.top=`${f}px`,S.style.zIndex="1000",S.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=a,s.bracketTextForPaste=c,s.copyHandler=function(m,S){m.clipboardData&&m.clipboardData.setData("text/plain",S.selectionText),m.preventDefault()},s.handlePasteEvent=function(m,S,b,v){m.stopPropagation(),m.clipboardData&&_(m.clipboardData.getData("text/plain"),S,b,v)},s.paste=_,s.moveTextAreaUnderMouseCursor=d,s.rightClickHandler=function(m,S,b,v,l){d(m,S,b),l&&v.rightClickSelect(m),S.value=v.selectionText,S.select()}},7239:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const c=a(1505);s.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(_,d,m){this._css.set(_,d,m)}getCss(_,d){return this._css.get(_,d)}setColor(_,d,m){this._color.set(_,d,m)}getColor(_,d){return this._color.get(_,d)}clear(){this._color.clear(),this._css.clear()}}},3656:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(a,c,_,d){a.addEventListener(c,_,d);let m=!1;return{dispose:()=>{m||(m=!0,a.removeEventListener(c,_,d))}}}},3551:function(p,s,a){var c=this&&this.__decorate||function(f,h,u,g){var E,x=arguments.length,R=x<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,u):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(f,h,u,g);else for(var y=f.length-1;y>=0;y--)(E=f[y])&&(R=(x<3?E(R):x>3?E(h,u,R):E(h,u))||R);return x>3&&R&&Object.defineProperty(h,u,R),R},_=this&&this.__param||function(f,h){return function(u,g){h(u,g,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier=void 0;const d=a(3656),m=a(8460),S=a(844),b=a(2585),v=a(4725);let l=s.Linkifier=class extends S.Disposable{get currentLink(){return this._currentLink}constructor(f,h,u,g,E){super(),this._element=f,this._mouseService=h,this._renderService=u,this._bufferService=g,this._linkProviderService=E,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new m.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new m.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,S.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,S.toDisposable)(()=>{var x;this._lastMouseEvent=void 0,(x=this._activeProviderReplies)==null||x.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,d.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,d.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(f){this._lastMouseEvent=f;const h=this._positionFromMouseEvent(f,this._element,this._mouseService);if(!h)return;this._isMouseOut=!1;const u=f.composedPath();for(let g=0;g<u.length;g++){const E=u[g];if(E.classList.contains("xterm"))break;if(E.classList.contains("xterm-hover"))return}this._lastBufferCell&&h.x===this._lastBufferCell.x&&h.y===this._lastBufferCell.y||(this._handleHover(h),this._lastBufferCell=h)}_handleHover(f){if(this._activeLine!==f.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(f,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,f)||(this._clearCurrentLink(),this._askForLink(f,!0))}_askForLink(f,h){var g,E;this._activeProviderReplies&&h||((g=this._activeProviderReplies)==null||g.forEach(x=>{x==null||x.forEach(R=>{R.link.dispose&&R.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=f.y);let u=!1;for(const[x,R]of this._linkProviderService.linkProviders.entries())h?(E=this._activeProviderReplies)!=null&&E.get(x)&&(u=this._checkLinkProviderResult(x,f,u)):R.provideLinks(f.y,y=>{var O,U;if(this._isMouseOut)return;const A=y==null?void 0:y.map(H=>({link:H}));(O=this._activeProviderReplies)==null||O.set(x,A),u=this._checkLinkProviderResult(x,f,u),((U=this._activeProviderReplies)==null?void 0:U.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(f.y,this._activeProviderReplies)})}_removeIntersectingLinks(f,h){const u=new Set;for(let g=0;g<h.size;g++){const E=h.get(g);if(E)for(let x=0;x<E.length;x++){const R=E[x],y=R.link.range.start.y<f?0:R.link.range.start.x,A=R.link.range.end.y>f?this._bufferService.cols:R.link.range.end.x;for(let O=y;O<=A;O++){if(u.has(O)){E.splice(x--,1);break}u.add(O)}}}}_checkLinkProviderResult(f,h,u){var x;if(!this._activeProviderReplies)return u;const g=this._activeProviderReplies.get(f);let E=!1;for(let R=0;R<f;R++)this._activeProviderReplies.has(R)&&!this._activeProviderReplies.get(R)||(E=!0);if(!E&&g){const R=g.find(y=>this._linkAtPosition(y.link,h));R&&(u=!0,this._handleNewLink(R))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!u)for(let R=0;R<this._activeProviderReplies.size;R++){const y=(x=this._activeProviderReplies.get(R))==null?void 0:x.find(A=>this._linkAtPosition(A.link,h));if(y){u=!0,this._handleNewLink(y);break}}return u}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(f){if(!this._currentLink)return;const h=this._positionFromMouseEvent(f,this._element,this._mouseService);h&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,h)&&this._currentLink.link.activate(f,this._currentLink.link.text)}_clearCurrentLink(f,h){this._currentLink&&this._lastMouseEvent&&(!f||!h||this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=h)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,S.disposeArray)(this._linkCacheDisposables))}_handleNewLink(f){if(!this._lastMouseEvent)return;const h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._linkAtPosition(f.link,h)&&(this._currentLink=f,this._currentLink.state={decorations:{underline:f.link.decorations===void 0||f.link.decorations.underline,pointerCursor:f.link.decorations===void 0||f.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,f.link,this._lastMouseEvent),f.link.decorations={},Object.defineProperties(f.link.decorations,{pointerCursor:{get:()=>{var u,g;return(g=(u=this._currentLink)==null?void 0:u.state)==null?void 0:g.decorations.pointerCursor},set:u=>{var g;(g=this._currentLink)!=null&&g.state&&this._currentLink.state.decorations.pointerCursor!==u&&(this._currentLink.state.decorations.pointerCursor=u,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",u))}},underline:{get:()=>{var u,g;return(g=(u=this._currentLink)==null?void 0:u.state)==null?void 0:g.decorations.underline},set:u=>{var g,E,x;(g=this._currentLink)!=null&&g.state&&((x=(E=this._currentLink)==null?void 0:E.state)==null?void 0:x.decorations.underline)!==u&&(this._currentLink.state.decorations.underline=u,this._currentLink.state.isHovered&&this._fireUnderlineEvent(f.link,u))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(u=>{if(!this._currentLink)return;const g=u.start===0?0:u.start+1+this._bufferService.buffer.ydisp,E=this._bufferService.buffer.ydisp+1+u.end;if(this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=E&&(this._clearCurrentLink(g,E),this._lastMouseEvent)){const x=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);x&&this._askForLink(x,!1)}})))}_linkHover(f,h,u){var g;(g=this._currentLink)!=null&&g.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!0),this._currentLink.state.decorations.pointerCursor&&f.classList.add("xterm-cursor-pointer")),h.hover&&h.hover(u,h.text)}_fireUnderlineEvent(f,h){const u=f.range,g=this._bufferService.buffer.ydisp,E=this._createLinkUnderlineEvent(u.start.x-1,u.start.y-g-1,u.end.x,u.end.y-g-1,void 0);(h?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(E)}_linkLeave(f,h,u){var g;(g=this._currentLink)!=null&&g.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!1),this._currentLink.state.decorations.pointerCursor&&f.classList.remove("xterm-cursor-pointer")),h.leave&&h.leave(u,h.text)}_linkAtPosition(f,h){const u=f.range.start.y*this._bufferService.cols+f.range.start.x,g=f.range.end.y*this._bufferService.cols+f.range.end.x,E=h.y*this._bufferService.cols+h.x;return u<=E&&E<=g}_positionFromMouseEvent(f,h,u){const g=u.getCoords(f,h,this._bufferService.cols,this._bufferService.rows);if(g)return{x:g[0],y:g[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(f,h,u,g,E){return{x1:f,y1:h,x2:u,y2:g,cols:this._bufferService.cols,fg:E}}};s.Linkifier=l=c([_(1,v.IMouseService),_(2,v.IRenderService),_(3,b.IBufferService),_(4,v.ILinkProviderService)],l)},9042:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(p,s,a){var c=this&&this.__decorate||function(v,l,f,h){var u,g=arguments.length,E=g<3?l:h===null?h=Object.getOwnPropertyDescriptor(l,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(v,l,f,h);else for(var x=v.length-1;x>=0;x--)(u=v[x])&&(E=(g<3?u(E):g>3?u(l,f,E):u(l,f))||E);return g>3&&E&&Object.defineProperty(l,f,E),E},_=this&&this.__param||function(v,l){return function(f,h){l(f,h,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const d=a(511),m=a(2585);let S=s.OscLinkProvider=class{constructor(v,l,f){this._bufferService=v,this._optionsService=l,this._oscLinkService=f}provideLinks(v,l){var A;const f=this._bufferService.buffer.lines.get(v-1);if(!f)return void l(void 0);const h=[],u=this._optionsService.rawOptions.linkHandler,g=new d.CellData,E=f.getTrimmedLength();let x=-1,R=-1,y=!1;for(let O=0;O<E;O++)if(R!==-1||f.hasContent(O)){if(f.loadCell(O,g),g.hasExtendedAttrs()&&g.extended.urlId){if(R===-1){R=O,x=g.extended.urlId;continue}y=g.extended.urlId!==x}else R!==-1&&(y=!0);if(y||R!==-1&&O===E-1){const U=(A=this._oscLinkService.getLinkData(x))==null?void 0:A.uri;if(U){const H={start:{x:R+1,y:v},end:{x:O+(y||O!==E-1?0:1),y:v}};let B=!1;if(!(u!=null&&u.allowNonHttpProtocols))try{const j=new URL(U);["http:","https:"].includes(j.protocol)||(B=!0)}catch{B=!0}B||h.push({text:U,range:H,activate:(j,q)=>u?u.activate(j,q,H):b(0,q),hover:(j,q)=>{var Q;return(Q=u==null?void 0:u.hover)==null?void 0:Q.call(u,j,q,H)},leave:(j,q)=>{var Q;return(Q=u==null?void 0:u.leave)==null?void 0:Q.call(u,j,q,H)}})}y=!1,g.hasExtendedAttrs()&&g.extended.urlId?(R=O,x=g.extended.urlId):(R=-1,x=-1)}}l(h)}};function b(v,l){if(confirm(`Do you want to navigate to ${l}?

WARNING: This link could potentially be dangerous`)){const f=window.open();if(f){try{f.opener=null}catch{}f.location.href=l}else console.warn("Opening link blocked as opener could not be cleared")}}s.OscLinkProvider=S=c([_(0,m.IBufferService),_(1,m.IOptionsService),_(2,m.IOscLinkService)],S)},6193:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(a,c){this._renderCallback=a,this._coreBrowserService=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,c,_){this._rowCount=_,a=a!==void 0?a:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},3236:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const c=a(3614),_=a(3656),d=a(3551),m=a(9042),S=a(3730),b=a(1680),v=a(3107),l=a(5744),f=a(2950),h=a(1296),u=a(428),g=a(4269),E=a(5114),x=a(8934),R=a(3230),y=a(9312),A=a(4725),O=a(6731),U=a(8055),H=a(8969),B=a(8460),j=a(844),q=a(6114),Q=a(8437),ie=a(2584),te=a(7399),D=a(5941),T=a(9074),k=a(2585),M=a(5435),$=a(4567),V=a(779);class Z extends H.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(F={}){super(F),this.browser=q,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new j.MutableDisposable),this._onCursorMove=this.register(new B.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new B.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new B.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new B.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new B.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new B.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new B.EventEmitter),this._onBlur=this.register(new B.EventEmitter),this._onA11yCharEmitter=this.register(new B.EventEmitter),this._onA11yTabEmitter=this.register(new B.EventEmitter),this._onWillOpen=this.register(new B.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(T.DecorationService),this._instantiationService.setService(k.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(V.LinkProviderService),this._instantiationService.setService(A.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(S.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((I,z)=>this.refresh(I,z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(I=>this._reportWindowsOptions(I))),this.register(this._inputHandler.onColor(I=>this._handleColorEvent(I))),this.register((0,B.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,B.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(I=>this._afterResize(I.cols,I.rows))),this.register((0,j.toDisposable)(()=>{var I,z;this._customKeyEventHandler=void 0,(z=(I=this.element)==null?void 0:I.parentNode)==null||z.removeChild(this.element)}))}_handleColorEvent(F){if(this._themeService)for(const I of F){let z,W="";switch(I.index){case 256:z="foreground",W="10";break;case 257:z="background",W="11";break;case 258:z="cursor",W="12";break;default:z="ansi",W="4;"+I.index}switch(I.type){case 0:const X=U.color.toColorRGB(z==="ansi"?this._themeService.colors.ansi[I.index]:this._themeService.colors[z]);this.coreService.triggerDataEvent(`${ie.C0.ESC}]${W};${(0,D.toRgbString)(X)}${ie.C1_ESCAPED.ST}`);break;case 1:if(z==="ansi")this._themeService.modifyColors(Y=>Y.ansi[I.index]=U.channels.toColor(...I.color));else{const Y=z;this._themeService.modifyColors(le=>le[Y]=U.channels.toColor(...I.color))}break;case 2:this._themeService.restoreColor(I.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(F){F?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance($.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(F){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ie.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var F;return(F=this.textarea)==null?void 0:F.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ie.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const F=this.buffer.ybase+this.buffer.y,I=this.buffer.lines.get(F);if(!I)return;const z=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,X=I.getWidth(z),Y=this._renderService.dimensions.css.cell.width*X,le=this.buffer.y*this._renderService.dimensions.css.cell.height,ae=z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ae+"px",this.textarea.style.top=le+"px",this.textarea.style.width=Y+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,_.addDisposableDomListener)(this.element,"copy",I=>{this.hasSelection()&&(0,c.copyHandler)(I,this._selectionService)}));const F=I=>(0,c.handlePasteEvent)(I,this.textarea,this.coreService,this.optionsService);this.register((0,_.addDisposableDomListener)(this.textarea,"paste",F)),this.register((0,_.addDisposableDomListener)(this.element,"paste",F)),q.isFirefox?this.register((0,_.addDisposableDomListener)(this.element,"mousedown",I=>{I.button===2&&(0,c.rightClickHandler)(I,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,_.addDisposableDomListener)(this.element,"contextmenu",I=>{(0,c.rightClickHandler)(I,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),q.isLinux&&this.register((0,_.addDisposableDomListener)(this.element,"auxclick",I=>{I.button===1&&(0,c.moveTextAreaUnderMouseCursor)(I,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,_.addDisposableDomListener)(this.textarea,"keyup",F=>this._keyUp(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keydown",F=>this._keyDown(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keypress",F=>this._keyPress(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionupdate",F=>this._compositionHelper.compositionupdate(F))),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,_.addDisposableDomListener)(this.textarea,"input",F=>this._inputEvent(F),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(F){var z;if(!F)throw new Error("Terminal requires a parent element.");if(F.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((z=this.element)==null?void 0:z.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=F.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),F.appendChild(this.element);const I=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),I.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,_.addDisposableDomListener)(this.screenElement,"mousemove",W=>this.updateCursorStyle(W))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),I.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",m.promptLabel),q.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(E.CoreBrowserService,this.textarea,F.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(A.ICoreBrowserService,this._coreBrowserService),this.register((0,_.addDisposableDomListener)(this.textarea,"focus",W=>this._handleTextAreaFocus(W))),this.register((0,_.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(u.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(A.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(O.ThemeService),this._instantiationService.setService(A.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(g.CharacterJoinerService),this._instantiationService.setService(A.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(R.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(A.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(W=>this._onRender.fire(W))),this.onResize(W=>this._renderService.resize(W.cols,W.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(f.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(x.MouseService),this._instantiationService.setService(A.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(d.Linkifier,this.screenElement)),this.element.appendChild(I);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(b.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(y.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(A.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(W=>this._renderService.handleSelectionChanged(W.start,W.end,W.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(W=>{this.textarea.value=W,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(W=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(v.BufferDecorationRenderer,this.screenElement)),this.register((0,_.addDisposableDomListener)(this.element,"mousedown",W=>this._selectionService.handleMouseDown(W))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance($.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",W=>this._handleScreenReaderModeOptionChange(W))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(l.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",W=>{!this._overviewRulerRenderer&&W&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(l.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(h.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const F=this,I=this.element;function z(Y){const le=F._mouseService.getMouseReportCoords(Y,F.screenElement);if(!le)return!1;let ae,de;switch(Y.overrideType||Y.type){case"mousemove":de=32,Y.buttons===void 0?(ae=3,Y.button!==void 0&&(ae=Y.button<3?Y.button:3)):ae=1&Y.buttons?0:4&Y.buttons?1:2&Y.buttons?2:3;break;case"mouseup":de=0,ae=Y.button<3?Y.button:3;break;case"mousedown":de=1,ae=Y.button<3?Y.button:3;break;case"wheel":if(F._customWheelEventHandler&&F._customWheelEventHandler(Y)===!1||F.viewport.getLinesScrolled(Y)===0)return!1;de=Y.deltaY<0?0:1,ae=4;break;default:return!1}return!(de===void 0||ae===void 0||ae>4)&&F.coreMouseService.triggerMouseEvent({col:le.col,row:le.row,x:le.x,y:le.y,button:ae,action:de,ctrl:Y.ctrlKey,alt:Y.altKey,shift:Y.shiftKey})}const W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},X={mouseup:Y=>(z(Y),Y.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(Y)),wheel:Y=>(z(Y),this.cancel(Y,!0)),mousedrag:Y=>{Y.buttons&&z(Y)},mousemove:Y=>{Y.buttons||z(Y)}};this.register(this.coreMouseService.onProtocolChange(Y=>{Y?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Y)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Y?W.mousemove||(I.addEventListener("mousemove",X.mousemove),W.mousemove=X.mousemove):(I.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&Y?W.wheel||(I.addEventListener("wheel",X.wheel,{passive:!1}),W.wheel=X.wheel):(I.removeEventListener("wheel",W.wheel),W.wheel=null),2&Y?W.mouseup||(W.mouseup=X.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&Y?W.mousedrag||(W.mousedrag=X.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,_.addDisposableDomListener)(I,"mousedown",Y=>{if(Y.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Y))return z(Y),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(Y)})),this.register((0,_.addDisposableDomListener)(I,"wheel",Y=>{if(!W.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(Y)===!1)return!1;if(!this.buffer.hasScrollback){const le=this.viewport.getLinesScrolled(Y);if(le===0)return;const ae=ie.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Y.deltaY<0?"A":"B");let de="";for(let ge=0;ge<Math.abs(le);ge++)de+=ae;return this.coreService.triggerDataEvent(de,!0),this.cancel(Y,!0)}return this.viewport.handleWheel(Y)?this.cancel(Y):void 0}},{passive:!1})),this.register((0,_.addDisposableDomListener)(I,"touchstart",Y=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Y),this.cancel(Y)},{passive:!0})),this.register((0,_.addDisposableDomListener)(I,"touchmove",Y=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Y)?void 0:this.cancel(Y)},{passive:!1}))}refresh(F,I){var z;(z=this._renderService)==null||z.refreshRows(F,I)}updateCursorStyle(F){var I;(I=this._selectionService)!=null&&I.shouldColumnSelect(F)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(F,I,z=0){var W;z===1?(super.scrollLines(F,I,z),this.refresh(0,this.rows-1)):(W=this.viewport)==null||W.scrollLines(F)}paste(F){(0,c.paste)(F,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(F){this._customKeyEventHandler=F}attachCustomWheelEventHandler(F){this._customWheelEventHandler=F}registerLinkProvider(F){return this._linkProviderService.registerLinkProvider(F)}registerCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const I=this._characterJoinerService.register(F);return this.refresh(0,this.rows-1),I}deregisterCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(F)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(F){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+F)}registerDecoration(F){return this._decorationService.registerDecoration(F)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(F,I,z){this._selectionService.setSelection(F,I,z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var F;(F=this._selectionService)==null||F.clearSelection()}selectAll(){var F;(F=this._selectionService)==null||F.selectAll()}selectLines(F,I){var z;(z=this._selectionService)==null||z.selectLines(F,I)}_keyDown(F){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;const I=this.browser.isMac&&this.options.macOptionIsMeta&&F.altKey;if(!I&&!this._compositionHelper.keydown(F))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;I||F.key!=="Dead"&&F.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const z=(0,te.evaluateKeyboardEvent)(F,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(F),z.type===3||z.type===2){const W=this.rows-1;return this.scrollLines(z.type===2?-W:W),this.cancel(F,!0)}return z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,F)||(z.cancel&&this.cancel(F,!0),!z.key||!!(F.key&&!F.ctrlKey&&!F.altKey&&!F.metaKey&&F.key.length===1&&F.key.charCodeAt(0)>=65&&F.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(z.key!==ie.C0.ETX&&z.key!==ie.C0.CR||(this.textarea.value=""),this._onKey.fire({key:z.key,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(z.key,!0),!this.optionsService.rawOptions.screenReaderMode||F.altKey||F.ctrlKey?this.cancel(F,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(F,I){const z=F.isMac&&!this.options.macOptionIsMeta&&I.altKey&&!I.ctrlKey&&!I.metaKey||F.isWindows&&I.altKey&&I.ctrlKey&&!I.metaKey||F.isWindows&&I.getModifierState("AltGraph");return I.type==="keypress"?z:z&&(!I.keyCode||I.keyCode>47)}_keyUp(F){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1||(function(I){return I.keyCode===16||I.keyCode===17||I.keyCode===18}(F)||this.focus(),this.updateCursorStyle(F),this._keyPressHandled=!1)}_keyPress(F){let I;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;if(this.cancel(F),F.charCode)I=F.charCode;else if(F.which===null||F.which===void 0)I=F.keyCode;else{if(F.which===0||F.charCode===0)return!1;I=F.which}return!(!I||(F.altKey||F.ctrlKey||F.metaKey)&&!this._isThirdLevelShift(this.browser,F)||(I=String.fromCharCode(I),this._onKey.fire({key:I,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(I,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(F){if(F.data&&F.inputType==="insertText"&&(!F.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const I=F.data;return this.coreService.triggerDataEvent(I,!0),this.cancel(F),!0}return!1}resize(F,I){F!==this.cols||I!==this.rows?super.resize(F,I):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(F,I){var z,W;(z=this._charSizeService)==null||z.measure(),(W=this.viewport)==null||W.syncScrollArea(!0)}clear(){var F;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let I=1;I<this.rows;I++)this.buffer.lines.push(this.buffer.getBlankLine(Q.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(F=this.viewport)==null||F.reset(),this.refresh(0,this.rows-1)}}reset(){var I,z;this.options.rows=this.rows,this.options.cols=this.cols;const F=this._customKeyEventHandler;this._setup(),super.reset(),(I=this._selectionService)==null||I.reset(),this._decorationService.reset(),(z=this.viewport)==null||z.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1)}clearTextureAtlas(){var F;(F=this._renderService)==null||F.clearTextureAtlas()}_reportFocus(){var F;(F=this.element)!=null&&F.classList.contains("focus")?this.coreService.triggerDataEvent(ie.C0.ESC+"[I"):this.coreService.triggerDataEvent(ie.C0.ESC+"[O")}_reportWindowsOptions(F){if(this._renderService)switch(F){case M.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const I=this._renderService.dimensions.css.canvas.width.toFixed(0),z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${ie.C0.ESC}[4;${z};${I}t`);break;case M.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const W=this._renderService.dimensions.css.cell.width.toFixed(0),X=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${ie.C0.ESC}[6;${X};${W}t`)}}cancel(F,I){if(this.options.cancelEvents||I)return F.preventDefault(),F.stopPropagation(),!1}}s.Terminal=Z},9924:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(a,c=1e3){this._renderCallback=a,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,c,_){this._rowCount=_,a=a!==void 0?a:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const d=Date.now();if(d-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=d,this._innerRefresh();else if(!this._additionalRefreshRequested){const m=d-this._lastRefreshMs,S=this._debounceThresholdMS-m;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},S)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const a=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,c)}}},1680:function(p,s,a){var c=this&&this.__decorate||function(f,h,u,g){var E,x=arguments.length,R=x<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,u):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(f,h,u,g);else for(var y=f.length-1;y>=0;y--)(E=f[y])&&(R=(x<3?E(R):x>3?E(h,u,R):E(h,u))||R);return x>3&&R&&Object.defineProperty(h,u,R),R},_=this&&this.__param||function(f,h){return function(u,g){h(u,g,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const d=a(3656),m=a(4725),S=a(8460),b=a(844),v=a(2585);let l=s.Viewport=class extends b.Disposable{constructor(f,h,u,g,E,x,R,y){super(),this._viewportElement=f,this._scrollArea=h,this._bufferService=u,this._optionsService=g,this._charSizeService=E,this._renderService=x,this._coreBrowserService=R,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new S.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(A=>this._activeBuffer=A.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(A=>this._renderDimensions=A)),this._handleThemeChange(y.colors),this.register(y.onChangeColors(A=>this._handleThemeChange(A))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(f){this._viewportElement.style.backgroundColor=f.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(f){if(f)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const h=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==h&&(this._lastRecordedBufferHeight=h,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const f=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==f&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=f),this._refreshAnimationFrame=null}syncScrollArea(f=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(f);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(f)}_handleScroll(f){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const h=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:h,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const f=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(f*(this._smoothScrollState.target-this._smoothScrollState.origin)),f<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(f,h){const u=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(h<0&&this._viewportElement.scrollTop!==0||h>0&&u<this._lastRecordedBufferHeight)||(f.cancelable&&f.preventDefault(),!1)}handleWheel(f){const h=this._getPixelsScrolled(f);return h!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+h:this._smoothScrollState.target+=h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}scrollLines(f){if(f!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const h=f*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:f,suppressScrollEvent:!1})}_getPixelsScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_LINE?h*=this._currentRowHeight:f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._currentRowHeight*this._bufferService.rows),h}getBufferElements(f,h){var y;let u,g="";const E=[],x=h??this._bufferService.buffer.lines.length,R=this._bufferService.buffer.lines;for(let A=f;A<x;A++){const O=R.get(A);if(!O)continue;const U=(y=R.get(A+1))==null?void 0:y.isWrapped;if(g+=O.translateToString(!U),!U||A===R.length-1){const H=document.createElement("div");H.textContent=g,E.push(H),g.length>0&&(u=H),g=""}}return{bufferElements:E,cursorElement:u}}getLinesScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(h/=this._currentRowHeight+0,this._wheelPartialScroll+=h,h=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._bufferService.rows),h}_applyScrollModifier(f,h){const u=this._optionsService.rawOptions.fastScrollModifier;return u==="alt"&&h.altKey||u==="ctrl"&&h.ctrlKey||u==="shift"&&h.shiftKey?f*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:f*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(f){this._lastTouchY=f.touches[0].pageY}handleTouchMove(f){const h=this._lastTouchY-f.touches[0].pageY;return this._lastTouchY=f.touches[0].pageY,h!==0&&(this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}};s.Viewport=l=c([_(2,v.IBufferService),_(3,v.IOptionsService),_(4,m.ICharSizeService),_(5,m.IRenderService),_(6,m.ICoreBrowserService),_(7,m.IThemeService)],l)},3107:function(p,s,a){var c=this&&this.__decorate||function(v,l,f,h){var u,g=arguments.length,E=g<3?l:h===null?h=Object.getOwnPropertyDescriptor(l,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(v,l,f,h);else for(var x=v.length-1;x>=0;x--)(u=v[x])&&(E=(g<3?u(E):g>3?u(l,f,E):u(l,f))||E);return g>3&&E&&Object.defineProperty(l,f,E),E},_=this&&this.__param||function(v,l){return function(f,h){l(f,h,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const d=a(4725),m=a(844),S=a(2585);let b=s.BufferDecorationRenderer=class extends m.Disposable{constructor(v,l,f,h,u){super(),this._screenElement=v,this._bufferService=l,this._coreBrowserService=f,this._decorationService=h,this._renderService=u,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(g=>this._removeDecoration(g))),this.register((0,m.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const v of this._decorationService.decorations)this._renderDecoration(v);this._dimensionsChanged=!1}_renderDecoration(v){this._refreshStyle(v),this._dimensionsChanged&&this._refreshXPosition(v)}_createElement(v){var h;const l=this._coreBrowserService.mainDocument.createElement("div");l.classList.add("xterm-decoration"),l.classList.toggle("xterm-decoration-top-layer",((h=v==null?void 0:v.options)==null?void 0:h.layer)==="top"),l.style.width=`${Math.round((v.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,l.style.height=(v.options.height||1)*this._renderService.dimensions.css.cell.height+"px",l.style.top=(v.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",l.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const f=v.options.x??0;return f&&f>this._bufferService.cols&&(l.style.display="none"),this._refreshXPosition(v,l),l}_refreshStyle(v){const l=v.marker.line-this._bufferService.buffers.active.ydisp;if(l<0||l>=this._bufferService.rows)v.element&&(v.element.style.display="none",v.onRenderEmitter.fire(v.element));else{let f=this._decorationElements.get(v);f||(f=this._createElement(v),v.element=f,this._decorationElements.set(v,f),this._container.appendChild(f),v.onDispose(()=>{this._decorationElements.delete(v),f.remove()})),f.style.top=l*this._renderService.dimensions.css.cell.height+"px",f.style.display=this._altBufferIsActive?"none":"block",v.onRenderEmitter.fire(f)}}_refreshXPosition(v,l=v.element){if(!l)return;const f=v.options.x??0;(v.options.anchor||"left")==="right"?l.style.right=f?f*this._renderService.dimensions.css.cell.width+"px":"":l.style.left=f?f*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(v){var l;(l=this._decorationElements.get(v))==null||l.remove(),this._decorationElements.delete(v),v.dispose()}};s.BufferDecorationRenderer=b=c([_(1,S.IBufferService),_(2,d.ICoreBrowserService),_(3,S.IDecorationService),_(4,d.IRenderService)],b)},5871:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const c of this._zones)if(c.color===a.options.overviewRulerOptions.color&&c.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,a.marker.line))return;if(this._lineAdjacentToZone(c,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(c,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,c){return c>=a.startBufferLine&&c<=a.endBufferLine}_lineAdjacentToZone(a,c,_){return c>=a.startBufferLine-this._linePadding[_||"full"]&&c<=a.endBufferLine+this._linePadding[_||"full"]}_addLineToZone(a,c){a.startBufferLine=Math.min(a.startBufferLine,c),a.endBufferLine=Math.max(a.endBufferLine,c)}}},5744:function(p,s,a){var c=this&&this.__decorate||function(u,g,E,x){var R,y=arguments.length,A=y<3?g:x===null?x=Object.getOwnPropertyDescriptor(g,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(u,g,E,x);else for(var O=u.length-1;O>=0;O--)(R=u[O])&&(A=(y<3?R(A):y>3?R(g,E,A):R(g,E))||A);return y>3&&A&&Object.defineProperty(g,E,A),A},_=this&&this.__param||function(u,g){return function(E,x){g(E,x,u)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const d=a(5871),m=a(4725),S=a(844),b=a(2585),v={full:0,left:0,center:0,right:0},l={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0};let h=s.OverviewRulerRenderer=class extends S.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(u,g,E,x,R,y,A){var U;super(),this._viewportElement=u,this._screenElement=g,this._bufferService=E,this._decorationService=x,this._renderService=R,this._optionsService=y,this._coreBrowserService=A,this._colorZoneStore=new d.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(U=this._viewportElement.parentElement)==null||U.insertBefore(this._canvas,this._viewportElement);const O=this._canvas.getContext("2d");if(!O)throw new Error("Ctx cannot be null");this._ctx=O,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,S.toDisposable)(()=>{var H;(H=this._canvas)==null||H.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const u=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);l.full=this._canvas.width,l.left=u,l.center=g,l.right=u,this._refreshDrawHeightConstants(),f.full=0,f.left=0,f.center=l.left,f.right=l.left+l.center}_refreshDrawHeightConstants(){v.full=Math.round(2*this._coreBrowserService.dpr);const u=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(u,12),6)*this._coreBrowserService.dpr);v.left=g,v.center=g,v.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*v.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*v.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*v.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*v.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const u=this._colorZoneStore.zones;for(const g of u)g.position!=="full"&&this._renderColorZone(g);for(const g of u)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(u){this._ctx.fillStyle=u.color,this._ctx.fillRect(f[u.position||"full"],Math.round((this._canvas.height-1)*(u.startBufferLine/this._bufferService.buffers.active.lines.length)-v[u.position||"full"]/2),l[u.position||"full"],Math.round((this._canvas.height-1)*((u.endBufferLine-u.startBufferLine)/this._bufferService.buffers.active.lines.length)+v[u.position||"full"]))}_queueRefresh(u,g){this._shouldUpdateDimensions=u||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s.OverviewRulerRenderer=h=c([_(2,b.IBufferService),_(3,b.IDecorationService),_(4,m.IRenderService),_(5,b.IOptionsService),_(6,m.ICoreBrowserService)],h)},2950:function(p,s,a){var c=this&&this.__decorate||function(v,l,f,h){var u,g=arguments.length,E=g<3?l:h===null?h=Object.getOwnPropertyDescriptor(l,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(v,l,f,h);else for(var x=v.length-1;x>=0;x--)(u=v[x])&&(E=(g<3?u(E):g>3?u(l,f,E):u(l,f))||E);return g>3&&E&&Object.defineProperty(l,f,E),E},_=this&&this.__param||function(v,l){return function(f,h){l(f,h,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const d=a(4725),m=a(2585),S=a(2584);let b=s.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(v,l,f,h,u,g){this._textarea=v,this._compositionView=l,this._bufferService=f,this._optionsService=h,this._coreService=u,this._renderService=g,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(v){this._compositionView.textContent=v.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(v){if(this._isComposing||this._isSendingComposition){if(v.keyCode===229||v.keyCode===16||v.keyCode===17||v.keyCode===18)return!1;this._finalizeComposition(!1)}return v.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(v){if(this._compositionView.classList.remove("active"),this._isComposing=!1,v){const l={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let f;this._isSendingComposition=!1,l.start+=this._dataAlreadySent.length,f=this._isComposing?this._textarea.value.substring(l.start,l.end):this._textarea.value.substring(l.start),f.length>0&&this._coreService.triggerDataEvent(f,!0)}},0)}else{this._isSendingComposition=!1;const l=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(l,!0)}}_handleAnyTextareaChanges(){const v=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const l=this._textarea.value,f=l.replace(v,"");this._dataAlreadySent=f,l.length>v.length?this._coreService.triggerDataEvent(f,!0):l.length<v.length?this._coreService.triggerDataEvent(`${S.C0.DEL}`,!0):l.length===v.length&&l!==v&&this._coreService.triggerDataEvent(l,!0)}},0)}updateCompositionElements(v){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const l=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),f=this._renderService.dimensions.css.cell.height,h=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,u=l*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=u+"px",this._compositionView.style.top=h+"px",this._compositionView.style.height=f+"px",this._compositionView.style.lineHeight=f+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const g=this._compositionView.getBoundingClientRect();this._textarea.style.left=u+"px",this._textarea.style.top=h+"px",this._textarea.style.width=Math.max(g.width,1)+"px",this._textarea.style.height=Math.max(g.height,1)+"px",this._textarea.style.lineHeight=g.height+"px"}v||setTimeout(()=>this.updateCompositionElements(!0),0)}}};s.CompositionHelper=b=c([_(2,m.IBufferService),_(3,m.IOptionsService),_(4,m.ICoreService),_(5,d.IRenderService)],b)},9806:(p,s)=>{function a(c,_,d){const m=d.getBoundingClientRect(),S=c.getComputedStyle(d),b=parseInt(S.getPropertyValue("padding-left")),v=parseInt(S.getPropertyValue("padding-top"));return[_.clientX-m.left-b,_.clientY-m.top-v]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=a,s.getCoords=function(c,_,d,m,S,b,v,l,f){if(!b)return;const h=a(c,_,d);return h?(h[0]=Math.ceil((h[0]+(f?v/2:0))/v),h[1]=Math.ceil(h[1]/l),h[0]=Math.min(Math.max(h[0],1),m+(f?1:0)),h[1]=Math.min(Math.max(h[1],1),S),h):void 0}},9504:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const c=a(2584);function _(l,f,h,u){const g=l-d(l,h),E=f-d(f,h),x=Math.abs(g-E)-function(R,y,A){let O=0;const U=R-d(R,A),H=y-d(y,A);for(let B=0;B<Math.abs(U-H);B++){const j=m(R,y)==="A"?-1:1,q=A.buffer.lines.get(U+j*B);q!=null&&q.isWrapped&&O++}return O}(l,f,h);return v(x,b(m(l,f),u))}function d(l,f){let h=0,u=f.buffer.lines.get(l),g=u==null?void 0:u.isWrapped;for(;g&&l>=0&&l<f.rows;)h++,u=f.buffer.lines.get(--l),g=u==null?void 0:u.isWrapped;return h}function m(l,f){return l>f?"A":"B"}function S(l,f,h,u,g,E){let x=l,R=f,y="";for(;x!==h||R!==u;)x+=g?1:-1,g&&x>E.cols-1?(y+=E.buffer.translateBufferLineToString(R,!1,l,x),x=0,l=0,R++):!g&&x<0&&(y+=E.buffer.translateBufferLineToString(R,!1,0,l+1),x=E.cols-1,l=x,R--);return y+E.buffer.translateBufferLineToString(R,!1,l,x)}function b(l,f){const h=f?"O":"[";return c.C0.ESC+h+l}function v(l,f){l=Math.floor(l);let h="";for(let u=0;u<l;u++)h+=f;return h}s.moveToCellSequence=function(l,f,h,u){const g=h.buffer.x,E=h.buffer.y;if(!h.buffer.hasScrollback)return function(y,A,O,U,H,B){return _(A,U,H,B).length===0?"":v(S(y,A,y,A-d(A,H),!1,H).length,b("D",B))}(g,E,0,f,h,u)+_(E,f,h,u)+function(y,A,O,U,H,B){let j;j=_(A,U,H,B).length>0?U-d(U,H):A;const q=U,Q=function(ie,te,D,T,k,M){let $;return $=_(D,T,k,M).length>0?T-d(T,k):te,ie<D&&$<=T||ie>=D&&$<T?"C":"D"}(y,A,O,U,H,B);return v(S(y,j,O,q,Q==="C",H).length,b(Q,B))}(g,E,l,f,h,u);let x;if(E===f)return x=g>l?"D":"C",v(Math.abs(g-l),b(x,u));x=E>f?"D":"C";const R=Math.abs(E-f);return v(function(y,A){return A.cols-y}(E>f?l:g,h)+(R-1)*h.cols+1+((E>f?g:l)-1),b(x,u))}},1296:function(p,s,a){var c=this&&this.__decorate||function(B,j,q,Q){var ie,te=arguments.length,D=te<3?j:Q===null?Q=Object.getOwnPropertyDescriptor(j,q):Q;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(B,j,q,Q);else for(var T=B.length-1;T>=0;T--)(ie=B[T])&&(D=(te<3?ie(D):te>3?ie(j,q,D):ie(j,q))||D);return te>3&&D&&Object.defineProperty(j,q,D),D},_=this&&this.__param||function(B,j){return function(q,Q){j(q,Q,B)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const d=a(3787),m=a(2550),S=a(2223),b=a(6171),v=a(6052),l=a(4725),f=a(8055),h=a(8460),u=a(844),g=a(2585),E="xterm-dom-renderer-owner-",x="xterm-rows",R="xterm-fg-",y="xterm-bg-",A="xterm-focus",O="xterm-selection";let U=1,H=s.DomRenderer=class extends u.Disposable{constructor(B,j,q,Q,ie,te,D,T,k,M,$,V,Z){super(),this._terminal=B,this._document=j,this._element=q,this._screenElement=Q,this._viewportElement=ie,this._helperContainer=te,this._linkifier2=D,this._charSizeService=k,this._optionsService=M,this._bufferService=$,this._coreBrowserService=V,this._themeService=Z,this._terminalClass=U++,this._rowElements=[],this._selectionRenderModel=(0,v.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new h.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(x),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(O),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,b.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(ee=>this._injectCss(ee))),this._injectCss(this._themeService.colors),this._rowFactory=T.createInstance(d.DomRendererRowFactory,document),this._element.classList.add(E+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(ee=>this._handleLinkHover(ee))),this.register(this._linkifier2.onHideLinkUnderline(ee=>this._handleLinkLeave(ee))),this.register((0,u.toDisposable)(()=>{this._element.classList.remove(E+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new m.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const B=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*B,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*B),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/B),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/B),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const q of this._rowElements)q.style.width=`${this.dimensions.css.canvas.width}px`,q.style.height=`${this.dimensions.css.cell.height}px`,q.style.lineHeight=`${this.dimensions.css.cell.height}px`,q.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const j=`${this._terminalSelector} .${x} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=j,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(B){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let j=`${this._terminalSelector} .${x} { color: ${B.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;j+=`${this._terminalSelector} .${x} .xterm-dim { color: ${f.color.multiplyOpacity(B.foreground,.5).css};}`,j+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const q=`blink_underline_${this._terminalClass}`,Q=`blink_bar_${this._terminalClass}`,ie=`blink_block_${this._terminalClass}`;j+=`@keyframes ${q} { 50% {  border-bottom-style: hidden; }}`,j+=`@keyframes ${Q} { 50% {  box-shadow: none; }}`,j+=`@keyframes ${ie} { 0% {  background-color: ${B.cursor.css};  color: ${B.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${B.cursor.css}; }}`,j+=`${this._terminalSelector} .${x}.${A} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${q} 1s step-end infinite;}${this._terminalSelector} .${x}.${A} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${Q} 1s step-end infinite;}${this._terminalSelector} .${x}.${A} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${ie} 1s step-end infinite;}${this._terminalSelector} .${x} .xterm-cursor.xterm-cursor-block { background-color: ${B.cursor.css}; color: ${B.cursorAccent.css};}${this._terminalSelector} .${x} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${B.cursor.css} !important; color: ${B.cursorAccent.css} !important;}${this._terminalSelector} .${x} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${B.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${x} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${B.cursor.css} inset;}${this._terminalSelector} .${x} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${B.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,j+=`${this._terminalSelector} .${O} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${O} div { position: absolute; background-color: ${B.selectionBackgroundOpaque.css};}${this._terminalSelector} .${O} div { position: absolute; background-color: ${B.selectionInactiveBackgroundOpaque.css};}`;for(const[te,D]of B.ansi.entries())j+=`${this._terminalSelector} .${R}${te} { color: ${D.css}; }${this._terminalSelector} .${R}${te}.xterm-dim { color: ${f.color.multiplyOpacity(D,.5).css}; }${this._terminalSelector} .${y}${te} { background-color: ${D.css}; }`;j+=`${this._terminalSelector} .${R}${S.INVERTED_DEFAULT_COLOR} { color: ${f.color.opaque(B.background).css}; }${this._terminalSelector} .${R}${S.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${f.color.multiplyOpacity(f.color.opaque(B.background),.5).css}; }${this._terminalSelector} .${y}${S.INVERTED_DEFAULT_COLOR} { background-color: ${B.foreground.css}; }`,this._themeStyleElement.textContent=j}_setDefaultSpacing(){const B=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${B}px`,this._rowFactory.defaultSpacing=B}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(B,j){for(let q=this._rowElements.length;q<=j;q++){const Q=this._document.createElement("div");this._rowContainer.appendChild(Q),this._rowElements.push(Q)}for(;this._rowElements.length>j;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(B,j){this._refreshRowElements(B,j),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(A),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(A),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(B,j,q){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(B,j,q),this.renderRows(0,this._bufferService.rows-1),!B||!j)return;this._selectionRenderModel.update(this._terminal,B,j,q);const Q=this._selectionRenderModel.viewportStartRow,ie=this._selectionRenderModel.viewportEndRow,te=this._selectionRenderModel.viewportCappedStartRow,D=this._selectionRenderModel.viewportCappedEndRow;if(te>=this._bufferService.rows||D<0)return;const T=this._document.createDocumentFragment();if(q){const k=B[0]>j[0];T.appendChild(this._createSelectionElement(te,k?j[0]:B[0],k?B[0]:j[0],D-te+1))}else{const k=Q===te?B[0]:0,M=te===ie?j[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(te,k,M));const $=D-te-1;if(T.appendChild(this._createSelectionElement(te+1,0,this._bufferService.cols,$)),te!==D){const V=ie===D?j[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(D,0,V))}}this._selectionContainer.appendChild(T)}_createSelectionElement(B,j,q,Q=1){const ie=this._document.createElement("div"),te=j*this.dimensions.css.cell.width;let D=this.dimensions.css.cell.width*(q-j);return te+D>this.dimensions.css.canvas.width&&(D=this.dimensions.css.canvas.width-te),ie.style.height=Q*this.dimensions.css.cell.height+"px",ie.style.top=B*this.dimensions.css.cell.height+"px",ie.style.left=`${te}px`,ie.style.width=`${D}px`,ie}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const B of this._rowElements)B.replaceChildren()}renderRows(B,j){const q=this._bufferService.buffer,Q=q.ybase+q.y,ie=Math.min(q.x,this._bufferService.cols-1),te=this._optionsService.rawOptions.cursorBlink,D=this._optionsService.rawOptions.cursorStyle,T=this._optionsService.rawOptions.cursorInactiveStyle;for(let k=B;k<=j;k++){const M=k+q.ydisp,$=this._rowElements[k],V=q.lines.get(M);if(!$||!V)break;$.replaceChildren(...this._rowFactory.createRow(V,M,M===Q,D,T,ie,te,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${E}${this._terminalClass}`}_handleLinkHover(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!0)}_handleLinkLeave(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!1)}_setCellUnderline(B,j,q,Q,ie,te){q<0&&(B=0),Q<0&&(j=0);const D=this._bufferService.rows-1;q=Math.max(Math.min(q,D),0),Q=Math.max(Math.min(Q,D),0),ie=Math.min(ie,this._bufferService.cols);const T=this._bufferService.buffer,k=T.ybase+T.y,M=Math.min(T.x,ie-1),$=this._optionsService.rawOptions.cursorBlink,V=this._optionsService.rawOptions.cursorStyle,Z=this._optionsService.rawOptions.cursorInactiveStyle;for(let ee=q;ee<=Q;++ee){const F=ee+T.ydisp,I=this._rowElements[ee],z=T.lines.get(F);if(!I||!z)break;I.replaceChildren(...this._rowFactory.createRow(z,F,F===k,V,Z,M,$,this.dimensions.css.cell.width,this._widthCache,te?ee===q?B:0:-1,te?(ee===Q?j:ie)-1:-1))}}};s.DomRenderer=H=c([_(7,g.IInstantiationService),_(8,l.ICharSizeService),_(9,g.IOptionsService),_(10,g.IBufferService),_(11,l.ICoreBrowserService),_(12,l.IThemeService)],H)},3787:function(p,s,a){var c=this&&this.__decorate||function(x,R,y,A){var O,U=arguments.length,H=U<3?R:A===null?A=Object.getOwnPropertyDescriptor(R,y):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(x,R,y,A);else for(var B=x.length-1;B>=0;B--)(O=x[B])&&(H=(U<3?O(H):U>3?O(R,y,H):O(R,y))||H);return U>3&&H&&Object.defineProperty(R,y,H),H},_=this&&this.__param||function(x,R){return function(y,A){R(y,A,x)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=void 0;const d=a(2223),m=a(643),S=a(511),b=a(2585),v=a(8055),l=a(4725),f=a(4269),h=a(6171),u=a(3734);let g=s.DomRendererRowFactory=class{constructor(x,R,y,A,O,U,H){this._document=x,this._characterJoinerService=R,this._optionsService=y,this._coreBrowserService=A,this._coreService=O,this._decorationService=U,this._themeService=H,this._workCell=new S.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(x,R,y){this._selectionStart=x,this._selectionEnd=R,this._columnSelectMode=y}createRow(x,R,y,A,O,U,H,B,j,q,Q){const ie=[],te=this._characterJoinerService.getJoinedCharacters(R),D=this._themeService.colors;let T,k=x.getNoBgTrimmedLength();y&&k<U+1&&(k=U+1);let M=0,$="",V=0,Z=0,ee=0,F=!1,I=0,z=!1,W=0;const X=[],Y=q!==-1&&Q!==-1;for(let le=0;le<k;le++){x.loadCell(le,this._workCell);let ae=this._workCell.getWidth();if(ae===0)continue;let de=!1,ge=le,he=this._workCell;if(te.length>0&&le===te[0][0]){de=!0;const ye=te.shift();he=new f.JoinedCellData(this._workCell,x.translateToString(!0,ye[0],ye[1]),ye[1]-ye[0]),ge=ye[1]-1,ae=he.getWidth()}const P=this._isCellInSelection(le,R),C=y&&le===U,w=Y&&le>=q&&le<=Q;let L=!1;this._decorationService.forEachDecorationAtCell(le,R,void 0,ye=>{L=!0});let N=he.getChars()||m.WHITESPACE_CELL_CHAR;if(N===" "&&(he.isUnderline()||he.isOverline())&&(N="Â "),W=ae*B-j.get(N,he.isBold(),he.isItalic()),T){if(M&&(P&&z||!P&&!z&&he.bg===V)&&(P&&z&&D.selectionForeground||he.fg===Z)&&he.extended.ext===ee&&w===F&&W===I&&!C&&!de&&!L){he.isInvisible()?$+=m.WHITESPACE_CELL_CHAR:$+=N,M++;continue}M&&(T.textContent=$),T=this._document.createElement("span"),M=0,$=""}else T=this._document.createElement("span");if(V=he.bg,Z=he.fg,ee=he.extended.ext,F=w,I=W,z=P,de&&U>=le&&U<=ge&&(U=le),!this._coreService.isCursorHidden&&C&&this._coreService.isCursorInitialized){if(X.push("xterm-cursor"),this._coreBrowserService.isFocused)H&&X.push("xterm-cursor-blink"),X.push(A==="bar"?"xterm-cursor-bar":A==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(O)switch(O){case"outline":X.push("xterm-cursor-outline");break;case"block":X.push("xterm-cursor-block");break;case"bar":X.push("xterm-cursor-bar");break;case"underline":X.push("xterm-cursor-underline")}}if(he.isBold()&&X.push("xterm-bold"),he.isItalic()&&X.push("xterm-italic"),he.isDim()&&X.push("xterm-dim"),$=he.isInvisible()?m.WHITESPACE_CELL_CHAR:he.getChars()||m.WHITESPACE_CELL_CHAR,he.isUnderline()&&(X.push(`xterm-underline-${he.extended.underlineStyle}`),$===" "&&($="Â "),!he.isUnderlineColorDefault()))if(he.isUnderlineColorRGB())T.style.textDecorationColor=`rgb(${u.AttributeData.toColorRGB(he.getUnderlineColor()).join(",")})`;else{let ye=he.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&he.isBold()&&ye<8&&(ye+=8),T.style.textDecorationColor=D.ansi[ye].css}he.isOverline()&&(X.push("xterm-overline"),$===" "&&($="Â ")),he.isStrikethrough()&&X.push("xterm-strikethrough"),w&&(T.style.textDecoration="underline");let K=he.getFgColor(),G=he.getFgColorMode(),ce=he.getBgColor(),_e=he.getBgColorMode();const ve=!!he.isInverse();if(ve){const ye=K;K=ce,ce=ye;const Ar=G;G=_e,_e=Ar}let Ce,Se,De,Ke=!1;switch(this._decorationService.forEachDecorationAtCell(le,R,void 0,ye=>{ye.options.layer!=="top"&&Ke||(ye.backgroundColorRGB&&(_e=50331648,ce=ye.backgroundColorRGB.rgba>>8&16777215,Ce=ye.backgroundColorRGB),ye.foregroundColorRGB&&(G=50331648,K=ye.foregroundColorRGB.rgba>>8&16777215,Se=ye.foregroundColorRGB),Ke=ye.options.layer==="top")}),!Ke&&P&&(Ce=this._coreBrowserService.isFocused?D.selectionBackgroundOpaque:D.selectionInactiveBackgroundOpaque,ce=Ce.rgba>>8&16777215,_e=50331648,Ke=!0,D.selectionForeground&&(G=50331648,K=D.selectionForeground.rgba>>8&16777215,Se=D.selectionForeground)),Ke&&X.push("xterm-decoration-top"),_e){case 16777216:case 33554432:De=D.ansi[ce],X.push(`xterm-bg-${ce}`);break;case 50331648:De=v.channels.toColor(ce>>16,ce>>8&255,255&ce),this._addStyle(T,`background-color:#${E((ce>>>0).toString(16),"0",6)}`);break;default:ve?(De=D.foreground,X.push(`xterm-bg-${d.INVERTED_DEFAULT_COLOR}`)):De=D.background}switch(Ce||he.isDim()&&(Ce=v.color.multiplyOpacity(De,.5)),G){case 16777216:case 33554432:he.isBold()&&K<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(K+=8),this._applyMinimumContrast(T,De,D.ansi[K],he,Ce,void 0)||X.push(`xterm-fg-${K}`);break;case 50331648:const ye=v.channels.toColor(K>>16&255,K>>8&255,255&K);this._applyMinimumContrast(T,De,ye,he,Ce,Se)||this._addStyle(T,`color:#${E(K.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(T,De,D.foreground,he,Ce,Se)||ve&&X.push(`xterm-fg-${d.INVERTED_DEFAULT_COLOR}`)}X.length&&(T.className=X.join(" "),X.length=0),C||de||L?T.textContent=$:M++,W!==this.defaultSpacing&&(T.style.letterSpacing=`${W}px`),ie.push(T),le=ge}return T&&M&&(T.textContent=$),ie}_applyMinimumContrast(x,R,y,A,O,U){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,h.treatGlyphAsBackgroundColor)(A.getCode()))return!1;const H=this._getContrastCache(A);let B;if(O||U||(B=H.getColor(R.rgba,y.rgba)),B===void 0){const j=this._optionsService.rawOptions.minimumContrastRatio/(A.isDim()?2:1);B=v.color.ensureContrastRatio(O||R,U||y,j),H.setColor((O||R).rgba,(U||y).rgba,B??null)}return!!B&&(this._addStyle(x,`color:${B.css}`),!0)}_getContrastCache(x){return x.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(x,R){x.setAttribute("style",`${x.getAttribute("style")||""}${R};`)}_isCellInSelection(x,R){const y=this._selectionStart,A=this._selectionEnd;return!(!y||!A)&&(this._columnSelectMode?y[0]<=A[0]?x>=y[0]&&R>=y[1]&&x<A[0]&&R<=A[1]:x<y[0]&&R>=y[1]&&x>=A[0]&&R<=A[1]:R>y[1]&&R<A[1]||y[1]===A[1]&&R===y[1]&&x>=y[0]&&x<A[0]||y[1]<A[1]&&R===A[1]&&x<A[0]||y[1]<A[1]&&R===y[1]&&x>=y[0])}};function E(x,R,y){for(;x.length<y;)x=R+x;return x}s.DomRendererRowFactory=g=c([_(1,l.ICharacterJoinerService),_(2,b.IOptionsService),_(3,l.ICoreBrowserService),_(4,b.ICoreService),_(5,b.IDecorationService),_(6,l.IThemeService)],g)},2550:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WidthCache=void 0,s.WidthCache=class{constructor(a,c){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const _=a.createElement("span");_.classList.add("xterm-char-measure-element");const d=a.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontWeight="bold";const m=a.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontStyle="italic";const S=a.createElement("span");S.classList.add("xterm-char-measure-element"),S.style.fontWeight="bold",S.style.fontStyle="italic",this._measureElements=[_,d,m,S],this._container.appendChild(_),this._container.appendChild(d),this._container.appendChild(m),this._container.appendChild(S),c.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,c,_,d){a===this._font&&c===this._fontSize&&_===this._weight&&d===this._weightBold||(this._font=a,this._fontSize=c,this._weight=_,this._weightBold=d,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${_}`,this._measureElements[1].style.fontWeight=`${d}`,this._measureElements[2].style.fontWeight=`${_}`,this._measureElements[3].style.fontWeight=`${d}`,this.clear())}get(a,c,_){let d=0;if(!c&&!_&&a.length===1&&(d=a.charCodeAt(0))<256){if(this._flat[d]!==-9999)return this._flat[d];const b=this._measure(a,0);return b>0&&(this._flat[d]=b),b}let m=a;c&&(m+="B"),_&&(m+="I");let S=this._holey.get(m);if(S===void 0){let b=0;c&&(b|=1),_&&(b|=2),S=this._measure(a,b),S>0&&this._holey.set(m,S)}return S}_measure(a,c){const _=this._measureElements[c];return _.textContent=a.repeat(32),_.offsetWidth/32}}},2223:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const c=a(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(p,s)=>{function a(_){return 57508<=_&&_<=57558}function c(_){return _>=128512&&_<=128591||_>=127744&&_<=128511||_>=128640&&_<=128767||_>=9728&&_<=9983||_>=9984&&_<=10175||_>=65024&&_<=65039||_>=129280&&_<=129535||_>=127462&&_<=127487}Object.defineProperty(s,"__esModule",{value:!0}),s.computeNextVariantOffset=s.createRenderDimensions=s.treatGlyphAsBackgroundColor=s.allowRescaling=s.isEmoji=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},s.isPowerlineGlyph=a,s.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},s.isEmoji=c,s.allowRescaling=function(_,d,m,S){return d===1&&m>Math.ceil(1.5*S)&&_!==void 0&&_>255&&!c(_)&&!a(_)&&!function(b){return 57344<=b&&b<=63743}(_)},s.treatGlyphAsBackgroundColor=function(_){return a(_)||function(d){return 9472<=d&&d<=9631}(_)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},s.computeNextVariantOffset=function(_,d,m=0){return(_-(2*Math.round(d)-m))%(2*Math.round(d))}},6052:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(_,d,m,S=!1){if(this.selectionStart=d,this.selectionEnd=m,!d||!m||d[0]===m[0]&&d[1]===m[1])return void this.clear();const b=_.buffers.active.ydisp,v=d[1]-b,l=m[1]-b,f=Math.max(v,0),h=Math.min(l,_.rows-1);f>=_.rows||h<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=S,this.viewportStartRow=v,this.viewportEndRow=l,this.viewportCappedStartRow=f,this.viewportCappedEndRow=h,this.startCol=d[0],this.endCol=m[0])}isCellSelected(_,d,m){return!!this.hasSelection&&(m-=_.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?d>=this.startCol&&m>=this.viewportCappedStartRow&&d<this.endCol&&m<=this.viewportCappedEndRow:d<this.startCol&&m>=this.viewportCappedStartRow&&d>=this.endCol&&m<=this.viewportCappedEndRow:m>this.viewportStartRow&&m<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&m===this.viewportStartRow&&d>=this.startCol&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&m===this.viewportEndRow&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&m===this.viewportStartRow&&d>=this.startCol)}}s.createSelectionRenderModel=function(){return new a}},456:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,c=this.selectionEnd;return!(!a||!c)&&(a[1]>c[1]||a[1]===c[1]&&a[0]>c[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(p,s,a){var c=this&&this.__decorate||function(h,u,g,E){var x,R=arguments.length,y=R<3?u:E===null?E=Object.getOwnPropertyDescriptor(u,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(h,u,g,E);else for(var A=h.length-1;A>=0;A--)(x=h[A])&&(y=(R<3?x(y):R>3?x(u,g,y):x(u,g))||y);return R>3&&y&&Object.defineProperty(u,g,y),y},_=this&&this.__param||function(h,u){return function(g,E){u(g,E,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const d=a(2585),m=a(8460),S=a(844);let b=s.CharSizeService=class extends S.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(h,u,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new m.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new f(this._optionsService))}catch{this._measureStrategy=this.register(new l(h,u,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const h=this._measureStrategy.measure();h.width===this.width&&h.height===this.height||(this.width=h.width,this.height=h.height,this._onCharSizeChange.fire())}};s.CharSizeService=b=c([_(2,d.IOptionsService)],b);class v extends S.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(u,g){u!==void 0&&u>0&&g!==void 0&&g>0&&(this._result.width=u,this._result.height=g)}}class l extends v{constructor(u,g,E){super(),this._document=u,this._parentElement=g,this._optionsService=E,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class f extends v{constructor(u){super(),this._optionsService=u,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const g=this._ctx.measureText("W");if(!("width"in g&&"fontBoundingBoxAscent"in g&&"fontBoundingBoxDescent"in g))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const u=this._ctx.measureText("W");return this._validateAndSet(u.width,u.fontBoundingBoxAscent+u.fontBoundingBoxDescent),this._result}}},4269:function(p,s,a){var c=this&&this.__decorate||function(f,h,u,g){var E,x=arguments.length,R=x<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,u):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(f,h,u,g);else for(var y=f.length-1;y>=0;y--)(E=f[y])&&(R=(x<3?E(R):x>3?E(h,u,R):E(h,u))||R);return x>3&&R&&Object.defineProperty(h,u,R),R},_=this&&this.__param||function(f,h){return function(u,g){h(u,g,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const d=a(3734),m=a(643),S=a(511),b=a(2585);class v extends d.AttributeData{constructor(h,u,g){super(),this.content=0,this.combinedData="",this.fg=h.fg,this.bg=h.bg,this.combinedData=u,this._width=g}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(h){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=v;let l=s.CharacterJoinerService=class Ns{constructor(h){this._bufferService=h,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new S.CellData}register(h){const u={id:this._nextCharacterJoinerId++,handler:h};return this._characterJoiners.push(u),u.id}deregister(h){for(let u=0;u<this._characterJoiners.length;u++)if(this._characterJoiners[u].id===h)return this._characterJoiners.splice(u,1),!0;return!1}getJoinedCharacters(h){if(this._characterJoiners.length===0)return[];const u=this._bufferService.buffer.lines.get(h);if(!u||u.length===0)return[];const g=[],E=u.translateToString(!0);let x=0,R=0,y=0,A=u.getFg(0),O=u.getBg(0);for(let U=0;U<u.getTrimmedLength();U++)if(u.loadCell(U,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==A||this._workCell.bg!==O){if(U-x>1){const H=this._getJoinedRanges(E,y,R,u,x);for(let B=0;B<H.length;B++)g.push(H[B])}x=U,y=R,A=this._workCell.fg,O=this._workCell.bg}R+=this._workCell.getChars().length||m.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-x>1){const U=this._getJoinedRanges(E,y,R,u,x);for(let H=0;H<U.length;H++)g.push(U[H])}return g}_getJoinedRanges(h,u,g,E,x){const R=h.substring(u,g);let y=[];try{y=this._characterJoiners[0].handler(R)}catch(A){console.error(A)}for(let A=1;A<this._characterJoiners.length;A++)try{const O=this._characterJoiners[A].handler(R);for(let U=0;U<O.length;U++)Ns._mergeRanges(y,O[U])}catch(O){console.error(O)}return this._stringRangesToCellRanges(y,E,x),y}_stringRangesToCellRanges(h,u,g){let E=0,x=!1,R=0,y=h[E];if(y){for(let A=g;A<this._bufferService.cols;A++){const O=u.getWidth(A),U=u.getString(A).length||m.WHITESPACE_CELL_CHAR.length;if(O!==0){if(!x&&y[0]<=R&&(y[0]=A,x=!0),y[1]<=R){if(y[1]=A,y=h[++E],!y)break;y[0]<=R?(y[0]=A,x=!0):x=!1}R+=U}}y&&(y[1]=this._bufferService.cols)}}static _mergeRanges(h,u){let g=!1;for(let E=0;E<h.length;E++){const x=h[E];if(g){if(u[1]<=x[0])return h[E-1][1]=u[1],h;if(u[1]<=x[1])return h[E-1][1]=Math.max(u[1],x[1]),h.splice(E,1),h;h.splice(E,1),E--}else{if(u[1]<=x[0])return h.splice(E,0,u),h;if(u[1]<=x[1])return x[0]=Math.min(u[0],x[0]),h;u[0]<x[1]&&(x[0]=Math.min(u[0],x[0]),g=!0)}}return g?h[h.length-1][1]=u[1]:h.push(u),h}};s.CharacterJoinerService=l=c([_(0,b.IBufferService)],l)},5114:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0;const c=a(844),_=a(8460),d=a(3656);class m extends c.Disposable{constructor(v,l,f){super(),this._textarea=v,this._window=l,this.mainDocument=f,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new S(this._window),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new _.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(h=>this._screenDprMonitor.setWindow(h))),this.register((0,_.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(v){this._window!==v&&(this._window=v,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}s.CoreBrowserService=m;class S extends c.Disposable{constructor(v){super(),this._parentWindow=v,this._windowResizeListener=this.register(new c.MutableDisposable),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,c.toDisposable)(()=>this.clearListener()))}setWindow(v){this._parentWindow=v,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,d.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var v;this._outerListener&&((v=this._resolutionMediaMatchList)==null||v.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LinkProviderService=void 0;const c=a(844);class _ extends c.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,c.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(m){return this.linkProviders.push(m),{dispose:()=>{const S=this.linkProviders.indexOf(m);S!==-1&&this.linkProviders.splice(S,1)}}}}s.LinkProviderService=_},8934:function(p,s,a){var c=this&&this.__decorate||function(b,v,l,f){var h,u=arguments.length,g=u<3?v:f===null?f=Object.getOwnPropertyDescriptor(v,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(b,v,l,f);else for(var E=b.length-1;E>=0;E--)(h=b[E])&&(g=(u<3?h(g):u>3?h(v,l,g):h(v,l))||g);return u>3&&g&&Object.defineProperty(v,l,g),g},_=this&&this.__param||function(b,v){return function(l,f){v(l,f,b)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const d=a(4725),m=a(9806);let S=s.MouseService=class{constructor(b,v){this._renderService=b,this._charSizeService=v}getCoords(b,v,l,f,h){return(0,m.getCoords)(window,b,v,l,f,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,h)}getMouseReportCoords(b,v){const l=(0,m.getCoordsRelativeToElement)(window,b,v);if(this._charSizeService.hasValidSize)return l[0]=Math.min(Math.max(l[0],0),this._renderService.dimensions.css.canvas.width-1),l[1]=Math.min(Math.max(l[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(l[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(l[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(l[0]),y:Math.floor(l[1])}}};s.MouseService=S=c([_(0,d.IRenderService),_(1,d.ICharSizeService)],S)},3230:function(p,s,a){var c=this&&this.__decorate||function(h,u,g,E){var x,R=arguments.length,y=R<3?u:E===null?E=Object.getOwnPropertyDescriptor(u,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(h,u,g,E);else for(var A=h.length-1;A>=0;A--)(x=h[A])&&(y=(R<3?x(y):R>3?x(u,g,y):x(u,g))||y);return R>3&&y&&Object.defineProperty(u,g,y),y},_=this&&this.__param||function(h,u){return function(g,E){u(g,E,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const d=a(6193),m=a(4725),S=a(8460),b=a(844),v=a(7226),l=a(2585);let f=s.RenderService=class extends b.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(h,u,g,E,x,R,y,A){super(),this._rowCount=h,this._charSizeService=E,this._renderer=this.register(new b.MutableDisposable),this._pausedResizeTask=new v.DebouncedIdleTask,this._observerDisposable=this.register(new b.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new S.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new S.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new S.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new S.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new d.RenderDebouncer((O,U)=>this._renderRows(O,U),y),this.register(this._renderDebouncer),this.register(y.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(R.onResize(()=>this._fullRefresh())),this.register(R.buffers.onBufferActivate(()=>{var O;return(O=this._renderer.value)==null?void 0:O.clear()})),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(x.onDecorationRegistered(()=>this._fullRefresh())),this.register(x.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(R.cols,R.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(R.buffer.y,R.buffer.y,!0))),this.register(A.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(y.window,u),this.register(y.onWindowChange(O=>this._registerIntersectionObserver(O,u)))}_registerIntersectionObserver(h,u){if("IntersectionObserver"in h){const g=new h.IntersectionObserver(E=>this._handleIntersectionChange(E[E.length-1]),{threshold:0});g.observe(u),this._observerDisposable.value=(0,b.toDisposable)(()=>g.disconnect())}}_handleIntersectionChange(h){this._isPaused=h.isIntersecting===void 0?h.intersectionRatio===0:!h.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(h,u,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(h,u,this._rowCount))}_renderRows(h,u){this._renderer.value&&(h=Math.min(h,this._rowCount-1),u=Math.min(u,this._rowCount-1),this._renderer.value.renderRows(h,u),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:h,end:u}),this._onRender.fire({start:h,end:u}),this._isNextRenderRedrawOnly=!0)}resize(h,u){this._rowCount=u,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(h){this._renderer.value=h,this._renderer.value&&(this._renderer.value.onRequestRedraw(u=>this.refreshRows(u.start,u.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(h){return this._renderDebouncer.addRefreshCallback(h)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var h,u;this._renderer.value&&((u=(h=this._renderer.value).clearTextureAtlas)==null||u.call(h),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(h,u){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var g;return(g=this._renderer.value)==null?void 0:g.handleResize(h,u)}):this._renderer.value.handleResize(h,u),this._fullRefresh())}handleCharSizeChanged(){var h;(h=this._renderer.value)==null||h.handleCharSizeChanged()}handleBlur(){var h;(h=this._renderer.value)==null||h.handleBlur()}handleFocus(){var h;(h=this._renderer.value)==null||h.handleFocus()}handleSelectionChanged(h,u,g){var E;this._selectionState.start=h,this._selectionState.end=u,this._selectionState.columnSelectMode=g,(E=this._renderer.value)==null||E.handleSelectionChanged(h,u,g)}handleCursorMove(){var h;(h=this._renderer.value)==null||h.handleCursorMove()}clear(){var h;(h=this._renderer.value)==null||h.clear()}};s.RenderService=f=c([_(2,l.IOptionsService),_(3,m.ICharSizeService),_(4,l.IDecorationService),_(5,l.IBufferService),_(6,m.ICoreBrowserService),_(7,m.IThemeService)],f)},9312:function(p,s,a){var c=this&&this.__decorate||function(y,A,O,U){var H,B=arguments.length,j=B<3?A:U===null?U=Object.getOwnPropertyDescriptor(A,O):U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(y,A,O,U);else for(var q=y.length-1;q>=0;q--)(H=y[q])&&(j=(B<3?H(j):B>3?H(A,O,j):H(A,O))||j);return B>3&&j&&Object.defineProperty(A,O,j),j},_=this&&this.__param||function(y,A){return function(O,U){A(O,U,y)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const d=a(9806),m=a(9504),S=a(456),b=a(4725),v=a(8460),l=a(844),f=a(6114),h=a(4841),u=a(511),g=a(2585),E="Â ",x=new RegExp(E,"g");let R=s.SelectionService=class extends l.Disposable{constructor(y,A,O,U,H,B,j,q,Q){super(),this._element=y,this._screenElement=A,this._linkifier=O,this._bufferService=U,this._coreService=H,this._mouseService=B,this._optionsService=j,this._renderService=q,this._coreBrowserService=Q,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new u.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new v.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new v.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new v.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=ie=>this._handleMouseMove(ie),this._mouseUpListener=ie=>this._handleMouseUp(ie),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(ie=>this._handleTrim(ie)),this.register(this._bufferService.buffers.onBufferActivate(ie=>this._handleBufferActivate(ie))),this.enable(),this._model=new S.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,l.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const y=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!y||!A||y[0]===A[0]&&y[1]===A[1])}get selectionText(){const y=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;if(!y||!A)return"";const O=this._bufferService.buffer,U=[];if(this._activeSelectionMode===3){if(y[0]===A[0])return"";const H=y[0]<A[0]?y[0]:A[0],B=y[0]<A[0]?A[0]:y[0];for(let j=y[1];j<=A[1];j++){const q=O.translateBufferLineToString(j,!0,H,B);U.push(q)}}else{const H=y[1]===A[1]?A[0]:void 0;U.push(O.translateBufferLineToString(y[1],!0,y[0],H));for(let B=y[1]+1;B<=A[1]-1;B++){const j=O.lines.get(B),q=O.translateBufferLineToString(B,!0);j!=null&&j.isWrapped?U[U.length-1]+=q:U.push(q)}if(y[1]!==A[1]){const B=O.lines.get(A[1]),j=O.translateBufferLineToString(A[1],!0,0,A[0]);B&&B.isWrapped?U[U.length-1]+=j:U.push(j)}}return U.map(H=>H.replace(x," ")).join(f.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(y){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),f.isLinux&&y&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(y){const A=this._getMouseBufferCoords(y),O=this._model.finalSelectionStart,U=this._model.finalSelectionEnd;return!!(O&&U&&A)&&this._areCoordsInSelection(A,O,U)}isCellInSelection(y,A){const O=this._model.finalSelectionStart,U=this._model.finalSelectionEnd;return!(!O||!U)&&this._areCoordsInSelection([y,A],O,U)}_areCoordsInSelection(y,A,O){return y[1]>A[1]&&y[1]<O[1]||A[1]===O[1]&&y[1]===A[1]&&y[0]>=A[0]&&y[0]<O[0]||A[1]<O[1]&&y[1]===O[1]&&y[0]<O[0]||A[1]<O[1]&&y[1]===A[1]&&y[0]>=A[0]}_selectWordAtCursor(y,A){var H,B;const O=(B=(H=this._linkifier.currentLink)==null?void 0:H.link)==null?void 0:B.range;if(O)return this._model.selectionStart=[O.start.x-1,O.start.y-1],this._model.selectionStartLength=(0,h.getRangeLength)(O,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const U=this._getMouseBufferCoords(y);return!!U&&(this._selectWordAt(U,A),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(y,A){this._model.clearSelection(),y=Math.max(y,0),A=Math.min(A,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,y],this._model.selectionEnd=[this._bufferService.cols,A],this.refresh(),this._onSelectionChange.fire()}_handleTrim(y){this._model.handleTrim(y)&&this.refresh()}_getMouseBufferCoords(y){const A=this._mouseService.getCoords(y,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(A)return A[0]--,A[1]--,A[1]+=this._bufferService.buffer.ydisp,A}_getMouseEventScrollAmount(y){let A=(0,d.getCoordsRelativeToElement)(this._coreBrowserService.window,y,this._screenElement)[1];const O=this._renderService.dimensions.css.canvas.height;return A>=0&&A<=O?0:(A>O&&(A-=O),A=Math.min(Math.max(A,-50),50),A/=50,A/Math.abs(A)+Math.round(14*A))}shouldForceSelection(y){return f.isMac?y.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:y.shiftKey}handleMouseDown(y){if(this._mouseDownTimeStamp=y.timeStamp,(y.button!==2||!this.hasSelection)&&y.button===0){if(!this._enabled){if(!this.shouldForceSelection(y))return;y.stopPropagation()}y.preventDefault(),this._dragScrollAmount=0,this._enabled&&y.shiftKey?this._handleIncrementalClick(y):y.detail===1?this._handleSingleClick(y):y.detail===2?this._handleDoubleClick(y):y.detail===3&&this._handleTripleClick(y),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(y){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(y))}_handleSingleClick(y){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(y)?3:0,this._model.selectionStart=this._getMouseBufferCoords(y),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const A=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);A&&A.length!==this._model.selectionStart[0]&&A.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(y){this._selectWordAtCursor(y,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(y){const A=this._getMouseBufferCoords(y);A&&(this._activeSelectionMode=2,this._selectLineAt(A[1]))}shouldColumnSelect(y){return y.altKey&&!(f.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(y){if(y.stopImmediatePropagation(),!this._model.selectionStart)return;const A=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(y),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(y),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const O=this._bufferService.buffer;if(this._model.selectionEnd[1]<O.lines.length){const U=O.lines.get(this._model.selectionEnd[1]);U&&U.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}A&&A[0]===this._model.selectionEnd[0]&&A[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const y=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(y.ydisp+this._bufferService.rows,y.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=y.ydisp),this.refresh()}}_handleMouseUp(y){const A=y.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&A<500&&y.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const O=this._mouseService.getCoords(y,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(O&&O[0]!==void 0&&O[1]!==void 0){const U=(0,m.moveToCellSequence)(O[0]-1,O[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(U,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const y=this._model.finalSelectionStart,A=this._model.finalSelectionEnd,O=!(!y||!A||y[0]===A[0]&&y[1]===A[1]);O?y&&A&&(this._oldSelectionStart&&this._oldSelectionEnd&&y[0]===this._oldSelectionStart[0]&&y[1]===this._oldSelectionStart[1]&&A[0]===this._oldSelectionEnd[0]&&A[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(y,A,O)):this._oldHasSelection&&this._fireOnSelectionChange(y,A,O)}_fireOnSelectionChange(y,A,O){this._oldSelectionStart=y,this._oldSelectionEnd=A,this._oldHasSelection=O,this._onSelectionChange.fire()}_handleBufferActivate(y){this.clearSelection(),this._trimListener.dispose(),this._trimListener=y.activeBuffer.lines.onTrim(A=>this._handleTrim(A))}_convertViewportColToCharacterIndex(y,A){let O=A;for(let U=0;A>=U;U++){const H=y.loadCell(U,this._workCell).getChars().length;this._workCell.getWidth()===0?O--:H>1&&A!==U&&(O+=H-1)}return O}setSelection(y,A,O){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[y,A],this._model.selectionStartLength=O,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(y){this._isClickInSelection(y)||(this._selectWordAtCursor(y,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(y,A,O=!0,U=!0){if(y[0]>=this._bufferService.cols)return;const H=this._bufferService.buffer,B=H.lines.get(y[1]);if(!B)return;const j=H.translateBufferLineToString(y[1],!1);let q=this._convertViewportColToCharacterIndex(B,y[0]),Q=q;const ie=y[0]-q;let te=0,D=0,T=0,k=0;if(j.charAt(q)===" "){for(;q>0&&j.charAt(q-1)===" ";)q--;for(;Q<j.length&&j.charAt(Q+1)===" ";)Q++}else{let V=y[0],Z=y[0];B.getWidth(V)===0&&(te++,V--),B.getWidth(Z)===2&&(D++,Z++);const ee=B.getString(Z).length;for(ee>1&&(k+=ee-1,Q+=ee-1);V>0&&q>0&&!this._isCharWordSeparator(B.loadCell(V-1,this._workCell));){B.loadCell(V-1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===0?(te++,V--):F>1&&(T+=F-1,q-=F-1),q--,V--}for(;Z<B.length&&Q+1<j.length&&!this._isCharWordSeparator(B.loadCell(Z+1,this._workCell));){B.loadCell(Z+1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===2?(D++,Z++):F>1&&(k+=F-1,Q+=F-1),Q++,Z++}}Q++;let M=q+ie-te+T,$=Math.min(this._bufferService.cols,Q-q+te+D-T-k);if(A||j.slice(q,Q).trim()!==""){if(O&&M===0&&B.getCodePoint(0)!==32){const V=H.lines.get(y[1]-1);if(V&&B.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){const Z=this._getWordAt([this._bufferService.cols-1,y[1]-1],!1,!0,!1);if(Z){const ee=this._bufferService.cols-Z.start;M-=ee,$+=ee}}}if(U&&M+$===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const V=H.lines.get(y[1]+1);if(V!=null&&V.isWrapped&&V.getCodePoint(0)!==32){const Z=this._getWordAt([0,y[1]+1],!1,!1,!0);Z&&($+=Z.length)}}return{start:M,length:$}}}_selectWordAt(y,A){const O=this._getWordAt(y,A);if(O){for(;O.start<0;)O.start+=this._bufferService.cols,y[1]--;this._model.selectionStart=[O.start,y[1]],this._model.selectionStartLength=O.length}}_selectToWordAt(y){const A=this._getWordAt(y,!0);if(A){let O=y[1];for(;A.start<0;)A.start+=this._bufferService.cols,O--;if(!this._model.areSelectionValuesReversed())for(;A.start+A.length>this._bufferService.cols;)A.length-=this._bufferService.cols,O++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?A.start:A.start+A.length,O]}}_isCharWordSeparator(y){return y.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(y.getChars())>=0}_selectLineAt(y){const A=this._bufferService.buffer.getWrappedRangeForLine(y),O={start:{x:0,y:A.first},end:{x:this._bufferService.cols-1,y:A.last}};this._model.selectionStart=[0,A.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,h.getRangeLength)(O,this._bufferService.cols)}};s.SelectionService=R=c([_(3,g.IBufferService),_(4,g.ICoreService),_(5,b.IMouseService),_(6,g.IOptionsService),_(7,b.IRenderService),_(8,b.ICoreBrowserService)],R)},4725:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ILinkProviderService=s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const c=a(8343);s.ICharSizeService=(0,c.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),s.IMouseService=(0,c.createDecorator)("MouseService"),s.IRenderService=(0,c.createDecorator)("RenderService"),s.ISelectionService=(0,c.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,c.createDecorator)("ThemeService"),s.ILinkProviderService=(0,c.createDecorator)("LinkProviderService")},6731:function(p,s,a){var c=this&&this.__decorate||function(R,y,A,O){var U,H=arguments.length,B=H<3?y:O===null?O=Object.getOwnPropertyDescriptor(y,A):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(R,y,A,O);else for(var j=R.length-1;j>=0;j--)(U=R[j])&&(B=(H<3?U(B):H>3?U(y,A,B):U(y,A))||B);return H>3&&B&&Object.defineProperty(y,A,B),B},_=this&&this.__param||function(R,y){return function(A,O){y(A,O,R)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const d=a(7239),m=a(8055),S=a(8460),b=a(844),v=a(2585),l=m.css.toColor("#ffffff"),f=m.css.toColor("#000000"),h=m.css.toColor("#ffffff"),u=m.css.toColor("#000000"),g={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const R=[m.css.toColor("#2e3436"),m.css.toColor("#cc0000"),m.css.toColor("#4e9a06"),m.css.toColor("#c4a000"),m.css.toColor("#3465a4"),m.css.toColor("#75507b"),m.css.toColor("#06989a"),m.css.toColor("#d3d7cf"),m.css.toColor("#555753"),m.css.toColor("#ef2929"),m.css.toColor("#8ae234"),m.css.toColor("#fce94f"),m.css.toColor("#729fcf"),m.css.toColor("#ad7fa8"),m.css.toColor("#34e2e2"),m.css.toColor("#eeeeec")],y=[0,95,135,175,215,255];for(let A=0;A<216;A++){const O=y[A/36%6|0],U=y[A/6%6|0],H=y[A%6];R.push({css:m.channels.toCss(O,U,H),rgba:m.channels.toRgba(O,U,H)})}for(let A=0;A<24;A++){const O=8+10*A;R.push({css:m.channels.toCss(O,O,O),rgba:m.channels.toRgba(O,O,O)})}return R})());let E=s.ThemeService=class extends b.Disposable{get colors(){return this._colors}constructor(R){super(),this._optionsService=R,this._contrastCache=new d.ColorContrastCache,this._halfContrastCache=new d.ColorContrastCache,this._onChangeColors=this.register(new S.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:l,background:f,cursor:h,cursorAccent:u,selectionForeground:void 0,selectionBackgroundTransparent:g,selectionBackgroundOpaque:m.color.blend(f,g),selectionInactiveBackgroundTransparent:g,selectionInactiveBackgroundOpaque:m.color.blend(f,g),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(R={}){const y=this._colors;if(y.foreground=x(R.foreground,l),y.background=x(R.background,f),y.cursor=x(R.cursor,h),y.cursorAccent=x(R.cursorAccent,u),y.selectionBackgroundTransparent=x(R.selectionBackground,g),y.selectionBackgroundOpaque=m.color.blend(y.background,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundTransparent=x(R.selectionInactiveBackground,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundOpaque=m.color.blend(y.background,y.selectionInactiveBackgroundTransparent),y.selectionForeground=R.selectionForeground?x(R.selectionForeground,m.NULL_COLOR):void 0,y.selectionForeground===m.NULL_COLOR&&(y.selectionForeground=void 0),m.color.isOpaque(y.selectionBackgroundTransparent)&&(y.selectionBackgroundTransparent=m.color.opacity(y.selectionBackgroundTransparent,.3)),m.color.isOpaque(y.selectionInactiveBackgroundTransparent)&&(y.selectionInactiveBackgroundTransparent=m.color.opacity(y.selectionInactiveBackgroundTransparent,.3)),y.ansi=s.DEFAULT_ANSI_COLORS.slice(),y.ansi[0]=x(R.black,s.DEFAULT_ANSI_COLORS[0]),y.ansi[1]=x(R.red,s.DEFAULT_ANSI_COLORS[1]),y.ansi[2]=x(R.green,s.DEFAULT_ANSI_COLORS[2]),y.ansi[3]=x(R.yellow,s.DEFAULT_ANSI_COLORS[3]),y.ansi[4]=x(R.blue,s.DEFAULT_ANSI_COLORS[4]),y.ansi[5]=x(R.magenta,s.DEFAULT_ANSI_COLORS[5]),y.ansi[6]=x(R.cyan,s.DEFAULT_ANSI_COLORS[6]),y.ansi[7]=x(R.white,s.DEFAULT_ANSI_COLORS[7]),y.ansi[8]=x(R.brightBlack,s.DEFAULT_ANSI_COLORS[8]),y.ansi[9]=x(R.brightRed,s.DEFAULT_ANSI_COLORS[9]),y.ansi[10]=x(R.brightGreen,s.DEFAULT_ANSI_COLORS[10]),y.ansi[11]=x(R.brightYellow,s.DEFAULT_ANSI_COLORS[11]),y.ansi[12]=x(R.brightBlue,s.DEFAULT_ANSI_COLORS[12]),y.ansi[13]=x(R.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),y.ansi[14]=x(R.brightCyan,s.DEFAULT_ANSI_COLORS[14]),y.ansi[15]=x(R.brightWhite,s.DEFAULT_ANSI_COLORS[15]),R.extendedAnsi){const A=Math.min(y.ansi.length-16,R.extendedAnsi.length);for(let O=0;O<A;O++)y.ansi[O+16]=x(R.extendedAnsi[O],s.DEFAULT_ANSI_COLORS[O+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(R){this._restoreColor(R),this._onChangeColors.fire(this.colors)}_restoreColor(R){if(R!==void 0)switch(R){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[R]=this._restoreColors.ansi[R]}else for(let y=0;y<this._restoreColors.ansi.length;++y)this._colors.ansi[y]=this._restoreColors.ansi[y]}modifyColors(R){R(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function x(R,y){if(R!==void 0)try{return m.css.toColor(R)}catch{}return y}s.ThemeService=E=c([_(0,v.IOptionsService)],E)},6349:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const c=a(8460),_=a(844);class d extends _.Disposable{constructor(S){super(),this._maxLength=S,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(S){if(this._maxLength===S)return;const b=new Array(S);for(let v=0;v<Math.min(S,this.length);v++)b[v]=this._array[this._getCyclicIndex(v)];this._array=b,this._maxLength=S,this._startIndex=0}get length(){return this._length}set length(S){if(S>this._length)for(let b=this._length;b<S;b++)this._array[b]=void 0;this._length=S}get(S){return this._array[this._getCyclicIndex(S)]}set(S,b){this._array[this._getCyclicIndex(S)]=b}push(S){this._array[this._getCyclicIndex(this._length)]=S,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(S,b,...v){if(b){for(let l=S;l<this._length-b;l++)this._array[this._getCyclicIndex(l)]=this._array[this._getCyclicIndex(l+b)];this._length-=b,this.onDeleteEmitter.fire({index:S,amount:b})}for(let l=this._length-1;l>=S;l--)this._array[this._getCyclicIndex(l+v.length)]=this._array[this._getCyclicIndex(l)];for(let l=0;l<v.length;l++)this._array[this._getCyclicIndex(S+l)]=v[l];if(v.length&&this.onInsertEmitter.fire({index:S,amount:v.length}),this._length+v.length>this._maxLength){const l=this._length+v.length-this._maxLength;this._startIndex+=l,this._length=this._maxLength,this.onTrimEmitter.fire(l)}else this._length+=v.length}trimStart(S){S>this._length&&(S=this._length),this._startIndex+=S,this._length-=S,this.onTrimEmitter.fire(S)}shiftElements(S,b,v){if(!(b<=0)){if(S<0||S>=this._length)throw new Error("start argument out of range");if(S+v<0)throw new Error("Cannot shift elements in list beyond index 0");if(v>0){for(let f=b-1;f>=0;f--)this.set(S+f+v,this.get(S+f));const l=S+b+v-this._length;if(l>0)for(this._length+=l;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let l=0;l<b;l++)this.set(S+l+v,this.get(S+l))}}_getCyclicIndex(S){return(this._startIndex+S)%this._maxLength}}s.CircularList=d},1439:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function a(c,_=5){if(typeof c!="object")return c;const d=Array.isArray(c)?[]:{};for(const m in c)d[m]=_<=1?c[m]:c[m]&&a(c[m],_-1);return d}},8055:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;let a=0,c=0,_=0,d=0;var m,S,b,v,l;function f(u){const g=u.toString(16);return g.length<2?"0"+g:g}function h(u,g){return u<g?(g+.05)/(u+.05):(u+.05)/(g+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(u){u.toCss=function(g,E,x,R){return R!==void 0?`#${f(g)}${f(E)}${f(x)}${f(R)}`:`#${f(g)}${f(E)}${f(x)}`},u.toRgba=function(g,E,x,R=255){return(g<<24|E<<16|x<<8|R)>>>0},u.toColor=function(g,E,x,R){return{css:u.toCss(g,E,x,R),rgba:u.toRgba(g,E,x,R)}}}(m||(s.channels=m={})),function(u){function g(E,x){return d=Math.round(255*x),[a,c,_]=l.toChannels(E.rgba),{css:m.toCss(a,c,_,d),rgba:m.toRgba(a,c,_,d)}}u.blend=function(E,x){if(d=(255&x.rgba)/255,d===1)return{css:x.css,rgba:x.rgba};const R=x.rgba>>24&255,y=x.rgba>>16&255,A=x.rgba>>8&255,O=E.rgba>>24&255,U=E.rgba>>16&255,H=E.rgba>>8&255;return a=O+Math.round((R-O)*d),c=U+Math.round((y-U)*d),_=H+Math.round((A-H)*d),{css:m.toCss(a,c,_),rgba:m.toRgba(a,c,_)}},u.isOpaque=function(E){return(255&E.rgba)==255},u.ensureContrastRatio=function(E,x,R){const y=l.ensureContrastRatio(E.rgba,x.rgba,R);if(y)return m.toColor(y>>24&255,y>>16&255,y>>8&255)},u.opaque=function(E){const x=(255|E.rgba)>>>0;return[a,c,_]=l.toChannels(x),{css:m.toCss(a,c,_),rgba:x}},u.opacity=g,u.multiplyOpacity=function(E,x){return d=255&E.rgba,g(E,d*x/255)},u.toColorRGB=function(E){return[E.rgba>>24&255,E.rgba>>16&255,E.rgba>>8&255]}}(S||(s.color=S={})),function(u){let g,E;try{const x=document.createElement("canvas");x.width=1,x.height=1;const R=x.getContext("2d",{willReadFrequently:!0});R&&(g=R,g.globalCompositeOperation="copy",E=g.createLinearGradient(0,0,1,1))}catch{}u.toColor=function(x){if(x.match(/#[\da-f]{3,8}/i))switch(x.length){case 4:return a=parseInt(x.slice(1,2).repeat(2),16),c=parseInt(x.slice(2,3).repeat(2),16),_=parseInt(x.slice(3,4).repeat(2),16),m.toColor(a,c,_);case 5:return a=parseInt(x.slice(1,2).repeat(2),16),c=parseInt(x.slice(2,3).repeat(2),16),_=parseInt(x.slice(3,4).repeat(2),16),d=parseInt(x.slice(4,5).repeat(2),16),m.toColor(a,c,_,d);case 7:return{css:x,rgba:(parseInt(x.slice(1),16)<<8|255)>>>0};case 9:return{css:x,rgba:parseInt(x.slice(1),16)>>>0}}const R=x.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(R)return a=parseInt(R[1]),c=parseInt(R[2]),_=parseInt(R[3]),d=Math.round(255*(R[5]===void 0?1:parseFloat(R[5]))),m.toColor(a,c,_,d);if(!g||!E)throw new Error("css.toColor: Unsupported css format");if(g.fillStyle=E,g.fillStyle=x,typeof g.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(g.fillRect(0,0,1,1),[a,c,_,d]=g.getImageData(0,0,1,1).data,d!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(a,c,_,d),css:x}}}(b||(s.css=b={})),function(u){function g(E,x,R){const y=E/255,A=x/255,O=R/255;return .2126*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.7152*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))+.0722*(O<=.03928?O/12.92:Math.pow((O+.055)/1.055,2.4))}u.relativeLuminance=function(E){return g(E>>16&255,E>>8&255,255&E)},u.relativeLuminance2=g}(v||(s.rgb=v={})),function(u){function g(x,R,y){const A=x>>24&255,O=x>>16&255,U=x>>8&255;let H=R>>24&255,B=R>>16&255,j=R>>8&255,q=h(v.relativeLuminance2(H,B,j),v.relativeLuminance2(A,O,U));for(;q<y&&(H>0||B>0||j>0);)H-=Math.max(0,Math.ceil(.1*H)),B-=Math.max(0,Math.ceil(.1*B)),j-=Math.max(0,Math.ceil(.1*j)),q=h(v.relativeLuminance2(H,B,j),v.relativeLuminance2(A,O,U));return(H<<24|B<<16|j<<8|255)>>>0}function E(x,R,y){const A=x>>24&255,O=x>>16&255,U=x>>8&255;let H=R>>24&255,B=R>>16&255,j=R>>8&255,q=h(v.relativeLuminance2(H,B,j),v.relativeLuminance2(A,O,U));for(;q<y&&(H<255||B<255||j<255);)H=Math.min(255,H+Math.ceil(.1*(255-H))),B=Math.min(255,B+Math.ceil(.1*(255-B))),j=Math.min(255,j+Math.ceil(.1*(255-j))),q=h(v.relativeLuminance2(H,B,j),v.relativeLuminance2(A,O,U));return(H<<24|B<<16|j<<8|255)>>>0}u.blend=function(x,R){if(d=(255&R)/255,d===1)return R;const y=R>>24&255,A=R>>16&255,O=R>>8&255,U=x>>24&255,H=x>>16&255,B=x>>8&255;return a=U+Math.round((y-U)*d),c=H+Math.round((A-H)*d),_=B+Math.round((O-B)*d),m.toRgba(a,c,_)},u.ensureContrastRatio=function(x,R,y){const A=v.relativeLuminance(x>>8),O=v.relativeLuminance(R>>8);if(h(A,O)<y){if(O<A){const B=g(x,R,y),j=h(A,v.relativeLuminance(B>>8));if(j<y){const q=E(x,R,y);return j>h(A,v.relativeLuminance(q>>8))?B:q}return B}const U=E(x,R,y),H=h(A,v.relativeLuminance(U>>8));if(H<y){const B=g(x,R,y);return H>h(A,v.relativeLuminance(B>>8))?U:B}return U}},u.reduceLuminance=g,u.increaseLuminance=E,u.toChannels=function(x){return[x>>24&255,x>>16&255,x>>8&255,255&x]}}(l||(s.rgba=l={})),s.toPaddedHex=f,s.contrastRatio=h},8969:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const c=a(844),_=a(2585),d=a(4348),m=a(7866),S=a(744),b=a(7302),v=a(6975),l=a(8460),f=a(1753),h=a(1480),u=a(7994),g=a(9282),E=a(5435),x=a(5981),R=a(2660);let y=!1;class A extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new l.EventEmitter),this._onScroll.event(U=>{var H;(H=this._onScrollApi)==null||H.fire(U.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(U){for(const H in U)this.optionsService.options[H]=U[H]}constructor(U){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new l.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new l.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new l.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new l.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new l.EventEmitter),this._instantiationService=new d.InstantiationService,this.optionsService=this.register(new b.OptionsService(U)),this._instantiationService.setService(_.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(S.BufferService)),this._instantiationService.setService(_.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(m.LogService)),this._instantiationService.setService(_.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(v.CoreService)),this._instantiationService.setService(_.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(f.CoreMouseService)),this._instantiationService.setService(_.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(h.UnicodeService)),this._instantiationService.setService(_.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(u.CharsetService),this._instantiationService.setService(_.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(R.OscLinkService),this._instantiationService.setService(_.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new E.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,l.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,l.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,l.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,l.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(H=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(H=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new x.WriteBuffer((H,B)=>this._inputHandler.parse(H,B))),this.register((0,l.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(U,H){this._writeBuffer.write(U,H)}writeSync(U,H){this._logService.logLevel<=_.LogLevelEnum.WARN&&!y&&(this._logService.warn("writeSync is unreliable and will be removed soon."),y=!0),this._writeBuffer.writeSync(U,H)}input(U,H=!0){this.coreService.triggerDataEvent(U,H)}resize(U,H){isNaN(U)||isNaN(H)||(U=Math.max(U,S.MINIMUM_COLS),H=Math.max(H,S.MINIMUM_ROWS),this._bufferService.resize(U,H))}scroll(U,H=!1){this._bufferService.scroll(U,H)}scrollLines(U,H,B){this._bufferService.scrollLines(U,H,B)}scrollPages(U){this.scrollLines(U*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(U){const H=U-this._bufferService.buffer.ydisp;H!==0&&this.scrollLines(H)}registerEscHandler(U,H){return this._inputHandler.registerEscHandler(U,H)}registerDcsHandler(U,H){return this._inputHandler.registerDcsHandler(U,H)}registerCsiHandler(U,H){return this._inputHandler.registerCsiHandler(U,H)}registerOscHandler(U,H){return this._inputHandler.registerOscHandler(U,H)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let U=!1;const H=this.optionsService.rawOptions.windowsPty;H&&H.buildNumber!==void 0&&H.buildNumber!==void 0?U=H.backend==="conpty"&&H.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(U=!0),U?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const U=[];U.push(this.onLineFeed(g.updateWindowsModeWrappedState.bind(null,this._bufferService))),U.push(this.registerCsiHandler({final:"H"},()=>((0,g.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const H of U)H.dispose()})}}}s.CoreTerminal=A},8460:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.runAndSubscribe=s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===a)return void this._listeners.splice(c,1)}}})),this._event}fire(a,c){const _=[];for(let d=0;d<this._listeners.length;d++)_.push(this._listeners[d]);for(let d=0;d<_.length;d++)_[d].call(void 0,a,c)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},s.forwardEvent=function(a,c){return a(_=>c.fire(_))},s.runAndSubscribe=function(a,c){return c(void 0),a(_=>c(_))}},5435:function(p,s,a){var c=this&&this.__decorate||function(te,D,T,k){var M,$=arguments.length,V=$<3?D:k===null?k=Object.getOwnPropertyDescriptor(D,T):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")V=Reflect.decorate(te,D,T,k);else for(var Z=te.length-1;Z>=0;Z--)(M=te[Z])&&(V=($<3?M(V):$>3?M(D,T,V):M(D,T))||V);return $>3&&V&&Object.defineProperty(D,T,V),V},_=this&&this.__param||function(te,D){return function(T,k){D(T,k,te)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const d=a(2584),m=a(7116),S=a(2015),b=a(844),v=a(482),l=a(8437),f=a(8460),h=a(643),u=a(511),g=a(3734),E=a(2585),x=a(1480),R=a(6242),y=a(6351),A=a(5941),O={"(":0,")":1,"*":2,"+":3,"-":1,".":2},U=131072;function H(te,D){if(te>24)return D.setWinLines||!1;switch(te){case 1:return!!D.restoreWin;case 2:return!!D.minimizeWin;case 3:return!!D.setWinPosition;case 4:return!!D.setWinSizePixels;case 5:return!!D.raiseWin;case 6:return!!D.lowerWin;case 7:return!!D.refreshWin;case 8:return!!D.setWinSizeChars;case 9:return!!D.maximizeWin;case 10:return!!D.fullscreenWin;case 11:return!!D.getWinState;case 13:return!!D.getWinPosition;case 14:return!!D.getWinSizePixels;case 15:return!!D.getScreenSizePixels;case 16:return!!D.getCellSizePixels;case 18:return!!D.getWinSizeChars;case 19:return!!D.getScreenSizeChars;case 20:return!!D.getIconTitle;case 21:return!!D.getWinTitle;case 22:return!!D.pushTitle;case 23:return!!D.popTitle;case 24:return!!D.setWinLines}return!1}var B;(function(te){te[te.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",te[te.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(B||(s.WindowsOptionsReportType=B={}));let j=0;class q extends b.Disposable{getAttrData(){return this._curAttrData}constructor(D,T,k,M,$,V,Z,ee,F=new S.EscapeSequenceParser){super(),this._bufferService=D,this._charsetService=T,this._coreService=k,this._logService=M,this._optionsService=$,this._oscLinkService=V,this._coreMouseService=Z,this._unicodeService=ee,this._parser=F,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new v.StringToUtf32,this._utf8Decoder=new v.Utf8ToUtf32,this._workCell=new u.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=l.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new f.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new f.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new f.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new f.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new f.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new f.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new f.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new f.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new f.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new f.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new f.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new f.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new Q(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(I=>this._activeBuffer=I.activeBuffer)),this._parser.setCsiHandlerFallback((I,z)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(I),params:z.toArray()})}),this._parser.setEscHandlerFallback(I=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(I)})}),this._parser.setExecuteHandlerFallback(I=>{this._logService.debug("Unknown EXECUTE code: ",{code:I})}),this._parser.setOscHandlerFallback((I,z,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:I,action:z,data:W})}),this._parser.setDcsHandlerFallback((I,z,W)=>{z==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(I),action:z,payload:W})}),this._parser.setPrintHandler((I,z,W)=>this.print(I,z,W)),this._parser.registerCsiHandler({final:"@"},I=>this.insertChars(I)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},I=>this.scrollLeft(I)),this._parser.registerCsiHandler({final:"A"},I=>this.cursorUp(I)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},I=>this.scrollRight(I)),this._parser.registerCsiHandler({final:"B"},I=>this.cursorDown(I)),this._parser.registerCsiHandler({final:"C"},I=>this.cursorForward(I)),this._parser.registerCsiHandler({final:"D"},I=>this.cursorBackward(I)),this._parser.registerCsiHandler({final:"E"},I=>this.cursorNextLine(I)),this._parser.registerCsiHandler({final:"F"},I=>this.cursorPrecedingLine(I)),this._parser.registerCsiHandler({final:"G"},I=>this.cursorCharAbsolute(I)),this._parser.registerCsiHandler({final:"H"},I=>this.cursorPosition(I)),this._parser.registerCsiHandler({final:"I"},I=>this.cursorForwardTab(I)),this._parser.registerCsiHandler({final:"J"},I=>this.eraseInDisplay(I,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},I=>this.eraseInDisplay(I,!0)),this._parser.registerCsiHandler({final:"K"},I=>this.eraseInLine(I,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},I=>this.eraseInLine(I,!0)),this._parser.registerCsiHandler({final:"L"},I=>this.insertLines(I)),this._parser.registerCsiHandler({final:"M"},I=>this.deleteLines(I)),this._parser.registerCsiHandler({final:"P"},I=>this.deleteChars(I)),this._parser.registerCsiHandler({final:"S"},I=>this.scrollUp(I)),this._parser.registerCsiHandler({final:"T"},I=>this.scrollDown(I)),this._parser.registerCsiHandler({final:"X"},I=>this.eraseChars(I)),this._parser.registerCsiHandler({final:"Z"},I=>this.cursorBackwardTab(I)),this._parser.registerCsiHandler({final:"`"},I=>this.charPosAbsolute(I)),this._parser.registerCsiHandler({final:"a"},I=>this.hPositionRelative(I)),this._parser.registerCsiHandler({final:"b"},I=>this.repeatPrecedingCharacter(I)),this._parser.registerCsiHandler({final:"c"},I=>this.sendDeviceAttributesPrimary(I)),this._parser.registerCsiHandler({prefix:">",final:"c"},I=>this.sendDeviceAttributesSecondary(I)),this._parser.registerCsiHandler({final:"d"},I=>this.linePosAbsolute(I)),this._parser.registerCsiHandler({final:"e"},I=>this.vPositionRelative(I)),this._parser.registerCsiHandler({final:"f"},I=>this.hVPosition(I)),this._parser.registerCsiHandler({final:"g"},I=>this.tabClear(I)),this._parser.registerCsiHandler({final:"h"},I=>this.setMode(I)),this._parser.registerCsiHandler({prefix:"?",final:"h"},I=>this.setModePrivate(I)),this._parser.registerCsiHandler({final:"l"},I=>this.resetMode(I)),this._parser.registerCsiHandler({prefix:"?",final:"l"},I=>this.resetModePrivate(I)),this._parser.registerCsiHandler({final:"m"},I=>this.charAttributes(I)),this._parser.registerCsiHandler({final:"n"},I=>this.deviceStatus(I)),this._parser.registerCsiHandler({prefix:"?",final:"n"},I=>this.deviceStatusPrivate(I)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},I=>this.softReset(I)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},I=>this.setCursorStyle(I)),this._parser.registerCsiHandler({final:"r"},I=>this.setScrollRegion(I)),this._parser.registerCsiHandler({final:"s"},I=>this.saveCursor(I)),this._parser.registerCsiHandler({final:"t"},I=>this.windowOptions(I)),this._parser.registerCsiHandler({final:"u"},I=>this.restoreCursor(I)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},I=>this.insertColumns(I)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},I=>this.deleteColumns(I)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},I=>this.selectProtected(I)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},I=>this.requestMode(I,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},I=>this.requestMode(I,!1)),this._parser.setExecuteHandler(d.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(d.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(d.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(d.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(d.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(d.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(d.C1.IND,()=>this.index()),this._parser.setExecuteHandler(d.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(d.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new R.OscHandler(I=>(this.setTitle(I),this.setIconName(I),!0))),this._parser.registerOscHandler(1,new R.OscHandler(I=>this.setIconName(I))),this._parser.registerOscHandler(2,new R.OscHandler(I=>this.setTitle(I))),this._parser.registerOscHandler(4,new R.OscHandler(I=>this.setOrReportIndexedColor(I))),this._parser.registerOscHandler(8,new R.OscHandler(I=>this.setHyperlink(I))),this._parser.registerOscHandler(10,new R.OscHandler(I=>this.setOrReportFgColor(I))),this._parser.registerOscHandler(11,new R.OscHandler(I=>this.setOrReportBgColor(I))),this._parser.registerOscHandler(12,new R.OscHandler(I=>this.setOrReportCursorColor(I))),this._parser.registerOscHandler(104,new R.OscHandler(I=>this.restoreIndexedColor(I))),this._parser.registerOscHandler(110,new R.OscHandler(I=>this.restoreFgColor(I))),this._parser.registerOscHandler(111,new R.OscHandler(I=>this.restoreBgColor(I))),this._parser.registerOscHandler(112,new R.OscHandler(I=>this.restoreCursorColor(I))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const I in m.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:I},()=>this.selectCharset("("+I)),this._parser.registerEscHandler({intermediates:")",final:I},()=>this.selectCharset(")"+I)),this._parser.registerEscHandler({intermediates:"*",final:I},()=>this.selectCharset("*"+I)),this._parser.registerEscHandler({intermediates:"+",final:I},()=>this.selectCharset("+"+I)),this._parser.registerEscHandler({intermediates:"-",final:I},()=>this.selectCharset("-"+I)),this._parser.registerEscHandler({intermediates:".",final:I},()=>this.selectCharset("."+I)),this._parser.registerEscHandler({intermediates:"/",final:I},()=>this.selectCharset("/"+I));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(I=>(this._logService.error("Parsing error: ",I),I)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new y.DcsHandler((I,z)=>this.requestStatusString(I,z)))}_preserveStack(D,T,k,M){this._parseStack.paused=!0,this._parseStack.cursorStartX=D,this._parseStack.cursorStartY=T,this._parseStack.decodedLength=k,this._parseStack.position=M}_logSlowResolvingAsync(D){this._logService.logLevel<=E.LogLevelEnum.WARN&&Promise.race([D,new Promise((T,k)=>setTimeout(()=>k("#SLOW_TIMEOUT"),5e3))]).catch(T=>{if(T!=="#SLOW_TIMEOUT")throw T;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(D,T){let k,M=this._activeBuffer.x,$=this._activeBuffer.y,V=0;const Z=this._parseStack.paused;if(Z){if(k=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,T))return this._logSlowResolvingAsync(k),k;M=this._parseStack.cursorStartX,$=this._parseStack.cursorStartY,this._parseStack.paused=!1,D.length>U&&(V=this._parseStack.position+U)}if(this._logService.logLevel<=E.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof D=="string"?` "${D}"`:` "${Array.prototype.map.call(D,I=>String.fromCharCode(I)).join("")}"`),typeof D=="string"?D.split("").map(I=>I.charCodeAt(0)):D),this._parseBuffer.length<D.length&&this._parseBuffer.length<U&&(this._parseBuffer=new Uint32Array(Math.min(D.length,U))),Z||this._dirtyRowTracker.clearRange(),D.length>U)for(let I=V;I<D.length;I+=U){const z=I+U<D.length?I+U:D.length,W=typeof D=="string"?this._stringDecoder.decode(D.substring(I,z),this._parseBuffer):this._utf8Decoder.decode(D.subarray(I,z),this._parseBuffer);if(k=this._parser.parse(this._parseBuffer,W))return this._preserveStack(M,$,W,I),this._logSlowResolvingAsync(k),k}else if(!Z){const I=typeof D=="string"?this._stringDecoder.decode(D,this._parseBuffer):this._utf8Decoder.decode(D,this._parseBuffer);if(k=this._parser.parse(this._parseBuffer,I))return this._preserveStack(M,$,I,0),this._logSlowResolvingAsync(k),k}this._activeBuffer.x===M&&this._activeBuffer.y===$||this._onCursorMove.fire();const ee=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),F=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);F<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(F,this._bufferService.rows-1),Math.min(ee,this._bufferService.rows-1))}print(D,T,k){let M,$;const V=this._charsetService.charset,Z=this._optionsService.rawOptions.screenReaderMode,ee=this._bufferService.cols,F=this._coreService.decPrivateModes.wraparound,I=this._coreService.modes.insertMode,z=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&k-T>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodepoint(this._activeBuffer.x-1,0,1,z);let X=this._parser.precedingJoinState;for(let Y=T;Y<k;++Y){if(M=D[Y],M<127&&V){const ge=V[String.fromCharCode(M)];ge&&(M=ge.charCodeAt(0))}const le=this._unicodeService.charProperties(M,X);$=x.UnicodeService.extractWidth(le);const ae=x.UnicodeService.extractShouldJoin(le),de=ae?x.UnicodeService.extractWidth(X):0;if(X=le,Z&&this._onA11yChar.fire((0,v.stringFromCodePoint)(M)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+$-de>ee){if(F){const ge=W;let he=this._activeBuffer.x-de;for(this._activeBuffer.x=de,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),de>0&&W instanceof l.BufferLine&&W.copyCellsFrom(ge,he,0,de,!1);he<ee;)ge.setCellFromCodepoint(he++,0,1,z)}else if(this._activeBuffer.x=ee-1,$===2)continue}if(ae&&this._activeBuffer.x){const ge=W.getWidth(this._activeBuffer.x-1)?1:2;W.addCodepointToCell(this._activeBuffer.x-ge,M,$);for(let he=$-de;--he>=0;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,z)}else if(I&&(W.insertCells(this._activeBuffer.x,$-de,this._activeBuffer.getNullCell(z)),W.getWidth(ee-1)===2&&W.setCellFromCodepoint(ee-1,h.NULL_CELL_CODE,h.NULL_CELL_WIDTH,z)),W.setCellFromCodepoint(this._activeBuffer.x++,M,$,z),$>0)for(;--$;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,z)}this._parser.precedingJoinState=X,this._activeBuffer.x<ee&&k-T>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodepoint(this._activeBuffer.x,0,1,z),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(D,T){return D.final!=="t"||D.prefix||D.intermediates?this._parser.registerCsiHandler(D,T):this._parser.registerCsiHandler(D,k=>!H(k.params[0],this._optionsService.rawOptions.windowOptions)||T(k))}registerDcsHandler(D,T){return this._parser.registerDcsHandler(D,new y.DcsHandler(T))}registerEscHandler(D,T){return this._parser.registerEscHandler(D,T)}registerOscHandler(D,T){return this._parser.registerOscHandler(D,new R.OscHandler(T))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var D;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&D.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);T.hasWidth(this._activeBuffer.x)&&!T.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const D=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-D),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(D=this._bufferService.cols-1){this._activeBuffer.x=Math.min(D,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(D,T){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=D,this._activeBuffer.y=this._activeBuffer.scrollTop+T):(this._activeBuffer.x=D,this._activeBuffer.y=T),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(D,T){this._restrictCursor(),this._setCursor(this._activeBuffer.x+D,this._activeBuffer.y+T)}cursorUp(D){const T=this._activeBuffer.y-this._activeBuffer.scrollTop;return T>=0?this._moveCursor(0,-Math.min(T,D.params[0]||1)):this._moveCursor(0,-(D.params[0]||1)),!0}cursorDown(D){const T=this._activeBuffer.scrollBottom-this._activeBuffer.y;return T>=0?this._moveCursor(0,Math.min(T,D.params[0]||1)):this._moveCursor(0,D.params[0]||1),!0}cursorForward(D){return this._moveCursor(D.params[0]||1,0),!0}cursorBackward(D){return this._moveCursor(-(D.params[0]||1),0),!0}cursorNextLine(D){return this.cursorDown(D),this._activeBuffer.x=0,!0}cursorPrecedingLine(D){return this.cursorUp(D),this._activeBuffer.x=0,!0}cursorCharAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(D){return this._setCursor(D.length>=2?(D.params[1]||1)-1:0,(D.params[0]||1)-1),!0}charPosAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(D){return this._moveCursor(D.params[0]||1,0),!0}linePosAbsolute(D){return this._setCursor(this._activeBuffer.x,(D.params[0]||1)-1),!0}vPositionRelative(D){return this._moveCursor(0,D.params[0]||1),!0}hVPosition(D){return this.cursorPosition(D),!0}tabClear(D){const T=D.params[0];return T===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:T===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=D.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=D.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(D){const T=D.params[0];return T===1&&(this._curAttrData.bg|=536870912),T!==2&&T!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(D,T,k,M=!1,$=!1){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);V.replaceCells(T,k,this._activeBuffer.getNullCell(this._eraseAttrData()),$),M&&(V.isWrapped=!1)}_resetBufferLine(D,T=!1){const k=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);k&&(k.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),T),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+D),k.isWrapped=!1)}eraseInDisplay(D,T=!1){let k;switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:for(k=this._activeBuffer.y,this._dirtyRowTracker.markDirty(k),this._eraseInBufferLine(k++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);k<this._bufferService.rows;k++)this._resetBufferLine(k,T);this._dirtyRowTracker.markDirty(k);break;case 1:for(k=this._activeBuffer.y,this._dirtyRowTracker.markDirty(k),this._eraseInBufferLine(k,0,this._activeBuffer.x+1,!0,T),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(k+1).isWrapped=!1);k--;)this._resetBufferLine(k,T);this._dirtyRowTracker.markDirty(0);break;case 2:for(k=this._bufferService.rows,this._dirtyRowTracker.markDirty(k-1);k--;)this._resetBufferLine(k,T);this._dirtyRowTracker.markDirty(0);break;case 3:const M=this._activeBuffer.lines.length-this._bufferService.rows;M>0&&(this._activeBuffer.lines.trimStart(M),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-M,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-M,0),this._onScroll.fire(0))}return!0}eraseInLine(D,T=!1){switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,T);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,T)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(D){this._restrictCursor();let T=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const k=this._activeBuffer.ybase+this._activeBuffer.y,M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,$=this._bufferService.rows-1+this._activeBuffer.ybase-M+1;for(;T--;)this._activeBuffer.lines.splice($-1,1),this._activeBuffer.lines.splice(k,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(D){this._restrictCursor();let T=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const k=this._activeBuffer.ybase+this._activeBuffer.y;let M;for(M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,M=this._bufferService.rows-1+this._activeBuffer.ybase-M;T--;)this._activeBuffer.lines.splice(k,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(D){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.insertCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(D){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.deleteCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(D){let T=D.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(D){let T=D.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(l.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=D.params[0]||1;for(let k=this._activeBuffer.scrollTop;k<=this._activeBuffer.scrollBottom;++k){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);M.deleteCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=D.params[0]||1;for(let k=this._activeBuffer.scrollTop;k<=this._activeBuffer.scrollBottom;++k){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);M.insertCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=D.params[0]||1;for(let k=this._activeBuffer.scrollTop;k<=this._activeBuffer.scrollBottom;++k){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);M.insertCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=D.params[0]||1;for(let k=this._activeBuffer.scrollTop;k<=this._activeBuffer.scrollBottom;++k){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);M.deleteCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(D){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(D.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(D){const T=this._parser.precedingJoinState;if(!T)return!0;const k=D.params[0]||1,M=x.UnicodeService.extractWidth(T),$=this._activeBuffer.x-M,V=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString($),Z=new Uint32Array(V.length*k);let ee=0;for(let I=0;I<V.length;){const z=V.codePointAt(I)||0;Z[ee++]=z,I+=z>65535?2:1}let F=ee;for(let I=1;I<k;++I)Z.copyWithin(F,0,ee),F+=ee;return this.print(Z,0,F),!0}sendDeviceAttributesPrimary(D){return D.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(d.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(d.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(D){return D.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(d.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(d.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(D.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(d.C0.ESC+"[>83;40003;0c")),!0}_is(D){return(this._optionsService.rawOptions.termName+"").indexOf(D)===0}setMode(D){for(let T=0;T<D.length;T++)switch(D.params[T]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(D){for(let T=0;T<D.length;T++)switch(D.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,m.DEFAULT_CHARSET),this._charsetService.setgCharset(1,m.DEFAULT_CHARSET),this._charsetService.setgCharset(2,m.DEFAULT_CHARSET),this._charsetService.setgCharset(3,m.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(D){for(let T=0;T<D.length;T++)switch(D.params[T]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(D){for(let T=0;T<D.length;T++)switch(D.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),D.params[T]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(D,T){const k=this._coreService.decPrivateModes,{activeProtocol:M,activeEncoding:$}=this._coreMouseService,V=this._coreService,{buffers:Z,cols:ee}=this._bufferService,{active:F,alt:I}=Z,z=this._optionsService.rawOptions,W=ae=>ae?1:2,X=D.params[0];return Y=X,le=T?X===2?4:X===4?W(V.modes.insertMode):X===12?3:X===20?W(z.convertEol):0:X===1?W(k.applicationCursorKeys):X===3?z.windowOptions.setWinLines?ee===80?2:ee===132?1:0:0:X===6?W(k.origin):X===7?W(k.wraparound):X===8?3:X===9?W(M==="X10"):X===12?W(z.cursorBlink):X===25?W(!V.isCursorHidden):X===45?W(k.reverseWraparound):X===66?W(k.applicationKeypad):X===67?4:X===1e3?W(M==="VT200"):X===1002?W(M==="DRAG"):X===1003?W(M==="ANY"):X===1004?W(k.sendFocus):X===1005?4:X===1006?W($==="SGR"):X===1015?4:X===1016?W($==="SGR_PIXELS"):X===1048?1:X===47||X===1047||X===1049?W(F===I):X===2004?W(k.bracketedPasteMode):0,V.triggerDataEvent(`${d.C0.ESC}[${T?"":"?"}${Y};${le}$y`),!0;var Y,le}_updateAttrColor(D,T,k,M,$){return T===2?(D|=50331648,D&=-16777216,D|=g.AttributeData.fromColorRGB([k,M,$])):T===5&&(D&=-50331904,D|=33554432|255&k),D}_extractColor(D,T,k){const M=[0,0,-1,0,0,0];let $=0,V=0;do{if(M[V+$]=D.params[T+V],D.hasSubParams(T+V)){const Z=D.getSubParams(T+V);let ee=0;do M[1]===5&&($=1),M[V+ee+1+$]=Z[ee];while(++ee<Z.length&&ee+V+1+$<M.length);break}if(M[1]===5&&V+$>=2||M[1]===2&&V+$>=5)break;M[1]&&($=1)}while(++V+T<D.length&&V+$<M.length);for(let Z=2;Z<M.length;++Z)M[Z]===-1&&(M[Z]=0);switch(M[0]){case 38:k.fg=this._updateAttrColor(k.fg,M[1],M[3],M[4],M[5]);break;case 48:k.bg=this._updateAttrColor(k.bg,M[1],M[3],M[4],M[5]);break;case 58:k.extended=k.extended.clone(),k.extended.underlineColor=this._updateAttrColor(k.extended.underlineColor,M[1],M[3],M[4],M[5])}return V}_processUnderline(D,T){T.extended=T.extended.clone(),(!~D||D>5)&&(D=1),T.extended.underlineStyle=D,T.fg|=268435456,D===0&&(T.fg&=-268435457),T.updateExtended()}_processSGR0(D){D.fg=l.DEFAULT_ATTR_DATA.fg,D.bg=l.DEFAULT_ATTR_DATA.bg,D.extended=D.extended.clone(),D.extended.underlineStyle=0,D.extended.underlineColor&=-67108864,D.updateExtended()}charAttributes(D){if(D.length===1&&D.params[0]===0)return this._processSGR0(this._curAttrData),!0;const T=D.length;let k;const M=this._curAttrData;for(let $=0;$<T;$++)k=D.params[$],k>=30&&k<=37?(M.fg&=-50331904,M.fg|=16777216|k-30):k>=40&&k<=47?(M.bg&=-50331904,M.bg|=16777216|k-40):k>=90&&k<=97?(M.fg&=-50331904,M.fg|=16777224|k-90):k>=100&&k<=107?(M.bg&=-50331904,M.bg|=16777224|k-100):k===0?this._processSGR0(M):k===1?M.fg|=134217728:k===3?M.bg|=67108864:k===4?(M.fg|=268435456,this._processUnderline(D.hasSubParams($)?D.getSubParams($)[0]:1,M)):k===5?M.fg|=536870912:k===7?M.fg|=67108864:k===8?M.fg|=1073741824:k===9?M.fg|=2147483648:k===2?M.bg|=134217728:k===21?this._processUnderline(2,M):k===22?(M.fg&=-134217729,M.bg&=-134217729):k===23?M.bg&=-67108865:k===24?(M.fg&=-268435457,this._processUnderline(0,M)):k===25?M.fg&=-536870913:k===27?M.fg&=-67108865:k===28?M.fg&=-1073741825:k===29?M.fg&=2147483647:k===39?(M.fg&=-67108864,M.fg|=16777215&l.DEFAULT_ATTR_DATA.fg):k===49?(M.bg&=-67108864,M.bg|=16777215&l.DEFAULT_ATTR_DATA.bg):k===38||k===48||k===58?$+=this._extractColor(D,$,M):k===53?M.bg|=1073741824:k===55?M.bg&=-1073741825:k===59?(M.extended=M.extended.clone(),M.extended.underlineColor=-1,M.updateExtended()):k===100?(M.fg&=-67108864,M.fg|=16777215&l.DEFAULT_ATTR_DATA.fg,M.bg&=-67108864,M.bg|=16777215&l.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",k);return!0}deviceStatus(D){switch(D.params[0]){case 5:this._coreService.triggerDataEvent(`${d.C0.ESC}[0n`);break;case 6:const T=this._activeBuffer.y+1,k=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[${T};${k}R`)}return!0}deviceStatusPrivate(D){if(D.params[0]===6){const T=this._activeBuffer.y+1,k=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[?${T};${k}R`)}return!0}softReset(D){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(D){const T=D.params[0]||1;switch(T){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const k=T%2==1;return this._optionsService.options.cursorBlink=k,!0}setScrollRegion(D){const T=D.params[0]||1;let k;return(D.length<2||(k=D.params[1])>this._bufferService.rows||k===0)&&(k=this._bufferService.rows),k>T&&(this._activeBuffer.scrollTop=T-1,this._activeBuffer.scrollBottom=k-1,this._setCursor(0,0)),!0}windowOptions(D){if(!H(D.params[0],this._optionsService.rawOptions.windowOptions))return!0;const T=D.length>1?D.params[1]:0;switch(D.params[0]){case 14:T!==2&&this._onRequestWindowsOptionsReport.fire(B.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(B.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${d.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:T!==0&&T!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),T!==0&&T!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:T!==0&&T!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),T!==0&&T!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(D){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(D){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(D){return this._windowTitle=D,this._onTitleChange.fire(D),!0}setIconName(D){return this._iconName=D,!0}setOrReportIndexedColor(D){const T=[],k=D.split(";");for(;k.length>1;){const M=k.shift(),$=k.shift();if(/^\d+$/.exec(M)){const V=parseInt(M);if(ie(V))if($==="?")T.push({type:0,index:V});else{const Z=(0,A.parseColor)($);Z&&T.push({type:1,index:V,color:Z})}}}return T.length&&this._onColor.fire(T),!0}setHyperlink(D){const T=D.split(";");return!(T.length<2)&&(T[1]?this._createHyperlink(T[0],T[1]):!T[0]&&this._finishHyperlink())}_createHyperlink(D,T){this._getCurrentLinkId()&&this._finishHyperlink();const k=D.split(":");let M;const $=k.findIndex(V=>V.startsWith("id="));return $!==-1&&(M=k[$].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:M,uri:T}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(D,T){const k=D.split(";");for(let M=0;M<k.length&&!(T>=this._specialColors.length);++M,++T)if(k[M]==="?")this._onColor.fire([{type:0,index:this._specialColors[T]}]);else{const $=(0,A.parseColor)(k[M]);$&&this._onColor.fire([{type:1,index:this._specialColors[T],color:$}])}return!0}setOrReportFgColor(D){return this._setOrReportSpecialColor(D,0)}setOrReportBgColor(D){return this._setOrReportSpecialColor(D,1)}setOrReportCursorColor(D){return this._setOrReportSpecialColor(D,2)}restoreIndexedColor(D){if(!D)return this._onColor.fire([{type:2}]),!0;const T=[],k=D.split(";");for(let M=0;M<k.length;++M)if(/^\d+$/.exec(k[M])){const $=parseInt(k[M]);ie($)&&T.push({type:2,index:$})}return T.length&&this._onColor.fire(T),!0}restoreFgColor(D){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(D){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(D){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,m.DEFAULT_CHARSET),!0}selectCharset(D){return D.length!==2?(this.selectDefaultCharset(),!0):(D[0]==="/"||this._charsetService.setgCharset(O[D[0]],m.CHARSETS[D[1]]||m.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const D=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,D,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=l.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(D){return this._charsetService.setgLevel(D),!0}screenAlignmentPattern(){const D=new u.CellData;D.content=4194373,D.fg=this._curAttrData.fg,D.bg=this._curAttrData.bg,this._setCursor(0,0);for(let T=0;T<this._bufferService.rows;++T){const k=this._activeBuffer.ybase+this._activeBuffer.y+T,M=this._activeBuffer.lines.get(k);M&&(M.fill(D),M.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(D,T){const k=this._bufferService.buffer,M=this._optionsService.rawOptions;return($=>(this._coreService.triggerDataEvent(`${d.C0.ESC}${$}${d.C0.ESC}\\`),!0))(D==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:D==='"p'?'P1$r61;1"p':D==="r"?`P1$r${k.scrollTop+1};${k.scrollBottom+1}r`:D==="m"?"P1$r0m":D===" q"?`P1$r${{block:2,underline:4,bar:6}[M.cursorStyle]-(M.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(D,T){this._dirtyRowTracker.markRangeDirty(D,T)}}s.InputHandler=q;let Q=class{constructor(te){this._bufferService=te,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(te){te<this.start?this.start=te:te>this.end&&(this.end=te)}markRangeDirty(te,D){te>D&&(j=te,te=D,D=j),te<this.start&&(this.start=te),D>this.end&&(this.end=D)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function ie(te){return 0<=te&&te<256}Q=c([_(0,E.IBufferService)],Q)},844:(p,s)=>{function a(c){for(const _ of c)_.dispose();c.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.MutableDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const _=this._disposables.indexOf(c);_!==-1&&this._disposables.splice(_,1)}},s.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(c){var _;this._isDisposed||c===this._value||((_=this._value)==null||_.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){var c;this._isDisposed=!0,(c=this._value)==null||c.dispose(),this._value=void 0}},s.toDisposable=function(c){return{dispose:c}},s.disposeArray=a,s.getDisposeArrayDisposable=function(c){return{dispose:()=>a(c)}}},1505:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(_,d,m){this._data[_]||(this._data[_]={}),this._data[_][d]=m}get(_,d){return this._data[_]?this._data[_][d]:void 0}clear(){this._data={}}}s.TwoKeyMap=a,s.FourKeyMap=class{constructor(){this._data=new a}set(c,_,d,m,S){this._data.get(c,_)||this._data.set(c,_,new a),this._data.get(c,_).set(d,m,S)}get(c,_,d,m){var S;return(S=this._data.get(c,_))==null?void 0:S.get(d,m)}clear(){this._data.clear()}}},6114:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof process<"u"&&"title"in process;const a=s.isNode?"node":navigator.userAgent,c=s.isNode?"node":navigator.platform;s.isFirefox=a.includes("Firefox"),s.isLegacyEdge=a.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(a),s.getSafariVersion=function(){if(!s.isSafari)return 0;const _=a.match(/Version\/(\d+)/);return _===null||_.length<2?0:parseInt(_[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),s.isIpad=c==="iPad",s.isIphone=c==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),s.isLinux=c.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(a)},6106:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let a=0;s.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(a=this._search(this._getKey(c)),this._array.splice(a,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const _=this._getKey(c);if(_===void 0||(a=this._search(_),a===-1)||this._getKey(this._array[a])!==_)return!1;do if(this._array[a]===c)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===_);return!1}*getKeyIterator(c){if(this._array.length!==0&&(a=this._search(c),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===c))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===c)}forEachByKey(c,_){if(this._array.length!==0&&(a=this._search(c),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===c))do _(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===c)}values(){return[...this._array].values()}_search(c){let _=0,d=this._array.length-1;for(;d>=_;){let m=_+d>>1;const S=this._getKey(this._array[m]);if(S>c)d=m-1;else{if(!(S<c)){for(;m>0&&this._getKey(this._array[m-1])===c;)m--;return m}_=m+1}}return _}}},7226:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const c=a(6114);class _{constructor(){this._tasks=[],this._i=0}enqueue(S){this._tasks.push(S),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(S){this._idleCallback=void 0;let b=0,v=0,l=S.timeRemaining(),f=0;for(;this._i<this._tasks.length;){if(b=Date.now(),this._tasks[this._i]()||this._i++,b=Math.max(1,Date.now()-b),v=Math.max(b,v),f=S.timeRemaining(),1.5*v>f)return l-b<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(l-b))}ms`),void this._start();l=f}this.clear()}}class d extends _{_requestCallback(S){return setTimeout(()=>S(this._createDeadline(16)))}_cancelCallback(S){clearTimeout(S)}_createDeadline(S){const b=Date.now()+S;return{timeRemaining:()=>Math.max(0,b-Date.now())}}}s.PriorityTaskQueue=d,s.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends _{_requestCallback(m){return requestIdleCallback(m)}_cancelCallback(m){cancelIdleCallback(m)}}:d,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(m){this._queue.clear(),this._queue.enqueue(m)}flush(){this._queue.flush()}}},9282:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const c=a(643);s.updateWindowsModeWrappedState=function(_){const d=_.buffer.lines.get(_.buffer.ybase+_.buffer.y-1),m=d==null?void 0:d.get(_.cols-1),S=_.buffer.lines.get(_.buffer.ybase+_.buffer.y);S&&m&&(S.isWrapped=m[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&m[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new a;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}s.AttributeData=a;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}get underlineVariantOffset(){const d=(3758096384&this._ext)>>29;return d<0?4294967288^d:d}set underlineVariantOffset(d){this._ext&=536870911,this._ext|=d<<29&3758096384}constructor(d=0,m=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=m}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=c},9092:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const c=a(6349),_=a(7226),d=a(3734),m=a(8437),S=a(4634),b=a(511),v=a(643),l=a(4863),f=a(7116);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(h,u,g){this._hasScrollback=h,this._optionsService=u,this._bufferService=g,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=m.DEFAULT_ATTR_DATA.clone(),this.savedCharset=f.DEFAULT_CHARSET,this.markers=[],this._nullCell=b.CellData.fromCharData([0,v.NULL_CELL_CHAR,v.NULL_CELL_WIDTH,v.NULL_CELL_CODE]),this._whitespaceCell=b.CellData.fromCharData([0,v.WHITESPACE_CELL_CHAR,v.WHITESPACE_CELL_WIDTH,v.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new _.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(h){return h?(this._nullCell.fg=h.fg,this._nullCell.bg=h.bg,this._nullCell.extended=h.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new d.ExtendedAttrs),this._nullCell}getWhitespaceCell(h){return h?(this._whitespaceCell.fg=h.fg,this._whitespaceCell.bg=h.bg,this._whitespaceCell.extended=h.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new d.ExtendedAttrs),this._whitespaceCell}getBlankLine(h,u){return new m.BufferLine(this._bufferService.cols,this.getNullCell(h),u)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const h=this.ybase+this.y-this.ydisp;return h>=0&&h<this._rows}_getCorrectBufferLength(h){if(!this._hasScrollback)return h;const u=h+this._optionsService.rawOptions.scrollback;return u>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:u}fillViewportRows(h){if(this.lines.length===0){h===void 0&&(h=m.DEFAULT_ATTR_DATA);let u=this._rows;for(;u--;)this.lines.push(this.getBlankLine(h))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(h,u){const g=this.getNullCell(m.DEFAULT_ATTR_DATA);let E=0;const x=this._getCorrectBufferLength(u);if(x>this.lines.maxLength&&(this.lines.maxLength=x),this.lines.length>0){if(this._cols<h)for(let y=0;y<this.lines.length;y++)E+=+this.lines.get(y).resize(h,g);let R=0;if(this._rows<u)for(let y=this._rows;y<u;y++)this.lines.length<u+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new m.BufferLine(h,g)):this.ybase>0&&this.lines.length<=this.ybase+this.y+R+1?(this.ybase--,R++,this.ydisp>0&&this.ydisp--):this.lines.push(new m.BufferLine(h,g)));else for(let y=this._rows;y>u;y--)this.lines.length>u+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(x<this.lines.maxLength){const y=this.lines.length-x;y>0&&(this.lines.trimStart(y),this.ybase=Math.max(this.ybase-y,0),this.ydisp=Math.max(this.ydisp-y,0),this.savedY=Math.max(this.savedY-y,0)),this.lines.maxLength=x}this.x=Math.min(this.x,h-1),this.y=Math.min(this.y,u-1),R&&(this.y+=R),this.savedX=Math.min(this.savedX,h-1),this.scrollTop=0}if(this.scrollBottom=u-1,this._isReflowEnabled&&(this._reflow(h,u),this._cols>h))for(let R=0;R<this.lines.length;R++)E+=+this.lines.get(R).resize(h,g);this._cols=h,this._rows=u,this._memoryCleanupQueue.clear(),E>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let h=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,h=!1);let u=0;for(;this._memoryCleanupPosition<this.lines.length;)if(u+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),u>100)return!0;return h}get _isReflowEnabled(){const h=this._optionsService.rawOptions.windowsPty;return h&&h.buildNumber?this._hasScrollback&&h.backend==="conpty"&&h.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(h,u){this._cols!==h&&(h>this._cols?this._reflowLarger(h,u):this._reflowSmaller(h,u))}_reflowLarger(h,u){const g=(0,S.reflowLargerGetLinesToRemove)(this.lines,this._cols,h,this.ybase+this.y,this.getNullCell(m.DEFAULT_ATTR_DATA));if(g.length>0){const E=(0,S.reflowLargerCreateNewLayout)(this.lines,g);(0,S.reflowLargerApplyNewLayout)(this.lines,E.layout),this._reflowLargerAdjustViewport(h,u,E.countRemoved)}}_reflowLargerAdjustViewport(h,u,g){const E=this.getNullCell(m.DEFAULT_ATTR_DATA);let x=g;for(;x-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<u&&this.lines.push(new m.BufferLine(h,E))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-g,0)}_reflowSmaller(h,u){const g=this.getNullCell(m.DEFAULT_ATTR_DATA),E=[];let x=0;for(let R=this.lines.length-1;R>=0;R--){let y=this.lines.get(R);if(!y||!y.isWrapped&&y.getTrimmedLength()<=h)continue;const A=[y];for(;y.isWrapped&&R>0;)y=this.lines.get(--R),A.unshift(y);const O=this.ybase+this.y;if(O>=R&&O<R+A.length)continue;const U=A[A.length-1].getTrimmedLength(),H=(0,S.reflowSmallerGetNewLineLengths)(A,this._cols,h),B=H.length-A.length;let j;j=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const q=[];for(let k=0;k<B;k++){const M=this.getBlankLine(m.DEFAULT_ATTR_DATA,!0);q.push(M)}q.length>0&&(E.push({start:R+A.length+x,newLines:q}),x+=q.length),A.push(...q);let Q=H.length-1,ie=H[Q];ie===0&&(Q--,ie=H[Q]);let te=A.length-B-1,D=U;for(;te>=0;){const k=Math.min(D,ie);if(A[Q]===void 0)break;if(A[Q].copyCellsFrom(A[te],D-k,ie-k,k,!0),ie-=k,ie===0&&(Q--,ie=H[Q]),D-=k,D===0){te--;const M=Math.max(te,0);D=(0,S.getWrappedLineTrimmedLength)(A,M,this._cols)}}for(let k=0;k<A.length;k++)H[k]<h&&A[k].setCell(H[k],g);let T=B-j;for(;T-- >0;)this.ybase===0?this.y<u-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+x)-u&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+u-1)}if(E.length>0){const R=[],y=[];for(let Q=0;Q<this.lines.length;Q++)y.push(this.lines.get(Q));const A=this.lines.length;let O=A-1,U=0,H=E[U];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+x);let B=0;for(let Q=Math.min(this.lines.maxLength-1,A+x-1);Q>=0;Q--)if(H&&H.start>O+B){for(let ie=H.newLines.length-1;ie>=0;ie--)this.lines.set(Q--,H.newLines[ie]);Q++,R.push({index:O+1,amount:H.newLines.length}),B+=H.newLines.length,H=E[++U]}else this.lines.set(Q,y[O--]);let j=0;for(let Q=R.length-1;Q>=0;Q--)R[Q].index+=j,this.lines.onInsertEmitter.fire(R[Q]),j+=R[Q].amount;const q=Math.max(0,A+x-this.lines.maxLength);q>0&&this.lines.onTrimEmitter.fire(q)}}translateBufferLineToString(h,u,g=0,E){const x=this.lines.get(h);return x?x.translateToString(u,g,E):""}getWrappedRangeForLine(h){let u=h,g=h;for(;u>0&&this.lines.get(u).isWrapped;)u--;for(;g+1<this.lines.length&&this.lines.get(g+1).isWrapped;)g++;return{first:u,last:g}}setupTabStops(h){for(h!=null?this.tabs[h]||(h=this.prevStop(h)):(this.tabs={},h=0);h<this._cols;h+=this._optionsService.rawOptions.tabStopWidth)this.tabs[h]=!0}prevStop(h){for(h==null&&(h=this.x);!this.tabs[--h]&&h>0;);return h>=this._cols?this._cols-1:h<0?0:h}nextStop(h){for(h==null&&(h=this.x);!this.tabs[++h]&&h<this._cols;);return h>=this._cols?this._cols-1:h<0?0:h}clearMarkers(h){this._isClearing=!0;for(let u=0;u<this.markers.length;u++)this.markers[u].line===h&&(this.markers[u].dispose(),this.markers.splice(u--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].dispose(),this.markers.splice(h--,1);this._isClearing=!1}addMarker(h){const u=new l.Marker(h);return this.markers.push(u),u.register(this.lines.onTrim(g=>{u.line-=g,u.line<0&&u.dispose()})),u.register(this.lines.onInsert(g=>{u.line>=g.index&&(u.line+=g.amount)})),u.register(this.lines.onDelete(g=>{u.line>=g.index&&u.line<g.index+g.amount&&u.dispose(),u.line>g.index&&(u.line-=g.amount)})),u.register(u.onDispose(()=>this._removeMarker(u))),u}_removeMarker(h){this._isClearing||this.markers.splice(this.markers.indexOf(h),1)}}},8437:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const c=a(3734),_=a(511),d=a(643),m=a(482);s.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let S=0;class b{constructor(l,f,h=!1){this.isWrapped=h,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*l);const u=f||_.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]);for(let g=0;g<l;++g)this.setCell(g,u);this.length=l}get(l){const f=this._data[3*l+0],h=2097151&f;return[this._data[3*l+1],2097152&f?this._combined[l]:h?(0,m.stringFromCodePoint)(h):"",f>>22,2097152&f?this._combined[l].charCodeAt(this._combined[l].length-1):h]}set(l,f){this._data[3*l+1]=f[d.CHAR_DATA_ATTR_INDEX],f[d.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[l]=f[1],this._data[3*l+0]=2097152|l|f[d.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*l+0]=f[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[d.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(l){return this._data[3*l+0]>>22}hasWidth(l){return 12582912&this._data[3*l+0]}getFg(l){return this._data[3*l+1]}getBg(l){return this._data[3*l+2]}hasContent(l){return 4194303&this._data[3*l+0]}getCodePoint(l){const f=this._data[3*l+0];return 2097152&f?this._combined[l].charCodeAt(this._combined[l].length-1):2097151&f}isCombined(l){return 2097152&this._data[3*l+0]}getString(l){const f=this._data[3*l+0];return 2097152&f?this._combined[l]:2097151&f?(0,m.stringFromCodePoint)(2097151&f):""}isProtected(l){return 536870912&this._data[3*l+2]}loadCell(l,f){return S=3*l,f.content=this._data[S+0],f.fg=this._data[S+1],f.bg=this._data[S+2],2097152&f.content&&(f.combinedData=this._combined[l]),268435456&f.bg&&(f.extended=this._extendedAttrs[l]),f}setCell(l,f){2097152&f.content&&(this._combined[l]=f.combinedData),268435456&f.bg&&(this._extendedAttrs[l]=f.extended),this._data[3*l+0]=f.content,this._data[3*l+1]=f.fg,this._data[3*l+2]=f.bg}setCellFromCodepoint(l,f,h,u){268435456&u.bg&&(this._extendedAttrs[l]=u.extended),this._data[3*l+0]=f|h<<22,this._data[3*l+1]=u.fg,this._data[3*l+2]=u.bg}addCodepointToCell(l,f,h){let u=this._data[3*l+0];2097152&u?this._combined[l]+=(0,m.stringFromCodePoint)(f):2097151&u?(this._combined[l]=(0,m.stringFromCodePoint)(2097151&u)+(0,m.stringFromCodePoint)(f),u&=-2097152,u|=2097152):u=f|4194304,h&&(u&=-12582913,u|=h<<22),this._data[3*l+0]=u}insertCells(l,f,h){if((l%=this.length)&&this.getWidth(l-1)===2&&this.setCellFromCodepoint(l-1,0,1,h),f<this.length-l){const u=new _.CellData;for(let g=this.length-l-f-1;g>=0;--g)this.setCell(l+f+g,this.loadCell(l+g,u));for(let g=0;g<f;++g)this.setCell(l+g,h)}else for(let u=l;u<this.length;++u)this.setCell(u,h);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,h)}deleteCells(l,f,h){if(l%=this.length,f<this.length-l){const u=new _.CellData;for(let g=0;g<this.length-l-f;++g)this.setCell(l+g,this.loadCell(l+f+g,u));for(let g=this.length-f;g<this.length;++g)this.setCell(g,h)}else for(let u=l;u<this.length;++u)this.setCell(u,h);l&&this.getWidth(l-1)===2&&this.setCellFromCodepoint(l-1,0,1,h),this.getWidth(l)!==0||this.hasContent(l)||this.setCellFromCodepoint(l,0,1,h)}replaceCells(l,f,h,u=!1){if(u)for(l&&this.getWidth(l-1)===2&&!this.isProtected(l-1)&&this.setCellFromCodepoint(l-1,0,1,h),f<this.length&&this.getWidth(f-1)===2&&!this.isProtected(f)&&this.setCellFromCodepoint(f,0,1,h);l<f&&l<this.length;)this.isProtected(l)||this.setCell(l,h),l++;else for(l&&this.getWidth(l-1)===2&&this.setCellFromCodepoint(l-1,0,1,h),f<this.length&&this.getWidth(f-1)===2&&this.setCellFromCodepoint(f,0,1,h);l<f&&l<this.length;)this.setCell(l++,h)}resize(l,f){if(l===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const h=3*l;if(l>this.length){if(this._data.buffer.byteLength>=4*h)this._data=new Uint32Array(this._data.buffer,0,h);else{const u=new Uint32Array(h);u.set(this._data),this._data=u}for(let u=this.length;u<l;++u)this.setCell(u,f)}else{this._data=this._data.subarray(0,h);const u=Object.keys(this._combined);for(let E=0;E<u.length;E++){const x=parseInt(u[E],10);x>=l&&delete this._combined[x]}const g=Object.keys(this._extendedAttrs);for(let E=0;E<g.length;E++){const x=parseInt(g[E],10);x>=l&&delete this._extendedAttrs[x]}}return this.length=l,4*h*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const l=new Uint32Array(this._data.length);return l.set(this._data),this._data=l,1}return 0}fill(l,f=!1){if(f)for(let h=0;h<this.length;++h)this.isProtected(h)||this.setCell(h,l);else{this._combined={},this._extendedAttrs={};for(let h=0;h<this.length;++h)this.setCell(h,l)}}copyFrom(l){this.length!==l.length?this._data=new Uint32Array(l._data):this._data.set(l._data),this.length=l.length,this._combined={};for(const f in l._combined)this._combined[f]=l._combined[f];this._extendedAttrs={};for(const f in l._extendedAttrs)this._extendedAttrs[f]=l._extendedAttrs[f];this.isWrapped=l.isWrapped}clone(){const l=new b(0);l._data=new Uint32Array(this._data),l.length=this.length;for(const f in this._combined)l._combined[f]=this._combined[f];for(const f in this._extendedAttrs)l._extendedAttrs[f]=this._extendedAttrs[f];return l.isWrapped=this.isWrapped,l}getTrimmedLength(){for(let l=this.length-1;l>=0;--l)if(4194303&this._data[3*l+0])return l+(this._data[3*l+0]>>22);return 0}getNoBgTrimmedLength(){for(let l=this.length-1;l>=0;--l)if(4194303&this._data[3*l+0]||50331648&this._data[3*l+2])return l+(this._data[3*l+0]>>22);return 0}copyCellsFrom(l,f,h,u,g){const E=l._data;if(g)for(let R=u-1;R>=0;R--){for(let y=0;y<3;y++)this._data[3*(h+R)+y]=E[3*(f+R)+y];268435456&E[3*(f+R)+2]&&(this._extendedAttrs[h+R]=l._extendedAttrs[f+R])}else for(let R=0;R<u;R++){for(let y=0;y<3;y++)this._data[3*(h+R)+y]=E[3*(f+R)+y];268435456&E[3*(f+R)+2]&&(this._extendedAttrs[h+R]=l._extendedAttrs[f+R])}const x=Object.keys(l._combined);for(let R=0;R<x.length;R++){const y=parseInt(x[R],10);y>=f&&(this._combined[y-f+h]=l._combined[y])}}translateToString(l,f,h,u){f=f??0,h=h??this.length,l&&(h=Math.min(h,this.getTrimmedLength())),u&&(u.length=0);let g="";for(;f<h;){const E=this._data[3*f+0],x=2097151&E,R=2097152&E?this._combined[f]:x?(0,m.stringFromCodePoint)(x):d.WHITESPACE_CELL_CHAR;if(g+=R,u)for(let y=0;y<R.length;++y)u.push(f);f+=E>>22||1}return u&&u.push(f),g}}s.BufferLine=b},4841:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(a,c){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return c*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(p,s)=>{function a(c,_,d){if(_===c.length-1)return c[_].getTrimmedLength();const m=!c[_].hasContent(d-1)&&c[_].getWidth(d-1)===1,S=c[_+1].getWidth(0)===2;return m&&S?d-1:d}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(c,_,d,m,S){const b=[];for(let v=0;v<c.length-1;v++){let l=v,f=c.get(++l);if(!f.isWrapped)continue;const h=[c.get(v)];for(;l<c.length&&f.isWrapped;)h.push(f),f=c.get(++l);if(m>=v&&m<l){v+=h.length-1;continue}let u=0,g=a(h,u,_),E=1,x=0;for(;E<h.length;){const y=a(h,E,_),A=y-x,O=d-g,U=Math.min(A,O);h[u].copyCellsFrom(h[E],x,g,U,!1),g+=U,g===d&&(u++,g=0),x+=U,x===y&&(E++,x=0),g===0&&u!==0&&h[u-1].getWidth(d-1)===2&&(h[u].copyCellsFrom(h[u-1],d-1,g++,1,!1),h[u-1].setCell(d-1,S))}h[u].replaceCells(g,d,S);let R=0;for(let y=h.length-1;y>0&&(y>u||h[y].getTrimmedLength()===0);y--)R++;R>0&&(b.push(v+h.length-R),b.push(R)),v+=h.length-1}return b},s.reflowLargerCreateNewLayout=function(c,_){const d=[];let m=0,S=_[m],b=0;for(let v=0;v<c.length;v++)if(S===v){const l=_[++m];c.onDeleteEmitter.fire({index:v-b,amount:l}),v+=l-1,b+=l,S=_[++m]}else d.push(v);return{layout:d,countRemoved:b}},s.reflowLargerApplyNewLayout=function(c,_){const d=[];for(let m=0;m<_.length;m++)d.push(c.get(_[m]));for(let m=0;m<d.length;m++)c.set(m,d[m]);c.length=_.length},s.reflowSmallerGetNewLineLengths=function(c,_,d){const m=[],S=c.map((f,h)=>a(c,h,_)).reduce((f,h)=>f+h);let b=0,v=0,l=0;for(;l<S;){if(S-l<d){m.push(S-l);break}b+=d;const f=a(c,v,_);b>f&&(b-=f,v++);const h=c[v].getWidth(b-1)===2;h&&b--;const u=h?d-1:d;m.push(u),l+=u}return m},s.getWrappedLineTrimmedLength=a},5295:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const c=a(8460),_=a(844),d=a(9092);class m extends _.Disposable{constructor(b,v){super(),this._optionsService=b,this._bufferService=v,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new d.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new d.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(b){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(b),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(b,v){this._normal.resize(b,v),this._alt.resize(b,v),this.setupTabStops(b)}setupTabStops(b){this._normal.setupTabStops(b),this._alt.setupTabStops(b)}}s.BufferSet=m},511:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const c=a(482),_=a(643),d=a(3734);class m extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(b){const v=new m;return v.setFromCharData(b),v}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(b){this.fg=b[_.CHAR_DATA_ATTR_INDEX],this.bg=0;let v=!1;if(b[_.CHAR_DATA_CHAR_INDEX].length>2)v=!0;else if(b[_.CHAR_DATA_CHAR_INDEX].length===2){const l=b[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=l&&l<=56319){const f=b[_.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=f&&f<=57343?this.content=1024*(l-55296)+f-56320+65536|b[_.CHAR_DATA_WIDTH_INDEX]<<22:v=!0}else v=!0}else this.content=b[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|b[_.CHAR_DATA_WIDTH_INDEX]<<22;v&&(this.combinedData=b[_.CHAR_DATA_CHAR_INDEX],this.content=2097152|b[_.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=m},643:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const c=a(8460),_=a(844);class d{get id(){return this._id}constructor(S){this.line=S,this.isDisposed=!1,this._disposables=[],this._id=d._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,_.disposeArray)(this._disposables),this._disposables.length=0)}register(S){return this._disposables.push(S),S}}s.Marker=d,d._nextId=1},7116:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},s.CHARSETS.A={"#":"Â£"},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},s.CHARSETS.C=s.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},s.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},s.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},s.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},s.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},s.CHARSETS.E=s.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},s.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},s.CHARSETS.H=s.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},s.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(p,s)=>{var a,c,_;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(d){d.NUL="\0",d.SOH="",d.STX="",d.ETX="",d.EOT="",d.ENQ="",d.ACK="",d.BEL="\x07",d.BS="\b",d.HT="	",d.LF=`
`,d.VT="\v",d.FF="\f",d.CR="\r",d.SO="",d.SI="",d.DLE="",d.DC1="",d.DC2="",d.DC3="",d.DC4="",d.NAK="",d.SYN="",d.ETB="",d.CAN="",d.EM="",d.SUB="",d.ESC="\x1B",d.FS="",d.GS="",d.RS="",d.US="",d.SP=" ",d.DEL=""}(a||(s.C0=a={})),function(d){d.PAD="Â",d.HOP="Â",d.BPH="Â",d.NBH="Â",d.IND="Â",d.NEL="Â",d.SSA="Â",d.ESA="Â",d.HTS="Â",d.HTJ="Â",d.VTS="Â",d.PLD="Â",d.PLU="Â",d.RI="Â",d.SS2="Â",d.SS3="Â",d.DCS="Â",d.PU1="Â",d.PU2="Â",d.STS="Â",d.CCH="Â",d.MW="Â",d.SPA="Â",d.EPA="Â",d.SOS="Â",d.SGCI="Â",d.SCI="Â",d.CSI="Â",d.ST="Â",d.OSC="Â",d.PM="Â",d.APC="Â"}(c||(s.C1=c={})),function(d){d.ST=`${a.ESC}\\`}(_||(s.C1_ESCAPED=_={}))},7399:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const c=a(2584),_={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(d,m,S,b){const v={type:0,cancel:!1,key:void 0},l=(d.shiftKey?1:0)|(d.altKey?2:0)|(d.ctrlKey?4:0)|(d.metaKey?8:0);switch(d.keyCode){case 0:d.key==="UIKeyInputUpArrow"?v.key=m?c.C0.ESC+"OA":c.C0.ESC+"[A":d.key==="UIKeyInputLeftArrow"?v.key=m?c.C0.ESC+"OD":c.C0.ESC+"[D":d.key==="UIKeyInputRightArrow"?v.key=m?c.C0.ESC+"OC":c.C0.ESC+"[C":d.key==="UIKeyInputDownArrow"&&(v.key=m?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:v.key=d.ctrlKey?"\b":c.C0.DEL,d.altKey&&(v.key=c.C0.ESC+v.key);break;case 9:if(d.shiftKey){v.key=c.C0.ESC+"[Z";break}v.key=c.C0.HT,v.cancel=!0;break;case 13:v.key=d.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,v.cancel=!0;break;case 27:v.key=c.C0.ESC,d.altKey&&(v.key=c.C0.ESC+c.C0.ESC),v.cancel=!0;break;case 37:if(d.metaKey)break;l?(v.key=c.C0.ESC+"[1;"+(l+1)+"D",v.key===c.C0.ESC+"[1;3D"&&(v.key=c.C0.ESC+(S?"b":"[1;5D"))):v.key=m?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(d.metaKey)break;l?(v.key=c.C0.ESC+"[1;"+(l+1)+"C",v.key===c.C0.ESC+"[1;3C"&&(v.key=c.C0.ESC+(S?"f":"[1;5C"))):v.key=m?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(d.metaKey)break;l?(v.key=c.C0.ESC+"[1;"+(l+1)+"A",S||v.key!==c.C0.ESC+"[1;3A"||(v.key=c.C0.ESC+"[1;5A")):v.key=m?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(d.metaKey)break;l?(v.key=c.C0.ESC+"[1;"+(l+1)+"B",S||v.key!==c.C0.ESC+"[1;3B"||(v.key=c.C0.ESC+"[1;5B")):v.key=m?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:d.shiftKey||d.ctrlKey||(v.key=c.C0.ESC+"[2~");break;case 46:v.key=l?c.C0.ESC+"[3;"+(l+1)+"~":c.C0.ESC+"[3~";break;case 36:v.key=l?c.C0.ESC+"[1;"+(l+1)+"H":m?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:v.key=l?c.C0.ESC+"[1;"+(l+1)+"F":m?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:d.shiftKey?v.type=2:d.ctrlKey?v.key=c.C0.ESC+"[5;"+(l+1)+"~":v.key=c.C0.ESC+"[5~";break;case 34:d.shiftKey?v.type=3:d.ctrlKey?v.key=c.C0.ESC+"[6;"+(l+1)+"~":v.key=c.C0.ESC+"[6~";break;case 112:v.key=l?c.C0.ESC+"[1;"+(l+1)+"P":c.C0.ESC+"OP";break;case 113:v.key=l?c.C0.ESC+"[1;"+(l+1)+"Q":c.C0.ESC+"OQ";break;case 114:v.key=l?c.C0.ESC+"[1;"+(l+1)+"R":c.C0.ESC+"OR";break;case 115:v.key=l?c.C0.ESC+"[1;"+(l+1)+"S":c.C0.ESC+"OS";break;case 116:v.key=l?c.C0.ESC+"[15;"+(l+1)+"~":c.C0.ESC+"[15~";break;case 117:v.key=l?c.C0.ESC+"[17;"+(l+1)+"~":c.C0.ESC+"[17~";break;case 118:v.key=l?c.C0.ESC+"[18;"+(l+1)+"~":c.C0.ESC+"[18~";break;case 119:v.key=l?c.C0.ESC+"[19;"+(l+1)+"~":c.C0.ESC+"[19~";break;case 120:v.key=l?c.C0.ESC+"[20;"+(l+1)+"~":c.C0.ESC+"[20~";break;case 121:v.key=l?c.C0.ESC+"[21;"+(l+1)+"~":c.C0.ESC+"[21~";break;case 122:v.key=l?c.C0.ESC+"[23;"+(l+1)+"~":c.C0.ESC+"[23~";break;case 123:v.key=l?c.C0.ESC+"[24;"+(l+1)+"~":c.C0.ESC+"[24~";break;default:if(!d.ctrlKey||d.shiftKey||d.altKey||d.metaKey)if(S&&!b||!d.altKey||d.metaKey)!S||d.altKey||d.ctrlKey||d.shiftKey||!d.metaKey?d.key&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&d.keyCode>=48&&d.key.length===1?v.key=d.key:d.key&&d.ctrlKey&&(d.key==="_"&&(v.key=c.C0.US),d.key==="@"&&(v.key=c.C0.NUL)):d.keyCode===65&&(v.type=1);else{const f=_[d.keyCode],h=f==null?void 0:f[d.shiftKey?1:0];if(h)v.key=c.C0.ESC+h;else if(d.keyCode>=65&&d.keyCode<=90){const u=d.ctrlKey?d.keyCode-64:d.keyCode+32;let g=String.fromCharCode(u);d.shiftKey&&(g=g.toUpperCase()),v.key=c.C0.ESC+g}else if(d.keyCode===32)v.key=c.C0.ESC+(d.ctrlKey?c.C0.NUL:" ");else if(d.key==="Dead"&&d.code.startsWith("Key")){let u=d.code.slice(3,4);d.shiftKey||(u=u.toLowerCase()),v.key=c.C0.ESC+u,v.cancel=!0}}else d.keyCode>=65&&d.keyCode<=90?v.key=String.fromCharCode(d.keyCode-64):d.keyCode===32?v.key=c.C0.NUL:d.keyCode>=51&&d.keyCode<=55?v.key=String.fromCharCode(d.keyCode-51+27):d.keyCode===56?v.key=c.C0.DEL:d.keyCode===219?v.key=c.C0.ESC:d.keyCode===220?v.key=c.C0.FS:d.keyCode===221&&(v.key=c.C0.GS)}return v}},482:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},s.utf32ToString=function(a,c=0,_=a.length){let d="";for(let m=c;m<_;++m){let S=a[m];S>65535?(S-=65536,d+=String.fromCharCode(55296+(S>>10))+String.fromCharCode(S%1024+56320)):d+=String.fromCharCode(S)}return d},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,c){const _=a.length;if(!_)return 0;let d=0,m=0;if(this._interim){const S=a.charCodeAt(m++);56320<=S&&S<=57343?c[d++]=1024*(this._interim-55296)+S-56320+65536:(c[d++]=this._interim,c[d++]=S),this._interim=0}for(let S=m;S<_;++S){const b=a.charCodeAt(S);if(55296<=b&&b<=56319){if(++S>=_)return this._interim=b,d;const v=a.charCodeAt(S);56320<=v&&v<=57343?c[d++]=1024*(b-55296)+v-56320+65536:(c[d++]=b,c[d++]=v)}else b!==65279&&(c[d++]=b)}return d}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,c){const _=a.length;if(!_)return 0;let d,m,S,b,v=0,l=0,f=0;if(this.interim[0]){let g=!1,E=this.interim[0];E&=(224&E)==192?31:(240&E)==224?15:7;let x,R=0;for(;(x=63&this.interim[++R])&&R<4;)E<<=6,E|=x;const y=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,A=y-R;for(;f<A;){if(f>=_)return 0;if(x=a[f++],(192&x)!=128){f--,g=!0;break}this.interim[R++]=x,E<<=6,E|=63&x}g||(y===2?E<128?f--:c[v++]=E:y===3?E<2048||E>=55296&&E<=57343||E===65279||(c[v++]=E):E<65536||E>1114111||(c[v++]=E)),this.interim.fill(0)}const h=_-4;let u=f;for(;u<_;){for(;!(!(u<h)||128&(d=a[u])||128&(m=a[u+1])||128&(S=a[u+2])||128&(b=a[u+3]));)c[v++]=d,c[v++]=m,c[v++]=S,c[v++]=b,u+=4;if(d=a[u++],d<128)c[v++]=d;else if((224&d)==192){if(u>=_)return this.interim[0]=d,v;if(m=a[u++],(192&m)!=128){u--;continue}if(l=(31&d)<<6|63&m,l<128){u--;continue}c[v++]=l}else if((240&d)==224){if(u>=_)return this.interim[0]=d,v;if(m=a[u++],(192&m)!=128){u--;continue}if(u>=_)return this.interim[0]=d,this.interim[1]=m,v;if(S=a[u++],(192&S)!=128){u--;continue}if(l=(15&d)<<12|(63&m)<<6|63&S,l<2048||l>=55296&&l<=57343||l===65279)continue;c[v++]=l}else if((248&d)==240){if(u>=_)return this.interim[0]=d,v;if(m=a[u++],(192&m)!=128){u--;continue}if(u>=_)return this.interim[0]=d,this.interim[1]=m,v;if(S=a[u++],(192&S)!=128){u--;continue}if(u>=_)return this.interim[0]=d,this.interim[1]=m,this.interim[2]=S,v;if(b=a[u++],(192&b)!=128){u--;continue}if(l=(7&d)<<18|(63&m)<<12|(63&S)<<6|63&b,l<65536||l>1114111)continue;c[v++]=l}}return v}}},225:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const c=a(1480),_=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],d=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let m;s.UnicodeV6=class{constructor(){if(this.version="6",!m){m=new Uint8Array(65536),m.fill(1),m[0]=0,m.fill(0,1,32),m.fill(0,127,160),m.fill(2,4352,4448),m[9001]=2,m[9002]=2,m.fill(2,11904,42192),m[12351]=1,m.fill(2,44032,55204),m.fill(2,63744,64256),m.fill(2,65040,65050),m.fill(2,65072,65136),m.fill(2,65280,65377),m.fill(2,65504,65511);for(let S=0;S<_.length;++S)m.fill(0,_[S][0],_[S][1]+1)}}wcwidth(S){return S<32?0:S<127?1:S<65536?m[S]:function(b,v){let l,f=0,h=v.length-1;if(b<v[0][0]||b>v[h][1])return!1;for(;h>=f;)if(l=f+h>>1,b>v[l][1])f=l+1;else{if(!(b<v[l][0]))return!0;h=l-1}return!1}(S,d)?0:S>=131072&&S<=196605||S>=196608&&S<=262141?2:1}charProperties(S,b){let v=this.wcwidth(S),l=v===0&&b!==0;if(l){const f=c.UnicodeService.extractWidth(b);f===0?l=!1:f>v&&(v=f)}return c.UnicodeService.createPropertyValue(0,v,l)}}},5981:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const c=a(8460),_=a(844);class d extends _.Disposable{constructor(S){super(),this._action=S,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(S,b){if(b!==void 0&&this._syncCalls>b)return void(this._syncCalls=0);if(this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let v;for(this._isSyncWriting=!0;v=this._writeBuffer.shift();){this._action(v);const l=this._callbacks.shift();l&&l()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(S,b){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(b),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(b)}_innerWrite(S=0,b=!0){const v=S||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const l=this._writeBuffer[this._bufferOffset],f=this._action(l,b);if(f){const u=g=>Date.now()-v>=12?setTimeout(()=>this._innerWrite(0,g)):this._innerWrite(v,g);return void f.catch(g=>(queueMicrotask(()=>{throw g}),Promise.resolve(!1))).then(u)}const h=this._callbacks[this._bufferOffset];if(h&&h(),this._bufferOffset++,this._pendingData-=l.length,Date.now()-v>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=d},5941:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function _(d,m){const S=d.toString(16),b=S.length<2?"0"+S:S;switch(m){case 4:return S[0];case 8:return b;case 12:return(b+b).slice(0,3);default:return b+b}}s.parseColor=function(d){if(!d)return;let m=d.toLowerCase();if(m.indexOf("rgb:")===0){m=m.slice(4);const S=a.exec(m);if(S){const b=S[1]?15:S[4]?255:S[7]?4095:65535;return[Math.round(parseInt(S[1]||S[4]||S[7]||S[10],16)/b*255),Math.round(parseInt(S[2]||S[5]||S[8]||S[11],16)/b*255),Math.round(parseInt(S[3]||S[6]||S[9]||S[12],16)/b*255)]}}else if(m.indexOf("#")===0&&(m=m.slice(1),c.exec(m)&&[3,6,9,12].includes(m.length))){const S=m.length/3,b=[0,0,0];for(let v=0;v<3;++v){const l=parseInt(m.slice(S*v,S*v+S),16);b[v]=S===1?l<<4:S===2?l:S===3?l>>4:l>>8}return b}},s.toRgbString=function(d,m=16){const[S,b,v]=d;return`rgb:${_(S,m)}/${_(b,m)}/${_(v,m)}`}},5770:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const c=a(482),_=a(8742),d=a(5770),m=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=m,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=m}registerHandler(b,v){this._handlers[b]===void 0&&(this._handlers[b]=[]);const l=this._handlers[b];return l.push(v),{dispose:()=>{const f=l.indexOf(v);f!==-1&&l.splice(f,1)}}}clearHandler(b){this._handlers[b]&&delete this._handlers[b]}setHandlerFallback(b){this._handlerFb=b}reset(){if(this._active.length)for(let b=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;b>=0;--b)this._active[b].unhook(!1);this._stack.paused=!1,this._active=m,this._ident=0}hook(b,v){if(this.reset(),this._ident=b,this._active=this._handlers[b]||m,this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].hook(v);else this._handlerFb(this._ident,"HOOK",v)}put(b,v,l){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(b,v,l);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(b,v,l))}unhook(b,v=!0){if(this._active.length){let l=!1,f=this._active.length-1,h=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,l=v,h=this._stack.fallThrough,this._stack.paused=!1),!h&&l===!1){for(;f>=0&&(l=this._active[f].unhook(b),l!==!0);f--)if(l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,l;f--}for(;f>=0;f--)if(l=this._active[f].unhook(!1),l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,l}else this._handlerFb(this._ident,"UNHOOK",b);this._active=m,this._ident=0}};const S=new _.Params;S.addParam(0),s.DcsHandler=class{constructor(b){this._handler=b,this._data="",this._params=S,this._hitLimit=!1}hook(b){this._params=b.length>1||b.params[0]?b.clone():S,this._data="",this._hitLimit=!1}put(b,v,l){this._hitLimit||(this._data+=(0,c.utf32ToString)(b,v,l),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(b){let v=!1;if(this._hitLimit)v=!1;else if(b&&(v=this._handler(this._data,this._params),v instanceof Promise))return v.then(l=>(this._params=S,this._data="",this._hitLimit=!1,l));return this._params=S,this._data="",this._hitLimit=!1,v}}},2015:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const c=a(844),_=a(8742),d=a(6242),m=a(6351);class S{constructor(f){this.table=new Uint8Array(f)}setDefault(f,h){this.table.fill(f<<4|h)}add(f,h,u,g){this.table[h<<8|f]=u<<4|g}addMany(f,h,u,g){for(let E=0;E<f.length;E++)this.table[h<<8|f[E]]=u<<4|g}}s.TransitionTable=S;const b=160;s.VT500_TRANSITION_TABLE=function(){const l=new S(4095),f=Array.apply(null,Array(256)).map((R,y)=>y),h=(R,y)=>f.slice(R,y),u=h(32,127),g=h(0,24);g.push(25),g.push.apply(g,h(28,32));const E=h(0,14);let x;for(x in l.setDefault(1,0),l.addMany(u,0,2,0),E)l.addMany([24,26,153,154],x,3,0),l.addMany(h(128,144),x,3,0),l.addMany(h(144,152),x,3,0),l.add(156,x,0,0),l.add(27,x,11,1),l.add(157,x,4,8),l.addMany([152,158,159],x,0,7),l.add(155,x,11,3),l.add(144,x,11,9);return l.addMany(g,0,3,0),l.addMany(g,1,3,1),l.add(127,1,0,1),l.addMany(g,8,0,8),l.addMany(g,3,3,3),l.add(127,3,0,3),l.addMany(g,4,3,4),l.add(127,4,0,4),l.addMany(g,6,3,6),l.addMany(g,5,3,5),l.add(127,5,0,5),l.addMany(g,2,3,2),l.add(127,2,0,2),l.add(93,1,4,8),l.addMany(u,8,5,8),l.add(127,8,5,8),l.addMany([156,27,24,26,7],8,6,0),l.addMany(h(28,32),8,0,8),l.addMany([88,94,95],1,0,7),l.addMany(u,7,0,7),l.addMany(g,7,0,7),l.add(156,7,0,0),l.add(127,7,0,7),l.add(91,1,11,3),l.addMany(h(64,127),3,7,0),l.addMany(h(48,60),3,8,4),l.addMany([60,61,62,63],3,9,4),l.addMany(h(48,60),4,8,4),l.addMany(h(64,127),4,7,0),l.addMany([60,61,62,63],4,0,6),l.addMany(h(32,64),6,0,6),l.add(127,6,0,6),l.addMany(h(64,127),6,0,0),l.addMany(h(32,48),3,9,5),l.addMany(h(32,48),5,9,5),l.addMany(h(48,64),5,0,6),l.addMany(h(64,127),5,7,0),l.addMany(h(32,48),4,9,5),l.addMany(h(32,48),1,9,2),l.addMany(h(32,48),2,9,2),l.addMany(h(48,127),2,10,0),l.addMany(h(48,80),1,10,0),l.addMany(h(81,88),1,10,0),l.addMany([89,90,92],1,10,0),l.addMany(h(96,127),1,10,0),l.add(80,1,11,9),l.addMany(g,9,0,9),l.add(127,9,0,9),l.addMany(h(28,32),9,0,9),l.addMany(h(32,48),9,9,12),l.addMany(h(48,60),9,8,10),l.addMany([60,61,62,63],9,9,10),l.addMany(g,11,0,11),l.addMany(h(32,128),11,0,11),l.addMany(h(28,32),11,0,11),l.addMany(g,10,0,10),l.add(127,10,0,10),l.addMany(h(28,32),10,0,10),l.addMany(h(48,60),10,8,10),l.addMany([60,61,62,63],10,0,11),l.addMany(h(32,48),10,9,12),l.addMany(g,12,0,12),l.add(127,12,0,12),l.addMany(h(28,32),12,0,12),l.addMany(h(32,48),12,9,12),l.addMany(h(48,64),12,0,11),l.addMany(h(64,127),12,12,13),l.addMany(h(64,127),10,12,13),l.addMany(h(64,127),9,12,13),l.addMany(g,13,13,13),l.addMany(u,13,13,13),l.add(127,13,0,13),l.addMany([27,156,24,26],13,14,0),l.add(b,0,2,0),l.add(b,8,5,8),l.add(b,6,0,6),l.add(b,11,0,11),l.add(b,13,13,13),l}();class v extends c.Disposable{constructor(f=s.VT500_TRANSITION_TABLE){super(),this._transitions=f,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new _.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(h,u,g)=>{},this._executeHandlerFb=h=>{},this._csiHandlerFb=(h,u)=>{},this._escHandlerFb=h=>{},this._errorHandlerFb=h=>h,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new d.OscParser),this._dcsParser=this.register(new m.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(f,h=[64,126]){let u=0;if(f.prefix){if(f.prefix.length>1)throw new Error("only one byte as prefix supported");if(u=f.prefix.charCodeAt(0),u&&60>u||u>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(f.intermediates){if(f.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let E=0;E<f.intermediates.length;++E){const x=f.intermediates.charCodeAt(E);if(32>x||x>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");u<<=8,u|=x}}if(f.final.length!==1)throw new Error("final must be a single byte");const g=f.final.charCodeAt(0);if(h[0]>g||g>h[1])throw new Error(`final must be in range ${h[0]} .. ${h[1]}`);return u<<=8,u|=g,u}identToString(f){const h=[];for(;f;)h.push(String.fromCharCode(255&f)),f>>=8;return h.reverse().join("")}setPrintHandler(f){this._printHandler=f}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(f,h){const u=this._identifier(f,[48,126]);this._escHandlers[u]===void 0&&(this._escHandlers[u]=[]);const g=this._escHandlers[u];return g.push(h),{dispose:()=>{const E=g.indexOf(h);E!==-1&&g.splice(E,1)}}}clearEscHandler(f){this._escHandlers[this._identifier(f,[48,126])]&&delete this._escHandlers[this._identifier(f,[48,126])]}setEscHandlerFallback(f){this._escHandlerFb=f}setExecuteHandler(f,h){this._executeHandlers[f.charCodeAt(0)]=h}clearExecuteHandler(f){this._executeHandlers[f.charCodeAt(0)]&&delete this._executeHandlers[f.charCodeAt(0)]}setExecuteHandlerFallback(f){this._executeHandlerFb=f}registerCsiHandler(f,h){const u=this._identifier(f);this._csiHandlers[u]===void 0&&(this._csiHandlers[u]=[]);const g=this._csiHandlers[u];return g.push(h),{dispose:()=>{const E=g.indexOf(h);E!==-1&&g.splice(E,1)}}}clearCsiHandler(f){this._csiHandlers[this._identifier(f)]&&delete this._csiHandlers[this._identifier(f)]}setCsiHandlerFallback(f){this._csiHandlerFb=f}registerDcsHandler(f,h){return this._dcsParser.registerHandler(this._identifier(f),h)}clearDcsHandler(f){this._dcsParser.clearHandler(this._identifier(f))}setDcsHandlerFallback(f){this._dcsParser.setHandlerFallback(f)}registerOscHandler(f,h){return this._oscParser.registerHandler(f,h)}clearOscHandler(f){this._oscParser.clearHandler(f)}setOscHandlerFallback(f){this._oscParser.setHandlerFallback(f)}setErrorHandler(f){this._errorHandler=f}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(f,h,u,g,E){this._parseStack.state=f,this._parseStack.handlers=h,this._parseStack.handlerPos=u,this._parseStack.transition=g,this._parseStack.chunkPos=E}parse(f,h,u){let g,E=0,x=0,R=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,R=this._parseStack.chunkPos+1;else{if(u===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const y=this._parseStack.handlers;let A=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(u===!1&&A>-1){for(;A>=0&&(g=y[A](this._params),g!==!0);A--)if(g instanceof Promise)return this._parseStack.handlerPos=A,g}this._parseStack.handlers=[];break;case 4:if(u===!1&&A>-1){for(;A>=0&&(g=y[A](),g!==!0);A--)if(g instanceof Promise)return this._parseStack.handlerPos=A,g}this._parseStack.handlers=[];break;case 6:if(E=f[this._parseStack.chunkPos],g=this._dcsParser.unhook(E!==24&&E!==26,u),g)return g;E===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(E=f[this._parseStack.chunkPos],g=this._oscParser.end(E!==24&&E!==26,u),g)return g;E===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,R=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let y=R;y<h;++y){switch(E=f[y],x=this._transitions.table[this.currentState<<8|(E<160?E:b)],x>>4){case 2:for(let B=y+1;;++B){if(B>=h||(E=f[B])<32||E>126&&E<b){this._printHandler(f,y,B),y=B-1;break}if(++B>=h||(E=f[B])<32||E>126&&E<b){this._printHandler(f,y,B),y=B-1;break}if(++B>=h||(E=f[B])<32||E>126&&E<b){this._printHandler(f,y,B),y=B-1;break}if(++B>=h||(E=f[B])<32||E>126&&E<b){this._printHandler(f,y,B),y=B-1;break}}break;case 3:this._executeHandlers[E]?this._executeHandlers[E]():this._executeHandlerFb(E),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:y,code:E,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const A=this._csiHandlers[this._collect<<8|E];let O=A?A.length-1:-1;for(;O>=0&&(g=A[O](this._params),g!==!0);O--)if(g instanceof Promise)return this._preserveStack(3,A,O,x,y),g;O<0&&this._csiHandlerFb(this._collect<<8|E,this._params),this.precedingJoinState=0;break;case 8:do switch(E){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(E-48)}while(++y<h&&(E=f[y])>47&&E<60);y--;break;case 9:this._collect<<=8,this._collect|=E;break;case 10:const U=this._escHandlers[this._collect<<8|E];let H=U?U.length-1:-1;for(;H>=0&&(g=U[H](),g!==!0);H--)if(g instanceof Promise)return this._preserveStack(4,U,H,x,y),g;H<0&&this._escHandlerFb(this._collect<<8|E),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|E,this._params);break;case 13:for(let B=y+1;;++B)if(B>=h||(E=f[B])===24||E===26||E===27||E>127&&E<b){this._dcsParser.put(f,y,B),y=B-1;break}break;case 14:if(g=this._dcsParser.unhook(E!==24&&E!==26),g)return this._preserveStack(6,[],0,x,y),g;E===27&&(x|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let B=y+1;;B++)if(B>=h||(E=f[B])<32||E>127&&E<b){this._oscParser.put(f,y,B),y=B-1;break}break;case 6:if(g=this._oscParser.end(E!==24&&E!==26),g)return this._preserveStack(5,[],0,x,y),g;E===27&&(x|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&x}}}s.EscapeSequenceParser=v},6242:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const c=a(5770),_=a(482),d=[];s.OscParser=class{constructor(){this._state=0,this._active=d,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(m,S){this._handlers[m]===void 0&&(this._handlers[m]=[]);const b=this._handlers[m];return b.push(S),{dispose:()=>{const v=b.indexOf(S);v!==-1&&b.splice(v,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}reset(){if(this._state===2)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].end(!1);this._stack.paused=!1,this._active=d,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||d,this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].start();else this._handlerFb(this._id,"START")}_put(m,S,b){if(this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].put(m,S,b);else this._handlerFb(this._id,"PUT",(0,_.utf32ToString)(m,S,b))}start(){this.reset(),this._state=1}put(m,S,b){if(this._state!==3){if(this._state===1)for(;S<b;){const v=m[S++];if(v===59){this._state=2,this._start();break}if(v<48||57<v)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+v-48}this._state===2&&b-S>0&&this._put(m,S,b)}}end(m,S=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let b=!1,v=this._active.length-1,l=!1;if(this._stack.paused&&(v=this._stack.loopPosition-1,b=S,l=this._stack.fallThrough,this._stack.paused=!1),!l&&b===!1){for(;v>=0&&(b=this._active[v].end(m),b!==!0);v--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=v,this._stack.fallThrough=!1,b;v--}for(;v>=0;v--)if(b=this._active[v].end(!1),b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=v,this._stack.fallThrough=!0,b}else this._handlerFb(this._id,"END",m);this._active=d,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(m){this._handler=m,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(m,S,b){this._hitLimit||(this._data+=(0,_.utf32ToString)(m,S,b),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(m){let S=!1;if(this._hitLimit)S=!1;else if(m&&(S=this._handler(this._data),S instanceof Promise))return S.then(b=>(this._data="",this._hitLimit=!1,b));return this._data="",this._hitLimit=!1,S}}},8742:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const a=2147483647;class c{static fromArray(d){const m=new c;if(!d.length)return m;for(let S=Array.isArray(d[0])?1:0;S<d.length;++S){const b=d[S];if(Array.isArray(b))for(let v=0;v<b.length;++v)m.addSubParam(b[v]);else m.addParam(b)}return m}constructor(d=32,m=32){if(this.maxLength=d,this.maxSubParamsLength=m,m>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(d),this.length=0,this._subParams=new Int32Array(m),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(d),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const d=new c(this.maxLength,this.maxSubParamsLength);return d.params.set(this.params),d.length=this.length,d._subParams.set(this._subParams),d._subParamsLength=this._subParamsLength,d._subParamsIdx.set(this._subParamsIdx),d._rejectDigits=this._rejectDigits,d._rejectSubDigits=this._rejectSubDigits,d._digitIsSub=this._digitIsSub,d}toArray(){const d=[];for(let m=0;m<this.length;++m){d.push(this.params[m]);const S=this._subParamsIdx[m]>>8,b=255&this._subParamsIdx[m];b-S>0&&d.push(Array.prototype.slice.call(this._subParams,S,b))}return d}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(d){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=d>a?a:d}}addSubParam(d){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=d>a?a:d,this._subParamsIdx[this.length-1]++}}hasSubParams(d){return(255&this._subParamsIdx[d])-(this._subParamsIdx[d]>>8)>0}getSubParams(d){const m=this._subParamsIdx[d]>>8,S=255&this._subParamsIdx[d];return S-m>0?this._subParams.subarray(m,S):null}getSubParamsAll(){const d={};for(let m=0;m<this.length;++m){const S=this._subParamsIdx[m]>>8,b=255&this._subParamsIdx[m];b-S>0&&(d[m]=this._subParams.slice(S,b))}return d}addDigit(d){let m;if(this._rejectDigits||!(m=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const S=this._digitIsSub?this._subParams:this.params,b=S[m-1];S[m-1]=~b?Math.min(10*b+d,a):d}}s.Params=c},5741:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,c){const _={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(_),c.dispose=()=>this._wrappedAddonDispose(_),c.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let c=-1;for(let _=0;_<this._addons.length;_++)if(this._addons[_]===a){c=_;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(c,1)}}},8771:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const c=a(3785),_=a(511);s.BufferApiView=class{constructor(d,m){this._buffer=d,this.type=m}init(d){return this._buffer=d,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(d){const m=this._buffer.lines.get(d);if(m)return new c.BufferLineApiView(m)}getNullCell(){return new _.CellData}}},3785:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const c=a(511);s.BufferLineApiView=class{constructor(_){this._line=_}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(_,d){if(!(_<0||_>=this._line.length))return d?(this._line.loadCell(_,d),d):this._line.loadCell(_,new c.CellData)}translateToString(_,d,m){return this._line.translateToString(_,d,m)}}},8285:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const c=a(8771),_=a(8460),d=a(844);class m extends d.Disposable{constructor(b){super(),this._core=b,this._onBufferChange=this.register(new _.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}s.BufferNamespaceApi=m},7975:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,c){return this._core.registerCsiHandler(a,_=>c(_.toArray()))}addCsiHandler(a,c){return this.registerCsiHandler(a,c)}registerDcsHandler(a,c){return this._core.registerDcsHandler(a,(_,d)=>c(_,d.toArray()))}addDcsHandler(a,c){return this.registerDcsHandler(a,c)}registerEscHandler(a,c){return this._core.registerEscHandler(a,c)}addEscHandler(a,c){return this.registerEscHandler(a,c)}registerOscHandler(a,c){return this._core.registerOscHandler(a,c)}addOscHandler(a,c){return this.registerOscHandler(a,c)}}},7090:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(p,s,a){var c=this&&this.__decorate||function(l,f,h,u){var g,E=arguments.length,x=E<3?f:u===null?u=Object.getOwnPropertyDescriptor(f,h):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(l,f,h,u);else for(var R=l.length-1;R>=0;R--)(g=l[R])&&(x=(E<3?g(x):E>3?g(f,h,x):g(f,h))||x);return E>3&&x&&Object.defineProperty(f,h,x),x},_=this&&this.__param||function(l,f){return function(h,u){f(h,u,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const d=a(8460),m=a(844),S=a(5295),b=a(2585);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let v=s.BufferService=class extends m.Disposable{get buffer(){return this.buffers.active}constructor(l){super(),this.isUserScrolling=!1,this._onResize=this.register(new d.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(l.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(l.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new S.BufferSet(l,this))}resize(l,f){this.cols=l,this.rows=f,this.buffers.resize(l,f),this._onResize.fire({cols:l,rows:f})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(l,f=!1){const h=this.buffer;let u;u=this._cachedBlankLine,u&&u.length===this.cols&&u.getFg(0)===l.fg&&u.getBg(0)===l.bg||(u=h.getBlankLine(l,f),this._cachedBlankLine=u),u.isWrapped=f;const g=h.ybase+h.scrollTop,E=h.ybase+h.scrollBottom;if(h.scrollTop===0){const x=h.lines.isFull;E===h.lines.length-1?x?h.lines.recycle().copyFrom(u):h.lines.push(u.clone()):h.lines.splice(E+1,0,u.clone()),x?this.isUserScrolling&&(h.ydisp=Math.max(h.ydisp-1,0)):(h.ybase++,this.isUserScrolling||h.ydisp++)}else{const x=E-g+1;h.lines.shiftElements(g+1,x-1,-1),h.lines.set(E,u.clone())}this.isUserScrolling||(h.ydisp=h.ybase),this._onScroll.fire(h.ydisp)}scrollLines(l,f,h){const u=this.buffer;if(l<0){if(u.ydisp===0)return;this.isUserScrolling=!0}else l+u.ydisp>=u.ybase&&(this.isUserScrolling=!1);const g=u.ydisp;u.ydisp=Math.max(Math.min(u.ydisp+l,u.ybase),0),g!==u.ydisp&&(f||this._onScroll.fire(u.ydisp))}};s.BufferService=v=c([_(0,b.IOptionsService)],v)},7994:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,c){this._charsets[a]=c,this.glevel===a&&(this.charset=c)}}},1753:function(p,s,a){var c=this&&this.__decorate||function(u,g,E,x){var R,y=arguments.length,A=y<3?g:x===null?x=Object.getOwnPropertyDescriptor(g,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(u,g,E,x);else for(var O=u.length-1;O>=0;O--)(R=u[O])&&(A=(y<3?R(A):y>3?R(g,E,A):R(g,E))||A);return y>3&&A&&Object.defineProperty(g,E,A),A},_=this&&this.__param||function(u,g){return function(E,x){g(E,x,u)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const d=a(2585),m=a(8460),S=a(844),b={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:u=>u.button!==4&&u.action===1&&(u.ctrl=!1,u.alt=!1,u.shift=!1,!0)},VT200:{events:19,restrict:u=>u.action!==32},DRAG:{events:23,restrict:u=>u.action!==32||u.button!==3},ANY:{events:31,restrict:u=>!0}};function v(u,g){let E=(u.ctrl?16:0)|(u.shift?4:0)|(u.alt?8:0);return u.button===4?(E|=64,E|=u.action):(E|=3&u.button,4&u.button&&(E|=64),8&u.button&&(E|=128),u.action===32?E|=32:u.action!==0||g||(E|=3)),E}const l=String.fromCharCode,f={DEFAULT:u=>{const g=[v(u,!1)+32,u.col+32,u.row+32];return g[0]>255||g[1]>255||g[2]>255?"":`\x1B[M${l(g[0])}${l(g[1])}${l(g[2])}`},SGR:u=>{const g=u.action===0&&u.button!==4?"m":"M";return`\x1B[<${v(u,!0)};${u.col};${u.row}${g}`},SGR_PIXELS:u=>{const g=u.action===0&&u.button!==4?"m":"M";return`\x1B[<${v(u,!0)};${u.x};${u.y}${g}`}};let h=s.CoreMouseService=class extends S.Disposable{constructor(u,g){super(),this._bufferService=u,this._coreService=g,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new m.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const E of Object.keys(b))this.addProtocol(E,b[E]);for(const E of Object.keys(f))this.addEncoding(E,f[E]);this.reset()}addProtocol(u,g){this._protocols[u]=g}addEncoding(u,g){this._encodings[u]=g}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(u){if(!this._protocols[u])throw new Error(`unknown protocol "${u}"`);this._activeProtocol=u,this._onProtocolChange.fire(this._protocols[u].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(u){if(!this._encodings[u])throw new Error(`unknown encoding "${u}"`);this._activeEncoding=u}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(u){if(u.col<0||u.col>=this._bufferService.cols||u.row<0||u.row>=this._bufferService.rows||u.button===4&&u.action===32||u.button===3&&u.action!==32||u.button!==4&&(u.action===2||u.action===3)||(u.col++,u.row++,u.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,u,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(u))return!1;const g=this._encodings[this._activeEncoding](u);return g&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(g):this._coreService.triggerDataEvent(g,!0)),this._lastEvent=u,!0}explainEvents(u){return{down:!!(1&u),up:!!(2&u),drag:!!(4&u),move:!!(8&u),wheel:!!(16&u)}}_equalEvents(u,g,E){if(E){if(u.x!==g.x||u.y!==g.y)return!1}else if(u.col!==g.col||u.row!==g.row)return!1;return u.button===g.button&&u.action===g.action&&u.ctrl===g.ctrl&&u.alt===g.alt&&u.shift===g.shift}};s.CoreMouseService=h=c([_(0,d.IBufferService),_(1,d.ICoreService)],h)},6975:function(p,s,a){var c=this&&this.__decorate||function(h,u,g,E){var x,R=arguments.length,y=R<3?u:E===null?E=Object.getOwnPropertyDescriptor(u,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(h,u,g,E);else for(var A=h.length-1;A>=0;A--)(x=h[A])&&(y=(R<3?x(y):R>3?x(u,g,y):x(u,g))||y);return R>3&&y&&Object.defineProperty(u,g,y),y},_=this&&this.__param||function(h,u){return function(g,E){u(g,E,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const d=a(1439),m=a(8460),S=a(844),b=a(2585),v=Object.freeze({insertMode:!1}),l=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let f=s.CoreService=class extends S.Disposable{constructor(h,u,g){super(),this._bufferService=h,this._logService=u,this._optionsService=g,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new m.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new m.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new m.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new m.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,d.clone)(v),this.decPrivateModes=(0,d.clone)(l)}reset(){this.modes=(0,d.clone)(v),this.decPrivateModes=(0,d.clone)(l)}triggerDataEvent(h,u=!1){if(this._optionsService.rawOptions.disableStdin)return;const g=this._bufferService.buffer;u&&this._optionsService.rawOptions.scrollOnUserInput&&g.ybase!==g.ydisp&&this._onRequestScrollToBottom.fire(),u&&this._onUserInput.fire(),this._logService.debug(`sending data "${h}"`,()=>h.split("").map(E=>E.charCodeAt(0))),this._onData.fire(h)}triggerBinaryEvent(h){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${h}"`,()=>h.split("").map(u=>u.charCodeAt(0))),this._onBinary.fire(h))}};s.CoreService=f=c([_(0,b.IBufferService),_(1,b.ILogService),_(2,b.IOptionsService)],f)},9074:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const c=a(8055),_=a(8460),d=a(844),m=a(6106);let S=0,b=0;class v extends d.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new m.SortedList(h=>h==null?void 0:h.marker.line),this._onDecorationRegistered=this.register(new _.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new _.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,d.toDisposable)(()=>this.reset()))}registerDecoration(h){if(h.marker.isDisposed)return;const u=new l(h);if(u){const g=u.marker.onDispose(()=>u.dispose());u.onDispose(()=>{u&&(this._decorations.delete(u)&&this._onDecorationRemoved.fire(u),g.dispose())}),this._decorations.insert(u),this._onDecorationRegistered.fire(u)}return u}reset(){for(const h of this._decorations.values())h.dispose();this._decorations.clear()}*getDecorationsAtCell(h,u,g){let E=0,x=0;for(const R of this._decorations.getKeyIterator(u))E=R.options.x??0,x=E+(R.options.width??1),h>=E&&h<x&&(!g||(R.options.layer??"bottom")===g)&&(yield R)}forEachDecorationAtCell(h,u,g,E){this._decorations.forEachByKey(u,x=>{S=x.options.x??0,b=S+(x.options.width??1),h>=S&&h<b&&(!g||(x.options.layer??"bottom")===g)&&E(x)})}}s.DecorationService=v;class l extends d.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(h){super(),this.options=h,this.onRenderEmitter=this.register(new _.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=h.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const c=a(2585),_=a(8343);class d{constructor(...S){this._entries=new Map;for(const[b,v]of S)this.set(b,v)}set(S,b){const v=this._entries.get(S);return this._entries.set(S,b),v}forEach(S){for(const[b,v]of this._entries.entries())S(b,v)}has(S){return this._entries.has(S)}get(S){return this._entries.get(S)}}s.ServiceCollection=d,s.InstantiationService=class{constructor(){this._services=new d,this._services.set(c.IInstantiationService,this)}setService(m,S){this._services.set(m,S)}getService(m){return this._services.get(m)}createInstance(m,...S){const b=(0,_.getServiceDependencies)(m).sort((f,h)=>f.index-h.index),v=[];for(const f of b){const h=this._services.get(f.id);if(!h)throw new Error(`[createInstance] ${m.name} depends on UNKNOWN service ${f.id}.`);v.push(h)}const l=b.length>0?b[0].index:S.length;if(S.length!==l)throw new Error(`[createInstance] First service dependency of ${m.name} at position ${l+1} conflicts with ${S.length} static arguments`);return new m(...S,...v)}}},7866:function(p,s,a){var c=this&&this.__decorate||function(l,f,h,u){var g,E=arguments.length,x=E<3?f:u===null?u=Object.getOwnPropertyDescriptor(f,h):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(l,f,h,u);else for(var R=l.length-1;R>=0;R--)(g=l[R])&&(x=(E<3?g(x):E>3?g(f,h,x):g(f,h))||x);return E>3&&x&&Object.defineProperty(f,h,x),x},_=this&&this.__param||function(l,f){return function(h,u){f(h,u,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.traceCall=s.setTraceLogger=s.LogService=void 0;const d=a(844),m=a(2585),S={trace:m.LogLevelEnum.TRACE,debug:m.LogLevelEnum.DEBUG,info:m.LogLevelEnum.INFO,warn:m.LogLevelEnum.WARN,error:m.LogLevelEnum.ERROR,off:m.LogLevelEnum.OFF};let b,v=s.LogService=class extends d.Disposable{get logLevel(){return this._logLevel}constructor(l){super(),this._optionsService=l,this._logLevel=m.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),b=this}_updateLogLevel(){this._logLevel=S[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(l){for(let f=0;f<l.length;f++)typeof l[f]=="function"&&(l[f]=l[f]())}_log(l,f,h){this._evalLazyOptionalParams(h),l.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+f,...h)}trace(l,...f){var h;this._logLevel<=m.LogLevelEnum.TRACE&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.trace.bind(this._optionsService.options.logger))??console.log,l,f)}debug(l,...f){var h;this._logLevel<=m.LogLevelEnum.DEBUG&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.debug.bind(this._optionsService.options.logger))??console.log,l,f)}info(l,...f){var h;this._logLevel<=m.LogLevelEnum.INFO&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.info.bind(this._optionsService.options.logger))??console.info,l,f)}warn(l,...f){var h;this._logLevel<=m.LogLevelEnum.WARN&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.warn.bind(this._optionsService.options.logger))??console.warn,l,f)}error(l,...f){var h;this._logLevel<=m.LogLevelEnum.ERROR&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.error.bind(this._optionsService.options.logger))??console.error,l,f)}};s.LogService=v=c([_(0,m.IOptionsService)],v),s.setTraceLogger=function(l){b=l},s.traceCall=function(l,f,h){if(typeof h.value!="function")throw new Error("not supported");const u=h.value;h.value=function(...g){if(b.logLevel!==m.LogLevelEnum.TRACE)return u.apply(this,g);b.trace(`GlyphRenderer#${u.name}(${g.map(x=>JSON.stringify(x)).join(", ")})`);const E=u.apply(this,g);return b.trace(`GlyphRenderer#${u.name} return`,E),E}}},7302:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const c=a(8460),_=a(844),d=a(6114);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:d.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const m=["normal","bold","100","200","300","400","500","600","700","800","900"];class S extends _.Disposable{constructor(v){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const l={...s.DEFAULT_OPTIONS};for(const f in v)if(f in l)try{const h=v[f];l[f]=this._sanitizeAndValidateOption(f,h)}catch(h){console.error(h)}this.rawOptions=l,this.options={...l},this._setupOptions(),this.register((0,_.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(v,l){return this.onOptionChange(f=>{f===v&&l(this.rawOptions[v])})}onMultipleOptionChange(v,l){return this.onOptionChange(f=>{v.indexOf(f)!==-1&&l()})}_setupOptions(){const v=f=>{if(!(f in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);return this.rawOptions[f]},l=(f,h)=>{if(!(f in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);h=this._sanitizeAndValidateOption(f,h),this.rawOptions[f]!==h&&(this.rawOptions[f]=h,this._onOptionChange.fire(f))};for(const f in this.rawOptions){const h={get:v.bind(this,f),set:l.bind(this,f)};Object.defineProperty(this.options,f,h)}}_sanitizeAndValidateOption(v,l){switch(v){case"cursorStyle":if(l||(l=s.DEFAULT_OPTIONS[v]),!function(f){return f==="block"||f==="underline"||f==="bar"}(l))throw new Error(`"${l}" is not a valid value for ${v}`);break;case"wordSeparator":l||(l=s.DEFAULT_OPTIONS[v]);break;case"fontWeight":case"fontWeightBold":if(typeof l=="number"&&1<=l&&l<=1e3)break;l=m.includes(l)?l:s.DEFAULT_OPTIONS[v];break;case"cursorWidth":l=Math.floor(l);case"lineHeight":case"tabStopWidth":if(l<1)throw new Error(`${v} cannot be less than 1, value: ${l}`);break;case"minimumContrastRatio":l=Math.max(1,Math.min(21,Math.round(10*l)/10));break;case"scrollback":if((l=Math.min(l,4294967295))<0)throw new Error(`${v} cannot be less than 0, value: ${l}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(l<=0)throw new Error(`${v} cannot be less than or equal to 0, value: ${l}`);break;case"rows":case"cols":if(!l&&l!==0)throw new Error(`${v} must be numeric, value: ${l}`);break;case"windowsPty":l=l??{}}return l}}s.OptionsService=S},2660:function(p,s,a){var c=this&&this.__decorate||function(S,b,v,l){var f,h=arguments.length,u=h<3?b:l===null?l=Object.getOwnPropertyDescriptor(b,v):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(S,b,v,l);else for(var g=S.length-1;g>=0;g--)(f=S[g])&&(u=(h<3?f(u):h>3?f(b,v,u):f(b,v))||u);return h>3&&u&&Object.defineProperty(b,v,u),u},_=this&&this.__param||function(S,b){return function(v,l){b(v,l,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const d=a(2585);let m=s.OscLinkService=class{constructor(S){this._bufferService=S,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(S){const b=this._bufferService.buffer;if(S.id===void 0){const g=b.addMarker(b.ybase+b.y),E={data:S,id:this._nextId++,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(E,g)),this._dataByLinkId.set(E.id,E),E.id}const v=S,l=this._getEntryIdKey(v),f=this._entriesWithId.get(l);if(f)return this.addLineToLink(f.id,b.ybase+b.y),f.id;const h=b.addMarker(b.ybase+b.y),u={id:this._nextId++,key:this._getEntryIdKey(v),data:v,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(u,h)),this._entriesWithId.set(u.key,u),this._dataByLinkId.set(u.id,u),u.id}addLineToLink(S,b){const v=this._dataByLinkId.get(S);if(v&&v.lines.every(l=>l.line!==b)){const l=this._bufferService.buffer.addMarker(b);v.lines.push(l),l.onDispose(()=>this._removeMarkerFromLink(v,l))}}getLinkData(S){var b;return(b=this._dataByLinkId.get(S))==null?void 0:b.data}_getEntryIdKey(S){return`${S.id};;${S.uri}`}_removeMarkerFromLink(S,b){const v=S.lines.indexOf(b);v!==-1&&(S.lines.splice(v,1),S.lines.length===0&&(S.data.id!==void 0&&this._entriesWithId.delete(S.key),this._dataByLinkId.delete(S.id)))}};s.OscLinkService=m=c([_(0,d.IBufferService)],m)},8343:(p,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0;const a="di$target",c="di$dependencies";s.serviceRegistry=new Map,s.getServiceDependencies=function(_){return _[c]||[]},s.createDecorator=function(_){if(s.serviceRegistry.has(_))return s.serviceRegistry.get(_);const d=function(m,S,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(v,l,f){l[a]===l?l[c].push({id:v,index:f}):(l[c]=[{id:v,index:f}],l[a]=l)})(d,m,b)};return d.toString=()=>_,s.serviceRegistry.set(_,d),d}},2585:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const c=a(8343);var _;s.IBufferService=(0,c.createDecorator)("BufferService"),s.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),s.ICoreService=(0,c.createDecorator)("CoreService"),s.ICharsetService=(0,c.createDecorator)("CharsetService"),s.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(d){d[d.TRACE=0]="TRACE",d[d.DEBUG=1]="DEBUG",d[d.INFO=2]="INFO",d[d.WARN=3]="WARN",d[d.ERROR=4]="ERROR",d[d.OFF=5]="OFF"}(_||(s.LogLevelEnum=_={})),s.ILogService=(0,c.createDecorator)("LogService"),s.IOptionsService=(0,c.createDecorator)("OptionsService"),s.IOscLinkService=(0,c.createDecorator)("OscLinkService"),s.IUnicodeService=(0,c.createDecorator)("UnicodeService"),s.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(p,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const c=a(8460),_=a(225);class d{static extractShouldJoin(S){return(1&S)!=0}static extractWidth(S){return S>>1&3}static extractCharKind(S){return S>>3}static createPropertyValue(S,b,v=!1){return(16777215&S)<<3|(3&b)<<1|(v?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const S=new _.UnicodeV6;this.register(S),this._active=S.version,this._activeProvider=S}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(S){if(!this._providers[S])throw new Error(`unknown Unicode version "${S}"`);this._active=S,this._activeProvider=this._providers[S],this._onChange.fire(S)}register(S){this._providers[S.version]=S}wcwidth(S){return this._activeProvider.wcwidth(S)}getStringCellWidth(S){let b=0,v=0;const l=S.length;for(let f=0;f<l;++f){let h=S.charCodeAt(f);if(55296<=h&&h<=56319){if(++f>=l)return b+this.wcwidth(h);const E=S.charCodeAt(f);56320<=E&&E<=57343?h=1024*(h-55296)+E-56320+65536:b+=this.wcwidth(E)}const u=this.charProperties(h,v);let g=d.extractWidth(u);d.extractShouldJoin(u)&&(g-=d.extractWidth(v)),b+=g,v=u}return b}charProperties(S,b){return this._activeProvider.charProperties(S,b)}}s.UnicodeService=d}},i={};function n(p){var s=i[p];if(s!==void 0)return s.exports;var a=i[p]={exports:{}};return r[p].call(a.exports,a,a.exports,n),a.exports}var o={};return(()=>{var p=o;Object.defineProperty(p,"__esModule",{value:!0}),p.Terminal=void 0;const s=n(9042),a=n(3236),c=n(844),_=n(5741),d=n(8285),m=n(7975),S=n(7090),b=["cols","rows"];class v extends c.Disposable{constructor(f){super(),this._core=this.register(new a.Terminal(f)),this._addonManager=this.register(new _.AddonManager),this._publicOptions={...this._core.options};const h=g=>this._core.options[g],u=(g,E)=>{this._checkReadonlyOptions(g),this._core.options[g]=E};for(const g in this._core.options){const E={get:h.bind(this,g),set:u.bind(this,g)};Object.defineProperty(this._publicOptions,g,E)}}_checkReadonlyOptions(f){if(b.includes(f))throw new Error(`Option "${f}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new m.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new S.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new d.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const f=this._core.coreService.decPrivateModes;let h="none";switch(this._core.coreMouseService.activeProtocol){case"X10":h="x10";break;case"VT200":h="vt200";break;case"DRAG":h="drag";break;case"ANY":h="any"}return{applicationCursorKeysMode:f.applicationCursorKeys,applicationKeypadMode:f.applicationKeypad,bracketedPasteMode:f.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:h,originMode:f.origin,reverseWraparoundMode:f.reverseWraparound,sendFocusMode:f.sendFocus,wraparoundMode:f.wraparound}}get options(){return this._publicOptions}set options(f){for(const h in f)this._publicOptions[h]=f[h]}blur(){this._core.blur()}focus(){this._core.focus()}input(f,h=!0){this._core.input(f,h)}resize(f,h){this._verifyIntegers(f,h),this._core.resize(f,h)}open(f){this._core.open(f)}attachCustomKeyEventHandler(f){this._core.attachCustomKeyEventHandler(f)}attachCustomWheelEventHandler(f){this._core.attachCustomWheelEventHandler(f)}registerLinkProvider(f){return this._core.registerLinkProvider(f)}registerCharacterJoiner(f){return this._checkProposedApi(),this._core.registerCharacterJoiner(f)}deregisterCharacterJoiner(f){this._checkProposedApi(),this._core.deregisterCharacterJoiner(f)}registerMarker(f=0){return this._verifyIntegers(f),this._core.registerMarker(f)}registerDecoration(f){return this._checkProposedApi(),this._verifyPositiveIntegers(f.x??0,f.width??0,f.height??0),this._core.registerDecoration(f)}hasSelection(){return this._core.hasSelection()}select(f,h,u){this._verifyIntegers(f,h,u),this._core.select(f,h,u)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(f,h){this._verifyIntegers(f,h),this._core.selectLines(f,h)}dispose(){super.dispose()}scrollLines(f){this._verifyIntegers(f),this._core.scrollLines(f)}scrollPages(f){this._verifyIntegers(f),this._core.scrollPages(f)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(f){this._verifyIntegers(f),this._core.scrollToLine(f)}clear(){this._core.clear()}write(f,h){this._core.write(f,h)}writeln(f,h){this._core.write(f),this._core.write(`\r
`,h)}paste(f){this._core.paste(f)}refresh(f,h){this._verifyIntegers(f,h),this._core.refresh(f,h)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(f){this._addonManager.loadAddon(this,f)}static get strings(){return s}_verifyIntegers(...f){for(const h of f)if(h===1/0||isNaN(h)||h%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...f){for(const h of f)if(h&&(h===1/0||isNaN(h)||h%1!=0||h<0))throw new Error("This API only accepts positive integers")}}p.Terminal=v})(),o})())})(Hs);var eo=Hs.exports,Ws={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(self,()=>(()=>{var r={};return(()=>{var i=r;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{activate(n){this._terminal=n}dispose(){}fit(){const n=this.proposeDimensions();if(!n||!this._terminal||isNaN(n.cols)||isNaN(n.rows))return;const o=this._terminal._core;this._terminal.rows===n.rows&&this._terminal.cols===n.cols||(o._renderService.clear(),this._terminal.resize(n.cols,n.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const n=this._terminal._core,o=n._renderService.dimensions;if(o.css.cell.width===0||o.css.cell.height===0)return;const p=this._terminal.options.scrollback===0?0:n.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(s.getPropertyValue("height")),c=Math.max(0,parseInt(s.getPropertyValue("width"))),_=window.getComputedStyle(this._terminal.element),d=a-(parseInt(_.getPropertyValue("padding-top"))+parseInt(_.getPropertyValue("padding-bottom"))),m=c-(parseInt(_.getPropertyValue("padding-right"))+parseInt(_.getPropertyValue("padding-left")))-p;return{cols:Math.max(2,Math.floor(m/o.css.cell.width)),rows:Math.max(1,Math.floor(d/o.css.cell.height))}}}})(),r})())})(Ws);var to=Ws.exports;const ro={fontFamily:'"Fira Code", Menlo, "DejaVu Sans Mono", "Lucida Console", monospace',cursorBlink:!0,cursorStyle:"block",cursorInactiveStyle:"outline",rows:16,theme:{foreground:"white",background:"black",cursor:"white",cursorAccent:"yellow",selectionForeground:"gray",selectionBackground:"black",black:"#000000",red:"#ff0000",green:"#00ff00",yellow:"#ffff00",blue:"#4444ff",magenta:"#ff00ff",cyan:"#00ffff",white:"#ffffff",brightBlack:"#808080",brightRed:"#ff0000",brightGreen:"#00ff00",brightYellow:"#ffff00",brightBlue:"#66aaff",brightMagenta:"#ff00ff",brightCyan:"#00ffff",brightWhite:"#ffffff"}};class io extends ke.Component{constructor(r){super(r);J(this,"terminal");J(this,"terminalRef");J(this,"promptDelimiter","$");J(this,"promptLength",0);J(this,"isShowVideo",!1);J(this,"fitAddon",new to.FitAddon);J(this,"isDebug",!1);J(this,"onDataDisposable",null);J(this,"handleResize",()=>{var r;(r=this.fitAddon)==null||r.fit()});J(this,"scrollBottom",()=>{this.terminal.scrollToBottom()});const{terminalElementRef:i}=r;this.terminalRef=i,this.state={},this.terminal=new eo.Terminal(ro),this.onDataHandler=this.onDataHandler.bind(this)}initializeTerminal(){const{terminalElementRef:r}=this.props;r!=null&&r.current&&(this.terminalRef=r,this.terminal.open(r.current),this.terminal.loadAddon(this.fitAddon),this.fitAddon.fit(),this.terminal.write("\x1B[4h"),this.focusTerminal())}focusTerminal(){this.terminal.focus(),this.terminal.scrollToBottom()}terminalReset(){this.terminal.reset()}terminalWrite(r){this.terminal.write(r)}getTerminalText(){return this.getCurrentCommand()}componentDidMount(){const{terminalElementRef:r}=this.props;r!=null&&r.current?this.initializeTerminal():console.error("terminalElementRef.current is NULL"),this.onDataDisposable=this.terminal.onData(this.onDataHandler),this.terminal.onCursorMove(()=>{}),this.setViewPortOpacity(),this.terminal.focus(),this.prompt(),window.addEventListener("resize",this.handleResize),this.scrollBottom(),this.focusTerminal()}componentDidUpdate(r){this.focusTerminal(),this.scrollBottom()}componentWillUnmount(){this.onDataDisposable&&this.onDataDisposable.dispose(),window.removeEventListener("resize",this.handleResize)}setCursorMode(r){r.options.cursorBlink=!0,r.options.cursorStyle="block",r.write("\x1B[4h")}handleBackSpaceAndNavigation(r){let i=!1;if(r.charCodeAt(0)===127){if(this.isCursorOnPrompt())return!0;this.terminal.write("\x1B[D\x1B[P"),i=!0}return i}isCursorOnPrompt(){const r=this.terminal.buffer.active.cursorY===0,i=this.terminal.buffer.active.cursorX<this.promptLength;return r&&i}isCursorOnFirstLine(){return this.terminal.buffer.active.cursorY===0}onDataHandler(r){const i=r.split("").map(n=>n.charCodeAt(0)).join(",");if(this.isDebug&&console.info("onDataHandler",r,i,this.terminal.buffer.active.cursorX,this.terminal.buffer.active.cursorY),this.setCursorMode(this.terminal),!this.handleBackSpaceAndNavigation(r)){if(r.charCodeAt(0)===27&&r.charCodeAt(1)===91){if(r.length>2&&r.charCodeAt(2)===72){this.terminal.write(`\x1B[${this.promptLength+1}G`);return}if(r.charCodeAt(2)===65&&this.isCursorOnFirstLine()){this.props.onAddCharacter("ArrowUp");return}if(r.charCodeAt(2)===68&&this.isCursorOnPrompt())return}this.props.onAddCharacter(r)}}setViewPortOpacity(){const r=document.getElementsByClassName("xterm-viewport")[0];r.style.opacity="0.0"}getCurrentCommand(){const r=this.terminal.buffer.active;let i="";for(let o=0;o<=r.cursorY;o++){const p=r.getLine(o);p&&(i+=p.translateToString(!0))}const n=i.indexOf(this.promptDelimiter)+1;return i.substring(n).trimStart()}prompt(r="guest",i="handex.io"){const n=`\x1B[1;34m${r}@${i} \x1B[0m\x1B[1;32m~${this.promptDelimiter}\x1B[0m `;this.promptLength=n.length-21,this.terminal.write(n)}promptLogin(){this.terminal.writeln("Welcome to Handex Term!"),this.terminal.writeln("Login:"),this.terminal.write("Username: ");let r=!1;this.terminal.onKey(({key:i,domEvent:n})=>{if(n.key,i==="Enter")r?this.terminal.writeln(""):(r=!0,this.terminal.writeln(""),this.terminal.write("Password: "));else if(i.charCodeAt(0)===127){if(this.isCursorOnPrompt())return!0;this.terminal.write("\x1B[D\x1B[P")}})}getTerminalSize(){if(this.terminalRef.current)return{width:this.terminalRef.current.clientWidth,height:this.terminalRef.current.clientHeight}}render(){return ne.jsx(ne.Fragment,{children:ne.jsx("div",{ref:this.terminalRef,id:Ie.Terminal,className:Ie.Terminal})})}}const so=me.forwardRef((e,t)=>{const[r,i]=me.useState(0),[n,o]=me.useState(!1),[p,s]=me.useState("start");me.useEffect(()=>{let S=null;return n?(s("pause"),S=window.setInterval(()=>{i(b=>b+1)},10)):!n&&r!==0&&(s("start"),clearInterval(S)),()=>{S&&clearInterval(S)}},[n,r]);const a=()=>{o(!0)},c=()=>{o(!1)},_=()=>{o(!1);const S=r;return i(0),S},d=()=>{console.info("Timer Success"),i(0),o(!1)};me.useImperativeHandle(t,()=>({start:a,stop:c,reset:_,success:d}));const m=()=>{switch(p){case"start":return ne.jsx("use",{href:"#start",transform:"scale(2,2)"});case"stop":return ne.jsx("use",{href:"#stop",transform:"scale(2,2)"});case"pause":return ne.jsx("use",{href:"#pause",transform:"scale(2,2)"});default:return ne.jsx("use",{href:"#stop",transform:"scale(2,2)"})}};return ne.jsxs(ke.Fragment,{children:[ne.jsx("span",{id:"timer",children:(r/100).toFixed(1)}),ne.jsx("svg",{width:"15",height:"20",style:{float:"left"},children:m()})]})}),Mi=[{key:"a",chordCode:"4",index:0},{key:"A",chordCode:"54",index:0},{key:"b",chordCode:"17",index:1},{key:"B",chordCode:"517",index:1},{key:"c",chordCode:"37",index:2},{key:"C",chordCode:"537",index:2},{key:"d",chordCode:"2",index:3},{key:"D",chordCode:"52",index:3},{key:"e",chordCode:"32",index:4},{key:"E",chordCode:"532",index:4},{key:"f",chordCode:"1",index:5},{key:"F",chordCode:"51",index:5},{key:"g",chordCode:"21",index:6},{key:"G",chordCode:"521",index:6},{key:"h",chordCode:"76",index:7},{key:"H",chordCode:"576",index:7},{key:"i",chordCode:"72",index:8},{key:"I",chordCode:"572",index:8},{key:"j",chordCode:"6",index:9},{key:"J",chordCode:"56",index:9},{key:"k",chordCode:"7",index:10},{key:"K",chordCode:"57",index:10},{key:"l",chordCode:"8",index:11},{key:"L",chordCode:"58",index:11},{key:"m",chordCode:"27",index:12},{key:"M",chordCode:"527",index:12},{key:"n",chordCode:"16",index:13},{key:"N",chordCode:"516",index:13},{key:"o",chordCode:"83",index:14},{key:"O",chordCode:"583",index:14},{key:"p",chordCode:"94",index:15},{key:"P",chordCode:"594",index:15},{key:"q",chordCode:"43",index:16},{key:"Q",chordCode:"543",index:16},{key:"r",chordCode:"23",index:17},{key:"R",chordCode:"523",index:17},{key:"s",chordCode:"3",index:18},{key:"S",chordCode:"53",index:18},{key:"t",chordCode:"12",index:19},{key:"T",chordCode:"512",index:19},{key:"u",chordCode:"61",index:20},{key:"U",chordCode:"561",index:20},{key:"v",chordCode:"28",index:21},{key:"V",chordCode:"528",index:21},{key:"w",chordCode:"34",index:22},{key:"W",chordCode:"534",index:22},{key:"x",chordCode:"39",index:23},{key:"X",chordCode:"539",index:23},{key:"y",chordCode:"26",index:24},{key:"Y",chordCode:"526",index:24},{key:"z",chordCode:"48",index:25},{key:"Z",chordCode:"548",index:25},{key:"1",chordCode:"10",index:26},{key:"!",chordCode:"510",index:26},{key:"2",chordCode:"20",index:27},{key:"@",chordCode:"520",index:27},{key:"3",chordCode:"30",index:28},{key:"#",chordCode:"530",index:28},{key:"4",chordCode:"40",index:29},{key:"$",chordCode:"540",index:29},{key:"5",chordCode:"050",index:30},{key:"%",chordCode:"5050",index:30},{key:"6",chordCode:"60",index:31},{key:"^",chordCode:"560",index:31},{key:"7",chordCode:"70",index:32},{key:"&",chordCode:"570",index:32},{key:"8",chordCode:"80",index:33},{key:"*",chordCode:"580",index:33},{key:"9",chordCode:"90",index:34},{key:"(",chordCode:"590",index:34},{key:"0",chordCode:"C",index:35},{key:")",chordCode:"5C",index:35},{key:"Return (ENTER)",chordCode:"0",index:36},{key:"ESCAPE",chordCode:"491",index:37},{key:"DELETE (Backspace)",chordCode:"B",index:38},{key:"\\t",chordCode:"14",index:39},{key:"&#x2581;",chordCode:"5",index:40},{key:"-",chordCode:"B0",index:41},{key:"(underscore)",chordCode:"5B0",index:41},{key:"=",chordCode:"C0",index:42},{key:"+",chordCode:"5C0",index:42},{key:"[",chordCode:"45",index:43},{key:"{",chordCode:"545",index:43},{key:"]",chordCode:"495",index:44},{key:"}",chordCode:"5495",index:44},{key:"\\",chordCode:"15",index:45},{key:"|",chordCode:"515",index:45},{key:";",chordCode:"9",index:46},{key:":",chordCode:"59",index:46},{key:"'",chordCode:"89",index:47},{key:'"',chordCode:"589",index:47},{key:"`",chordCode:"101",index:48},{key:"~",chordCode:"5101",index:48},{key:",",chordCode:"38",index:49},{key:"<",chordCode:"538",index:49},{key:".",chordCode:"49",index:50},{key:">",chordCode:"549",index:50},{key:"/",chordCode:"96",index:51},{key:"?",chordCode:"596",index:51},{key:"Caps Lock",chordCode:"E",index:52},{key:"F1",chordCode:"131",index:53},{key:"F2",chordCode:"1D",index:54},{key:"F3",chordCode:"370",index:55},{key:"F4",chordCode:"B0B",index:56},{key:"F5",chordCode:"1C",index:57},{key:"F6",chordCode:"B06",index:58},{key:"F7",chordCode:"B12",index:59},{key:"F8",chordCode:"B7",index:60},{key:"F9",chordCode:"B2",index:61},{key:"F10",chordCode:"BC",index:62},{key:"F11",chordCode:"B8B",index:63},{key:"F12",chordCode:"B3B",index:64},{key:"PrintScreen",chordCode:"BD",index:65},{key:"Scroll Lock",chordCode:"7E7",index:66},{key:"Pause",chordCode:"206",index:67},{key:"Insert",chordCode:"200",index:68},{key:"Home",chordCode:"B1",index:69},{key:"PageUp",chordCode:"B8",index:70},{key:"Delete Forward",chordCode:"7B",index:71},{key:"End",chordCode:"C2",index:72},{key:"PageDown",chordCode:"8B",index:73},{key:"RightArrow",chordCode:"2C",index:74},{key:"LeftArrow",chordCode:"1B",index:75},{key:"DownArrow",chordCode:"71",index:76},{key:"UpArrow",chordCode:"73",index:77},{key:"Keypad Num Lock",chordCode:"202",index:78},{key:"Clear",chordCode:"5202",index:78},{key:"Keypad /",chordCode:"2A2",index:79},{key:"Keypad *",chordCode:"717",index:80},{key:"Keypad -",chordCode:"212",index:81},{key:"Keypad +",chordCode:"2B",index:82},{key:"Keypad ENTER",chordCode:"27E",index:83},{key:"Keypad 1",chordCode:"2C4",index:84},{key:"End",chordCode:"52C4",index:84},{key:"Keypad 2",chordCode:"282",index:85},{key:"Down Arrow",chordCode:"5282",index:85},{key:"Keypad 3",chordCode:"23278",index:86},{key:"PageDn",chordCode:"523278",index:86},{key:"Keypad 4",chordCode:"2D",index:87},{key:"Left Arrow",chordCode:"52D",index:87},{key:"Keypad 5",chordCode:"CE",index:88},{key:"Keypad 6",chordCode:"C0C",index:89},{key:"Right Arrow",chordCode:"5C0C",index:89},{key:"Keypad 7",chordCode:"CA",index:90},{key:"Home",chordCode:"5CA",index:90},{key:"Keypad 8",chordCode:"C6",index:91},{key:"Up Arrow",chordCode:"5C6",index:91},{key:"Keypad 9",chordCode:"C1",index:92},{key:"PageUp",chordCode:"5C1",index:92},{key:"Keypad 0",chordCode:"CB",index:93},{key:"Insert",chordCode:"5CB",index:93},{key:"Keypad .",chordCode:"C7E",index:94},{key:"Delete",chordCode:"5C7E",index:94},{key:"Non-US \\",chordCode:"C2E",index:95},{key:"|",chordCode:"5C2E",index:95},{key:"Application",chordCode:"C8",index:96},{key:"Power",chordCode:"321",index:97},{key:"Keypad =",chordCode:"CD",index:98},{key:"F13",chordCode:"8E",index:99},{key:"F14",chordCode:"850",index:100},{key:"F15",chordCode:"8A",index:101},{key:"F16",chordCode:"6C6",index:102},{key:"F17",chordCode:"801",index:103},{key:"F18",chordCode:"8B8",index:104},{key:"F19",chordCode:"878",index:105},{key:"F20",chordCode:"82",index:106},{key:"F21",chordCode:"8C",index:107},{key:"F22",chordCode:"8383",index:108},{key:"F23",chordCode:"8D",index:109},{key:"F24",chordCode:"3E",index:110},{key:"Execute",chordCode:"1A1",index:111},{key:"Help",chordCode:"7E",index:112},{key:"Menu",chordCode:"36",index:113},{key:"Select",chordCode:"313",index:114},{key:"Stop",chordCode:"123",index:115},{key:"Again",chordCode:"7A7",index:116},{key:"Undo",chordCode:"232",index:117},{key:"Cut",chordCode:"3C",index:118},{key:"Copy",chordCode:"383",index:119},{key:"Paste",chordCode:"838",index:120},{key:"Find",chordCode:"DE",index:121},{key:"Mute",chordCode:"D0D",index:122},{key:"Volume Up",chordCode:"DA",index:123},{key:"Volume Down",chordCode:"D6",index:124},{key:"Locking Caps Lock",chordCode:"D1",index:125},{key:"Locking Num Lock",chordCode:"DB",index:126},{key:"Locking Scroll Lock",chordCode:"D7",index:127},{key:"Keypad Comma",chordCode:"D2",index:128},{key:"Keypad Equal Sign",chordCode:"DC",index:129},{key:"International1",chordCode:"D82",index:130},{key:"International2",chordCode:"D3D",index:131},{key:"International3",chordCode:"700",index:132},{key:"International4",chordCode:"7E0",index:133},{key:"International5",chordCode:"7EA",index:134},{key:"International6",chordCode:"7E6",index:135},{key:"International7",chordCode:"6E1",index:136},{key:"International8",chordCode:"7EB",index:137},{key:"International9",chordCode:"7E73",index:138},{key:"LANG1",chordCode:"7E2",index:139},{key:"LANG2",chordCode:"7EC",index:140},{key:"LANG3",chordCode:"7E8",index:141},{key:"LANG4",chordCode:"7E3",index:142},{key:"LANG5",chordCode:"7ED",index:143},{key:"LANG6",chordCode:"70C",index:144},{key:"LeftControl",chordCode:"09999",index:145},{key:"LeftShift",chordCode:"59999",index:146},{key:"LeftAlt",chordCode:"A",index:147},{key:"Left GUI",chordCode:"2121",index:148},{key:"RightControl",chordCode:"7A0",index:149},{key:"RightShift",chordCode:"7EA7",index:150},{key:"RightAlt",chordCode:"7A6",index:151},{key:"Right GUI",chordCode:"1212",index:152}];class st{constructor(t){J(this,"_value");J(this,"_chords",[]);J(this,"_chordsHTML",[]);if(!t||!Array.isArray(t)||t.length==0)throw new Error("Phrase value must be an array with at least one element");this._value=t,t[0]&&Array.isArray(t)&&this.setChords(t)}get value(){return this._value}get chordsHTML(){return this._chordsHTML}get chords(){return this._chords}setChords(t){t.forEach(r=>{const i=st.findChordHTML(r);i&&this._chordsHTML.push(i);const n=Mi.find(o=>o.key==r);n&&this._chords.push(n)})}static createChordHTML(t){return Wr(`<div class="col-sm-2 row generated" id="chord2">
                <span id="char${t.index}">${t.key}</span>
                <img loading="lazy" alt="2" src="/images/svgs/${t.chordCode}.svg" width="100" class="hand">
            </div>`)}static findChordHTML(t){let r=null;const i=Array.from(Mi).filter(n=>n.key.replace("&#x2581;"," ").replace("(underscore)","_")==t);if(i.length>0){const n=i[0];r=this.createChordHTML(n),r.setAttribute("name",n.key.replace("(","").replace(")","").replace(" ","-"))}else console.error("Missing chord:",t==null?void 0:t.charCodeAt(0));return r}}function ci(e){if(!e.displayChar||e.displayChar.length===0)throw new Error("displayChar is required: "+e.displayChar);const t=new st(e.displayChar).chords;if(t.length===0)return null;const r=t[0].chordCode,i=e.displayChar.join("").replace("Arrow","").replace("Return (ENTER)","Enter");return ne.jsx("div",{className:"chord-image-holder",id:"chord-image-holder","data-source":"ErrorDisplay.tsx",children:ne.jsxs("div",{className:"col-sm-2 row generated next",id:"chord2",children:[ne.jsx("span",{id:"char15",className:"char",children:i}),ne.jsx("img",{loading:"lazy",alt:"2",src:`/images/svgs/${r}.svg`,width:"75",className:"hand"})]})})}const no=me.forwardRef((e,t)=>{const[r,i]=me.useState(0),{mismatchedChar:n}=e,o=()=>{i(p=>p+1)};return me.useImperativeHandle(t,()=>({showError:o})),ne.jsxs("div",{style:{display:e.isVisible?"block":"none"},children:[ne.jsxs("div",{children:["Error Count: ",r]}),n&&ne.jsx(ci,{displayChar:n.split("")})]})});class oo extends ke.Component{constructor(r){super(r);J(this,"_nextCharsRef");J(this,"_nextCharsRateRef");J(this,"_timerRef");J(this,"voiceSynth");J(this,"_wpmRef");J(this,"isTestMode");J(this,"_nextCharsLength",60);J(this,"showError",r=>{this.setState({mismatchedChar:r,mismatchedIsVisible:!0})});J(this,"hideError",()=>{this.setState({mismatchedChar:null,mismatchedIsVisible:!1})});J(this,"handleSuccess",()=>{this.setState({isActive:!1,mismatchedChar:"",mismatchedIsVisible:!1,nextChars:""}),this.props.onPhraseSuccess(this.state.phrase.value.join(""))});J(this,"cancelTimer",()=>{this._timerRef.current&&this._timerRef.current.reset(),this._nextCharsRef.current&&(this._nextCharsRef.current.innerText=this.state.phrase.value.join(""))});J(this,"setNext",r=>{const i=this.getFirstNonMatchingChar(r);return i<0||i>this.state.phrase.value.length-1?null:(this.setState({nextChars:this.getNextCharacters(r)}),this.state.phrase.chordsHTML[i])});J(this,"cancel",()=>{this.wpm&&(this.wpm="0"),this.setNext("")});J(this,"testInput",r=>{this.startTImer();const i=this.setNext(r);if(i&&i.classList.remove("error"),r.length===0){this.cancelTimer();return}if(r==this.state.phrase.value.join("").trim().substring(0,r.length))this.hideError();else{const n=this.getFirstNonMatchingChar(r),o=this.state.phrase.value[n];this.setState({mismatchedIsVisible:!0,mismatchedChar:o}),this.showError(o)}if(r.trim()==this.state.phrase.value.join("").trim()){this.stopTimer(),this.handleSuccess();return}});J(this,"getFirstNonMatchingChar",r=>{if(!this.state.phrase.value)return 0;const i=this.state.phrase.value;if(r.length==0)return 0;var n=0;for(let o=0;o<r.length;o++){if(r[o]!==i[o])return o;n++}return n});J(this,"sayText",r=>{const i=r.target;if(!i||!i.value)return;let n=i.value;const o=r.key;if(o){if(this.voiceSynth||(this.voiceSynth=window.speechSynthesis),this.voiceSynth.speaking&&this.voiceSynth.cancel(),o!=null&&o.match(/^[a-z0-9]$/i))n=o;else if(o=="Backspace")n="delete";else if(o=="Enter")n=n;else{const s=n.trim().split(" ");n=s[s.length-1]}var p=new SpeechSynthesisUtterance(n);p.pitch=1,p.rate=.7,this.voiceSynth.speak(p)}});this.voiceSynth=window.speechSynthesis,this._nextCharsRef=ke.createRef(),this._nextCharsRateRef=ke.createRef(),this._wpmRef=ke.createRef(),this.isTestMode=localStorage.getItem("testMode")=="true",this._timerRef=me.createRef(),this.state={mismatchedChar:null,mismatchedIsVisible:!1,nextChars:this.props.newPhrase,nextCharsIsVisible:!1,isActive:!1,phrase:new st(this.props.newPhrase.split(""))}}componentDidMount(){this.props.isInPhraseMode&&this.setState({phrase:new st(this.props.newPhrase.split(""))})}componentDidUpdate(r){if(this.props.newPhrase!==r.newPhrase&&this.props.isInPhraseMode&&this.setState({phrase:new st(this.props.newPhrase.split("")),nextChars:this.props.newPhrase}),this.props.commandLine!==r.commandLine){const i=this.getNextCharacters(this.props.commandLine);this.setState({nextChars:i}),this.handleCommandLineChange(this.props.commandLine)}}handleCommandLineChange(r){this.testInput(r)}stopTimer(){this._timerRef.current&&this._timerRef.current.stop()}startTImer(){this._timerRef.current&&this._timerRef.current.start()}resetTimer(){this._timerRef.current&&this._timerRef.current.reset()}reset(){var r;this.setNext(""),(r=this._nextCharsRef)!=null&&r.current&&(this._nextCharsRef.current.hidden=!0)}get nextChars(){var r;return(r=this._nextCharsRef)==null?void 0:r.current}set wpm(r){this._wpmRef.current&&(this._wpmRef.current.innerText=r)}get phrase(){return this.state.phrase}get nextCharsRate(){return this._nextCharsRateRef.current}set phrase(r){this.setState({phrase:new st(r.value.split(""))})}getNextCharacters(r){const i=this.getFirstNonMatchingChar(r);return this.state.phrase.value.join("").substring(i,i+this._nextCharsLength)||r.substring(i,i+this._nextCharsLength)}render(){return ne.jsxs("div",{hidden:!this.props.isInPhraseMode,children:[this.state.mismatchedChar&&ne.jsx(no,{isVisible:this.state.mismatchedIsVisible,mismatchedChar:this.state.mismatchedChar}),ne.jsx(so,{ref:this._timerRef}),ne.jsx("div",{id:Ie.NextCharsRate,ref:this._nextCharsRateRef}),ne.jsx("span",{id:Ie.WPM,ref:this._wpmRef}),ne.jsx("pre",{id:Ie.NextChars,ref:this._nextCharsRef,children:this.state.nextChars})]})}}const ao=ke.forwardRef(({elements:e,onTouchStart:t,onTouchEnd:r},i)=>ne.jsx("div",{id:Ie.Output,className:Ie.Output,onTouchStart:t,onTouchEnd:r,ref:i,children:e.map((n,o)=>typeof n=="string"?ne.jsx("div",{dangerouslySetInnerHTML:{__html:n}},o):ne.jsx("div",{children:n},o))}));function ho(e,t){if(!e)throw new Error(`Assertion failed: ${t}`)}class lo{constructor(t,r,i,n,o){J(this,"image");J(this,"frameCount");J(this,"frameWidth");J(this,"frameHeight");J(this,"frameSequence");J(this,"draw",(t,r,i,n,o=1.5)=>{let p=0,s=0;if(this.frameSequence){const a=this.frameSequence[r];a?(p=a.leftX,s=a.topY):console.error("No frameCoords found for frameIndex:",r,this.frameSequence)}else p=this.frameWidth*r,s=0;t.drawImage(this.image,p,s,this.frameWidth,this.frameHeight,i,n,this.frameWidth*o,this.frameHeight*o)});this.image=new Image,this.image.onload=()=>{ho(this.image.complete,"Image failed to load: "+t),this.frameWidth||(this.frameWidth=this.image.width/this.frameCount),this.frameHeight||(this.frameHeight=this.image.height)},this.image.onerror=()=>{console.error("Image failed to load: "+t)},this.image.src=t,this.frameCount=r,this.frameWidth=i||0,this.frameHeight=n||0,this.frameSequence=o}updateFrameIndex(t,r,i,n){return r-i>n?(t+1)%this.frameCount:t}}class co{constructor(){J(this,"spriteCache",new Map)}async loadSprite(t){if(this.spriteCache.has(t.imagePath)){const i=this.spriteCache.get(t.imagePath);if(i!==void 0)return i}const r=new lo(t.imagePath,t.frameCount,t.frameWidth,t.frameHeight,t.framePositions);return await this.waitForManagerImageLoad(r.image),this.spriteCache.set(t.imagePath,r),r}waitForManagerImageLoad(t){return new Promise((r,i)=>{const n=()=>{t.removeEventListener("load",n),t.removeEventListener("error",o),r()},o=()=>{t.removeEventListener("load",n),t.removeEventListener("error",o),console.error("Image failed to load: "+t.src),i(new Error(`Image failed to load: ${t.src}`))};t.addEventListener("load",n),t.addEventListener("error",o)})}}const $s=e=>{const[,t]=me.useState(null),r=new co,i=me.useRef(e.currentActionType),n=me.useRef(0),o=me.useRef({}),p=async(d,m)=>{const S=await r.loadSprite(m);S&&(o.current[d]=S,d===e.currentActionType&&t(S))},s=(d,m,S)=>{const b=o.current[e.currentActionType],v=e.actions[e.currentActionType],l=m.leftX+v.dx;return _(),b&&b.draw(d,n.current,l,m.topY,S??e.scale),v.dx},a=()=>{Object.entries(e.actions).forEach(([d,m])=>{p(d,m.animation)})};me.useEffect(()=>(a(),()=>{}),[]),me.useEffect(()=>{const d=o.current[e.currentActionType];d?t(d):p(e.currentActionType,e.actions[e.currentActionType].animation)},[e.currentActionType,e.actions]),me.useEffect(()=>(e.name.toLocaleLowerCase()==="hero"&&c(e.currentActionType),()=>{}),[e.currentActionType]),me.useEffect(()=>{const d=o.current[e.currentActionType];d&&d.frameCount&&(e.currentActionType!==i.current?n.current=0:_()),i.current=e.currentActionType},[e.currentActionType,e.actions]);const c=d=>{if(e.currentActionType===d)return;e.currentActionType=d,n.current=0;const m=o.current[d];m?t(m):console.error(`Sprite not found for action type: ${d}`)},_=()=>{const d=o.current[e.currentActionType];if(d){const m=(n.current+1)%d.frameCount;n.current=m}};return{draw:s}},tt={Run:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:6,frameWidth:50,frameHeight:37,framePositions:[{leftX:50,topY:37},{leftX:100,topY:37},{leftX:150,topY:37},{leftX:200,topY:37},{leftX:250,topY:37},{leftX:300,topY:37}]},Idle:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Walk:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Attack:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Summersault:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:200,topY:74},{leftX:250,topY:74},{leftX:300,topY:74},{leftX:0,topY:106}]},Hurt:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Death:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Jump:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]}},Et={Idle:{imagePath:"images/Zombie4Package/Sprites/Idle.png",frameCount:5,frameWidth:62,frameHeight:62},Walk:{imagePath:"images/Zombie4Package/Sprites/Walk.png",frameCount:13,frameWidth:62,frameHeight:62},Attack:{imagePath:"images/Zombie4Package/Sprites/Attack.png",frameCount:15,frameWidth:62,frameHeight:62},Hurt:{imagePath:"images/Zombie4Package/Sprites/Hurt.png",frameCount:7,frameWidth:62,frameHeight:62},Death:{imagePath:"images/Zombie4Package/Sprites/Death.png",frameCount:12,frameWidth:62,frameHeight:62},Spawn:{imagePath:"images/Zombie4Package/Sprites/Spawn.png",frameCount:10,frameWidth:62,frameHeight:62}},uo={Run:{animation:tt.Run,dx:2,dy:0,continueous:!0},Idle:{animation:tt.Idle,dx:0,dy:0,continueous:!0},Walk:{animation:tt.Walk,dx:1,dy:0,continueous:!0},Jump:{animation:tt.Jump,dx:0,dy:0,continueous:!1},Attack:{animation:tt.Attack,dx:0,dy:0,continueous:!1},Summersault:{animation:tt.Summersault,dx:3,dy:1,continueous:!1},Death:{animation:tt.Death,dx:0,dy:0,continueous:!1},Hurt:{animation:tt.Hurt,dx:0,dy:0,continueous:!1}},fo={Attack:{animation:Et.Attack,dx:2,dy:0,continueous:!1},Idle:{animation:Et.Idle,dx:0,dy:0,continueous:!0},Walk:{animation:Et.Walk,dx:1,dy:0,continueous:!0},Hurt:{animation:Et.Hurt,dx:0,dy:0,continueous:!1},Death:{animation:Et.Death,dx:0,dy:0,continueous:!1}},po=me.forwardRef((e,t)=>{const{draw:r}=$s({actions:fo,currentActionType:e.currentActionType,name:"Zombie4",scale:e.scale});return me.useImperativeHandle(t,()=>({draw:r})),null}),_o=me.forwardRef((e,t)=>{const{draw:r}=$s({actions:uo,currentActionType:e.currentActionType,name:"Hero",scale:e.scale});return me.useImperativeHandle(t,()=>({draw:r})),null}),$r=[[{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0003_bg.png",scale:1,movementRate:0},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0002_far-buildings.png",scale:.8,movementRate:.4},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0001_buildings.png",scale:.6,movementRate:.6},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0000_foreground.png",scale:.6,movementRate:1}],[{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/far-buildings.png",scale:1,movementRate:.4},{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/back-buildings.png",scale:.8,movementRate:.6},{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/foreground.png",scale:1,movementRate:1}],[{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_1_ground.png",scale:1,movementRate:1},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_2_stars.png",scale:.8,movementRate:0},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_3_moon.png",scale:.8,movementRate:0},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_4_clouds_1.png",scale:.8,movementRate:.2},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_6_far_buildings.png",scale:.8,movementRate:.3},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_7_bg_buildings.png",scale:.8,movementRate:.5},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_8_fg_buildings.png",scale:.6,movementRate:.6},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_9_wall.png",scale:.6,movementRate:1}],[{imageSrc:"/images/parallax-city-background-pack/1BG.png",scale:1,movementRate:0},{imageSrc:"/images/parallax-city-background-pack/2Mountain.png",scale:1,movementRate:.2},{imageSrc:"/images/parallax-city-background-pack/3MountainCloser.png",scale:1,movementRate:.3},{imageSrc:"/images/parallax-city-background-pack/3MountainCloserWCranes.png",scale:1,movementRate:.4},{imageSrc:"/images/parallax-city-background-pack/5Buildings.png",scale:1,movementRate:.5},{imageSrc:"/images/parallax-city-background-pack/6BlueBuildings.png",scale:1,movementRate:.7},{imageSrc:"/images/parallax-city-background-pack/7FireDept.png",scale:1,movementRate:.8},{imageSrc:"/images/parallax-city-background-pack/8Player.png",scale:1,movementRate:1}],[{imageSrc:"/images/city-ruins/post_apocalipse1.png",scale:1.3,movementRate:0},{imageSrc:"/images/city-ruins/post_apocalipse2.png",scale:1.3,movementRate:.5},{imageSrc:"/images/city-ruins/post_apocalipse3.png",scale:1,movementRate:1}],[{imageSrc:"/images/haunted-forest-parallaxing-background/background_1.png",scale:1,movementRate:0},{imageSrc:"/images/haunted-forest-parallaxing-background/background_2.png",scale:1,movementRate:.2},{imageSrc:"/images/haunted-forest-parallaxing-background/background_3.png",scale:1,movementRate:.4},{imageSrc:"/images/haunted-forest-parallaxing-background/background_4.png",scale:1,movementRate:.6},{imageSrc:"/images/haunted-forest-parallaxing-background/background_5.png",scale:1,movementRate:1}]],Dr=()=>$r.length,mo=({layer:e,offset:t,canvasHeight:r})=>{const i=r*e.scale,n=r-r*e.scale,o={backgroundImage:`url(${e.imageSrc})`,backgroundPositionX:-t*e.movementRate,backgroundRepeat:"repeat-x",backgroundSize:`auto ${i}px`,willChange:"transform",height:`${i}px`,width:"100%",position:"absolute",top:n};return ne.jsx("div",{className:"parallax-layer",style:o})},go=e=>{const t=60-e.canvasHeight;return ne.jsx("div",{className:"scrolling-text-container",style:{position:"absolute",bottom:t,height:e.canvasHeight,width:"100%",zIndex:1,overflow:"hidden"},children:ne.jsx("div",{className:"scrolling-text",style:{whiteSpace:"nowrap"},children:e.text})})};var ui={};(function e(t,r,i,n){var o=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),p=typeof Path2D=="function"&&typeof DOMMatrix=="function",s=function(){if(!t.OffscreenCanvas)return!1;var T=new OffscreenCanvas(1,1),k=T.getContext("2d");k.fillRect(0,0,1,1);var M=T.transferToImageBitmap();try{k.createPattern(M,"no-repeat")}catch{return!1}return!0}();function a(){}function c(T){var k=r.exports.Promise,M=k!==void 0?k:t.Promise;return typeof M=="function"?new M(T):(T(a,a),null)}var _=function(T,k){return{transform:function(M){if(T)return M;if(k.has(M))return k.get(M);var $=new OffscreenCanvas(M.width,M.height),V=$.getContext("2d");return V.drawImage(M,0,0),k.set(M,$),$},clear:function(){k.clear()}}}(s,new Map),d=function(){var T=Math.floor(16.666666666666668),k,M,$={},V=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(k=function(Z){var ee=Math.random();return $[ee]=requestAnimationFrame(function F(I){V===I||V+T-1<I?(V=I,delete $[ee],Z()):$[ee]=requestAnimationFrame(F)}),ee},M=function(Z){$[Z]&&cancelAnimationFrame($[Z])}):(k=function(Z){return setTimeout(Z,T)},M=function(Z){return clearTimeout(Z)}),{frame:k,cancel:M}}(),m=function(){var T,k,M={};function $(V){function Z(ee,F){V.postMessage({options:ee||{},callback:F})}V.init=function(F){var I=F.transferControlToOffscreen();V.postMessage({canvas:I},[I])},V.fire=function(F,I,z){if(k)return Z(F,null),k;var W=Math.random().toString(36).slice(2);return k=c(function(X){function Y(le){le.data.callback===W&&(delete M[W],V.removeEventListener("message",Y),k=null,_.clear(),z(),X())}V.addEventListener("message",Y),Z(F,W),M[W]=Y.bind(null,{data:{callback:W}})}),k},V.reset=function(){V.postMessage({reset:!0});for(var F in M)M[F](),delete M[F]}}return function(){if(T)return T;if(!i&&o){var V=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{T=new Worker(URL.createObjectURL(new Blob([V])))}catch(Z){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",Z),null}$(T)}return T}}(),S={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function b(T,k){return k?k(T):T}function v(T){return T!=null}function l(T,k,M){return b(T&&v(T[k])?T[k]:S[k],M)}function f(T){return T<0?0:Math.floor(T)}function h(T,k){return Math.floor(Math.random()*(k-T))+T}function u(T){return parseInt(T,16)}function g(T){return T.map(E)}function E(T){var k=String(T).replace(/[^0-9a-f]/gi,"");return k.length<6&&(k=k[0]+k[0]+k[1]+k[1]+k[2]+k[2]),{r:u(k.substring(0,2)),g:u(k.substring(2,4)),b:u(k.substring(4,6))}}function x(T){var k=l(T,"origin",Object);return k.x=l(k,"x",Number),k.y=l(k,"y",Number),k}function R(T){T.width=document.documentElement.clientWidth,T.height=document.documentElement.clientHeight}function y(T){var k=T.getBoundingClientRect();T.width=k.width,T.height=k.height}function A(T){var k=document.createElement("canvas");return k.style.position="fixed",k.style.top="0px",k.style.left="0px",k.style.pointerEvents="none",k.style.zIndex=T,k}function O(T,k,M,$,V,Z,ee,F,I){T.save(),T.translate(k,M),T.rotate(Z),T.scale($,V),T.arc(0,0,1,ee,F,I),T.restore()}function U(T){var k=T.angle*(Math.PI/180),M=T.spread*(Math.PI/180);return{x:T.x,y:T.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:T.startVelocity*.5+Math.random()*T.startVelocity,angle2D:-k+(.5*M-Math.random()*M),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:T.color,shape:T.shape,tick:0,totalTicks:T.ticks,decay:T.decay,drift:T.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:T.gravity*3,ovalScalar:.6,scalar:T.scalar,flat:T.flat}}function H(T,k){k.x+=Math.cos(k.angle2D)*k.velocity+k.drift,k.y+=Math.sin(k.angle2D)*k.velocity+k.gravity,k.velocity*=k.decay,k.flat?(k.wobble=0,k.wobbleX=k.x+10*k.scalar,k.wobbleY=k.y+10*k.scalar,k.tiltSin=0,k.tiltCos=0,k.random=1):(k.wobble+=k.wobbleSpeed,k.wobbleX=k.x+10*k.scalar*Math.cos(k.wobble),k.wobbleY=k.y+10*k.scalar*Math.sin(k.wobble),k.tiltAngle+=.1,k.tiltSin=Math.sin(k.tiltAngle),k.tiltCos=Math.cos(k.tiltAngle),k.random=Math.random()+2);var M=k.tick++/k.totalTicks,$=k.x+k.random*k.tiltCos,V=k.y+k.random*k.tiltSin,Z=k.wobbleX+k.random*k.tiltCos,ee=k.wobbleY+k.random*k.tiltSin;if(T.fillStyle="rgba("+k.color.r+", "+k.color.g+", "+k.color.b+", "+(1-M)+")",T.beginPath(),p&&k.shape.type==="path"&&typeof k.shape.path=="string"&&Array.isArray(k.shape.matrix))T.fill(ie(k.shape.path,k.shape.matrix,k.x,k.y,Math.abs(Z-$)*.1,Math.abs(ee-V)*.1,Math.PI/10*k.wobble));else if(k.shape.type==="bitmap"){var F=Math.PI/10*k.wobble,I=Math.abs(Z-$)*.1,z=Math.abs(ee-V)*.1,W=k.shape.bitmap.width*k.scalar,X=k.shape.bitmap.height*k.scalar,Y=new DOMMatrix([Math.cos(F)*I,Math.sin(F)*I,-Math.sin(F)*z,Math.cos(F)*z,k.x,k.y]);Y.multiplySelf(new DOMMatrix(k.shape.matrix));var le=T.createPattern(_.transform(k.shape.bitmap),"no-repeat");le.setTransform(Y),T.globalAlpha=1-M,T.fillStyle=le,T.fillRect(k.x-W/2,k.y-X/2,W,X),T.globalAlpha=1}else if(k.shape==="circle")T.ellipse?T.ellipse(k.x,k.y,Math.abs(Z-$)*k.ovalScalar,Math.abs(ee-V)*k.ovalScalar,Math.PI/10*k.wobble,0,2*Math.PI):O(T,k.x,k.y,Math.abs(Z-$)*k.ovalScalar,Math.abs(ee-V)*k.ovalScalar,Math.PI/10*k.wobble,0,2*Math.PI);else if(k.shape==="star")for(var ae=Math.PI/2*3,de=4*k.scalar,ge=8*k.scalar,he=k.x,P=k.y,C=5,w=Math.PI/C;C--;)he=k.x+Math.cos(ae)*ge,P=k.y+Math.sin(ae)*ge,T.lineTo(he,P),ae+=w,he=k.x+Math.cos(ae)*de,P=k.y+Math.sin(ae)*de,T.lineTo(he,P),ae+=w;else T.moveTo(Math.floor(k.x),Math.floor(k.y)),T.lineTo(Math.floor(k.wobbleX),Math.floor(V)),T.lineTo(Math.floor(Z),Math.floor(ee)),T.lineTo(Math.floor($),Math.floor(k.wobbleY));return T.closePath(),T.fill(),k.tick<k.totalTicks}function B(T,k,M,$,V){var Z=k.slice(),ee=T.getContext("2d"),F,I,z=c(function(W){function X(){F=I=null,ee.clearRect(0,0,$.width,$.height),_.clear(),V(),W()}function Y(){i&&!($.width===n.width&&$.height===n.height)&&($.width=T.width=n.width,$.height=T.height=n.height),!$.width&&!$.height&&(M(T),$.width=T.width,$.height=T.height),ee.clearRect(0,0,$.width,$.height),Z=Z.filter(function(le){return H(ee,le)}),Z.length?F=d.frame(Y):X()}F=d.frame(Y),I=X});return{addFettis:function(W){return Z=Z.concat(W),z},canvas:T,promise:z,reset:function(){F&&d.cancel(F),I&&I()}}}function j(T,k){var M=!T,$=!!l(k||{},"resize"),V=!1,Z=l(k,"disableForReducedMotion",Boolean),ee=o&&!!l(k||{},"useWorker"),F=ee?m():null,I=M?R:y,z=T&&F?!!T.__confetti_initialized:!1,W=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,X;function Y(ae,de,ge){for(var he=l(ae,"particleCount",f),P=l(ae,"angle",Number),C=l(ae,"spread",Number),w=l(ae,"startVelocity",Number),L=l(ae,"decay",Number),N=l(ae,"gravity",Number),K=l(ae,"drift",Number),G=l(ae,"colors",g),ce=l(ae,"ticks",Number),_e=l(ae,"shapes"),ve=l(ae,"scalar"),Ce=!!l(ae,"flat"),Se=x(ae),De=he,Ke=[],ye=T.width*Se.x,Ar=T.height*Se.y;De--;)Ke.push(U({x:ye,y:Ar,angle:P,spread:C,startVelocity:w,color:G[De%G.length],shape:_e[h(0,_e.length)],ticks:ce,decay:L,gravity:N,drift:K,scalar:ve,flat:Ce}));return X?X.addFettis(Ke):(X=B(T,Ke,I,de,ge),X.promise)}function le(ae){var de=Z||l(ae,"disableForReducedMotion",Boolean),ge=l(ae,"zIndex",Number);if(de&&W)return c(function(w){w()});M&&X?T=X.canvas:M&&!T&&(T=A(ge),document.body.appendChild(T)),$&&!z&&I(T);var he={width:T.width,height:T.height};F&&!z&&F.init(T),z=!0,F&&(T.__confetti_initialized=!0);function P(){if(F){var w={getBoundingClientRect:function(){if(!M)return T.getBoundingClientRect()}};I(w),F.postMessage({resize:{width:w.width,height:w.height}});return}he.width=he.height=null}function C(){X=null,$&&(V=!1,t.removeEventListener("resize",P)),M&&T&&(document.body.contains(T)&&document.body.removeChild(T),T=null,z=!1)}return $&&!V&&(V=!0,t.addEventListener("resize",P,!1)),F?F.fire(ae,he,C):Y(ae,he,C)}return le.reset=function(){F&&F.reset(),X&&X.reset()},le}var q;function Q(){return q||(q=j(null,{useWorker:!0,resize:!0})),q}function ie(T,k,M,$,V,Z,ee){var F=new Path2D(T),I=new Path2D;I.addPath(F,new DOMMatrix(k));var z=new Path2D;return z.addPath(I,new DOMMatrix([Math.cos(ee)*V,Math.sin(ee)*V,-Math.sin(ee)*Z,Math.cos(ee)*Z,M,$])),z}function te(T){if(!p)throw new Error("path confetti are not supported in this browser");var k,M;typeof T=="string"?k=T:(k=T.path,M=T.matrix);var $=new Path2D(k),V=document.createElement("canvas"),Z=V.getContext("2d");if(!M){for(var ee=1e3,F=ee,I=ee,z=0,W=0,X,Y,le=0;le<ee;le+=2)for(var ae=0;ae<ee;ae+=2)Z.isPointInPath($,le,ae,"nonzero")&&(F=Math.min(F,le),I=Math.min(I,ae),z=Math.max(z,le),W=Math.max(W,ae));X=z-F,Y=W-I;var de=10,ge=Math.min(de/X,de/Y);M=[ge,0,0,ge,-Math.round(X/2+F)*ge,-Math.round(Y/2+I)*ge]}return{type:"path",path:k,matrix:M}}function D(T){var k,M=1,$="#000000",V='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof T=="string"?k=T:(k=T.text,M="scalar"in T?T.scalar:M,V="fontFamily"in T?T.fontFamily:V,$="color"in T?T.color:$);var Z=10*M,ee=""+Z+"px "+V,F=new OffscreenCanvas(Z,Z),I=F.getContext("2d");I.font=ee;var z=I.measureText(k),W=Math.ceil(z.actualBoundingBoxRight+z.actualBoundingBoxLeft),X=Math.ceil(z.actualBoundingBoxAscent+z.actualBoundingBoxDescent),Y=2,le=z.actualBoundingBoxLeft+Y,ae=z.actualBoundingBoxAscent+Y;W+=Y+Y,X+=Y+Y,F=new OffscreenCanvas(W,X),I=F.getContext("2d"),I.font=ee,I.fillStyle=$,I.fillText(k,le,ae);var de=1/M;return{type:"bitmap",bitmap:F.transferToImageBitmap(),matrix:[de,0,0,de,-W*de/2,-X*de/2]}}r.exports=function(){return Q().apply(this,arguments)},r.exports.reset=function(){Q().reset()},r.exports.create=j,r.exports.shapeFromPath=te,r.exports.shapeFromText=D})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ui,!1);const vo=ui.exports;ui.exports.create;class So extends ke.Component{constructor(r){super(r);J(this,"canvasRef",ke.createRef());J(this,"animationFrameIndex");J(this,"context",null);J(this,"heroXPercent",.23);J(this,"zombie4DeathTimeout",null);J(this,"heroRef",ke.createRef());J(this,"zombie4Ref",ke.createRef());J(this,"getLevel",()=>this.state.currentLevel);J(this,"setLevel",r=>{const i=$r[r-1];this.setState({currentLevel:r,layers:i})});J(this,"levelUp",(r=null)=>{r&&r>Dr()&&(r=Dr());let i=r||this.getLevel()+1;i>Dr()&&(i=0),i<1&&(i=1),this.setLevel(i)});J(this,"changeLevel",r=>{this.setState({currentLevel:r})});J(this,"toggleScrollingText",(r=null)=>{r===null&&(r=!this.state.isTextScrolling),this.setState({isTextScrolling:r})});J(this,"setZombie4ToDeathThenResetPosition",()=>{this.zombie4DeathTimeout&&(clearTimeout(this.zombie4DeathTimeout),this.zombie4DeathTimeout=null),this.setZombie4Action("Death"),this.zombie4DeathTimeout=setTimeout(()=>{this.setZombie4Action("Walk"),this.setState({zombie4Position:{topY:0,leftX:-70},isPhraseComplete:!1,textScrollX:this.props.canvasWidth}),this.zombie4DeathTimeout=null},3e3)});J(this,"updateCharacterAndBackgroundPostion",r=>{const n=this.props.canvasWidth*this.heroXPercent;r.clearRect(0,0,this.props.canvasWidth,this.props.canvasHeight);let o=0;if(this.heroRef.current&&r&&(o=this.heroRef.current.draw(r,this.state.heroPosition)),this.zombie4Ref.current&&r){const p=this.zombie4Ref.current.draw(r,this.state.zombie4Position);this.setState(s=>({zombie4Position:{...s.zombie4Position,leftX:s.zombie4Position.leftX+p}}))}if(this.state.isInScrollMode&&o!==0){this.setState(s=>({backgroundOffsetX:s.backgroundOffsetX+o})),this.state.heroPosition.leftX>=n&&this.setState({heroPosition:{...this.state.heroPosition,leftX:n}});const p=this.state.zombie4Position.leftX-o;this.setState({zombie4Position:{...this.state.zombie4Position,leftX:p}})}return o});J(this,"handleHeroPositionChange",r=>{this.setState({heroPosition:r})});J(this,"handleZombie4PositionChange",r=>{this.setState({zombie4Position:r})});this.state=this.getInitState(r)}getInitState(r){return{currentLevel:1,heroPosition:{leftX:r.canvasWidth*this.heroXPercent,topY:30},heroReady:!1,zombie4Position:{leftX:50,topY:0},zombie4Ready:!1,context:null,contextBackground:null,idleStartTime:null,backgroundOffsetX:0,isPhraseComplete:!1,textScrollX:this.props.canvasWidth,textToScroll:"Terminal Velocity!",isTextScrolling:!1,isInScrollMode:!0,layers:$r[0]}}resetGame(){}componentDidMount(){const r=this.canvasRef.current;if(r){const i=r.getContext("2d");i&&this.setupCanvas(i.canvas)}}componentDidUpdate(r,i,n){this.state.currentLevel,i.currentLevel,this.animationFrameIndex||this.startAnimationLoop(this.state.context)}componentWillUnmount(){this.animationFrameIndex&&cancelAnimationFrame(this.animationFrameIndex),this.stopAnimationLoop(),this.zombie4DeathTimeout&&clearTimeout(this.zombie4DeathTimeout)}setupCanvas(r){if(r){const i=r.getContext("2d");i instanceof CanvasRenderingContext2D?this.setState({context:i}):console.error("Obtained context is not a CanvasRenderingContext2D instance.")}else console.error("Failed to get canvas element.")}drawScrollingText(){this.toggleScrollingText(!0),setTimeout(()=>{this.toggleScrollingText(!1)},3e3)}completeGame(){this.setZombie4ToDeathThenResetPosition(),this.triggerConfettiCannon(),this.setState({isPhraseComplete:!0,textScrollX:this.props.canvasWidth})}checkProximityAndSetAction(){const i=this.state.heroPosition.leftX-this.state.zombie4Position.leftX;25<i&&i<100?this.setZombie4Action("Attack"):this.props.zombie4ActionType==="Attack"&&this.setZombie4Action("Walk")}setZombie4Action(r){this.props.onSetZombie4Action(r)}startAnimationLoop(r){let n=performance.now();const o=()=>{const p=performance.now(),s=p-n;s>=150&&(n=p-s%150,this.state.isPhraseComplete&&this.drawScrollingText(),this.updateCharacterAndBackgroundPostion(r),this.checkProximityAndSetAction()),this.animationFrameIndex=requestAnimationFrame(o)};this.animationFrameIndex=requestAnimationFrame(o)}maybeStartAnimationLoop(){this.state.context&&this.state.contextBackground&&this.startAnimationLoop(this.state.context)}stopAnimationLoop(){this.animationFrameIndex&&(cancelAnimationFrame(this.animationFrameIndex),this.animationFrameIndex=void 0)}triggerConfettiCannon(){vo({zIndex:3,angle:160,spread:45,startVelocity:45,particleCount:150,origin:{x:.99,y:.8}})}render(){return ne.jsxs("div",{id:Ie.TerminalGame,hidden:!this.props.isInPhraseMode,style:{position:"relative",height:this.props.canvasHeight},children:[ne.jsxs("div",{className:"parallax-background",children:[this.state.isTextScrolling&&ne.jsx(go,{text:this.state.textToScroll,canvasHeight:this.props.canvasHeight}),this.state.layers.map((r,i)=>ne.jsx(mo,{layer:r,offset:this.state.backgroundOffsetX,canvasHeight:this.props.canvasHeight},i))]}),ne.jsx("canvas",{style:{position:"absolute",top:0,left:0,zIndex:2},ref:this.canvasRef,width:this.props.canvasWidth,height:this.props.canvasHeight}),ne.jsx(_o,{ref:this.heroRef,currentActionType:this.props.heroActionType,scale:1.95}),ne.jsx(po,{ref:this.zombie4Ref,currentActionType:this.props.zombie4ActionType,scale:1.9})]})}}var ht={},Ct={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=me;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Oe=Object.prototype.hasOwnProperty,yo=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bi={},Oi={};function zs(e){return Oe.call(Oi,e)?!0:Oe.call(Bi,e)?!1:yo.test(e)?Oi[e]=!0:(Bi[e]=!0,!1)}function Me(e,t,r,i,n,o,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=p}var Te={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Te[e]=new Me(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Te[t]=new Me(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Te[e]=new Me(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Te[e]=new Me(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Te[e]=new Me(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Te[e]=new Me(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Te[e]=new Me(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Te[e]=new Me(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Te[e]=new Me(e,5,!1,e.toLowerCase(),null,!1,!1)});var di=/[\-:]([a-z])/g;function fi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(di,fi);Te[t]=new Me(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(di,fi);Te[t]=new Me(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(di,fi);Te[t]=new Me(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Te[e]=new Me(e,1,!1,e.toLowerCase(),null,!1,!1)});Te.xlinkHref=new Me("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Te[e]=new Me(e,1,!1,e.toLowerCase(),null,!0,!0)});var Kt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Co=["Webkit","ms","Moz","O"];Object.keys(Kt).forEach(function(e){Co.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kt[t]=Kt[e]})});var wo=/["'&<>]/;function Pe(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=wo.exec(e);if(t){var r="",i,n=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}n!==i&&(r+=e.substring(n,i)),n=i+1,r+=t}e=n!==i?r+e.substring(n,i):r}return e}var bo=/([A-Z])/g,xo=/^ms-/,jr=Array.isArray;function Ze(e,t){return{insertionMode:e,selectedValue:t}}function Eo(e,t,r){switch(t){case"select":return Ze(1,r.value!=null?r.value:r.defaultValue);case"svg":return Ze(2,null);case"math":return Ze(3,null);case"foreignObject":return Ze(1,null);case"table":return Ze(4,null);case"thead":case"tbody":case"tfoot":return Ze(5,null);case"colgroup":return Ze(7,null);case"tr":return Ze(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Ze(1,null):e}var Fi=new Map;function Ks(e,t,r){if(typeof r!="object")throw Error(ue(62));t=!0;for(var i in r)if(Oe.call(r,i)){var n=r[i];if(n!=null&&typeof n!="boolean"&&n!==""){if(i.indexOf("--")===0){var o=Pe(i);n=Pe((""+n).trim())}else{o=i;var p=Fi.get(o);p!==void 0||(p=Pe(o.replace(bo,"-$1").toLowerCase().replace(xo,"-ms-")),Fi.set(o,p)),o=p,n=typeof n=="number"?n===0||Oe.call(Kt,i)?""+n:n+"px":Pe((""+n).trim())}t?(t=!1,e.push(' style="',o,":",n)):e.push(";",o,":",n)}}t||e.push('"')}function Ue(e,t,r,i){switch(r){case"style":Ks(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(t=Te.hasOwnProperty(r)?Te[r]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(r=t.attributeName,t.type){case 3:i&&e.push(" ",r,'=""');break;case 4:i===!0?e.push(" ",r,'=""'):i!==!1&&e.push(" ",r,'="',Pe(i),'"');break;case 5:isNaN(i)||e.push(" ",r,'="',Pe(i),'"');break;case 6:!isNaN(i)&&1<=i&&e.push(" ",r,'="',Pe(i),'"');break;default:t.sanitizeURL&&(i=""+i),e.push(" ",r,'="',Pe(i),'"')}}else if(zs(r)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=r.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",r,'="',Pe(i),'"')}}}function Vt(e,t,r){if(t!=null){if(r!=null)throw Error(ue(60));if(typeof t!="object"||!("__html"in t))throw Error(ue(61));t=t.__html,t!=null&&e.push(""+t)}}function ko(e){var t="";return js.Children.forEach(e,function(r){r!=null&&(t+=r)}),t}function Ir(e,t,r,i){e.push(Ye(r));var n=r=null,o;for(o in t)if(Oe.call(t,o)){var p=t[o];if(p!=null)switch(o){case"children":r=p;break;case"dangerouslySetInnerHTML":n=p;break;default:Ue(e,i,o,p)}}return e.push(">"),Vt(e,n,r),typeof r=="string"?(e.push(Pe(r)),null):r}var Ro=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Ui=new Map;function Ye(e){var t=Ui.get(e);if(t===void 0){if(!Ro.test(e))throw Error(ue(65,e));t="<"+e,Ui.set(e,t)}return t}function To(e,t,r,i,n){switch(t){case"select":e.push(Ye("select"));var o=null,p=null;for(_ in r)if(Oe.call(r,_)){var s=r[_];if(s!=null)switch(_){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;case"defaultValue":case"value":break;default:Ue(e,i,_,s)}}return e.push(">"),Vt(e,p,o),o;case"option":p=n.selectedValue,e.push(Ye("option"));var a=s=null,c=null,_=null;for(o in r)if(Oe.call(r,o)){var d=r[o];if(d!=null)switch(o){case"children":s=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":_=d;break;case"value":a=d;default:Ue(e,i,o,d)}}if(p!=null)if(r=a!==null?""+a:ko(s),jr(p)){for(i=0;i<p.length;i++)if(""+p[i]===r){e.push(' selected=""');break}}else""+p===r&&e.push(' selected=""');else c&&e.push(' selected=""');return e.push(">"),Vt(e,_,s),s;case"textarea":e.push(Ye("textarea")),_=p=o=null;for(s in r)if(Oe.call(r,s)&&(a=r[s],a!=null))switch(s){case"children":_=a;break;case"value":o=a;break;case"defaultValue":p=a;break;case"dangerouslySetInnerHTML":throw Error(ue(91));default:Ue(e,i,s,a)}if(o===null&&p!==null&&(o=p),e.push(">"),_!=null){if(o!=null)throw Error(ue(92));if(jr(_)&&1<_.length)throw Error(ue(93));o=""+_}return typeof o=="string"&&o[0]===`
`&&e.push(`
`),o!==null&&e.push(Pe(""+o)),null;case"input":e.push(Ye("input")),a=_=s=o=null;for(p in r)if(Oe.call(r,p)&&(c=r[p],c!=null))switch(p){case"children":case"dangerouslySetInnerHTML":throw Error(ue(399,"input"));case"defaultChecked":a=c;break;case"defaultValue":s=c;break;case"checked":_=c;break;case"value":o=c;break;default:Ue(e,i,p,c)}return _!==null?Ue(e,i,"checked",_):a!==null&&Ue(e,i,"checked",a),o!==null?Ue(e,i,"value",o):s!==null&&Ue(e,i,"value",s),e.push("/>"),null;case"menuitem":e.push(Ye("menuitem"));for(var m in r)if(Oe.call(r,m)&&(o=r[m],o!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(ue(400));default:Ue(e,i,m,o)}return e.push(">"),null;case"title":e.push(Ye("title")),o=null;for(d in r)if(Oe.call(r,d)&&(p=r[d],p!=null))switch(d){case"children":o=p;break;case"dangerouslySetInnerHTML":throw Error(ue(434));default:Ue(e,i,d,p)}return e.push(">"),o;case"listing":case"pre":e.push(Ye(t)),p=o=null;for(a in r)if(Oe.call(r,a)&&(s=r[a],s!=null))switch(a){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;default:Ue(e,i,a,s)}if(e.push(">"),p!=null){if(o!=null)throw Error(ue(60));if(typeof p!="object"||!("__html"in p))throw Error(ue(61));r=p.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?e.push(`
`,r):e.push(""+r))}return typeof o=="string"&&o[0]===`
`&&e.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(Ye(t));for(var S in r)if(Oe.call(r,S)&&(o=r[S],o!=null))switch(S){case"children":case"dangerouslySetInnerHTML":throw Error(ue(399,t));default:Ue(e,i,S,o)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Ir(e,r,t,i);case"html":return n.insertionMode===0&&e.push("<!DOCTYPE html>"),Ir(e,r,t,i);default:if(t.indexOf("-")===-1&&typeof r.is!="string")return Ir(e,r,t,i);e.push(Ye(t)),p=o=null;for(c in r)if(Oe.call(r,c)&&(s=r[c],s!=null))switch(c){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;case"style":Ks(e,i,s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:zs(c)&&typeof s!="function"&&typeof s!="symbol"&&e.push(" ",c,'="',Pe(s),'"')}return e.push(">"),Vt(e,p,o),o}}function Hi(e,t,r){if(e.push('<!--$?--><template id="'),r===null)throw Error(ue(395));return e.push(r),e.push('"></template>')}function Ao(e,t,r,i){switch(r.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');default:throw Error(ue(397))}}function Do(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(ue(397))}}var Io=/[<\u2028\u2029]/g;function Pr(e){return JSON.stringify(e).replace(Io,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Po(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function Ni(e,t,r,i){return r.generateStaticMarkup?(e.push(Pe(t)),!1):(t===""?e=i:(i&&e.push("<!-- -->"),e.push(Pe(t)),e=!0),e)}var It=Object.assign,Lo=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),qs=Symbol.for("react.fragment"),Gs=Symbol.for("react.strict_mode"),Ys=Symbol.for("react.profiler"),Xs=Symbol.for("react.provider"),Js=Symbol.for("react.context"),Zs=Symbol.for("react.forward_ref"),Qs=Symbol.for("react.suspense"),en=Symbol.for("react.suspense_list"),tn=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),Mo=Symbol.for("react.scope"),Bo=Symbol.for("react.debug_trace_mode"),Oo=Symbol.for("react.legacy_hidden"),Fo=Symbol.for("react.default_value"),Wi=Symbol.iterator;function zr(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case qs:return"Fragment";case Vs:return"Portal";case Ys:return"Profiler";case Gs:return"StrictMode";case Qs:return"Suspense";case en:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Js:return(e.displayName||"Context")+".Consumer";case Xs:return(e._context.displayName||"Context")+".Provider";case Zs:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tn:return t=e.displayName||null,t!==null?t:zr(e.type)||"Memo";case pi:t=e._payload,e=e._init;try{return zr(e(t))}catch{}}return null}var rn={};function $i(e,t){if(e=e.contextTypes,!e)return rn;var r={},i;for(i in e)r[i]=t[i];return r}var _t=null;function mr(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var r=t.parent;if(e===null){if(r!==null)throw Error(ue(401))}else{if(r===null)throw Error(ue(401));mr(e,r)}t.context._currentValue2=t.value}}function sn(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&sn(e)}function nn(e){var t=e.parent;t!==null&&nn(t),e.context._currentValue2=e.value}function on(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(ue(402));e.depth===t.depth?mr(e,t):on(e,t)}function an(e,t){var r=t.parent;if(r===null)throw Error(ue(402));e.depth===r.depth?mr(e,r):an(e,r),t.context._currentValue2=t.value}function rr(e){var t=_t;t!==e&&(t===null?nn(e):e===null?sn(t):t.depth===e.depth?mr(t,e):t.depth>e.depth?on(t,e):an(t,e),_t=e)}var ji={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function zi(e,t,r,i){var n=e.state!==void 0?e.state:null;e.updater=ji,e.props=r,e.state=n;var o={queue:[],replace:!1};e._reactInternals=o;var p=t.contextType;if(e.context=typeof p=="object"&&p!==null?p._currentValue2:i,p=t.getDerivedStateFromProps,typeof p=="function"&&(p=p(r,n),n=p==null?n:It({},n,p),e.state=n),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&ji.enqueueReplaceState(e,e.state,null),o.queue!==null&&0<o.queue.length)if(t=o.queue,p=o.replace,o.queue=null,o.replace=!1,p&&t.length===1)e.state=t[0];else{for(o=p?t[0]:e.state,n=!0,p=p?1:0;p<t.length;p++){var s=t[p];s=typeof s=="function"?s.call(e,o,r,i):s,s!=null&&(n?(n=!1,o=It({},o,s)):It(o,s))}e.state=o}else o.queue=null}var Uo={id:1,overflow:""};function Kr(e,t,r){var i=e.id;e=e.overflow;var n=32-qt(i)-1;i&=~(1<<n),r+=1;var o=32-qt(t)+n;if(30<o){var p=n-n%5;return o=(i&(1<<p)-1).toString(32),i>>=p,n-=p,{id:1<<32-qt(t)+n|r<<n|i,overflow:o+e}}return{id:1<<o|r<<n|i,overflow:e}}var qt=Math.clz32?Math.clz32:Wo,Ho=Math.log,No=Math.LN2;function Wo(e){return e>>>=0,e===0?32:31-(Ho(e)/No|0)|0}function $o(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jo=typeof Object.is=="function"?Object.is:$o,Qe=null,_i=null,Gt=null,be=null,Rt=!1,ir=!1,Mt=0,nt=null,gr=0;function ut(){if(Qe===null)throw Error(ue(321));return Qe}function Ki(){if(0<gr)throw Error(ue(312));return{memoizedState:null,queue:null,next:null}}function mi(){return be===null?Gt===null?(Rt=!1,Gt=be=Ki()):(Rt=!0,be=Gt):be.next===null?(Rt=!1,be=be.next=Ki()):(Rt=!0,be=be.next),be}function gi(){_i=Qe=null,ir=!1,Gt=null,gr=0,be=nt=null}function hn(e,t){return typeof t=="function"?t(e):t}function Vi(e,t,r){if(Qe=ut(),be=mi(),Rt){var i=be.queue;if(t=i.dispatch,nt!==null&&(r=nt.get(i),r!==void 0)){nt.delete(i),i=be.memoizedState;do i=e(i,r.action),r=r.next;while(r!==null);return be.memoizedState=i,[i,t]}return[be.memoizedState,t]}return e=e===hn?typeof t=="function"?t():t:r!==void 0?r(t):t,be.memoizedState=e,e=be.queue={last:null,dispatch:null},e=e.dispatch=zo.bind(null,Qe,e),[be.memoizedState,e]}function qi(e,t){if(Qe=ut(),be=mi(),t=t===void 0?null:t,be!==null){var r=be.memoizedState;if(r!==null&&t!==null){var i=r[1];e:if(i===null)i=!1;else{for(var n=0;n<i.length&&n<t.length;n++)if(!jo(t[n],i[n])){i=!1;break e}i=!0}if(i)return r[0]}}return e=e(),be.memoizedState=[e,t],e}function zo(e,t,r){if(25<=gr)throw Error(ue(301));if(e===Qe)if(ir=!0,e={action:r,next:null},nt===null&&(nt=new Map),r=nt.get(t),r===void 0)nt.set(t,e);else{for(t=r;t.next!==null;)t=t.next;t.next=e}}function Ko(){throw Error(ue(394))}function Nt(){}var Gi={readContext:function(e){return e._currentValue2},useContext:function(e){return ut(),e._currentValue2},useMemo:qi,useReducer:Vi,useRef:function(e){Qe=ut(),be=mi();var t=be.memoizedState;return t===null?(e={current:e},be.memoizedState=e):t},useState:function(e){return Vi(hn,e)},useInsertionEffect:Nt,useLayoutEffect:function(){},useCallback:function(e,t){return qi(function(){return e},t)},useImperativeHandle:Nt,useEffect:Nt,useDebugValue:Nt,useDeferredValue:function(e){return ut(),e},useTransition:function(){return ut(),[!1,Ko]},useId:function(){var e=_i.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-qt(e)-1)).toString(32)+t;var r=Yt;if(r===null)throw Error(ue(404));return t=Mt++,e=":"+r.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return ut(),t(e._source)},useSyncExternalStore:function(e,t,r){if(r===void 0)throw Error(ue(407));return r()}},Yt=null,Lr=js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Vo(e){return console.error(e),null}function Tt(){}function qo(e,t,r,i,n,o,p,s,a){var c=[],_=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:_,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:n===void 0?Vo:n,onAllReady:Tt,onShellReady:p===void 0?Tt:p,onShellError:Tt,onFatalError:Tt},r=sr(t,0,null,r,!1,!1),r.parentFlushed=!0,e=vi(t,e,null,r,_,rn,null,Uo),c.push(e),t}function vi(e,t,r,i,n,o,p,s){e.allPendingTasks++,r===null?e.pendingRootTasks++:r.pendingTasks++;var a={node:t,ping:function(){var c=e.pingedTasks;c.push(a),c.length===1&&un(e)},blockedBoundary:r,blockedSegment:i,abortSet:n,legacyContext:o,context:p,treeContext:s};return n.add(a),a}function sr(e,t,r,i,n,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:r,lastPushedText:n,textEmbedded:o}}function Bt(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function nr(e,t){var r=e.onShellError;r(t),r=e.onFatalError,r(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function Yi(e,t,r,i,n){for(Qe={},_i=t,Mt=0,e=r(i,n);ir;)ir=!1,Mt=0,gr+=1,be=null,e=r(i,n);return gi(),e}function Xi(e,t,r,i){var n=r.render(),o=i.childContextTypes;if(o!=null){var p=t.legacyContext;if(typeof r.getChildContext!="function")i=p;else{r=r.getChildContext();for(var s in r)if(!(s in o))throw Error(ue(108,zr(i)||"Unknown",s));i=It({},p,r)}t.legacyContext=i,Ne(e,t,n),t.legacyContext=p}else Ne(e,t,n)}function Ji(e,t){if(e&&e.defaultProps){t=It({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Vr(e,t,r,i,n){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){n=$i(r,t.legacyContext);var o=r.contextType;o=new r(i,typeof o=="object"&&o!==null?o._currentValue2:n),zi(o,r,i,n),Xi(e,t,o,r)}else{o=$i(r,t.legacyContext),n=Yi(e,t,r,i,o);var p=Mt!==0;if(typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0)zi(n,r,i,o),Xi(e,t,n,r);else if(p){i=t.treeContext,t.treeContext=Kr(i,1,0);try{Ne(e,t,n)}finally{t.treeContext=i}}else Ne(e,t,n)}else if(typeof r=="string"){switch(n=t.blockedSegment,o=To(n.chunks,r,i,e.responseState,n.formatContext),n.lastPushedText=!1,p=n.formatContext,n.formatContext=Eo(p,r,i),qr(e,t,o),n.formatContext=p,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:n.chunks.push("</",r,">")}n.lastPushedText=!1}else{switch(r){case Oo:case Bo:case Gs:case Ys:case qs:Ne(e,t,i.children);return;case en:Ne(e,t,i.children);return;case Mo:throw Error(ue(343));case Qs:e:{r=t.blockedBoundary,n=t.blockedSegment,o=i.fallback,i=i.children,p=new Set;var s={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:p,errorDigest:null},a=sr(e,n.chunks.length,s,n.formatContext,!1,!1);n.children.push(a),n.lastPushedText=!1;var c=sr(e,0,null,n.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=s,t.blockedSegment=c;try{if(qr(e,t,i),e.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),c.status=1,or(s,c),s.pendingTasks===0)break e}catch(_){c.status=4,s.forceClientRender=!0,s.errorDigest=Bt(e,_)}finally{t.blockedBoundary=r,t.blockedSegment=n}t=vi(e,o,r,a,p,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Zs:if(i=Yi(e,t,r.render,i,n),Mt!==0){r=t.treeContext,t.treeContext=Kr(r,1,0);try{Ne(e,t,i)}finally{t.treeContext=r}}else Ne(e,t,i);return;case tn:r=r.type,i=Ji(r,i),Vr(e,t,r,i,n);return;case Xs:if(n=i.children,r=r._context,i=i.value,o=r._currentValue2,r._currentValue2=i,p=_t,_t=i={parent:p,depth:p===null?0:p.depth+1,context:r,parentValue:o,value:i},t.context=i,Ne(e,t,n),e=_t,e===null)throw Error(ue(403));i=e.parentValue,e.context._currentValue2=i===Fo?e.context._defaultValue:i,e=_t=e.parent,t.context=e;return;case Js:i=i.children,i=i(r._currentValue2),Ne(e,t,i);return;case pi:n=r._init,r=n(r._payload),i=Ji(r,i),Vr(e,t,r,i,void 0);return}throw Error(ue(130,r==null?r:typeof r,""))}}function Ne(e,t,r){if(t.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case Lo:Vr(e,t,r.type,r.props,r.ref);return;case Vs:throw Error(ue(257));case pi:var i=r._init;r=i(r._payload),Ne(e,t,r);return}if(jr(r)){Zi(e,t,r);return}if(r===null||typeof r!="object"?i=null:(i=Wi&&r[Wi]||r["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(r))){if(r=i.next(),!r.done){var n=[];do n.push(r.value),r=i.next();while(!r.done);Zi(e,t,n)}return}throw e=Object.prototype.toString.call(r),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}typeof r=="string"?(i=t.blockedSegment,i.lastPushedText=Ni(t.blockedSegment.chunks,r,e.responseState,i.lastPushedText)):typeof r=="number"&&(i=t.blockedSegment,i.lastPushedText=Ni(t.blockedSegment.chunks,""+r,e.responseState,i.lastPushedText))}function Zi(e,t,r){for(var i=r.length,n=0;n<i;n++){var o=t.treeContext;t.treeContext=Kr(o,i,n);try{qr(e,t,r[n])}finally{t.treeContext=o}}}function qr(e,t,r){var i=t.blockedSegment.formatContext,n=t.legacyContext,o=t.context;try{return Ne(e,t,r)}catch(a){if(gi(),typeof a=="object"&&a!==null&&typeof a.then=="function"){r=a;var p=t.blockedSegment,s=sr(e,p.chunks.length,null,p.formatContext,p.lastPushedText,!0);p.children.push(s),p.lastPushedText=!1,e=vi(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,r.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=n,t.context=o,rr(o)}else throw t.blockedSegment.formatContext=i,t.legacyContext=n,t.context=o,rr(o),a}}function Go(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,cn(this,t,e)}function ln(e,t,r){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=r===void 0?Error(ue(432)):r,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(n){return ln(n,t,r)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function or(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var r=t.children[0];r.id=t.id,r.parentFlushed=!0,r.status===1&&or(e,r)}else e.completedSegments.push(t)}function cn(e,t,r){if(t===null){if(r.parentFlushed){if(e.completedRootSegment!==null)throw Error(ue(389));e.completedRootSegment=r}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Tt,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(r.parentFlushed&&r.status===1&&or(t,r),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Go,e),t.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(or(t,r),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function un(e){if(e.status!==2){var t=_t,r=Lr.current;Lr.current=Gi;var i=Yt;Yt=e.responseState;try{var n=e.pingedTasks,o;for(o=0;o<n.length;o++){var p=n[o],s=e,a=p.blockedSegment;if(a.status===0){rr(p.context);try{Ne(s,p,p.node),s.responseState.generateStaticMarkup||a.lastPushedText&&a.textEmbedded&&a.chunks.push("<!-- -->"),p.abortSet.delete(p),a.status=1,cn(s,p.blockedBoundary,a)}catch(b){if(gi(),typeof b=="object"&&b!==null&&typeof b.then=="function"){var c=p.ping;b.then(c,c)}else{p.abortSet.delete(p),a.status=4;var _=p.blockedBoundary,d=b,m=Bt(s,d);if(_===null?nr(s,d):(_.pendingTasks--,_.forceClientRender||(_.forceClientRender=!0,_.errorDigest=m,_.parentFlushed&&s.clientRenderedBoundaries.push(_))),s.allPendingTasks--,s.allPendingTasks===0){var S=s.onAllReady;S()}}}finally{}}}n.splice(0,o),e.destination!==null&&Si(e,e.destination)}catch(b){Bt(e,b),nr(e,b)}finally{Yt=i,Lr.current=r,r===Gi&&rr(t)}}}function Wt(e,t,r){switch(r.parentFlushed=!0,r.status){case 0:var i=r.id=e.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=i.toString(16),t.push(e),t.push('"></template>');case 1:r.status=2;var n=!0;i=r.chunks;var o=0;r=r.children;for(var p=0;p<r.length;p++){for(n=r[p];o<n.index;o++)t.push(i[o]);n=vr(e,t,n)}for(;o<i.length-1;o++)t.push(i[o]);return o<i.length&&(n=t.push(i[o])),n;default:throw Error(ue(390))}}function vr(e,t,r){var i=r.boundary;if(i===null)return Wt(e,t,r);if(i.parentFlushed=!0,i.forceClientRender)return e.responseState.generateStaticMarkup||(i=i.errorDigest,t.push("<!--$!-->"),t.push("<template"),i&&(t.push(' data-dgst="'),i=Pe(i),t.push(i),t.push('"')),t.push("></template>")),Wt(e,t,r),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var n=e.responseState,o=n.nextSuspenseID++;return n=n.boundaryPrefix+o.toString(16),i=i.id=n,Hi(t,e.responseState,i),Wt(e,t,r),t.push("<!--/$-->")}if(i.byteSize>e.progressiveChunkSize)return i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),Hi(t,e.responseState,i.id),Wt(e,t,r),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),r=i.completedSegments,r.length!==1)throw Error(ue(391));return vr(e,t,r[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function Qi(e,t,r){return Ao(t,e.responseState,r.formatContext,r.id),vr(e,t,r),Do(t,r.formatContext)}function es(e,t,r){for(var i=r.completedSegments,n=0;n<i.length;n++)dn(e,t,r,i[n]);if(i.length=0,e=e.responseState,i=r.id,r=r.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),i===null)throw Error(ue(395));return r=r.toString(16),t.push(i),t.push('","'),t.push(e.segmentPrefix),t.push(r),t.push('")<\/script>')}function dn(e,t,r,i){if(i.status===2)return!0;var n=i.id;if(n===-1){if((i.id=r.rootSegmentID)===-1)throw Error(ue(392));return Qi(e,t,i)}return Qi(e,t,i),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),n=n.toString(16),t.push(n),t.push('","'),t.push(e.placeholderPrefix),t.push(n),t.push('")<\/script>')}function Si(e,t){try{var r=e.completedRootSegment;if(r!==null&&e.pendingRootTasks===0){vr(e,t,r),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(r=0;r<i.length-1;r++)t.push(i[r]);r<i.length&&t.push(i[r])}var n=e.clientRenderedBoundaries,o;for(o=0;o<n.length;o++){var p=n[o];i=t;var s=e.responseState,a=p.id,c=p.errorDigest,_=p.errorMessage,d=p.errorComponentStack;if(i.push(s.startInlineScript),s.sentClientRenderFunction?i.push('$RX("'):(s.sentClientRenderFunction=!0,i.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),a===null)throw Error(ue(395));if(i.push(a),i.push('"'),c||_||d){i.push(",");var m=Pr(c||"");i.push(m)}if(_||d){i.push(",");var S=Pr(_||"");i.push(S)}if(d){i.push(",");var b=Pr(d);i.push(b)}if(!i.push(")<\/script>")){e.destination=null,o++,n.splice(0,o);return}}n.splice(0,o);var v=e.completedBoundaries;for(o=0;o<v.length;o++)if(!es(e,t,v[o])){e.destination=null,o++,v.splice(0,o);return}v.splice(0,o);var l=e.partialBoundaries;for(o=0;o<l.length;o++){var f=l[o];e:{n=e,p=t;var h=f.completedSegments;for(s=0;s<h.length;s++)if(!dn(n,p,f,h[s])){s++,h.splice(0,s);var u=!1;break e}h.splice(0,s),u=!0}if(!u){e.destination=null,o++,l.splice(0,o);return}}l.splice(0,o);var g=e.completedBoundaries;for(o=0;o<g.length;o++)if(!es(e,t,g[o])){e.destination=null,o++,g.splice(0,o);return}g.splice(0,o)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function Yo(e,t){try{var r=e.abortableTasks;r.forEach(function(i){return ln(i,e,t)}),r.clear(),e.destination!==null&&Si(e,e.destination)}catch(i){Bt(e,i),nr(e,i)}}function Xo(){}function fn(e,t,r,i){var n=!1,o=null,p="",s={push:function(c){return c!==null&&(p+=c),!0},destroy:function(c){n=!0,o=c}},a=!1;if(e=qo(e,Po(r,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,Xo,void 0,function(){a=!0}),un(e),Yo(e,i),e.status===1)e.status=2,s.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=s;try{Si(e,s)}catch(c){Bt(e,c),nr(e,c)}}if(n)throw o;if(!a)throw Error(ue(426));return p}Ct.renderToNodeStream=function(){throw Error(ue(207))};Ct.renderToStaticMarkup=function(e,t){return fn(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ct.renderToStaticNodeStream=function(){throw Error(ue(208))};Ct.renderToString=function(e,t){return fn(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Ct.version="18.3.1";var yi={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pn=me;function fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var We=null,$e=0;function oe(e,t){if(t.length!==0)if(512<t.length)0<$e&&(e.enqueue(new Uint8Array(We.buffer,0,$e)),We=new Uint8Array(512),$e=0),e.enqueue(t);else{var r=We.length-$e;r<t.length&&(r===0?e.enqueue(We):(We.set(t.subarray(0,r),$e),e.enqueue(We),t=t.subarray(r)),We=new Uint8Array(512),$e=0),We.set(t,$e),$e+=t.length}}function Ee(e,t){return oe(e,t),!0}function ts(e){We&&0<$e&&(e.enqueue(new Uint8Array(We.buffer,0,$e)),We=null,$e=0)}var _n=new TextEncoder;function pe(e){return _n.encode(e)}function re(e){return _n.encode(e)}function mn(e,t){typeof e.error=="function"?e.error(t):e.close()}var Fe=Object.prototype.hasOwnProperty,Jo=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rs={},is={};function gn(e){return Fe.call(is,e)?!0:Fe.call(rs,e)?!1:Jo.test(e)?is[e]=!0:(rs[e]=!0,!1)}function Be(e,t,r,i,n,o,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=p}var Ae={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ae[e]=new Be(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ae[t]=new Be(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ae[e]=new Be(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ae[e]=new Be(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ae[e]=new Be(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ae[e]=new Be(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ae[e]=new Be(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ae[e]=new Be(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ae[e]=new Be(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ci=/[\-:]([a-z])/g;function wi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ci,wi);Ae[t]=new Be(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ci,wi);Ae[t]=new Be(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ci,wi);Ae[t]=new Be(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ae[e]=new Be(e,1,!1,e.toLowerCase(),null,!1,!1)});Ae.xlinkHref=new Be("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ae[e]=new Be(e,1,!1,e.toLowerCase(),null,!0,!0)});var Xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zo=["Webkit","ms","Moz","O"];Object.keys(Xt).forEach(function(e){Zo.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xt[t]=Xt[e]})});var Qo=/["'&<>]/;function Re(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=Qo.exec(e);if(t){var r="",i,n=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}n!==i&&(r+=e.substring(n,i)),n=i+1,r+=t}e=n!==i?r+e.substring(n,i):r}return e}var ea=/([A-Z])/g,ta=/^ms-/,Gr=Array.isArray,ra=re("<script>"),ia=re("<\/script>"),sa=re('<script src="'),na=re('<script type="module" src="'),ss=re('" async=""><\/script>'),oa=/(<\/|<)(s)(cript)/gi;function aa(e,t,r,i){return""+t+(r==="s"?"\\u0073":"\\u0053")+i}function ha(e,t,r,i,n){e=e===void 0?"":e,t=t===void 0?ra:re('<script nonce="'+Re(t)+'">');var o=[];if(r!==void 0&&o.push(t,pe((""+r).replace(oa,aa)),ia),i!==void 0)for(r=0;r<i.length;r++)o.push(sa,pe(Re(i[r])),ss);if(n!==void 0)for(i=0;i<n.length;i++)o.push(na,pe(Re(n[i])),ss);return{bootstrapChunks:o,startInlineScript:t,placeholderPrefix:re(e+"P:"),segmentPrefix:re(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Xe(e,t){return{insertionMode:e,selectedValue:t}}function la(e){return Xe(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function ca(e,t,r){switch(t){case"select":return Xe(1,r.value!=null?r.value:r.defaultValue);case"svg":return Xe(2,null);case"math":return Xe(3,null);case"foreignObject":return Xe(1,null);case"table":return Xe(4,null);case"thead":case"tbody":case"tfoot":return Xe(5,null);case"colgroup":return Xe(7,null);case"tr":return Xe(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Xe(1,null):e}var bi=re("<!-- -->");function ns(e,t,r,i){return t===""?i:(i&&e.push(bi),e.push(pe(Re(t))),!0)}var os=new Map,ua=re(' style="'),as=re(":"),da=re(";");function vn(e,t,r){if(typeof r!="object")throw Error(fe(62));t=!0;for(var i in r)if(Fe.call(r,i)){var n=r[i];if(n!=null&&typeof n!="boolean"&&n!==""){if(i.indexOf("--")===0){var o=pe(Re(i));n=pe(Re((""+n).trim()))}else{o=i;var p=os.get(o);p!==void 0||(p=re(Re(o.replace(ea,"-$1").toLowerCase().replace(ta,"-ms-"))),os.set(o,p)),o=p,n=typeof n=="number"?n===0||Fe.call(Xt,i)?pe(""+n):pe(n+"px"):pe(Re((""+n).trim()))}t?(t=!1,e.push(ua,o,as,n)):e.push(da,o,as,n)}}t||e.push(dt)}var rt=re(" "),vt=re('="'),dt=re('"'),hs=re('=""');function He(e,t,r,i){switch(r){case"style":vn(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(t=Ae.hasOwnProperty(r)?Ae[r]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(r=pe(t.attributeName),t.type){case 3:i&&e.push(rt,r,hs);break;case 4:i===!0?e.push(rt,r,hs):i!==!1&&e.push(rt,r,vt,pe(Re(i)),dt);break;case 5:isNaN(i)||e.push(rt,r,vt,pe(Re(i)),dt);break;case 6:!isNaN(i)&&1<=i&&e.push(rt,r,vt,pe(Re(i)),dt);break;default:t.sanitizeURL&&(i=""+i),e.push(rt,r,vt,pe(Re(i)),dt)}}else if(gn(r)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=r.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(rt,pe(r),vt,pe(Re(i)),dt)}}}var it=re(">"),ls=re("/>");function Jt(e,t,r){if(t!=null){if(r!=null)throw Error(fe(60));if(typeof t!="object"||!("__html"in t))throw Error(fe(61));t=t.__html,t!=null&&e.push(pe(""+t))}}function fa(e){var t="";return pn.Children.forEach(e,function(r){r!=null&&(t+=r)}),t}var Mr=re(' selected=""');function Br(e,t,r,i){e.push(Je(r));var n=r=null,o;for(o in t)if(Fe.call(t,o)){var p=t[o];if(p!=null)switch(o){case"children":r=p;break;case"dangerouslySetInnerHTML":n=p;break;default:He(e,i,o,p)}}return e.push(it),Jt(e,n,r),typeof r=="string"?(e.push(pe(Re(r))),null):r}var Or=re(`
`),pa=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,cs=new Map;function Je(e){var t=cs.get(e);if(t===void 0){if(!pa.test(e))throw Error(fe(65,e));t=re("<"+e),cs.set(e,t)}return t}var _a=re("<!DOCTYPE html>");function ma(e,t,r,i,n){switch(t){case"select":e.push(Je("select"));var o=null,p=null;for(_ in r)if(Fe.call(r,_)){var s=r[_];if(s!=null)switch(_){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;case"defaultValue":case"value":break;default:He(e,i,_,s)}}return e.push(it),Jt(e,p,o),o;case"option":p=n.selectedValue,e.push(Je("option"));var a=s=null,c=null,_=null;for(o in r)if(Fe.call(r,o)){var d=r[o];if(d!=null)switch(o){case"children":s=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":_=d;break;case"value":a=d;default:He(e,i,o,d)}}if(p!=null)if(r=a!==null?""+a:fa(s),Gr(p)){for(i=0;i<p.length;i++)if(""+p[i]===r){e.push(Mr);break}}else""+p===r&&e.push(Mr);else c&&e.push(Mr);return e.push(it),Jt(e,_,s),s;case"textarea":e.push(Je("textarea")),_=p=o=null;for(s in r)if(Fe.call(r,s)&&(a=r[s],a!=null))switch(s){case"children":_=a;break;case"value":o=a;break;case"defaultValue":p=a;break;case"dangerouslySetInnerHTML":throw Error(fe(91));default:He(e,i,s,a)}if(o===null&&p!==null&&(o=p),e.push(it),_!=null){if(o!=null)throw Error(fe(92));if(Gr(_)&&1<_.length)throw Error(fe(93));o=""+_}return typeof o=="string"&&o[0]===`
`&&e.push(Or),o!==null&&e.push(pe(Re(""+o))),null;case"input":e.push(Je("input")),a=_=s=o=null;for(p in r)if(Fe.call(r,p)&&(c=r[p],c!=null))switch(p){case"children":case"dangerouslySetInnerHTML":throw Error(fe(399,"input"));case"defaultChecked":a=c;break;case"defaultValue":s=c;break;case"checked":_=c;break;case"value":o=c;break;default:He(e,i,p,c)}return _!==null?He(e,i,"checked",_):a!==null&&He(e,i,"checked",a),o!==null?He(e,i,"value",o):s!==null&&He(e,i,"value",s),e.push(ls),null;case"menuitem":e.push(Je("menuitem"));for(var m in r)if(Fe.call(r,m)&&(o=r[m],o!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(fe(400));default:He(e,i,m,o)}return e.push(it),null;case"title":e.push(Je("title")),o=null;for(d in r)if(Fe.call(r,d)&&(p=r[d],p!=null))switch(d){case"children":o=p;break;case"dangerouslySetInnerHTML":throw Error(fe(434));default:He(e,i,d,p)}return e.push(it),o;case"listing":case"pre":e.push(Je(t)),p=o=null;for(a in r)if(Fe.call(r,a)&&(s=r[a],s!=null))switch(a){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;default:He(e,i,a,s)}if(e.push(it),p!=null){if(o!=null)throw Error(fe(60));if(typeof p!="object"||!("__html"in p))throw Error(fe(61));r=p.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?e.push(Or,pe(r)):e.push(pe(""+r)))}return typeof o=="string"&&o[0]===`
`&&e.push(Or),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(Je(t));for(var S in r)if(Fe.call(r,S)&&(o=r[S],o!=null))switch(S){case"children":case"dangerouslySetInnerHTML":throw Error(fe(399,t));default:He(e,i,S,o)}return e.push(ls),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Br(e,r,t,i);case"html":return n.insertionMode===0&&e.push(_a),Br(e,r,t,i);default:if(t.indexOf("-")===-1&&typeof r.is!="string")return Br(e,r,t,i);e.push(Je(t)),p=o=null;for(c in r)if(Fe.call(r,c)&&(s=r[c],s!=null))switch(c){case"children":o=s;break;case"dangerouslySetInnerHTML":p=s;break;case"style":vn(e,i,s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:gn(c)&&typeof s!="function"&&typeof s!="symbol"&&e.push(rt,pe(c),vt,pe(Re(s)),dt)}return e.push(it),Jt(e,p,o),o}}var ga=re("</"),va=re(">"),Sa=re('<template id="'),ya=re('"></template>'),Ca=re("<!--$-->"),wa=re('<!--$?--><template id="'),ba=re('"></template>'),xa=re("<!--$!-->"),Ea=re("<!--/$-->"),ka=re("<template"),Ra=re('"'),Ta=re(' data-dgst="');re(' data-msg="');re(' data-stck="');var Aa=re("></template>");function us(e,t,r){if(oe(e,wa),r===null)throw Error(fe(395));return oe(e,r),Ee(e,ba)}var Da=re('<div hidden id="'),Ia=re('">'),Pa=re("</div>"),La=re('<svg aria-hidden="true" style="display:none" id="'),Ma=re('">'),Ba=re("</svg>"),Oa=re('<math aria-hidden="true" style="display:none" id="'),Fa=re('">'),Ua=re("</math>"),Ha=re('<table hidden id="'),Na=re('">'),Wa=re("</table>"),$a=re('<table hidden><tbody id="'),ja=re('">'),za=re("</tbody></table>"),Ka=re('<table hidden><tr id="'),Va=re('">'),qa=re("</tr></table>"),Ga=re('<table hidden><colgroup id="'),Ya=re('">'),Xa=re("</colgroup></table>");function Ja(e,t,r,i){switch(r.insertionMode){case 0:case 1:return oe(e,Da),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Ia);case 2:return oe(e,La),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Ma);case 3:return oe(e,Oa),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Fa);case 4:return oe(e,Ha),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Na);case 5:return oe(e,$a),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,ja);case 6:return oe(e,Ka),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Va);case 7:return oe(e,Ga),oe(e,t.segmentPrefix),oe(e,pe(i.toString(16))),Ee(e,Ya);default:throw Error(fe(397))}}function Za(e,t){switch(t.insertionMode){case 0:case 1:return Ee(e,Pa);case 2:return Ee(e,Ba);case 3:return Ee(e,Ua);case 4:return Ee(e,Wa);case 5:return Ee(e,za);case 6:return Ee(e,qa);case 7:return Ee(e,Xa);default:throw Error(fe(397))}}var Qa=re('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),eh=re('$RS("'),th=re('","'),rh=re('")<\/script>'),ih=re('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),sh=re('$RC("'),nh=re('","'),oh=re('")<\/script>'),ah=re('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),hh=re('$RX("'),lh=re('"'),ch=re(")<\/script>"),Fr=re(","),uh=/[<\u2028\u2029]/g;function Ur(e){return JSON.stringify(e).replace(uh,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Pt=Object.assign,dh=Symbol.for("react.element"),Sn=Symbol.for("react.portal"),yn=Symbol.for("react.fragment"),Cn=Symbol.for("react.strict_mode"),wn=Symbol.for("react.profiler"),bn=Symbol.for("react.provider"),xn=Symbol.for("react.context"),En=Symbol.for("react.forward_ref"),kn=Symbol.for("react.suspense"),Rn=Symbol.for("react.suspense_list"),Tn=Symbol.for("react.memo"),xi=Symbol.for("react.lazy"),fh=Symbol.for("react.scope"),ph=Symbol.for("react.debug_trace_mode"),_h=Symbol.for("react.legacy_hidden"),mh=Symbol.for("react.default_value"),ds=Symbol.iterator;function Yr(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yn:return"Fragment";case Sn:return"Portal";case wn:return"Profiler";case Cn:return"StrictMode";case kn:return"Suspense";case Rn:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xn:return(e.displayName||"Context")+".Consumer";case bn:return(e._context.displayName||"Context")+".Provider";case En:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tn:return t=e.displayName||null,t!==null?t:Yr(e.type)||"Memo";case xi:t=e._payload,e=e._init;try{return Yr(e(t))}catch{}}return null}var An={};function fs(e,t){if(e=e.contextTypes,!e)return An;var r={},i;for(i in e)r[i]=t[i];return r}var mt=null;function Sr(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var r=t.parent;if(e===null){if(r!==null)throw Error(fe(401))}else{if(r===null)throw Error(fe(401));Sr(e,r)}t.context._currentValue=t.value}}function Dn(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&Dn(e)}function In(e){var t=e.parent;t!==null&&In(t),e.context._currentValue=e.value}function Pn(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(fe(402));e.depth===t.depth?Sr(e,t):Pn(e,t)}function Ln(e,t){var r=t.parent;if(r===null)throw Error(fe(402));e.depth===r.depth?Sr(e,r):Ln(e,r),t.context._currentValue=t.value}function ar(e){var t=mt;t!==e&&(t===null?In(e):e===null?Dn(t):t.depth===e.depth?Sr(t,e):t.depth>e.depth?Pn(t,e):Ln(t,e),mt=e)}var ps={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function _s(e,t,r,i){var n=e.state!==void 0?e.state:null;e.updater=ps,e.props=r,e.state=n;var o={queue:[],replace:!1};e._reactInternals=o;var p=t.contextType;if(e.context=typeof p=="object"&&p!==null?p._currentValue:i,p=t.getDerivedStateFromProps,typeof p=="function"&&(p=p(r,n),n=p==null?n:Pt({},n,p),e.state=n),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&ps.enqueueReplaceState(e,e.state,null),o.queue!==null&&0<o.queue.length)if(t=o.queue,p=o.replace,o.queue=null,o.replace=!1,p&&t.length===1)e.state=t[0];else{for(o=p?t[0]:e.state,n=!0,p=p?1:0;p<t.length;p++){var s=t[p];s=typeof s=="function"?s.call(e,o,r,i):s,s!=null&&(n?(n=!1,o=Pt({},o,s)):Pt(o,s))}e.state=o}else o.queue=null}var gh={id:1,overflow:""};function Xr(e,t,r){var i=e.id;e=e.overflow;var n=32-Zt(i)-1;i&=~(1<<n),r+=1;var o=32-Zt(t)+n;if(30<o){var p=n-n%5;return o=(i&(1<<p)-1).toString(32),i>>=p,n-=p,{id:1<<32-Zt(t)+n|r<<n|i,overflow:o+e}}return{id:1<<o|r<<n|i,overflow:e}}var Zt=Math.clz32?Math.clz32:yh,vh=Math.log,Sh=Math.LN2;function yh(e){return e>>>=0,e===0?32:31-(vh(e)/Sh|0)|0}function Ch(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wh=typeof Object.is=="function"?Object.is:Ch,et=null,Ei=null,Qt=null,xe=null,At=!1,hr=!1,Ot=0,ot=null,yr=0;function ft(){if(et===null)throw Error(fe(321));return et}function ms(){if(0<yr)throw Error(fe(312));return{memoizedState:null,queue:null,next:null}}function ki(){return xe===null?Qt===null?(At=!1,Qt=xe=ms()):(At=!0,xe=Qt):xe.next===null?(At=!1,xe=xe.next=ms()):(At=!0,xe=xe.next),xe}function Ri(){Ei=et=null,hr=!1,Qt=null,yr=0,xe=ot=null}function Mn(e,t){return typeof t=="function"?t(e):t}function gs(e,t,r){if(et=ft(),xe=ki(),At){var i=xe.queue;if(t=i.dispatch,ot!==null&&(r=ot.get(i),r!==void 0)){ot.delete(i),i=xe.memoizedState;do i=e(i,r.action),r=r.next;while(r!==null);return xe.memoizedState=i,[i,t]}return[xe.memoizedState,t]}return e=e===Mn?typeof t=="function"?t():t:r!==void 0?r(t):t,xe.memoizedState=e,e=xe.queue={last:null,dispatch:null},e=e.dispatch=bh.bind(null,et,e),[xe.memoizedState,e]}function vs(e,t){if(et=ft(),xe=ki(),t=t===void 0?null:t,xe!==null){var r=xe.memoizedState;if(r!==null&&t!==null){var i=r[1];e:if(i===null)i=!1;else{for(var n=0;n<i.length&&n<t.length;n++)if(!wh(t[n],i[n])){i=!1;break e}i=!0}if(i)return r[0]}}return e=e(),xe.memoizedState=[e,t],e}function bh(e,t,r){if(25<=yr)throw Error(fe(301));if(e===et)if(hr=!0,e={action:r,next:null},ot===null&&(ot=new Map),r=ot.get(t),r===void 0)ot.set(t,e);else{for(t=r;t.next!==null;)t=t.next;t.next=e}}function xh(){throw Error(fe(394))}function $t(){}var Ss={readContext:function(e){return e._currentValue},useContext:function(e){return ft(),e._currentValue},useMemo:vs,useReducer:gs,useRef:function(e){et=ft(),xe=ki();var t=xe.memoizedState;return t===null?(e={current:e},xe.memoizedState=e):t},useState:function(e){return gs(Mn,e)},useInsertionEffect:$t,useLayoutEffect:function(){},useCallback:function(e,t){return vs(function(){return e},t)},useImperativeHandle:$t,useEffect:$t,useDebugValue:$t,useDeferredValue:function(e){return ft(),e},useTransition:function(){return ft(),[!1,xh]},useId:function(){var e=Ei.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Zt(e)-1)).toString(32)+t;var r=er;if(r===null)throw Error(fe(404));return t=Ot++,e=":"+r.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return ft(),t(e._source)},useSyncExternalStore:function(e,t,r){if(r===void 0)throw Error(fe(407));return r()}},er=null,Hr=pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Eh(e){return console.error(e),null}function Dt(){}function kh(e,t,r,i,n,o,p,s,a){var c=[],_=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:_,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:n===void 0?Eh:n,onAllReady:o===void 0?Dt:o,onShellReady:p===void 0?Dt:p,onShellError:s===void 0?Dt:s,onFatalError:a===void 0?Dt:a},r=lr(t,0,null,r,!1,!1),r.parentFlushed=!0,e=Ti(t,e,null,r,_,An,null,gh),c.push(e),t}function Ti(e,t,r,i,n,o,p,s){e.allPendingTasks++,r===null?e.pendingRootTasks++:r.pendingTasks++;var a={node:t,ping:function(){var c=e.pingedTasks;c.push(a),c.length===1&&Fn(e)},blockedBoundary:r,blockedSegment:i,abortSet:n,legacyContext:o,context:p,treeContext:s};return n.add(a),a}function lr(e,t,r,i,n,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:r,lastPushedText:n,textEmbedded:o}}function Ft(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function cr(e,t){var r=e.onShellError;r(t),r=e.onFatalError,r(t),e.destination!==null?(e.status=2,mn(e.destination,t)):(e.status=1,e.fatalError=t)}function ys(e,t,r,i,n){for(et={},Ei=t,Ot=0,e=r(i,n);hr;)hr=!1,Ot=0,yr+=1,xe=null,e=r(i,n);return Ri(),e}function Cs(e,t,r,i){var n=r.render(),o=i.childContextTypes;if(o!=null){var p=t.legacyContext;if(typeof r.getChildContext!="function")i=p;else{r=r.getChildContext();for(var s in r)if(!(s in o))throw Error(fe(108,Yr(i)||"Unknown",s));i=Pt({},p,r)}t.legacyContext=i,je(e,t,n),t.legacyContext=p}else je(e,t,n)}function ws(e,t){if(e&&e.defaultProps){t=Pt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Jr(e,t,r,i,n){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){n=fs(r,t.legacyContext);var o=r.contextType;o=new r(i,typeof o=="object"&&o!==null?o._currentValue:n),_s(o,r,i,n),Cs(e,t,o,r)}else{o=fs(r,t.legacyContext),n=ys(e,t,r,i,o);var p=Ot!==0;if(typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0)_s(n,r,i,o),Cs(e,t,n,r);else if(p){i=t.treeContext,t.treeContext=Xr(i,1,0);try{je(e,t,n)}finally{t.treeContext=i}}else je(e,t,n)}else if(typeof r=="string"){switch(n=t.blockedSegment,o=ma(n.chunks,r,i,e.responseState,n.formatContext),n.lastPushedText=!1,p=n.formatContext,n.formatContext=ca(p,r,i),Zr(e,t,o),n.formatContext=p,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:n.chunks.push(ga,pe(r),va)}n.lastPushedText=!1}else{switch(r){case _h:case ph:case Cn:case wn:case yn:je(e,t,i.children);return;case Rn:je(e,t,i.children);return;case fh:throw Error(fe(343));case kn:e:{r=t.blockedBoundary,n=t.blockedSegment,o=i.fallback,i=i.children,p=new Set;var s={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:p,errorDigest:null},a=lr(e,n.chunks.length,s,n.formatContext,!1,!1);n.children.push(a),n.lastPushedText=!1;var c=lr(e,0,null,n.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=s,t.blockedSegment=c;try{if(Zr(e,t,i),c.lastPushedText&&c.textEmbedded&&c.chunks.push(bi),c.status=1,ur(s,c),s.pendingTasks===0)break e}catch(_){c.status=4,s.forceClientRender=!0,s.errorDigest=Ft(e,_)}finally{t.blockedBoundary=r,t.blockedSegment=n}t=Ti(e,o,r,a,p,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case En:if(i=ys(e,t,r.render,i,n),Ot!==0){r=t.treeContext,t.treeContext=Xr(r,1,0);try{je(e,t,i)}finally{t.treeContext=r}}else je(e,t,i);return;case Tn:r=r.type,i=ws(r,i),Jr(e,t,r,i,n);return;case bn:if(n=i.children,r=r._context,i=i.value,o=r._currentValue,r._currentValue=i,p=mt,mt=i={parent:p,depth:p===null?0:p.depth+1,context:r,parentValue:o,value:i},t.context=i,je(e,t,n),e=mt,e===null)throw Error(fe(403));i=e.parentValue,e.context._currentValue=i===mh?e.context._defaultValue:i,e=mt=e.parent,t.context=e;return;case xn:i=i.children,i=i(r._currentValue),je(e,t,i);return;case xi:n=r._init,r=n(r._payload),i=ws(r,i),Jr(e,t,r,i,void 0);return}throw Error(fe(130,r==null?r:typeof r,""))}}function je(e,t,r){if(t.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case dh:Jr(e,t,r.type,r.props,r.ref);return;case Sn:throw Error(fe(257));case xi:var i=r._init;r=i(r._payload),je(e,t,r);return}if(Gr(r)){bs(e,t,r);return}if(r===null||typeof r!="object"?i=null:(i=ds&&r[ds]||r["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(r))){if(r=i.next(),!r.done){var n=[];do n.push(r.value),r=i.next();while(!r.done);bs(e,t,n)}return}throw e=Object.prototype.toString.call(r),Error(fe(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}typeof r=="string"?(i=t.blockedSegment,i.lastPushedText=ns(t.blockedSegment.chunks,r,e.responseState,i.lastPushedText)):typeof r=="number"&&(i=t.blockedSegment,i.lastPushedText=ns(t.blockedSegment.chunks,""+r,e.responseState,i.lastPushedText))}function bs(e,t,r){for(var i=r.length,n=0;n<i;n++){var o=t.treeContext;t.treeContext=Xr(o,i,n);try{Zr(e,t,r[n])}finally{t.treeContext=o}}}function Zr(e,t,r){var i=t.blockedSegment.formatContext,n=t.legacyContext,o=t.context;try{return je(e,t,r)}catch(a){if(Ri(),typeof a=="object"&&a!==null&&typeof a.then=="function"){r=a;var p=t.blockedSegment,s=lr(e,p.chunks.length,null,p.formatContext,p.lastPushedText,!0);p.children.push(s),p.lastPushedText=!1,e=Ti(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,r.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=n,t.context=o,ar(o)}else throw t.blockedSegment.formatContext=i,t.legacyContext=n,t.context=o,ar(o),a}}function Rh(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,On(this,t,e)}function Bn(e,t,r){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=r===void 0?Error(fe(432)):r,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(n){return Bn(n,t,r)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function ur(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var r=t.children[0];r.id=t.id,r.parentFlushed=!0,r.status===1&&ur(e,r)}else e.completedSegments.push(t)}function On(e,t,r){if(t===null){if(r.parentFlushed){if(e.completedRootSegment!==null)throw Error(fe(389));e.completedRootSegment=r}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Dt,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(r.parentFlushed&&r.status===1&&ur(t,r),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Rh,e),t.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(ur(t,r),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function Fn(e){if(e.status!==2){var t=mt,r=Hr.current;Hr.current=Ss;var i=er;er=e.responseState;try{var n=e.pingedTasks,o;for(o=0;o<n.length;o++){var p=n[o],s=e,a=p.blockedSegment;if(a.status===0){ar(p.context);try{je(s,p,p.node),a.lastPushedText&&a.textEmbedded&&a.chunks.push(bi),p.abortSet.delete(p),a.status=1,On(s,p.blockedBoundary,a)}catch(b){if(Ri(),typeof b=="object"&&b!==null&&typeof b.then=="function"){var c=p.ping;b.then(c,c)}else{p.abortSet.delete(p),a.status=4;var _=p.blockedBoundary,d=b,m=Ft(s,d);if(_===null?cr(s,d):(_.pendingTasks--,_.forceClientRender||(_.forceClientRender=!0,_.errorDigest=m,_.parentFlushed&&s.clientRenderedBoundaries.push(_))),s.allPendingTasks--,s.allPendingTasks===0){var S=s.onAllReady;S()}}}finally{}}}n.splice(0,o),e.destination!==null&&Ai(e,e.destination)}catch(b){Ft(e,b),cr(e,b)}finally{er=i,Hr.current=r,r===Ss&&ar(t)}}}function jt(e,t,r){switch(r.parentFlushed=!0,r.status){case 0:var i=r.id=e.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,e=e.responseState,oe(t,Sa),oe(t,e.placeholderPrefix),e=pe(i.toString(16)),oe(t,e),Ee(t,ya);case 1:r.status=2;var n=!0;i=r.chunks;var o=0;r=r.children;for(var p=0;p<r.length;p++){for(n=r[p];o<n.index;o++)oe(t,i[o]);n=Cr(e,t,n)}for(;o<i.length-1;o++)oe(t,i[o]);return o<i.length&&(n=Ee(t,i[o])),n;default:throw Error(fe(390))}}function Cr(e,t,r){var i=r.boundary;if(i===null)return jt(e,t,r);if(i.parentFlushed=!0,i.forceClientRender)i=i.errorDigest,Ee(t,xa),oe(t,ka),i&&(oe(t,Ta),oe(t,pe(Re(i))),oe(t,Ra)),Ee(t,Aa),jt(e,t,r);else if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var n=e.responseState,o=n.nextSuspenseID++;n=re(n.boundaryPrefix+o.toString(16)),i=i.id=n,us(t,e.responseState,i),jt(e,t,r)}else if(i.byteSize>e.progressiveChunkSize)i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),us(t,e.responseState,i.id),jt(e,t,r);else{if(Ee(t,Ca),r=i.completedSegments,r.length!==1)throw Error(fe(391));Cr(e,t,r[0])}return Ee(t,Ea)}function xs(e,t,r){return Ja(t,e.responseState,r.formatContext,r.id),Cr(e,t,r),Za(t,r.formatContext)}function Es(e,t,r){for(var i=r.completedSegments,n=0;n<i.length;n++)Un(e,t,r,i[n]);if(i.length=0,e=e.responseState,i=r.id,r=r.rootSegmentID,oe(t,e.startInlineScript),e.sentCompleteBoundaryFunction?oe(t,sh):(e.sentCompleteBoundaryFunction=!0,oe(t,ih)),i===null)throw Error(fe(395));return r=pe(r.toString(16)),oe(t,i),oe(t,nh),oe(t,e.segmentPrefix),oe(t,r),Ee(t,oh)}function Un(e,t,r,i){if(i.status===2)return!0;var n=i.id;if(n===-1){if((i.id=r.rootSegmentID)===-1)throw Error(fe(392));return xs(e,t,i)}return xs(e,t,i),e=e.responseState,oe(t,e.startInlineScript),e.sentCompleteSegmentFunction?oe(t,eh):(e.sentCompleteSegmentFunction=!0,oe(t,Qa)),oe(t,e.segmentPrefix),n=pe(n.toString(16)),oe(t,n),oe(t,th),oe(t,e.placeholderPrefix),oe(t,n),Ee(t,rh)}function Ai(e,t){We=new Uint8Array(512),$e=0;try{var r=e.completedRootSegment;if(r!==null&&e.pendingRootTasks===0){Cr(e,t,r),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(r=0;r<i.length-1;r++)oe(t,i[r]);r<i.length&&Ee(t,i[r])}var n=e.clientRenderedBoundaries,o;for(o=0;o<n.length;o++){var p=n[o];i=t;var s=e.responseState,a=p.id,c=p.errorDigest,_=p.errorMessage,d=p.errorComponentStack;if(oe(i,s.startInlineScript),s.sentClientRenderFunction?oe(i,hh):(s.sentClientRenderFunction=!0,oe(i,ah)),a===null)throw Error(fe(395));oe(i,a),oe(i,lh),(c||_||d)&&(oe(i,Fr),oe(i,pe(Ur(c||"")))),(_||d)&&(oe(i,Fr),oe(i,pe(Ur(_||"")))),d&&(oe(i,Fr),oe(i,pe(Ur(d)))),Ee(i,ch)}n.splice(0,o);var m=e.completedBoundaries;for(o=0;o<m.length;o++)Es(e,t,m[o]);m.splice(0,o),ts(t),We=new Uint8Array(512),$e=0;var S=e.partialBoundaries;for(o=0;o<S.length;o++){var b=S[o];e:{n=e,p=t;var v=b.completedSegments;for(s=0;s<v.length;s++)if(!Un(n,p,b,v[s])){s++,v.splice(0,s);var l=!1;break e}v.splice(0,s),l=!0}if(!l){e.destination=null,o++,S.splice(0,o);return}}S.splice(0,o);var f=e.completedBoundaries;for(o=0;o<f.length;o++)Es(e,t,f[o]);f.splice(0,o)}finally{ts(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function ks(e,t){try{var r=e.abortableTasks;r.forEach(function(i){return Bn(i,e,t)}),r.clear(),e.destination!==null&&Ai(e,e.destination)}catch(i){Ft(e,i),cr(e,i)}}yi.renderToReadableStream=function(e,t){return new Promise(function(r,i){var n,o,p=new Promise(function(_,d){o=_,n=d}),s=kh(e,ha(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),la(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,o,function(){var _=new ReadableStream({type:"bytes",pull:function(d){if(s.status===1)s.status=2,mn(d,s.fatalError);else if(s.status!==2&&s.destination===null){s.destination=d;try{Ai(s,d)}catch(m){Ft(s,m),cr(s,m)}}},cancel:function(){ks(s)}},{highWaterMark:0});_.allReady=p,r(_)},function(_){p.catch(function(){}),i(_)},n);if(t&&t.signal){var a=t.signal,c=function(){ks(s,a.reason),a.removeEventListener("abort",c)};a.addEventListener("abort",c)}Fn(s)})};yi.version="18.3.1";var wt,Hn;wt=Ct,Hn=yi;ht.version=wt.version;ht.renderToString=wt.renderToString;ht.renderToStaticMarkup=wt.renderToStaticMarkup;ht.renderToNodeStream=wt.renderToNodeStream;ht.renderToStaticNodeStream=wt.renderToStaticNodeStream;ht.renderToReadableStream=Hn.renderToReadableStream;const _r=class _r{static getPhrase(t){const r=this.phrases.find(i=>i.name==t);return r?r.phrase:this.phrases[0].phrase}static getPhraseByIndex(t){return t>=0&&t<this.phrases.length?this.phrases[t].phrase:t<0?this.phrases[0].phrase:t>=this.phrases.length?this.phrases[this.phrases.length-1].phrase:this.phrases[0].phrase}static getPhraseNames(){return _r.phrases.map(t=>t.name)}static getRandomPhrase(){const t=this.phrases.length,r=Math.floor(Math.random()*t);return this.phrases[r].phrase}};J(_r,"phrases",[{name:"asd",phrase:"asdf"},{name:"asd2",phrase:"asdf sad dad daf fas fad das dad sas"},{name:"jkl",phrase:"jill"},{name:"jkl2",phrase:"jill kill jelly lilly jolly jill"},{name:"hello",phrase:"Hello, World!"},{name:"pack",phrase:"Pack my box with five dozen liquor jugs."},{name:"sphinx",phrase:"Sphinx of black quartz, judge my vow."},{name:"waltz",phrase:"Waltz, bad nymph, for quick jigs vex."},{name:"list",phrase:"List.map(fun i -> i + 1)[1;2;3]"},{name:"mr",phrase:"Mr. Jock, TV quiz PhD., bags few lynx."},{name:"watch",phrase:`Watch "Jeopardy!", Alex Trebek's fun TV`},{name:"h1",phrase:"Type anywhere with this one-handed keyboard. Stop sitting down to type. Stop looking down to send messages."},{name:"h2",phrase:"Built to the shape of your finger actions, this device will eliminate your need to reposition your fingers while typeing."},{name:"h3",phrase:"Use the same keyboard, designed for your hand, everywhere. You never have to learn a new one. The natural motions of your fingers compose the characters."},{name:"h4",phrase:"It's built around your hand, so you don't have to reorient your finger placement on a board. Repositioning your fingers on a board is the biggest hurdle of typing-training, so don't do it."},{name:"h5",phrase:"Handex is built around your finger movements, so you'll never have to reposition your fingers to find a key. Even unusual keys, such `\\`, `~`, `|`, `^`, `&` are easy to type."},{name:"h6",phrase:"Handex liberates you from the key-board-shackle problem. 151 keys are currently available and more are coming."},{name:"k=7",phrase:`k=7; l=8; m=$((k + l)); n=$((k > l ? k : l)); echo "Max: $n"; grep 'Max' <<< "Max: $n" || echo "No match found" > /dev/null; echo "Sum: $(($m))"`},{name:"x=4",phrase:`x=4; y=$((x + 5)); z=$((x > 5 ? x : 5)); echo "Max: $z"; grep 'Max' <<< "Max: $z" || echo "No match found" > /dev/null; echo "Sum: $(($y))"`},{name:"arr",phrase:'arr=(1 2 3); sum=0; for i in "${arr[@]}"; do sum=$(($sum + i)); done; echo "Sum: $sum"; [[ $sum -lt 10 ]] && echo "$sum < 10" || echo "$sum >= 10"'},{name:"f()",phrase:'f() { return $(($1 & $2)); }; f 4 5; echo "Bitwise AND: $?"'},{name:"a=5",phrase:'a=5; b=3; c=$((a / b)); d=$((a - b)); echo $c $d; [ $a -gt $b ] && echo "$a>$b" || echo "$a<$b"; e=$(($a % $b)); echo "Result: $e"'}]);let pt=_r;class Th{constructor(t){J(this,"preview");J(this,"toggleVideo",t=>{t?navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(r=>this.preview.srcObject=r):(console.log("this.preview.srcObject:",this.preview.srcObject,"setOn:",t),this.preview.srcObject&&(this.preview.srcObject.getTracks().forEach(i=>i.stop()),this.preview.srcObject=null),this.preview.srcObject=null),this.preview.hidden=!t});this.preview=t,this.preview.autoplay=!0,this.preview.muted=!0,this.preview.setAttribute("playsinline",""),this.preview.setAttribute("webkit-playsinline",""),this.preview.setAttribute("x5-playsinline","")}}const dr=ke.createContext(null),Ah=[{prompt:"The most important key is the Return (ENTER) key. Press the thumb tip and release. You'll use this key to enter every command.",phrase:["Return (ENTER)"],unlocked:!1},{prompt:"Type `fdsa` & Enter. Notice that it requires finger-pinch only.",phrase:"fdsa".split(""),unlocked:!1},{prompt:"Type `jkl;`. Notice that it requires finger-grasp only.",phrase:"jkl;".split(""),unlocked:!1},{prompt:"Press the thumb tip followed by a finger tip to type numbers 1-4",phrase:"1234".split(""),unlocked:!1},{prompt:"Many characters require combinations followed by releasing all keys. Type `zxcv` and we'll show corrections as you type.",phrase:"zxcv".split(""),unlocked:!1}];function Rs(e){if(!Array.isArray(e.achievement.phrase))throw new Error("achievement is undefined");const t=new st(e.achievement.phrase).chords;if(t.length===0)throw new Error("achievement is undefined");return ne.jsxs("div",{className:"tutorial-component",hidden:!e.isInTutorial,children:[ne.jsx("pre",{className:"tutorial-prompt",children:e.achievement.prompt}),ne.jsx("div",{className:"chord-display-container",children:t.map((r,i)=>ne.jsx(ci,{displayChar:[r.key]},i))})]})}const Lt=class Lt extends ke.Component{constructor(r){super(r);J(this,"terminalElementRef",ke.createRef());J(this,"adapterRef",ke.createRef());J(this,"nextCharsDisplayRef",ke.createRef());J(this,"terminalGameRef",ke.createRef());J(this,"_persistence");J(this,"_commandHistory",[]);J(this,"wpmCalculator",new Zn);J(this,"videoElementRef",ke.createRef());J(this,"webCam",null);J(this,"isDebug",!1);J(this,"heroRunTimeoutId",null);J(this,"heroSummersaultTimeoutId",null);J(this,"lastTouchDistance",null);J(this,"currentFontSize",17);J(this,"isShowVideo");J(this,"outputRef",ke.createRef());J(this,"inLoginProcess",!1);J(this,"tempUserName","");J(this,"tempPassword","");J(this,"tempNewPassword","");J(this,"isInChangePasswordMode",!1);J(this,"handleLogin",async(r,i)=>{try{await this.props.auth.login(r,i,(n,o)=>{n&&console.error("Login failed",n),console.log("Login successful",JSON.stringify(o))}),console.log("Login successful")}catch(n){console.error("Login failed",n)}});J(this,"handleCommand",r=>{var a,c,_,d;this.setState(m=>({commandHistory:[r,...m.commandHistory],currentCommandIndex:-1}),()=>this.saveCommandHistory(this.state.commandHistory)),this.state.isInTutorial&&(r===""&&(r="Return (ENTER)"),((a=this.state.nextAchievement)==null?void 0:a.phrase.join(""))===r&&this.unlockAchievement(r));const{command:i,args:n,switches:o}=this.parseCommand(r);if(this.context&&this.context.executeCommand(i,n,o).status===200)return;let p=404,s="Command not found.";if((c=this.terminalGameRef.current)==null||c.resetGame(),this.scrollToBottom(),this.state.isInPhraseMode&&(s=""),this.setState({isInPhraseMode:!1,commandLine:""}),(i==="help"||i==="411")&&(p=200,s="<div class='chord-display-container'>"+["UpArrow","LeftArrow","DownArrow","RightArrow"].map(b=>ne.jsx(ci,{displayChar:[b]})).map(b=>ht.renderToStaticMarkup(b)).join("")+"</div>"),i==="kill"){if(!this.terminalGameRef.current)return;this.terminalGameRef.current.setZombie4ToDeathThenResetPosition(),this.terminalGameRef.current.completeGame(),s="Killed zombie 4. Reset position and game completed.",p=200}if(i==="profile"){const m=this.props.auth.getCurrentUser();s="Is logged in: "+JSON.stringify(m),console.log("profile",this.props.auth.isLoggedIn)}if(i==="signup"){s="Signing up...";const m=r.split(" ");this.props.auth.signUp(m[1],m[2],m[3],(S,b)=>{S?(console.error(S),s="Error signing up."+b,p=500):(s="Sign up successful!"+b,p=200)})}if(i==="login"){s="Logging in...";const m=r.split(" ");this.inLoginProcess=!0,this.tempUserName=m[1]}if(i.startsWith("level")){if(!this.terminalGameRef.current)return;let m=i.match(/\d+/);const S=m&&m.length?parseInt(m[0]):null;(_=this.terminalGameRef.current)==null||_.levelUp(S)}if((i==="play"||i.startsWith("play "))&&(p=200,s="Type the phrase as fast as you can.",this.setNewPhrase(i)),(i==="phrase"||i.startsWith("phrase "))&&(p=200,s="Type the phrase as fast as you can.",this.setNewPhrase(i)),i.startsWith("video")&&(p=200,this.toggleVideo()?s="Starting video camera...":s="Stopping video camera..."),this.nextCharsDisplayRef.current&&this.nextCharsDisplayRef.current.cancelTimer(),this.state.isInPhraseMode&&this.setState({isInPhraseMode:!1}),(d=this.adapterRef.current)==null||d.prompt(),i!==""){if(i.startsWith("debug")){let m=i.includes("--true")||i.includes("-t");this.toggleIsDebug(m);return}this._commandHistory.length>Lt.commandHistoryLimit&&this._commandHistory.shift(),this.saveCommandResponseHistory(i,s,p)}});J(this,"handleCharacter",r=>{var n,o,p,s;const i=this.wpmCalculator.addKeystroke(r);if(this.inLoginProcess)if(r==="\r")this.props.auth.login(this.tempUserName,this.tempPassword,(a,c)=>{a?console.error(a):this.terminalWrite("Login successful!"+JSON.stringify(c)),this.inLoginProcess=!1,this.tempPassword="",this.tempUserName="",this.terminalReset()});else{this.tempPassword+=r,this.terminalWrite("*");return}if(this.isInChangePasswordMode)if(r==="\r")this.props.auth.changePassword(this.tempPassword,this.tempNewPassword,(a,c)=>{a?console.error(a):this.terminalWrite("Password changed successfully!"+c),this.isInChangePasswordMode=!1,this.terminalReset()});else{this.tempPassword+=r,this.terminalWrite("*");return}if(r.charCodeAt(0)===3&&(this.setState({isInPhraseMode:!1,commandLine:""}),(n=this.adapterRef.current)==null||n.terminalReset(),(o=this.adapterRef.current)==null||o.prompt()),r==="ArrowUp"){let a=(this.state.currentCommandIndex+1)%this.state.commandHistory.length,c=this.state.commandHistory[a];const _=this.getCommandResponseHistory().reverse();this.setState({currentCommandIndex:a,commandLine:c,outputElements:[_[a]]}),this.terminalReset(),this.terminalPrompt(),this.terminalWrite(c);return}if(r.charCodeAt(0)===4&&(console.log("Ctrl+D pressed"),this.increaseFontSize()),r.charCodeAt(0)===13){let a=((p=this.adapterRef.current)==null?void 0:p.getCurrentCommand())??"";this.terminalReset(),this.handleCommand(a)}else if(this.state.isInPhraseMode){this.terminalWrite(r);let a=((s=this.adapterRef.current)==null?void 0:s.getCurrentCommand())+r;if(a.length===0){this.nextCharsDisplayRef.current&&this.nextCharsDisplayRef.current.resetTimer();return}this.setState({commandLine:a}),[",",".","!","?"].includes(r)||/[0-9]/.test(r)?this.setHeroSummersaultAction():this.setHeroRunAction()}else this.terminalWrite(r),[",",".","!","?"].includes(r)||/[0-9]/.test(r)?this.setHeroSummersaultAction():this.setHeroRunAction();return i.durationMilliseconds});J(this,"unlockAchievement",r=>{this.setState(i=>{var p;const n=i.unlockedAchievements;((p=this.state.nextAchievement)==null?void 0:p.phrase.join(""))===r&&this.saveAchievements(r);const o=this.getNextAchievement();return{...i,achievements:n,nextAchievement:o,isInTutorial:!!o}})});J(this,"handlePhraseSuccess",r=>{var n,o,p,s;let i=this.wpmCalculator.getWPMs().wpmAverage.toString(10)+":"+r;this.setState(a=>({outputElements:[...a.outputElements,i]})),this.saveCommandResponseHistory("game",i,200),(n=this.terminalGameRef.current)==null||n.completeGame(),(o=this.adapterRef.current)==null||o.terminalReset(),(p=this.adapterRef.current)==null||p.prompt(),(s=this.terminalGameRef.current)==null||s.levelUp(),this.handlePhraseComplete()});J(this,"handlePhraseComplete",()=>{var n;let r=(this.state.phraseIndex+1)%pt.phrases.length,i=pt.getPhraseByIndex(r);this.setState({phraseIndex:r,isInPhraseMode:!0,phrase:i}),(n=this.terminalGameRef.current)==null||n.completeGame()});J(this,"setNewPhrase",r=>{r=r.replace("phrase ","");const i=r&&r!=""&&pt.getPhrase(r)?pt.getPhrase(r):pt.getPhraseByIndex(this.state.phraseIndex);this.setState(n=>({...n,isInPhraseMode:!0,phrase:i,commandLine:i}))});J(this,"setHeroRunAction",()=>{this.heroRunTimeoutId&&(clearTimeout(this.heroRunTimeoutId),this.heroRunTimeoutId=null),this.setState({heroAction:"Run"}),this.heroRunTimeoutId=window.setTimeout(()=>{this.setState({heroAction:"Idle"}),this.heroRunTimeoutId=null},800)});J(this,"setHeroSummersaultAction",()=>{this.heroSummersaultTimeoutId&&(clearTimeout(this.heroSummersaultTimeoutId),this.heroSummersaultTimeoutId=null),this.setState({heroAction:"Summersault"}),this.heroSummersaultTimeoutId=window.setTimeout(()=>{this.setState({heroAction:"Idle"}),this.heroSummersaultTimeoutId=null},800)});J(this,"setHeroAction",r=>{this.setState({heroAction:r})});J(this,"setZombie4Action",r=>{this.setState({zombie4Action:r})});J(this,"handleTouchStart",r=>{setTimeout(()=>{},500),r.touches.length===2&&(this.lastTouchDistance=this.getDistanceBetweenTouches(r.touches))});J(this,"handleTouchMove",r=>{if(r.touches.length===2){r.preventDefault();const i=this.getDistanceBetweenTouches(r.touches);if(this.lastTouchDistance&&this.lastTouchDistance>0){const n=r.target,o=i/this.lastTouchDistance;if(n&&n.nodeName==="CANVAS"){this.setState(p=>({canvasHeight:p.canvasHeight*o}));return}this.currentFontSize*=o,document.documentElement.style.setProperty("--terminal-font-size",`${this.currentFontSize}pt`),this.lastTouchDistance=i}}});J(this,"handleTouchEnd",()=>{localStorage.setItem("terminalFontSize",`${this.currentFontSize}`),console.log("SET terminalFontSize",this.currentFontSize),this.lastTouchDistance=null});J(this,"toggleVideo",()=>{var r;return this.isShowVideo=!this.isShowVideo,(r=this.webCam)==null||r.toggleVideo(this.isShowVideo),this.isShowVideo});this._persistence=new Qn;const i=localStorage.getItem("canvasHeight")||"100",n=this.getNextAchievement();this.state={outputElements:this.getCommandResponseHistory().slice(-1),isInPhraseMode:!1,phrase:"",phraseIndex:0,isActive:!1,commandLine:"",heroAction:"Idle",zombie4Action:"Walk",terminalSize:void 0,terminalFontSize:17,canvasHeight:parseInt(i),unlockedAchievements:this.loadAchievements(),nextAchievement:n,isInTutorial:!0,commandHistory:this.loadCommandHistory(),currentCommandIndex:-1},this.loadDebugValue(),this.loadFontSize()}loadAchievements(){const r=localStorage.getItem("achievements");return r?JSON.parse(r):[]}saveAchievements(r){const i=localStorage.getItem("achievements")||"";let n=i?JSON.parse(i):[];n.push(r),localStorage.setItem("achievements",JSON.stringify(n))}getNextAchievement(){const r=this.loadAchievements()||[];return Ah.find(n=>!r.some(o=>o===n.phrase.join("")))||null}focusTerminal(){this.adapterRef.current&&this.adapterRef.current.focusTerminal()}componentDidUpdate(r,i,n){}loadCommandHistory(){return JSON.parse(localStorage.getItem("commandHistory")||"[]")}saveCommandHistory(r){localStorage.setItem("commandHistory",JSON.stringify(r))}scrollToBottom(){this.adapterRef.current&&this.adapterRef.current.scrollBottom()}componentDidMount(){if(this.adapterRef.current){const r=this.adapterRef.current.getTerminalSize();r&&this.setState({terminalSize:r})}this.scrollToBottom(),this.videoElementRef.current&&(this.webCam=new Th(this.videoElementRef.current)),this.addTouchListeners()}componentWillUnmount(){this.heroRunTimeoutId&&clearTimeout(this.heroRunTimeoutId),this.removeTouchListeners()}parseCommand(r){const i=r.split(/\s+/),n=i.shift(),o=[],p={};if(n)for(const s of i)if(s.startsWith("--")){const a=s.substring(2);p[a]=!0}else o.push(s);return{command:n||"",args:o,switches:p}}getCommandResponseHistory(){var n;let r=[],i=[];for(let o=0;o<localStorage.length;o++){if(!((n=localStorage.key(o))!=null&&n.startsWith(kt.Command+"_")))continue;const p=localStorage.key(o);p&&r.push(p)}r.sort();for(let o of r){const p=localStorage.getItem(o);p&&i.push(p)}return i}WpmsToHTML(r,i){return i=i??"slowest-characters",ne.jsx("table",{className:"wpm-table",children:ne.jsxs("tbody",{children:[ne.jsx("tr",{children:ne.jsx("th",{colSpan:2,children:i})}),r.map((n,o)=>ne.jsx(ke.Fragment,{children:ne.jsxs("tr",{id:i,className:"wpm-table-row",children:[ne.jsx("td",{children:n.character.replace("\r","\\r").replace(" ","\\s")}),ne.jsx("td",{className:"number",children:n.wpm.toFixed(2)})]})},o))]})})}averageWpmByCharacter(r){const i={};return r.forEach(({character:n,wpm:o})=>{i[n]||(i[n]={totalWpm:0,count:0}),i[n].totalWpm+=o,i[n].count++}),Object.entries(i).map(([n,{totalWpm:o,count:p}])=>({character:n,wpm:o/p,durationMilliseconds:0}))}saveCommandResponseHistory(r,i,n){const o=new Date,p=this.createTimeCode(o).join(":");let s=this.createCommandRecord(r,o);const a=Wr(s);let c=document.createElement("div");c.dataset.status=n.toString(),c.appendChild(a),c.appendChild(Wr(`<div class="response">${i}</div>`));const _=this.wpmCalculator.getWPMs();let d=this.wpmCalculator.saveKeystrokes(p);this.wpmCalculator.clearKeystrokes(),c.innerHTML=c.innerHTML.replace(/{{wpm}}/g,("_____"+d.toFixed(0)).slice(-4)),s=s.replace(/{{wpm}}/g,("_____"+d.toFixed(0)).slice(-4)),this._commandHistory||(this._commandHistory=[]);const m=c.outerHTML,S=this.averageWpmByCharacter(_.charWpms.filter(l=>l.durationMilliseconds>1)),b=this.WpmsToHTML(S.sort((l,f)=>l.wpm-f.wpm).slice(0,3),"slow-chars"),v=ht.renderToStaticMarkup(b);return c.innerHTML+=v,this.writeOutput(m),this._persistence.setItem(`${kt.Command}_${p}`,c.outerHTML),m}writeOutput(r){this._commandHistory=[r],this.setState({outputElements:[r]})}clearCommandHistory(r,i=[],n={}){var p,s;let o=[];for(let a=localStorage.length;a>=0;a--){let c=localStorage.key(a);c&&((c.includes(kt.Command)||c.includes("terminalCommandHistory")||c.includes(kt.CharTime))&&o.push(c),i.includes("achievements")&&c.includes("achievements")&&o.push(c))}for(let a of o)localStorage.removeItem(a);this._commandHistory=[],this.setState({outputElements:[]}),(p=this.adapterRef.current)==null||p.terminalReset(),(s=this.adapterRef.current)==null||s.prompt()}createCommandRecord(r,i){return`<div class="log-line"><span class="log-time">[${this.createTimeHTML(i)}]</span><span class="wpm">{{wpm}}</span>${r}</div>`}createTimeCode(r=new Date){return r.toISOString().split(":")}createTimeHTML(r=new Date){const i=r.getHours().toString().padStart(2,"0"),n=r.getMinutes().toString().padStart(2,"0"),o=r.getSeconds().toString().padStart(2,"0");return`<span class="log-hour">${i}</span><span class="log-minute">${n}</span><span class="log-second">${o}</span>`}toggleIsDebug(r){this.isDebug=!this.isDebug,r&&(this.isDebug=r),localStorage.setItem("xterm-debug",String(this.isDebug)),console.log("Xterm debug:",localStorage.getItem("xterm-debug"))}loadDebugValue(){localStorage.getItem("xterm-debug")==="true"?this.isDebug=!0:this.isDebug=!1}handleTimerStatusChange(r){this.setState({isActive:r})}terminalReset(){var r;(r=this.adapterRef.current)==null||r.terminalReset()}terminalPrompt(){var r;(r=this.adapterRef.current)==null||r.prompt()}terminalWrite(r){var i;(i=this.adapterRef.current)==null||i.terminalWrite(r)}loadFontSize(){let r=localStorage.getItem("terminalFontSize")||this.currentFontSize.toString();const i=r&&r=="NaN"?this.currentFontSize:parseInt(r);i&&(this.currentFontSize=i,document.documentElement.style.setProperty("--terminal-font-size",`${this.currentFontSize}px`))}increaseFontSize(){this.currentFontSize+=1,localStorage.setItem("terminalFontSize",`${this.currentFontSize}`),console.log("INCREASE terminalFontSize",this.currentFontSize)}addTouchListeners(){const r=window.document.getElementById(Ie.Output);r&&r.addEventListener("touchmove",this.handleTouchMove,{passive:!1});const i=document.getElementById(Ie.Terminal);i&&i.addEventListener("touchmove",this.handleTouchMove,{passive:!1});const n=window.document.getElementById(Ie.TerminalGame);n&&n.addEventListener("touchmove",this.handleTouchMove,{passive:!1})}removeTouchListeners(){const r=this.terminalElementRef.current;r&&r.removeEventListener("touchmove",this.handleTouchMove);const i=window.document.getElementById(Ie.Output);i&&i.removeEventListener("touchmove",this.handleTouchMove);const n=document.getElementById(Ie.Terminal);n&&n.removeEventListener("touchmove",this.handleTouchMove);const o=window.document.getElementById(Ie.TerminalGame);o&&o.removeEventListener("touchmove",this.handleTouchMove)}getDistanceBetweenTouches(r){const i=r[0],n=r[1];return Math.sqrt(Math.pow(n.pageX-i.pageX,2)+Math.pow(n.pageY-i.pageY,2))}render(){const{terminalSize:r}=this.state,i=r?r.width:800;return ne.jsx(dr.Consumer,{children:n=>{var o;return this.context=n,ne.jsxs("div",{className:"terminal-container",children:[ne.jsx(ao,{ref:this.outputRef,elements:this.state.outputElements,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd}),ne.jsx(So,{ref:this.terminalGameRef,canvasHeight:this.state.canvasHeight,canvasWidth:i,isInPhraseMode:this.state.isInPhraseMode,heroActionType:this.state.heroAction,zombie4ActionType:this.state.zombie4Action,onSetHeroAction:this.setHeroAction,onSetZombie4Action:this.setZombie4Action,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd}),this.state.isInPhraseMode&&this.state.phrase&&ne.jsx(oo,{ref:this.nextCharsDisplayRef,onTimerStatusChange:this.handleTimerStatusChange,commandLine:this.state.commandLine,isInPhraseMode:this.state.isInPhraseMode,newPhrase:this.state.phrase,onPhraseSuccess:this.handlePhraseSuccess}),Array.isArray((o=this.state.nextAchievement)==null?void 0:o.phrase)&&Rs&&ne.jsx(Rs,{achievement:this.state.nextAchievement,isInTutorial:this.state.isInTutorial,includeReturn:!0}),ne.jsx(io,{ref:this.adapterRef,terminalElement:this.terminalElementRef.current,terminalElementRef:this.terminalElementRef,terminalFontSize:this.currentFontSize,onAddCharacter:this.handleCharacter,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onLogin:this.handleLogin}),ne.jsx("video",{ref:this.videoElementRef,id:"terminal-video",hidden:!this.isShowVideo})]})}})}};J(Lt,"contextType",dr),J(Lt,"commandHistoryLimit",120);let fr=Lt;fr.contextType=dr;class Dh{constructor(){J(this,"commands",{})}register(t){this.commands[t.name]=t}getCommand(t){return this.commands[t]}getHelp(t){return Object.values(this.commands).filter(r=>!t||r.name.includes(t)).map(r=>`${r.name}: ${r.description}`).join(`

`)}}const Ih=new Dh,Ph=e=>{const[t]=me.useState([]),r=me.useCallback((p,s,a)=>{const c=e.handTermRef.current;if(!c)return console.error("CommandProvider: handTermRef.current is NULL"),{status:404,message:"CommandProvider: handTermRef.current is NULL"};const _=Ih.getCommand(p);return _?{status:200,message:_.execute(p,s,a,c).message}:{status:404,message:`CommandProvider: Command not found: ${p}`}},[]),i=me.useCallback(p=>{const s=e.handTermRef.current;if(!s)return console.error("CommandProvider: handTermRef.current is NULL"),"CommandProvider: handTermRef.current is NULL";p&&s.writeOutput(p.toString())},[]),n=me.useCallback(()=>{const p=e.handTermRef.current;if(!p)return console.error("CommandProvider: handTermRef.current is NULL"),"CommandProvider: handTermRef.current is NULL";p.clearCommandHistory("clear")},[]),o=me.useMemo(()=>({commandHistory:t,executeCommand:r,appendToOutput:i,clearOuput:n}),[t,r]);return ne.jsx(dr.Provider,{value:o,children:e.children})};/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var Lh=function(){function e(r){var i=r||{},n=i.ValidationData,o=i.Username,p=i.Password,s=i.AuthParameters,a=i.ClientMetadata;this.validationData=n||{},this.authParameters=s||{},this.clientMetadata=a||{},this.username=o,this.password=p}var t=e.prototype;return t.getUsername=function(){return this.username},t.getPassword=function(){return this.password},t.getValidationData=function(){return this.validationData},t.getAuthParameters=function(){return this.authParameters},t.getClientMetadata=function(){return this.clientMetadata},e}(),we={},Mh={}.toString,Bh=Array.isArray||function(e){return Mh.call(e)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */(function(e){var t=Xn,r=Jn,i=Bh;e.Buffer=s,e.SlowBuffer=f,e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=Li.TYPED_ARRAY_SUPPORT!==void 0?Li.TYPED_ARRAY_SUPPORT:n(),e.kMaxLength=o();function n(){try{var P=new Uint8Array(1);return P.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},P.foo()===42&&typeof P.subarray=="function"&&P.subarray(1,1).byteLength===0}catch{return!1}}function o(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function p(P,C){if(o()<C)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(P=new Uint8Array(C),P.__proto__=s.prototype):(P===null&&(P=new s(C)),P.length=C),P}function s(P,C,w){if(!s.TYPED_ARRAY_SUPPORT&&!(this instanceof s))return new s(P,C,w);if(typeof P=="number"){if(typeof C=="string")throw new Error("If encoding is specified then the first argument must be a string");return d(this,P)}return a(this,P,C,w)}s.poolSize=8192,s._augment=function(P){return P.__proto__=s.prototype,P};function a(P,C,w,L){if(typeof C=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&C instanceof ArrayBuffer?b(P,C,w,L):typeof C=="string"?m(P,C,w):v(P,C)}s.from=function(P,C,w){return a(null,P,C,w)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0}));function c(P){if(typeof P!="number")throw new TypeError('"size" argument must be a number');if(P<0)throw new RangeError('"size" argument must not be negative')}function _(P,C,w,L){return c(C),C<=0?p(P,C):w!==void 0?typeof L=="string"?p(P,C).fill(w,L):p(P,C).fill(w):p(P,C)}s.alloc=function(P,C,w){return _(null,P,C,w)};function d(P,C){if(c(C),P=p(P,C<0?0:l(C)|0),!s.TYPED_ARRAY_SUPPORT)for(var w=0;w<C;++w)P[w]=0;return P}s.allocUnsafe=function(P){return d(null,P)},s.allocUnsafeSlow=function(P){return d(null,P)};function m(P,C,w){if((typeof w!="string"||w==="")&&(w="utf8"),!s.isEncoding(w))throw new TypeError('"encoding" must be a valid string encoding');var L=h(C,w)|0;P=p(P,L);var N=P.write(C,w);return N!==L&&(P=P.slice(0,N)),P}function S(P,C){var w=C.length<0?0:l(C.length)|0;P=p(P,w);for(var L=0;L<w;L+=1)P[L]=C[L]&255;return P}function b(P,C,w,L){if(C.byteLength,w<0||C.byteLength<w)throw new RangeError("'offset' is out of bounds");if(C.byteLength<w+(L||0))throw new RangeError("'length' is out of bounds");return w===void 0&&L===void 0?C=new Uint8Array(C):L===void 0?C=new Uint8Array(C,w):C=new Uint8Array(C,w,L),s.TYPED_ARRAY_SUPPORT?(P=C,P.__proto__=s.prototype):P=S(P,C),P}function v(P,C){if(s.isBuffer(C)){var w=l(C.length)|0;return P=p(P,w),P.length===0||C.copy(P,0,0,w),P}if(C){if(typeof ArrayBuffer<"u"&&C.buffer instanceof ArrayBuffer||"length"in C)return typeof C.length!="number"||he(C.length)?p(P,0):S(P,C);if(C.type==="Buffer"&&i(C.data))return S(P,C.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function l(P){if(P>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return P|0}function f(P){return+P!=P&&(P=0),s.alloc(+P)}s.isBuffer=function(C){return!!(C!=null&&C._isBuffer)},s.compare=function(C,w){if(!s.isBuffer(C)||!s.isBuffer(w))throw new TypeError("Arguments must be Buffers");if(C===w)return 0;for(var L=C.length,N=w.length,K=0,G=Math.min(L,N);K<G;++K)if(C[K]!==w[K]){L=C[K],N=w[K];break}return L<N?-1:N<L?1:0},s.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(C,w){if(!i(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return s.alloc(0);var L;if(w===void 0)for(w=0,L=0;L<C.length;++L)w+=C[L].length;var N=s.allocUnsafe(w),K=0;for(L=0;L<C.length;++L){var G=C[L];if(!s.isBuffer(G))throw new TypeError('"list" argument must be an Array of Buffers');G.copy(N,K),K+=G.length}return N};function h(P,C){if(s.isBuffer(P))return P.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(P)||P instanceof ArrayBuffer))return P.byteLength;typeof P!="string"&&(P=""+P);var w=P.length;if(w===0)return 0;for(var L=!1;;)switch(C){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":case void 0:return Y(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return de(P).length;default:if(L)return Y(P).length;C=(""+C).toLowerCase(),L=!0}}s.byteLength=h;function u(P,C,w){var L=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,C>>>=0,w<=C))return"";for(P||(P="utf8");;)switch(P){case"hex":return D(this,C,w);case"utf8":case"utf-8":return j(this,C,w);case"ascii":return ie(this,C,w);case"latin1":case"binary":return te(this,C,w);case"base64":return B(this,C,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,C,w);default:if(L)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),L=!0}}s.prototype._isBuffer=!0;function g(P,C,w){var L=P[C];P[C]=P[w],P[w]=L}s.prototype.swap16=function(){var C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var w=0;w<C;w+=2)g(this,w,w+1);return this},s.prototype.swap32=function(){var C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var w=0;w<C;w+=4)g(this,w,w+3),g(this,w+1,w+2);return this},s.prototype.swap64=function(){var C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var w=0;w<C;w+=8)g(this,w,w+7),g(this,w+1,w+6),g(this,w+2,w+5),g(this,w+3,w+4);return this},s.prototype.toString=function(){var C=this.length|0;return C===0?"":arguments.length===0?j(this,0,C):u.apply(this,arguments)},s.prototype.equals=function(C){if(!s.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:s.compare(this,C)===0},s.prototype.inspect=function(){var C="",w=e.INSPECT_MAX_BYTES;return this.length>0&&(C=this.toString("hex",0,w).match(/.{2}/g).join(" "),this.length>w&&(C+=" ... ")),"<Buffer "+C+">"},s.prototype.compare=function(C,w,L,N,K){if(!s.isBuffer(C))throw new TypeError("Argument must be a Buffer");if(w===void 0&&(w=0),L===void 0&&(L=C?C.length:0),N===void 0&&(N=0),K===void 0&&(K=this.length),w<0||L>C.length||N<0||K>this.length)throw new RangeError("out of range index");if(N>=K&&w>=L)return 0;if(N>=K)return-1;if(w>=L)return 1;if(w>>>=0,L>>>=0,N>>>=0,K>>>=0,this===C)return 0;for(var G=K-N,ce=L-w,_e=Math.min(G,ce),ve=this.slice(N,K),Ce=C.slice(w,L),Se=0;Se<_e;++Se)if(ve[Se]!==Ce[Se]){G=ve[Se],ce=Ce[Se];break}return G<ce?-1:ce<G?1:0};function E(P,C,w,L,N){if(P.length===0)return-1;if(typeof w=="string"?(L=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,isNaN(w)&&(w=N?0:P.length-1),w<0&&(w=P.length+w),w>=P.length){if(N)return-1;w=P.length-1}else if(w<0)if(N)w=0;else return-1;if(typeof C=="string"&&(C=s.from(C,L)),s.isBuffer(C))return C.length===0?-1:x(P,C,w,L,N);if(typeof C=="number")return C=C&255,s.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?N?Uint8Array.prototype.indexOf.call(P,C,w):Uint8Array.prototype.lastIndexOf.call(P,C,w):x(P,[C],w,L,N);throw new TypeError("val must be string, number or Buffer")}function x(P,C,w,L,N){var K=1,G=P.length,ce=C.length;if(L!==void 0&&(L=String(L).toLowerCase(),L==="ucs2"||L==="ucs-2"||L==="utf16le"||L==="utf-16le")){if(P.length<2||C.length<2)return-1;K=2,G/=2,ce/=2,w/=2}function _e(Ke,ye){return K===1?Ke[ye]:Ke.readUInt16BE(ye*K)}var ve;if(N){var Ce=-1;for(ve=w;ve<G;ve++)if(_e(P,ve)===_e(C,Ce===-1?0:ve-Ce)){if(Ce===-1&&(Ce=ve),ve-Ce+1===ce)return Ce*K}else Ce!==-1&&(ve-=ve-Ce),Ce=-1}else for(w+ce>G&&(w=G-ce),ve=w;ve>=0;ve--){for(var Se=!0,De=0;De<ce;De++)if(_e(P,ve+De)!==_e(C,De)){Se=!1;break}if(Se)return ve}return-1}s.prototype.includes=function(C,w,L){return this.indexOf(C,w,L)!==-1},s.prototype.indexOf=function(C,w,L){return E(this,C,w,L,!0)},s.prototype.lastIndexOf=function(C,w,L){return E(this,C,w,L,!1)};function R(P,C,w,L){w=Number(w)||0;var N=P.length-w;L?(L=Number(L),L>N&&(L=N)):L=N;var K=C.length;if(K%2!==0)throw new TypeError("Invalid hex string");L>K/2&&(L=K/2);for(var G=0;G<L;++G){var ce=parseInt(C.substr(G*2,2),16);if(isNaN(ce))return G;P[w+G]=ce}return G}function y(P,C,w,L){return ge(Y(C,P.length-w),P,w,L)}function A(P,C,w,L){return ge(le(C),P,w,L)}function O(P,C,w,L){return A(P,C,w,L)}function U(P,C,w,L){return ge(de(C),P,w,L)}function H(P,C,w,L){return ge(ae(C,P.length-w),P,w,L)}s.prototype.write=function(C,w,L,N){if(w===void 0)N="utf8",L=this.length,w=0;else if(L===void 0&&typeof w=="string")N=w,L=this.length,w=0;else if(isFinite(w))w=w|0,isFinite(L)?(L=L|0,N===void 0&&(N="utf8")):(N=L,L=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var K=this.length-w;if((L===void 0||L>K)&&(L=K),C.length>0&&(L<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");for(var G=!1;;)switch(N){case"hex":return R(this,C,w,L);case"utf8":case"utf-8":return y(this,C,w,L);case"ascii":return A(this,C,w,L);case"latin1":case"binary":return O(this,C,w,L);case"base64":return U(this,C,w,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,C,w,L);default:if(G)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase(),G=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(P,C,w){return C===0&&w===P.length?t.fromByteArray(P):t.fromByteArray(P.slice(C,w))}function j(P,C,w){w=Math.min(P.length,w);for(var L=[],N=C;N<w;){var K=P[N],G=null,ce=K>239?4:K>223?3:K>191?2:1;if(N+ce<=w){var _e,ve,Ce,Se;switch(ce){case 1:K<128&&(G=K);break;case 2:_e=P[N+1],(_e&192)===128&&(Se=(K&31)<<6|_e&63,Se>127&&(G=Se));break;case 3:_e=P[N+1],ve=P[N+2],(_e&192)===128&&(ve&192)===128&&(Se=(K&15)<<12|(_e&63)<<6|ve&63,Se>2047&&(Se<55296||Se>57343)&&(G=Se));break;case 4:_e=P[N+1],ve=P[N+2],Ce=P[N+3],(_e&192)===128&&(ve&192)===128&&(Ce&192)===128&&(Se=(K&15)<<18|(_e&63)<<12|(ve&63)<<6|Ce&63,Se>65535&&Se<1114112&&(G=Se))}}G===null?(G=65533,ce=1):G>65535&&(G-=65536,L.push(G>>>10&1023|55296),G=56320|G&1023),L.push(G),N+=ce}return Q(L)}var q=4096;function Q(P){var C=P.length;if(C<=q)return String.fromCharCode.apply(String,P);for(var w="",L=0;L<C;)w+=String.fromCharCode.apply(String,P.slice(L,L+=q));return w}function ie(P,C,w){var L="";w=Math.min(P.length,w);for(var N=C;N<w;++N)L+=String.fromCharCode(P[N]&127);return L}function te(P,C,w){var L="";w=Math.min(P.length,w);for(var N=C;N<w;++N)L+=String.fromCharCode(P[N]);return L}function D(P,C,w){var L=P.length;(!C||C<0)&&(C=0),(!w||w<0||w>L)&&(w=L);for(var N="",K=C;K<w;++K)N+=X(P[K]);return N}function T(P,C,w){for(var L=P.slice(C,w),N="",K=0;K<L.length;K+=2)N+=String.fromCharCode(L[K]+L[K+1]*256);return N}s.prototype.slice=function(C,w){var L=this.length;C=~~C,w=w===void 0?L:~~w,C<0?(C+=L,C<0&&(C=0)):C>L&&(C=L),w<0?(w+=L,w<0&&(w=0)):w>L&&(w=L),w<C&&(w=C);var N;if(s.TYPED_ARRAY_SUPPORT)N=this.subarray(C,w),N.__proto__=s.prototype;else{var K=w-C;N=new s(K,void 0);for(var G=0;G<K;++G)N[G]=this[G+C]}return N};function k(P,C,w){if(P%1!==0||P<0)throw new RangeError("offset is not uint");if(P+C>w)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function(C,w,L){C=C|0,w=w|0,L||k(C,w,this.length);for(var N=this[C],K=1,G=0;++G<w&&(K*=256);)N+=this[C+G]*K;return N},s.prototype.readUIntBE=function(C,w,L){C=C|0,w=w|0,L||k(C,w,this.length);for(var N=this[C+--w],K=1;w>0&&(K*=256);)N+=this[C+--w]*K;return N},s.prototype.readUInt8=function(C,w){return w||k(C,1,this.length),this[C]},s.prototype.readUInt16LE=function(C,w){return w||k(C,2,this.length),this[C]|this[C+1]<<8},s.prototype.readUInt16BE=function(C,w){return w||k(C,2,this.length),this[C]<<8|this[C+1]},s.prototype.readUInt32LE=function(C,w){return w||k(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},s.prototype.readUInt32BE=function(C,w){return w||k(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},s.prototype.readIntLE=function(C,w,L){C=C|0,w=w|0,L||k(C,w,this.length);for(var N=this[C],K=1,G=0;++G<w&&(K*=256);)N+=this[C+G]*K;return K*=128,N>=K&&(N-=Math.pow(2,8*w)),N},s.prototype.readIntBE=function(C,w,L){C=C|0,w=w|0,L||k(C,w,this.length);for(var N=w,K=1,G=this[C+--N];N>0&&(K*=256);)G+=this[C+--N]*K;return K*=128,G>=K&&(G-=Math.pow(2,8*w)),G},s.prototype.readInt8=function(C,w){return w||k(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},s.prototype.readInt16LE=function(C,w){w||k(C,2,this.length);var L=this[C]|this[C+1]<<8;return L&32768?L|4294901760:L},s.prototype.readInt16BE=function(C,w){w||k(C,2,this.length);var L=this[C+1]|this[C]<<8;return L&32768?L|4294901760:L},s.prototype.readInt32LE=function(C,w){return w||k(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},s.prototype.readInt32BE=function(C,w){return w||k(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},s.prototype.readFloatLE=function(C,w){return w||k(C,4,this.length),r.read(this,C,!0,23,4)},s.prototype.readFloatBE=function(C,w){return w||k(C,4,this.length),r.read(this,C,!1,23,4)},s.prototype.readDoubleLE=function(C,w){return w||k(C,8,this.length),r.read(this,C,!0,52,8)},s.prototype.readDoubleBE=function(C,w){return w||k(C,8,this.length),r.read(this,C,!1,52,8)};function M(P,C,w,L,N,K){if(!s.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>N||C<K)throw new RangeError('"value" argument is out of bounds');if(w+L>P.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function(C,w,L,N){if(C=+C,w=w|0,L=L|0,!N){var K=Math.pow(2,8*L)-1;M(this,C,w,L,K,0)}var G=1,ce=0;for(this[w]=C&255;++ce<L&&(G*=256);)this[w+ce]=C/G&255;return w+L},s.prototype.writeUIntBE=function(C,w,L,N){if(C=+C,w=w|0,L=L|0,!N){var K=Math.pow(2,8*L)-1;M(this,C,w,L,K,0)}var G=L-1,ce=1;for(this[w+G]=C&255;--G>=0&&(ce*=256);)this[w+G]=C/ce&255;return w+L},s.prototype.writeUInt8=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,1,255,0),s.TYPED_ARRAY_SUPPORT||(C=Math.floor(C)),this[w]=C&255,w+1};function $(P,C,w,L){C<0&&(C=65535+C+1);for(var N=0,K=Math.min(P.length-w,2);N<K;++N)P[w+N]=(C&255<<8*(L?N:1-N))>>>(L?N:1-N)*8}s.prototype.writeUInt16LE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[w]=C&255,this[w+1]=C>>>8):$(this,C,w,!0),w+2},s.prototype.writeUInt16BE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[w]=C>>>8,this[w+1]=C&255):$(this,C,w,!1),w+2};function V(P,C,w,L){C<0&&(C=4294967295+C+1);for(var N=0,K=Math.min(P.length-w,4);N<K;++N)P[w+N]=C>>>(L?N:3-N)*8&255}s.prototype.writeUInt32LE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[w+3]=C>>>24,this[w+2]=C>>>16,this[w+1]=C>>>8,this[w]=C&255):V(this,C,w,!0),w+4},s.prototype.writeUInt32BE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[w]=C>>>24,this[w+1]=C>>>16,this[w+2]=C>>>8,this[w+3]=C&255):V(this,C,w,!1),w+4},s.prototype.writeIntLE=function(C,w,L,N){if(C=+C,w=w|0,!N){var K=Math.pow(2,8*L-1);M(this,C,w,L,K-1,-K)}var G=0,ce=1,_e=0;for(this[w]=C&255;++G<L&&(ce*=256);)C<0&&_e===0&&this[w+G-1]!==0&&(_e=1),this[w+G]=(C/ce>>0)-_e&255;return w+L},s.prototype.writeIntBE=function(C,w,L,N){if(C=+C,w=w|0,!N){var K=Math.pow(2,8*L-1);M(this,C,w,L,K-1,-K)}var G=L-1,ce=1,_e=0;for(this[w+G]=C&255;--G>=0&&(ce*=256);)C<0&&_e===0&&this[w+G+1]!==0&&(_e=1),this[w+G]=(C/ce>>0)-_e&255;return w+L},s.prototype.writeInt8=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,1,127,-128),s.TYPED_ARRAY_SUPPORT||(C=Math.floor(C)),C<0&&(C=255+C+1),this[w]=C&255,w+1},s.prototype.writeInt16LE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[w]=C&255,this[w+1]=C>>>8):$(this,C,w,!0),w+2},s.prototype.writeInt16BE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[w]=C>>>8,this[w+1]=C&255):$(this,C,w,!1),w+2},s.prototype.writeInt32LE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[w]=C&255,this[w+1]=C>>>8,this[w+2]=C>>>16,this[w+3]=C>>>24):V(this,C,w,!0),w+4},s.prototype.writeInt32BE=function(C,w,L){return C=+C,w=w|0,L||M(this,C,w,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),s.TYPED_ARRAY_SUPPORT?(this[w]=C>>>24,this[w+1]=C>>>16,this[w+2]=C>>>8,this[w+3]=C&255):V(this,C,w,!1),w+4};function Z(P,C,w,L,N,K){if(w+L>P.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}function ee(P,C,w,L,N){return N||Z(P,C,w,4),r.write(P,C,w,L,23,4),w+4}s.prototype.writeFloatLE=function(C,w,L){return ee(this,C,w,!0,L)},s.prototype.writeFloatBE=function(C,w,L){return ee(this,C,w,!1,L)};function F(P,C,w,L,N){return N||Z(P,C,w,8),r.write(P,C,w,L,52,8),w+8}s.prototype.writeDoubleLE=function(C,w,L){return F(this,C,w,!0,L)},s.prototype.writeDoubleBE=function(C,w,L){return F(this,C,w,!1,L)},s.prototype.copy=function(C,w,L,N){if(L||(L=0),!N&&N!==0&&(N=this.length),w>=C.length&&(w=C.length),w||(w=0),N>0&&N<L&&(N=L),N===L||C.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(L<0||L>=this.length)throw new RangeError("sourceStart out of bounds");if(N<0)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length),C.length-w<N-L&&(N=C.length-w+L);var K=N-L,G;if(this===C&&L<w&&w<N)for(G=K-1;G>=0;--G)C[G+w]=this[G+L];else if(K<1e3||!s.TYPED_ARRAY_SUPPORT)for(G=0;G<K;++G)C[G+w]=this[G+L];else Uint8Array.prototype.set.call(C,this.subarray(L,L+K),w);return K},s.prototype.fill=function(C,w,L,N){if(typeof C=="string"){if(typeof w=="string"?(N=w,w=0,L=this.length):typeof L=="string"&&(N=L,L=this.length),C.length===1){var K=C.charCodeAt(0);K<256&&(C=K)}if(N!==void 0&&typeof N!="string")throw new TypeError("encoding must be a string");if(typeof N=="string"&&!s.isEncoding(N))throw new TypeError("Unknown encoding: "+N)}else typeof C=="number"&&(C=C&255);if(w<0||this.length<w||this.length<L)throw new RangeError("Out of range index");if(L<=w)return this;w=w>>>0,L=L===void 0?this.length:L>>>0,C||(C=0);var G;if(typeof C=="number")for(G=w;G<L;++G)this[G]=C;else{var ce=s.isBuffer(C)?C:Y(new s(C,N).toString()),_e=ce.length;for(G=0;G<L-w;++G)this[G+w]=ce[G%_e]}return this};var I=/[^+\/0-9A-Za-z-_]/g;function z(P){if(P=W(P).replace(I,""),P.length<2)return"";for(;P.length%4!==0;)P=P+"=";return P}function W(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")}function X(P){return P<16?"0"+P.toString(16):P.toString(16)}function Y(P,C){C=C||1/0;for(var w,L=P.length,N=null,K=[],G=0;G<L;++G){if(w=P.charCodeAt(G),w>55295&&w<57344){if(!N){if(w>56319){(C-=3)>-1&&K.push(239,191,189);continue}else if(G+1===L){(C-=3)>-1&&K.push(239,191,189);continue}N=w;continue}if(w<56320){(C-=3)>-1&&K.push(239,191,189),N=w;continue}w=(N-55296<<10|w-56320)+65536}else N&&(C-=3)>-1&&K.push(239,191,189);if(N=null,w<128){if((C-=1)<0)break;K.push(w)}else if(w<2048){if((C-=2)<0)break;K.push(w>>6|192,w&63|128)}else if(w<65536){if((C-=3)<0)break;K.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((C-=4)<0)break;K.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return K}function le(P){for(var C=[],w=0;w<P.length;++w)C.push(P.charCodeAt(w)&255);return C}function ae(P,C){for(var w,L,N,K=[],G=0;G<P.length&&!((C-=2)<0);++G)w=P.charCodeAt(G),L=w>>8,N=w%256,K.push(N),K.push(L);return K}function de(P){return t.toByteArray(z(P))}function ge(P,C,w,L){for(var N=0;N<L&&!(N+w>=C.length||N>=P.length);++N)C[N+w]=P[N];return N}function he(P){return P!==P}})(we);var qe;typeof window<"u"&&window.crypto&&(qe=window.crypto);!qe&&typeof window<"u"&&window.msCrypto&&(qe=window.msCrypto);!qe&&typeof global<"u"&&global.crypto&&(qe=global.crypto);if(!qe&&typeof require=="function")try{qe=require("crypto")}catch{}function Oh(){if(qe){if(typeof qe.getRandomValues=="function")try{return qe.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof qe.randomBytes=="function")try{return qe.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")}function Fh(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((o&15).toString(16))}return i.join("")}var Uh=function(){function e(r,i){r=this.words=r||[],i!=null?this.sigBytes=i:this.sigBytes=r.length*4}var t=e.prototype;return t.random=function(i){for(var n=[],o=0;o<i;o+=4)n.push(Oh());return new e(n,i)},t.toString=function(){return Fh(this)},e}(),yt={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qr=function(e,t){return Qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Qr(e,t)};function Hh(e,t){Qr(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ei=function(){return ei=Object.assign||function(t){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},ei.apply(this,arguments)};function Nh(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function Wh(e,t,r,i){var n=arguments.length,o=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(p=e[s])&&(o=(n<3?p(o):n>3?p(t,r,o):p(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o}function $h(e,t){return function(r,i){t(r,i,e)}}function jh(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function zh(e,t,r,i){function n(o){return o instanceof r?o:new r(function(p){p(o)})}return new(r||(r=Promise))(function(o,p){function s(_){try{c(i.next(_))}catch(d){p(d)}}function a(_){try{c(i.throw(_))}catch(d){p(d)}}function c(_){_.done?o(_.value):n(_.value).then(s,a)}c((i=i.apply(e,t||[])).next())})}function Kh(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,n,o,p;return p={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function s(c){return function(_){return a([c,_])}}function a(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=c[0]&2?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,n=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(c[0]===6&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(_){c=[6,_],n=0}finally{i=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Vh(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}function qh(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function ti(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nn(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var i=r.call(e),n,o=[],p;try{for(;(t===void 0||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(s){p={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(p)throw p.error}}return o}function Gh(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Nn(arguments[t]));return e}function Yh(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var o=arguments[t],p=0,s=o.length;p<s;p++,n++)i[n]=o[p];return i}function Ut(e){return this instanceof Ut?(this.v=e,this):new Ut(e)}function Xh(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),n,o=[];return n={},p("next"),p("throw"),p("return"),n[Symbol.asyncIterator]=function(){return this},n;function p(m){i[m]&&(n[m]=function(S){return new Promise(function(b,v){o.push([m,S,b,v])>1||s(m,S)})})}function s(m,S){try{a(i[m](S))}catch(b){d(o[0][3],b)}}function a(m){m.value instanceof Ut?Promise.resolve(m.value.v).then(c,_):d(o[0][2],m)}function c(m){s("next",m)}function _(m){s("throw",m)}function d(m,S){m(S),o.shift(),o.length&&s(o[0][0],o[0][1])}}function Jh(e){var t,r;return t={},i("next"),i("throw",function(n){throw n}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(n,o){t[n]=e[n]?function(p){return(r=!r)?{value:Ut(e[n](p)),done:n==="return"}:o?o(p):p}:o}}function Zh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof ti=="function"?ti(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(o){r[o]=e[o]&&function(p){return new Promise(function(s,a){p=e[o](p),n(s,a,p.done,p.value)})}}function n(o,p,s,a){Promise.resolve(a).then(function(c){o({value:c,done:s})},p)}}function Qh(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function el(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function tl(e){return e&&e.__esModule?e:{default:e}}function rl(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function il(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const sl=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ei},__asyncDelegator:Jh,__asyncGenerator:Xh,__asyncValues:Zh,__await:Ut,__awaiter:zh,__classPrivateFieldGet:rl,__classPrivateFieldSet:il,__createBinding:Vh,__decorate:Wh,__exportStar:qh,__extends:Hh,__generator:Kh,__importDefault:tl,__importStar:el,__makeTemplateObject:Qh,__metadata:jh,__param:$h,__read:Nn,__rest:Nh,__spread:Gh,__spreadArrays:Yh,__values:ti},Symbol.toStringTag,{value:"Module"})),Wn=li(sl);var wr={},ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.MAX_HASHABLE_LENGTH=ze.INIT=ze.KEY=ze.DIGEST_LENGTH=ze.BLOCK_SIZE=void 0;ze.BLOCK_SIZE=64;ze.DIGEST_LENGTH=32;ze.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);ze.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];ze.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1;var br={};Object.defineProperty(br,"__esModule",{value:!0});br.RawSha256=void 0;var Ve=ze,nl=function(){function e(){this.state=Int32Array.from(Ve.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,i=t.byteLength;if(this.bytesHashed+=i,this.bytesHashed*8>Ve.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=t[r++],i--,this.bufferLength===Ve.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(r.setUint8(this.bufferLength++,128),i%Ve.BLOCK_SIZE>=Ve.BLOCK_SIZE-8){for(var n=this.bufferLength;n<Ve.BLOCK_SIZE;n++)r.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<Ve.BLOCK_SIZE-8;n++)r.setUint8(n,0);r.setUint32(Ve.BLOCK_SIZE-8,Math.floor(t/4294967296),!0),r.setUint32(Ve.BLOCK_SIZE-4,t),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(Ve.DIGEST_LENGTH),n=0;n<8;n++)o[n*4]=this.state[n]>>>24&255,o[n*4+1]=this.state[n]>>>16&255,o[n*4+2]=this.state[n]>>>8&255,o[n*4+3]=this.state[n]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var t=this,r=t.buffer,i=t.state,n=i[0],o=i[1],p=i[2],s=i[3],a=i[4],c=i[5],_=i[6],d=i[7],m=0;m<Ve.BLOCK_SIZE;m++){if(m<16)this.temp[m]=(r[m*4]&255)<<24|(r[m*4+1]&255)<<16|(r[m*4+2]&255)<<8|r[m*4+3]&255;else{var S=this.temp[m-2],b=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10;S=this.temp[m-15];var v=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3;this.temp[m]=(b+this.temp[m-7]|0)+(v+this.temp[m-16]|0)}var l=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&c^~a&_)|0)+(d+(Ve.KEY[m]+this.temp[m]|0)|0)|0,f=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&p^o&p)|0;d=_,_=c,c=a,a=s+l|0,s=p,p=o,o=n,n=l+f|0}i[0]+=n,i[1]+=o,i[2]+=p,i[3]+=s,i[4]+=a,i[5]+=c,i[6]+=_,i[7]+=d},e}();br.RawSha256=nl;var $n={},xr={};const ol=e=>{const t=[];for(let r=0,i=e.length;r<i;r++){const n=e.charCodeAt(r);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192,n&63|128);else if(r+1<e.length&&(n&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){const o=65536+((n&1023)<<10)+(e.charCodeAt(++r)&1023);t.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else t.push(n>>12|224,n>>6&63|128,n&63|128)}return Uint8Array.from(t)},al=e=>{let t="";for(let r=0,i=e.length;r<i;r++){const n=e[r];if(n<128)t+=String.fromCharCode(n);else if(192<=n&&n<224){const o=e[++r];t+=String.fromCharCode((n&31)<<6|o&63)}else if(240<=n&&n<365){const p="%"+[n,e[++r],e[++r],e[++r]].map(s=>s.toString(16)).join("%");t+=decodeURIComponent(p)}else t+=String.fromCharCode((n&15)<<12|(e[++r]&63)<<6|e[++r]&63)}return t};function hl(e){return new TextEncoder().encode(e)}function ll(e){return new TextDecoder("utf-8").decode(e)}const cl=e=>typeof TextEncoder=="function"?hl(e):ol(e),ul=e=>typeof TextDecoder=="function"?ll(e):al(e),dl=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:cl,toUtf8:ul},Symbol.toStringTag,{value:"Module"})),fl=li(dl);Object.defineProperty(xr,"__esModule",{value:!0});xr.convertToBuffer=void 0;var pl=fl,_l=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:pl.fromUtf8;function ml(e){return e instanceof Uint8Array?e:typeof e=="string"?_l(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}xr.convertToBuffer=ml;var Er={};Object.defineProperty(Er,"__esModule",{value:!0});Er.isEmptyData=void 0;function gl(e){return typeof e=="string"?e.length===0:e.byteLength===0}Er.isEmptyData=gl;var kr={};Object.defineProperty(kr,"__esModule",{value:!0});kr.numToUint8=void 0;function vl(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}kr.numToUint8=vl;var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.uint32ArrayFrom=void 0;function Sl(e){if(!Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r];return t}return Uint32Array.from(e)}Rr.uint32ArrayFrom=Sl;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uint32ArrayFrom=e.numToUint8=e.isEmptyData=e.convertToBuffer=void 0;var t=xr;Object.defineProperty(e,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var r=Er;Object.defineProperty(e,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var i=kr;Object.defineProperty(e,"numToUint8",{enumerable:!0,get:function(){return i.numToUint8}});var n=Rr;Object.defineProperty(e,"uint32ArrayFrom",{enumerable:!0,get:function(){return n.uint32ArrayFrom}})})($n);Object.defineProperty(wr,"__esModule",{value:!0});wr.Sha256=void 0;var Ts=Wn,pr=ze,ri=br,ii=$n,yl=function(){function e(t){if(this.hash=new ri.RawSha256,t){this.outer=new ri.RawSha256;var r=Cl(t),i=new Uint8Array(pr.BLOCK_SIZE);i.set(r);for(var n=0;n<pr.BLOCK_SIZE;n++)r[n]^=54,i[n]^=92;this.hash.update(r),this.outer.update(i);for(var n=0;n<r.byteLength;n++)r[n]=0}}return e.prototype.update=function(t){if(!((0,ii.isEmptyData)(t)||this.error))try{this.hash.update((0,ii.convertToBuffer)(t))}catch(r){this.error=r}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return(0,Ts.__awaiter)(this,void 0,void 0,function(){return(0,Ts.__generator)(this,function(t){return[2,this.digestSync()]})})},e}();wr.Sha256=yl;function Cl(e){var t=(0,ii.convertToBuffer)(e);if(t.byteLength>pr.BLOCK_SIZE){var r=new ri.RawSha256;r.update(t),t=r.digest()}var i=new Uint8Array(pr.BLOCK_SIZE);return i.set(t),i}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Wn;(0,t.__exportStar)(wr,e)})(yt);function se(e,t){e!=null&&this.fromString(e,t)}function Le(){return new se(null)}var at,wl=0xdeadbeefcafe,As=(wl&16777215)==15715070;function bl(e,t,r,i,n,o){for(;--o>=0;){var p=t*this[e++]+r[i]+n;n=Math.floor(p/67108864),r[i++]=p&67108863}return n}function xl(e,t,r,i,n,o){for(var p=t&32767,s=t>>15;--o>=0;){var a=this[e]&32767,c=this[e++]>>15,_=s*a+c*p;a=p*a+((_&32767)<<15)+r[i]+(n&1073741823),n=(a>>>30)+(_>>>15)+s*c+(n>>>30),r[i++]=a&1073741823}return n}function El(e,t,r,i,n,o){for(var p=t&16383,s=t>>14;--o>=0;){var a=this[e]&16383,c=this[e++]>>14,_=s*a+c*p;a=p*a+((_&16383)<<14)+r[i]+n,n=(a>>28)+(_>>14)+s*c,r[i++]=a&268435455}return n}var Ds=typeof navigator<"u";Ds&&As&&navigator.appName=="Microsoft Internet Explorer"?(se.prototype.am=xl,at=30):Ds&&As&&navigator.appName!="Netscape"?(se.prototype.am=bl,at=26):(se.prototype.am=El,at=28);se.prototype.DB=at;se.prototype.DM=(1<<at)-1;se.prototype.DV=1<<at;var Di=52;se.prototype.FV=Math.pow(2,Di);se.prototype.F1=Di-at;se.prototype.F2=2*at-Di;var kl="0123456789abcdefghijklmnopqrstuvwxyz",Tr=new Array,bt,Ge;bt=48;for(Ge=0;Ge<=9;++Ge)Tr[bt++]=Ge;bt=97;for(Ge=10;Ge<36;++Ge)Tr[bt++]=Ge;bt=65;for(Ge=10;Ge<36;++Ge)Tr[bt++]=Ge;function Is(e){return kl.charAt(e)}function Rl(e,t){var r=Tr[e.charCodeAt(t)];return r??-1}function Tl(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function Al(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Ii(e){var t=Le();return t.fromInt(e),t}function Dl(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;for(var i=e.length,n=!1,o=0;--i>=0;){var p=Rl(e,i);if(p<0){e.charAt(i)=="-"&&(n=!0);continue}n=!1,o==0?this[this.t++]=p:o+r>this.DB?(this[this.t-1]|=(p&(1<<this.DB-o)-1)<<o,this[this.t++]=p>>this.DB-o):this[this.t-1]|=p<<o,o+=r,o>=this.DB&&(o-=this.DB)}this.clamp(),n&&se.ZERO.subTo(this,this)}function Il(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function Pl(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");var r=(1<<t)-1,i,n=!1,o="",p=this.t,s=this.DB-p*this.DB%t;if(p-- >0)for(s<this.DB&&(i=this[p]>>s)>0&&(n=!0,o=Is(i));p>=0;)s<t?(i=(this[p]&(1<<s)-1)<<t-s,i|=this[--p]>>(s+=this.DB-t)):(i=this[p]>>(s-=t)&r,s<=0&&(s+=this.DB,--p)),i>0&&(n=!0),n&&(o+=Is(i));return n?o:"0"}function Ll(){var e=Le();return se.ZERO.subTo(this,e),e}function Ml(){return this.s<0?this.negate():this}function Bl(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function Pi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Ol(){return this.t<=0?0:this.DB*(this.t-1)+Pi(this[this.t-1]^this.s&this.DM)}function Fl(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function Ul(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Hl(e,t){var r=e%this.DB,i=this.DB-r,n=(1<<i)-1,o=Math.floor(e/this.DB),p=this.s<<r&this.DM,s;for(s=this.t-1;s>=0;--s)t[s+o+1]=this[s]>>i|p,p=(this[s]&n)<<r;for(s=o-1;s>=0;--s)t[s]=0;t[o]=p,t.t=this.t+o+1,t.s=this.s,t.clamp()}function Nl(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var i=e%this.DB,n=this.DB-i,o=(1<<i)-1;t[0]=this[r]>>i;for(var p=r+1;p<this.t;++p)t[p-r-1]|=(this[p]&o)<<n,t[p-r]=this[p]>>i;i>0&&(t[this.t-r-1]|=(this.s&o)<<n),t.t=this.t-r,t.clamp()}function Wl(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]-e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i-=e[r],t[r++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[r++]=this.DV+i:i>0&&(t[r++]=i),t.t=r,t.clamp()}function $l(e,t){var r=this.abs(),i=e.abs(),n=r.t;for(t.t=n+i.t;--n>=0;)t[n]=0;for(n=0;n<i.t;++n)t[n+r.t]=r.am(0,i[n],t,n,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&se.ZERO.subTo(t,t)}function jl(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function zl(e,t,r){var i=e.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Le());var o=Le(),p=this.s,s=e.s,a=this.DB-Pi(i[i.t-1]);a>0?(i.lShiftTo(a,o),n.lShiftTo(a,r)):(i.copyTo(o),n.copyTo(r));var c=o.t,_=o[c-1];if(_!=0){var d=_*(1<<this.F1)+(c>1?o[c-2]>>this.F2:0),m=this.FV/d,S=(1<<this.F1)/d,b=1<<this.F2,v=r.t,l=v-c,f=t??Le();for(o.dlShiftTo(l,f),r.compareTo(f)>=0&&(r[r.t++]=1,r.subTo(f,r)),se.ONE.dlShiftTo(c,f),f.subTo(o,o);o.t<c;)o[o.t++]=0;for(;--l>=0;){var h=r[--v]==_?this.DM:Math.floor(r[v]*m+(r[v-1]+b)*S);if((r[v]+=o.am(0,h,r,l,0,c))<h)for(o.dlShiftTo(l,f),r.subTo(f,r);r[v]<--h;)r.subTo(f,r)}t!=null&&(r.drShiftTo(c,t),p!=s&&se.ZERO.subTo(t,t)),r.t=c,r.clamp(),a>0&&r.rShiftTo(a,r),p<0&&se.ZERO.subTo(r,r)}}}function Kl(e){var t=Le();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(se.ZERO)>0&&e.subTo(t,t),t}function Vl(){if(this.t<1)return 0;var e=this[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function ql(e){return this.compareTo(e)==0}function Gl(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]+e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i+=e[r],t[r++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[r++]=i:i<-1&&(t[r++]=this.DV+i),t.t=r,t.clamp()}function Yl(e){var t=Le();return this.addTo(e,t),t}function Xl(e){var t=Le();return this.subTo(e,t),t}function Jl(e){var t=Le();return this.multiplyTo(e,t),t}function Zl(e){var t=Le();return this.divRemTo(e,t,null),t}function xt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Ql(e){var t=Le();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(se.ZERO)>0&&this.m.subTo(t,t),t}function ec(e){var t=Le();return e.copyTo(t),this.reduce(t),t}function tc(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,i,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function rc(e,t){e.squareTo(t),this.reduce(t)}function ic(e,t,r){e.multiplyTo(t,r),this.reduce(r)}xt.prototype.convert=Ql;xt.prototype.revert=ec;xt.prototype.reduce=tc;xt.prototype.mulTo=ic;xt.prototype.sqrTo=rc;function sc(e,t,r){var i=e.bitLength(),n,o=Ii(1),p=new xt(t);if(i<=0)return o;i<18?n=1:i<48?n=3:i<144?n=4:i<768?n=5:n=6;var s=new Array,a=3,c=n-1,_=(1<<n)-1;if(s[1]=p.convert(this),n>1){var d=Le();for(p.sqrTo(s[1],d);a<=_;)s[a]=Le(),p.mulTo(d,s[a-2],s[a]),a+=2}var m=e.t-1,S,b=!0,v=Le(),l;for(i=Pi(e[m])-1;m>=0;){for(i>=c?S=e[m]>>i-c&_:(S=(e[m]&(1<<i+1)-1)<<c-i,m>0&&(S|=e[m-1]>>this.DB+i-c)),a=n;!(S&1);)S>>=1,--a;if((i-=a)<0&&(i+=this.DB,--m),b)s[S].copyTo(o),b=!1;else{for(;a>1;)p.sqrTo(o,v),p.sqrTo(v,o),a-=2;a>0?p.sqrTo(o,v):(l=o,o=v,v=l),p.mulTo(v,s[S],o)}for(;m>=0&&!(e[m]&1<<i);)p.sqrTo(o,v),l=o,o=v,v=l,--i<0&&(i=this.DB-1,--m)}var f=p.revert(o);return r(null,f),f}se.prototype.copyTo=Tl;se.prototype.fromInt=Al;se.prototype.fromString=Dl;se.prototype.clamp=Il;se.prototype.dlShiftTo=Fl;se.prototype.drShiftTo=Ul;se.prototype.lShiftTo=Hl;se.prototype.rShiftTo=Nl;se.prototype.subTo=Wl;se.prototype.multiplyTo=$l;se.prototype.squareTo=jl;se.prototype.divRemTo=zl;se.prototype.invDigit=Vl;se.prototype.addTo=Gl;se.prototype.toString=Pl;se.prototype.negate=Ll;se.prototype.abs=Ml;se.prototype.compareTo=Bl;se.prototype.bitLength=Ol;se.prototype.mod=Kl;se.prototype.equals=ql;se.prototype.add=Yl;se.prototype.subtract=Xl;se.prototype.multiply=Jl;se.prototype.divide=Zl;se.prototype.modPow=sc;se.ZERO=Ii(0);se.ONE=Ii(1);/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */function Nr(e){return we.Buffer.from(new Uh().random(e).toString(),"hex")}var nc=/^[89a-f]/i,oc="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",ac="userAttributes.",gt=function(){function e(r){this.N=new se(oc,16),this.g=new se("2",16),this.k=new se(this.hexHash(""+this.padHex(this.N)+this.padHex(this.g)),16),this.smallAValue=this.generateRandomSmallA(),this.getLargeAValue(function(){}),this.infoBits=we.Buffer.from("Caldera Derived Key","utf8"),this.poolName=r}var t=e.prototype;return t.getSmallAValue=function(){return this.smallAValue},t.getLargeAValue=function(i){var n=this;this.largeAValue?i(null,this.largeAValue):this.calculateA(this.smallAValue,function(o,p){o&&i(o,null),n.largeAValue=p,i(null,n.largeAValue)})},t.generateRandomSmallA=function(){var i=Nr(128).toString("hex"),n=new se(i,16);return n},t.generateRandomString=function(){return Nr(40).toString("base64")},t.getRandomPassword=function(){return this.randomPassword},t.getSaltDevices=function(){return this.SaltToHashDevices},t.getVerifierDevices=function(){return this.verifierDevices},t.generateHashDevice=function(i,n,o){var p=this;this.randomPassword=this.generateRandomString();var s=""+i+n+":"+this.randomPassword,a=this.hash(s),c=Nr(16).toString("hex");this.SaltToHashDevices=this.padHex(new se(c,16)),this.g.modPow(new se(this.hexHash(this.SaltToHashDevices+a),16),this.N,function(_,d){_&&o(_,null),p.verifierDevices=p.padHex(d),o(null,null)})},t.calculateA=function(i,n){var o=this;this.g.modPow(i,this.N,function(p,s){p&&n(p,null),s.mod(o.N).equals(se.ZERO)&&n(new Error("Illegal paramater. A mod N cannot be 0."),null),n(null,s)})},t.calculateU=function(i,n){this.UHexHash=this.hexHash(this.padHex(i)+this.padHex(n));var o=new se(this.UHexHash,16);return o},t.hash=function(i){var n=new yt.Sha256;n.update(i);var o=n.digestSync(),p=we.Buffer.from(o).toString("hex");return new Array(64-p.length).join("0")+p},t.hexHash=function(i){return this.hash(we.Buffer.from(i,"hex"))},t.computehkdf=function(i,n){var o=we.Buffer.concat([this.infoBits,we.Buffer.from("","utf8")]),p=new yt.Sha256(n);p.update(i);var s=p.digestSync(),a=new yt.Sha256(s);a.update(o);var c=a.digestSync(),_=c,d=_.slice(0,16);return d},t.getPasswordAuthenticationKey=function(i,n,o,p,s){var a=this;if(o.mod(this.N).equals(se.ZERO))throw new Error("B cannot be zero.");if(this.UValue=this.calculateU(this.largeAValue,o),this.UValue.equals(se.ZERO))throw new Error("U cannot be zero.");var c=""+this.poolName+i+":"+n,_=this.hash(c),d=new se(this.hexHash(this.padHex(p)+_),16);this.calculateS(d,o,function(m,S){m&&s(m,null);var b=a.computehkdf(we.Buffer.from(a.padHex(S),"hex"),we.Buffer.from(a.padHex(a.UValue),"hex"));s(null,b)})},t.calculateS=function(i,n,o){var p=this;this.g.modPow(i,this.N,function(s,a){s&&o(s,null);var c=n.subtract(p.k.multiply(a));c.modPow(p.smallAValue.add(p.UValue.multiply(i)),p.N,function(_,d){_&&o(_,null),o(null,d.mod(p.N))})})},t.getNewPasswordRequiredChallengeUserAttributePrefix=function(){return ac},t.padHex=function(i){if(!(i instanceof se))throw new Error("Not a BigInteger");var n=i.compareTo(se.ZERO)<0,o=i.abs().toString(16);if(o=o.length%2!==0?"0"+o:o,o=nc.test(o)?"00"+o:o,n){var p=o.split("").map(function(a){var c=~parseInt(a,16)&15;return"0123456789ABCDEF".charAt(c)}).join(""),s=new se(p,16).add(se.ONE);o=s.toString(16),o.toUpperCase().startsWith("FF8")&&(o=o.substring(2))}return o},e}();/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var jn=function(){function e(r){this.jwtToken=r||"",this.payload=this.decodePayload()}var t=e.prototype;return t.getJwtToken=function(){return this.jwtToken},t.getExpiration=function(){return this.payload.exp},t.getIssuedAt=function(){return this.payload.iat},t.decodePayload=function(){var i=this.jwtToken.split(".")[1];try{return JSON.parse(we.Buffer.from(i,"base64").toString("utf8"))}catch{return{}}},e}();function hc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,si(e,t)}function si(e,t){return si=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},si(e,t)}var Ps=function(e){hc(t,e);function t(r){var i=r===void 0?{}:r,n=i.AccessToken;return e.call(this,n||"")||this}return t}(jn);function lc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ni(e,t)}function ni(e,t){return ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},ni(e,t)}var Ls=function(e){lc(t,e);function t(r){var i=r===void 0?{}:r,n=i.IdToken;return e.call(this,n||"")||this}return t}(jn);/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var Ms=function(){function e(r){var i=r===void 0?{}:r,n=i.RefreshToken;this.token=n||""}var t=e.prototype;return t.getToken=function(){return this.token},e}(),cc="5.0.4";/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var uc="aws-amplify/"+cc,zn={userAgent:uc,isReactNative:typeof navigator<"u"&&navigator.product==="ReactNative"},dc=function(){return zn.userAgent};/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var Bs=function(){function e(r){var i=r===void 0?{}:r,n=i.IdToken,o=i.RefreshToken,p=i.AccessToken,s=i.ClockDrift;if(p==null||n==null)throw new Error("Id token and Access Token must be present.");this.idToken=n,this.refreshToken=o,this.accessToken=p,this.clockDrift=s===void 0?this.calculateClockDrift():s}var t=e.prototype;return t.getIdToken=function(){return this.idToken},t.getRefreshToken=function(){return this.refreshToken},t.getAccessToken=function(){return this.accessToken},t.getClockDrift=function(){return this.clockDrift},t.calculateClockDrift=function(){var i=Math.floor(new Date/1e3),n=Math.min(this.accessToken.getIssuedAt(),this.idToken.getIssuedAt());return i-n},t.isValid=function(){var i=Math.floor(new Date/1e3),n=i-this.clockDrift;return n<this.accessToken.getExpiration()&&n<this.idToken.getExpiration()},e}();/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var fc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pc=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Os=function(){function e(){}var t=e.prototype;return t.getNowString=function(){var i=new Date,n=pc[i.getUTCDay()],o=fc[i.getUTCMonth()],p=i.getUTCDate(),s=i.getUTCHours();s<10&&(s="0"+s);var a=i.getUTCMinutes();a<10&&(a="0"+a);var c=i.getUTCSeconds();c<10&&(c="0"+c);var _=i.getUTCFullYear(),d=n+" "+o+" "+p+" "+s+":"+a+":"+c+" UTC "+_;return d},e}();/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var Kn=function(){function e(r){var i=r===void 0?{}:r,n=i.Name,o=i.Value;this.Name=n||"",this.Value=o||""}var t=e.prototype;return t.getValue=function(){return this.Value},t.setValue=function(i){return this.Value=i,this},t.getName=function(){return this.Name},t.setName=function(i){return this.Name=i,this},t.toString=function(){return JSON.stringify(this)},t.toJSON=function(){return{Name:this.Name,Value:this.Value}},e}();/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var lt={},_c=function(){function e(){}return e.setItem=function(r,i){return lt[r]=i,lt[r]},e.getItem=function(r){return Object.prototype.hasOwnProperty.call(lt,r)?lt[r]:void 0},e.removeItem=function(r){return delete lt[r]},e.clear=function(){return lt={},lt},e}(),Vn=function(){function e(){try{this.storageWindow=window.localStorage,this.storageWindow.setItem("aws.cognito.test-ls",1),this.storageWindow.removeItem("aws.cognito.test-ls")}catch{this.storageWindow=_c}}var t=e.prototype;return t.getStorage=function(){return this.storageWindow},e}();/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var mc=typeof navigator<"u",Fs=mc?zn.isReactNative?"react-native":navigator.userAgent:"nodejs",oi=function(){function e(r){if(r==null||r.Username==null||r.Pool==null)throw new Error("Username and Pool information are required.");this.username=r.Username||"",this.pool=r.Pool,this.Session=null,this.client=r.Pool.client,this.signInUserSession=null,this.authenticationFlowType="USER_SRP_AUTH",this.storage=r.Storage||new Vn().getStorage(),this.keyPrefix="CognitoIdentityServiceProvider."+this.pool.getClientId(),this.userDataKey=this.keyPrefix+"."+this.username+".userData"}var t=e.prototype;return t.setSignInUserSession=function(i){this.clearCachedUserData(),this.signInUserSession=i,this.cacheTokens()},t.getSignInUserSession=function(){return this.signInUserSession},t.getUsername=function(){return this.username},t.getAuthenticationFlowType=function(){return this.authenticationFlowType},t.setAuthenticationFlowType=function(i){this.authenticationFlowType=i},t.initiateAuth=function(i,n){var o=this,p=i.getAuthParameters();p.USERNAME=this.username;var s=Object.keys(i.getValidationData()).length!==0?i.getValidationData():i.getClientMetadata(),a={AuthFlow:"CUSTOM_AUTH",ClientId:this.pool.getClientId(),AuthParameters:p,ClientMetadata:s};this.getUserContextData()&&(a.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",a,function(c,_){if(c)return n.onFailure(c);var d=_.ChallengeName,m=_.ChallengeParameters;return d==="CUSTOM_CHALLENGE"?(o.Session=_.Session,n.customChallenge(m)):(o.signInUserSession=o.getCognitoUserSession(_.AuthenticationResult),o.cacheTokens(),n.onSuccess(o.signInUserSession))})},t.authenticateUser=function(i,n){return this.authenticationFlowType==="USER_PASSWORD_AUTH"?this.authenticateUserPlainUsernamePassword(i,n):this.authenticationFlowType==="USER_SRP_AUTH"||this.authenticationFlowType==="CUSTOM_AUTH"?this.authenticateUserDefaultAuth(i,n):n.onFailure(new Error("Authentication flow type is invalid."))},t.authenticateUserDefaultAuth=function(i,n){var o=this,p=new gt(this.pool.getUserPoolName()),s=new Os,a,c,_={};this.deviceKey!=null&&(_.DEVICE_KEY=this.deviceKey),_.USERNAME=this.username,p.getLargeAValue(function(d,m){d&&n.onFailure(d),_.SRP_A=m.toString(16),o.authenticationFlowType==="CUSTOM_AUTH"&&(_.CHALLENGE_NAME="SRP_A");var S=Object.keys(i.getValidationData()).length!==0?i.getValidationData():i.getClientMetadata(),b={AuthFlow:o.authenticationFlowType,ClientId:o.pool.getClientId(),AuthParameters:_,ClientMetadata:S};o.getUserContextData(o.username)&&(b.UserContextData=o.getUserContextData(o.username)),o.client.request("InitiateAuth",b,function(v,l){if(v)return n.onFailure(v);var f=l.ChallengeParameters;o.username=f.USER_ID_FOR_SRP,o.userDataKey=o.keyPrefix+"."+o.username+".userData",a=new se(f.SRP_B,16),c=new se(f.SALT,16),o.getCachedDeviceKeyAndPassword(),p.getPasswordAuthenticationKey(o.username,i.getPassword(),a,c,function(h,u){h&&n.onFailure(h);var g=s.getNowString(),E=we.Buffer.concat([we.Buffer.from(o.pool.getUserPoolName(),"utf8"),we.Buffer.from(o.username,"utf8"),we.Buffer.from(f.SECRET_BLOCK,"base64"),we.Buffer.from(g,"utf8")]),x=new yt.Sha256(u);x.update(E);var R=x.digestSync(),y=we.Buffer.from(R).toString("base64"),A={};A.USERNAME=o.username,A.PASSWORD_CLAIM_SECRET_BLOCK=f.SECRET_BLOCK,A.TIMESTAMP=g,A.PASSWORD_CLAIM_SIGNATURE=y,o.deviceKey!=null&&(A.DEVICE_KEY=o.deviceKey);var O=function H(B,j){return o.client.request("RespondToAuthChallenge",B,function(q,Q){return q&&q.code==="ResourceNotFoundException"&&q.message.toLowerCase().indexOf("device")!==-1?(A.DEVICE_KEY=null,o.deviceKey=null,o.randomPassword=null,o.deviceGroupKey=null,o.clearCachedDeviceKeyAndPassword(),H(B,j)):j(q,Q)})},U={ChallengeName:"PASSWORD_VERIFIER",ClientId:o.pool.getClientId(),ChallengeResponses:A,Session:l.Session,ClientMetadata:S};o.getUserContextData()&&(U.UserContextData=o.getUserContextData()),O(U,function(H,B){return H?n.onFailure(H):o.authenticateUserInternal(B,p,n)})})})})},t.authenticateUserPlainUsernamePassword=function(i,n){var o=this,p={};if(p.USERNAME=this.username,p.PASSWORD=i.getPassword(),!p.PASSWORD){n.onFailure(new Error("PASSWORD parameter is required"));return}var s=new gt(this.pool.getUserPoolName());this.getCachedDeviceKeyAndPassword(),this.deviceKey!=null&&(p.DEVICE_KEY=this.deviceKey);var a=Object.keys(i.getValidationData()).length!==0?i.getValidationData():i.getClientMetadata(),c={AuthFlow:"USER_PASSWORD_AUTH",ClientId:this.pool.getClientId(),AuthParameters:p,ClientMetadata:a};this.getUserContextData(this.username)&&(c.UserContextData=this.getUserContextData(this.username)),this.client.request("InitiateAuth",c,function(_,d){return _?n.onFailure(_):o.authenticateUserInternal(d,s,n)})},t.authenticateUserInternal=function(i,n,o){var p=this,s=i.ChallengeName,a=i.ChallengeParameters;if(s==="SMS_MFA")return this.Session=i.Session,o.mfaRequired(s,a);if(s==="SELECT_MFA_TYPE")return this.Session=i.Session,o.selectMFAType(s,a);if(s==="MFA_SETUP")return this.Session=i.Session,o.mfaSetup(s,a);if(s==="SOFTWARE_TOKEN_MFA")return this.Session=i.Session,o.totpRequired(s,a);if(s==="CUSTOM_CHALLENGE")return this.Session=i.Session,o.customChallenge(a);if(s==="NEW_PASSWORD_REQUIRED"){this.Session=i.Session;var c=null,_=null,d=[],m=n.getNewPasswordRequiredChallengeUserAttributePrefix();if(a&&(c=JSON.parse(i.ChallengeParameters.userAttributes),_=JSON.parse(i.ChallengeParameters.requiredAttributes)),_)for(var S=0;S<_.length;S++)d[S]=_[S].substr(m.length);return o.newPasswordRequired(c,d)}if(s==="DEVICE_SRP_AUTH"){this.Session=i.Session,this.getDeviceResponse(o);return}this.signInUserSession=this.getCognitoUserSession(i.AuthenticationResult),this.challengeName=s,this.cacheTokens();var b=i.AuthenticationResult.NewDeviceMetadata;if(b==null)return o.onSuccess(this.signInUserSession);n.generateHashDevice(i.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,i.AuthenticationResult.NewDeviceMetadata.DeviceKey,function(v){if(v)return o.onFailure(v);var l={Salt:we.Buffer.from(n.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:we.Buffer.from(n.getVerifierDevices(),"hex").toString("base64")};p.verifierDevices=l.PasswordVerifier,p.deviceGroupKey=b.DeviceGroupKey,p.randomPassword=n.getRandomPassword(),p.client.request("ConfirmDevice",{DeviceKey:b.DeviceKey,AccessToken:p.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:l,DeviceName:Fs},function(f,h){return f?o.onFailure(f):(p.deviceKey=i.AuthenticationResult.NewDeviceMetadata.DeviceKey,p.cacheDeviceKeyAndPassword(),h.UserConfirmationNecessary===!0?o.onSuccess(p.signInUserSession,h.UserConfirmationNecessary):o.onSuccess(p.signInUserSession))})})},t.completeNewPasswordChallenge=function(i,n,o,p){var s=this;if(!i)return o.onFailure(new Error("New password is required."));var a=new gt(this.pool.getUserPoolName()),c=a.getNewPasswordRequiredChallengeUserAttributePrefix(),_={};n&&Object.keys(n).forEach(function(m){_[c+m]=n[m]}),_.NEW_PASSWORD=i,_.USERNAME=this.username;var d={ChallengeName:"NEW_PASSWORD_REQUIRED",ClientId:this.pool.getClientId(),ChallengeResponses:_,Session:this.Session,ClientMetadata:p};this.getUserContextData()&&(d.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",d,function(m,S){return m?o.onFailure(m):s.authenticateUserInternal(S,a,o)})},t.getDeviceResponse=function(i,n){var o=this,p=new gt(this.deviceGroupKey),s=new Os,a={};a.USERNAME=this.username,a.DEVICE_KEY=this.deviceKey,p.getLargeAValue(function(c,_){c&&i.onFailure(c),a.SRP_A=_.toString(16);var d={ChallengeName:"DEVICE_SRP_AUTH",ClientId:o.pool.getClientId(),ChallengeResponses:a,ClientMetadata:n,Session:o.Session};o.getUserContextData()&&(d.UserContextData=o.getUserContextData()),o.client.request("RespondToAuthChallenge",d,function(m,S){if(m)return i.onFailure(m);var b=S.ChallengeParameters,v=new se(b.SRP_B,16),l=new se(b.SALT,16);p.getPasswordAuthenticationKey(o.deviceKey,o.randomPassword,v,l,function(f,h){if(f)return i.onFailure(f);var u=s.getNowString(),g=we.Buffer.concat([we.Buffer.from(o.deviceGroupKey,"utf8"),we.Buffer.from(o.deviceKey,"utf8"),we.Buffer.from(b.SECRET_BLOCK,"base64"),we.Buffer.from(u,"utf8")]),E=new yt.Sha256(h);E.update(g);var x=E.digestSync(),R=we.Buffer.from(x).toString("base64"),y={};y.USERNAME=o.username,y.PASSWORD_CLAIM_SECRET_BLOCK=b.SECRET_BLOCK,y.TIMESTAMP=u,y.PASSWORD_CLAIM_SIGNATURE=R,y.DEVICE_KEY=o.deviceKey;var A={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:o.pool.getClientId(),ChallengeResponses:y,Session:S.Session};o.getUserContextData()&&(A.UserContextData=o.getUserContextData()),o.client.request("RespondToAuthChallenge",A,function(O,U){return O?i.onFailure(O):(o.signInUserSession=o.getCognitoUserSession(U.AuthenticationResult),o.cacheTokens(),i.onSuccess(o.signInUserSession))})})})})},t.confirmRegistration=function(i,n,o,p){var s={ClientId:this.pool.getClientId(),ConfirmationCode:i,Username:this.username,ForceAliasCreation:n,ClientMetadata:p};this.getUserContextData()&&(s.UserContextData=this.getUserContextData()),this.client.request("ConfirmSignUp",s,function(a){return a?o(a,null):o(null,"SUCCESS")})},t.sendCustomChallengeAnswer=function(i,n,o){var p=this,s={};s.USERNAME=this.username,s.ANSWER=i;var a=new gt(this.pool.getUserPoolName());this.getCachedDeviceKeyAndPassword(),this.deviceKey!=null&&(s.DEVICE_KEY=this.deviceKey);var c={ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:s,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:o};this.getUserContextData()&&(c.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",c,function(_,d){return _?n.onFailure(_):p.authenticateUserInternal(d,a,n)})},t.sendMFACode=function(i,n,o,p){var s=this,a={};a.USERNAME=this.username,a.SMS_MFA_CODE=i;var c=o||"SMS_MFA";c==="SOFTWARE_TOKEN_MFA"&&(a.SOFTWARE_TOKEN_MFA_CODE=i),this.deviceKey!=null&&(a.DEVICE_KEY=this.deviceKey);var _={ChallengeName:c,ChallengeResponses:a,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:p};this.getUserContextData()&&(_.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",_,function(d,m){if(d)return n.onFailure(d);var S=m.ChallengeName;if(S==="DEVICE_SRP_AUTH"){s.getDeviceResponse(n);return}if(s.signInUserSession=s.getCognitoUserSession(m.AuthenticationResult),s.cacheTokens(),m.AuthenticationResult.NewDeviceMetadata==null)return n.onSuccess(s.signInUserSession);var b=new gt(s.pool.getUserPoolName());b.generateHashDevice(m.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,m.AuthenticationResult.NewDeviceMetadata.DeviceKey,function(v){if(v)return n.onFailure(v);var l={Salt:we.Buffer.from(b.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:we.Buffer.from(b.getVerifierDevices(),"hex").toString("base64")};s.verifierDevices=l.PasswordVerifier,s.deviceGroupKey=m.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,s.randomPassword=b.getRandomPassword(),s.client.request("ConfirmDevice",{DeviceKey:m.AuthenticationResult.NewDeviceMetadata.DeviceKey,AccessToken:s.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:l,DeviceName:Fs},function(f,h){return f?n.onFailure(f):(s.deviceKey=m.AuthenticationResult.NewDeviceMetadata.DeviceKey,s.cacheDeviceKeyAndPassword(),h.UserConfirmationNecessary===!0?n.onSuccess(s.signInUserSession,h.UserConfirmationNecessary):n.onSuccess(s.signInUserSession))})})})},t.changePassword=function(i,n,o,p){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return o(new Error("User is not authenticated"),null);this.client.request("ChangePassword",{PreviousPassword:i,ProposedPassword:n,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:p},function(s){return s?o(s,null):o(null,"SUCCESS")})},t.enableMFA=function(i){if(this.signInUserSession==null||!this.signInUserSession.isValid())return i(new Error("User is not authenticated"),null);var n=[],o={DeliveryMedium:"SMS",AttributeName:"phone_number"};n.push(o),this.client.request("SetUserSettings",{MFAOptions:n,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(p){return p?i(p,null):i(null,"SUCCESS")})},t.setUserMfaPreference=function(i,n,o){if(this.signInUserSession==null||!this.signInUserSession.isValid())return o(new Error("User is not authenticated"),null);this.client.request("SetUserMFAPreference",{SMSMfaSettings:i,SoftwareTokenMfaSettings:n,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(p){return p?o(p,null):o(null,"SUCCESS")})},t.disableMFA=function(i){if(this.signInUserSession==null||!this.signInUserSession.isValid())return i(new Error("User is not authenticated"),null);var n=[];this.client.request("SetUserSettings",{MFAOptions:n,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(o){return o?i(o,null):i(null,"SUCCESS")})},t.deleteUser=function(i,n){var o=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return i(new Error("User is not authenticated"),null);this.client.request("DeleteUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:n},function(p){return p?i(p,null):(o.clearCachedUser(),i(null,"SUCCESS"))})},t.updateAttributes=function(i,n,o){var p=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return n(new Error("User is not authenticated"),null);this.client.request("UpdateUserAttributes",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserAttributes:i,ClientMetadata:o},function(s,a){return s?n(s,null):p.getUserData(function(){return n(null,"SUCCESS",a)},{bypassCache:!0})})},t.getUserAttributes=function(i){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return i(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n,o){if(n)return i(n,null);for(var p=[],s=0;s<o.UserAttributes.length;s++){var a={Name:o.UserAttributes[s].Name,Value:o.UserAttributes[s].Value},c=new Kn(a);p.push(c)}return i(null,p)})},t.getMFAOptions=function(i){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return i(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n,o){return n?i(n,null):i(null,o.MFAOptions)})},t.createGetUserRequest=function(){return this.client.promisifyRequest("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()})},t.refreshSessionIfPossible=function(i){var n=this;return i===void 0&&(i={}),new Promise(function(o){var p=n.signInUserSession.getRefreshToken();p&&p.getToken()?n.refreshSession(p,o,i.clientMetadata):o()})},t.getUserData=function(i,n){var o=this;if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return this.clearCachedUserData(),i(new Error("User is not authenticated"),null);var p=this.getUserDataFromCache();if(!p){this.fetchUserData().then(function(s){i(null,s)}).catch(i);return}if(this.isFetchUserDataAndTokenRequired(n)){this.fetchUserData().then(function(s){return o.refreshSessionIfPossible(n).then(function(){return s})}).then(function(s){return i(null,s)}).catch(i);return}try{i(null,JSON.parse(p));return}catch(s){this.clearCachedUserData(),i(s,null);return}},t.getUserDataFromCache=function(){var i=this.storage.getItem(this.userDataKey);return i},t.isFetchUserDataAndTokenRequired=function(i){var n=i||{},o=n.bypassCache,p=o===void 0?!1:o;return p},t.fetchUserData=function(){var i=this;return this.createGetUserRequest().then(function(n){return i.cacheUserData(n),n})},t.deleteAttributes=function(i,n){var o=this;if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return n(new Error("User is not authenticated"),null);this.client.request("DeleteUserAttributes",{UserAttributeNames:i,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(p){return p?n(p,null):o.getUserData(function(){return n(null,"SUCCESS")},{bypassCache:!0})})},t.resendConfirmationCode=function(i,n){var o={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:n};this.client.request("ResendConfirmationCode",o,function(p,s){return p?i(p,null):i(null,s)})},t.getSession=function(i,n){if(n===void 0&&(n={}),this.username==null)return i(new Error("Username is null. Cannot retrieve a new session"),null);if(this.signInUserSession!=null&&this.signInUserSession.isValid())return i(null,this.signInUserSession);var o="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,p=o+".idToken",s=o+".accessToken",a=o+".refreshToken",c=o+".clockDrift";if(this.storage.getItem(p)){var _=new Ls({IdToken:this.storage.getItem(p)}),d=new Ps({AccessToken:this.storage.getItem(s)}),m=new Ms({RefreshToken:this.storage.getItem(a)}),S=parseInt(this.storage.getItem(c),0)||0,b={IdToken:_,AccessToken:d,RefreshToken:m,ClockDrift:S},v=new Bs(b);if(v.isValid())return this.signInUserSession=v,i(null,this.signInUserSession);if(!m.getToken())return i(new Error("Cannot retrieve a new session. Please authenticate."),null);this.refreshSession(m,i,n.clientMetadata)}else i(new Error("Local storage is missing an ID Token, Please authenticate"),null)},t.refreshSession=function(i,n,o){var p=this,s=this.pool.wrapRefreshSessionCallback?this.pool.wrapRefreshSessionCallback(n):n,a={};a.REFRESH_TOKEN=i.getToken();var c="CognitoIdentityServiceProvider."+this.pool.getClientId(),_=c+".LastAuthUser";if(this.storage.getItem(_)){this.username=this.storage.getItem(_);var d=c+"."+this.username+".deviceKey";this.deviceKey=this.storage.getItem(d),a.DEVICE_KEY=this.deviceKey}var m={ClientId:this.pool.getClientId(),AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:a,ClientMetadata:o};this.getUserContextData()&&(m.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",m,function(S,b){if(S)return S.code==="NotAuthorizedException"&&p.clearCachedUser(),s(S,null);if(b){var v=b.AuthenticationResult;return Object.prototype.hasOwnProperty.call(v,"RefreshToken")||(v.RefreshToken=i.getToken()),p.signInUserSession=p.getCognitoUserSession(v),p.cacheTokens(),s(null,p.signInUserSession)}})},t.cacheTokens=function(){var i="CognitoIdentityServiceProvider."+this.pool.getClientId(),n=i+"."+this.username+".idToken",o=i+"."+this.username+".accessToken",p=i+"."+this.username+".refreshToken",s=i+"."+this.username+".clockDrift",a=i+".LastAuthUser";this.storage.setItem(n,this.signInUserSession.getIdToken().getJwtToken()),this.storage.setItem(o,this.signInUserSession.getAccessToken().getJwtToken()),this.storage.setItem(p,this.signInUserSession.getRefreshToken().getToken()),this.storage.setItem(s,""+this.signInUserSession.getClockDrift()),this.storage.setItem(a,this.username)},t.cacheUserData=function(i){this.storage.setItem(this.userDataKey,JSON.stringify(i))},t.clearCachedUserData=function(){this.storage.removeItem(this.userDataKey)},t.clearCachedUser=function(){this.clearCachedTokens(),this.clearCachedUserData()},t.cacheDeviceKeyAndPassword=function(){var i="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,n=i+".deviceKey",o=i+".randomPasswordKey",p=i+".deviceGroupKey";this.storage.setItem(n,this.deviceKey),this.storage.setItem(o,this.randomPassword),this.storage.setItem(p,this.deviceGroupKey)},t.getCachedDeviceKeyAndPassword=function(){var i="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,n=i+".deviceKey",o=i+".randomPasswordKey",p=i+".deviceGroupKey";this.storage.getItem(n)&&(this.deviceKey=this.storage.getItem(n),this.randomPassword=this.storage.getItem(o),this.deviceGroupKey=this.storage.getItem(p))},t.clearCachedDeviceKeyAndPassword=function(){var i="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,n=i+".deviceKey",o=i+".randomPasswordKey",p=i+".deviceGroupKey";this.storage.removeItem(n),this.storage.removeItem(o),this.storage.removeItem(p)},t.clearCachedTokens=function(){var i="CognitoIdentityServiceProvider."+this.pool.getClientId(),n=i+"."+this.username+".idToken",o=i+"."+this.username+".accessToken",p=i+"."+this.username+".refreshToken",s=i+".LastAuthUser",a=i+"."+this.username+".clockDrift";this.storage.removeItem(n),this.storage.removeItem(o),this.storage.removeItem(p),this.storage.removeItem(s),this.storage.removeItem(a)},t.getCognitoUserSession=function(i){var n=new Ls(i),o=new Ps(i),p=new Ms(i),s={IdToken:n,AccessToken:o,RefreshToken:p};return new Bs(s)},t.forgotPassword=function(i,n){var o={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:n};this.getUserContextData()&&(o.UserContextData=this.getUserContextData()),this.client.request("ForgotPassword",o,function(p,s){return p?i.onFailure(p):typeof i.inputVerificationCode=="function"?i.inputVerificationCode(s):i.onSuccess(s)})},t.confirmPassword=function(i,n,o,p){var s={ClientId:this.pool.getClientId(),Username:this.username,ConfirmationCode:i,Password:n,ClientMetadata:p};this.getUserContextData()&&(s.UserContextData=this.getUserContextData()),this.client.request("ConfirmForgotPassword",s,function(a){return a?o.onFailure(a):o.onSuccess("SUCCESS")})},t.getAttributeVerificationCode=function(i,n,o){if(this.signInUserSession==null||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));this.client.request("GetUserAttributeVerificationCode",{AttributeName:i,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:o},function(p,s){return p?n.onFailure(p):typeof n.inputVerificationCode=="function"?n.inputVerificationCode(s):n.onSuccess("SUCCESS")})},t.verifyAttribute=function(i,n,o){if(this.signInUserSession==null||!this.signInUserSession.isValid())return o.onFailure(new Error("User is not authenticated"));this.client.request("VerifyUserAttribute",{AttributeName:i,Code:n,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(p){return p?o.onFailure(p):o.onSuccess("SUCCESS")})},t.getDevice=function(i){if(this.signInUserSession==null||!this.signInUserSession.isValid())return i.onFailure(new Error("User is not authenticated"));this.client.request("GetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey},function(n,o){return n?i.onFailure(n):i.onSuccess(o)})},t.forgetSpecificDevice=function(i,n){if(this.signInUserSession==null||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));this.client.request("ForgetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:i},function(o){return o?n.onFailure(o):n.onSuccess("SUCCESS")})},t.forgetDevice=function(i){var n=this;this.forgetSpecificDevice(this.deviceKey,{onFailure:i.onFailure,onSuccess:function(p){return n.deviceKey=null,n.deviceGroupKey=null,n.randomPassword=null,n.clearCachedDeviceKeyAndPassword(),i.onSuccess(p)}})},t.setDeviceStatusRemembered=function(i){if(this.signInUserSession==null||!this.signInUserSession.isValid())return i.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"remembered"},function(n){return n?i.onFailure(n):i.onSuccess("SUCCESS")})},t.setDeviceStatusNotRemembered=function(i){if(this.signInUserSession==null||!this.signInUserSession.isValid())return i.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"not_remembered"},function(n){return n?i.onFailure(n):i.onSuccess("SUCCESS")})},t.listDevices=function(i,n,o){if(this.signInUserSession==null||!this.signInUserSession.isValid())return o.onFailure(new Error("User is not authenticated"));var p={AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),Limit:i};n&&(p.PaginationToken=n),this.client.request("ListDevices",p,function(s,a){return s?o.onFailure(s):o.onSuccess(a)})},t.globalSignOut=function(i){var n=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return i.onFailure(new Error("User is not authenticated"));this.client.request("GlobalSignOut",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(o){return o?i.onFailure(o):(n.clearCachedUser(),i.onSuccess("SUCCESS"))})},t.signOut=function(i){var n=this;if(!i||typeof i!="function"){this.cleanClientData();return}this.getSession(function(o,p){if(o)return i(o);n.revokeTokens(function(s){n.cleanClientData(),i(s)})})},t.revokeTokens=function(i){if(i===void 0&&(i=function(){}),typeof i!="function")throw new Error("Invalid revokeTokenCallback. It should be a function.");if(!this.signInUserSession){var n=new Error("User is not authenticated");return i(n)}if(!this.signInUserSession.getAccessToken()){var o=new Error("No Access token available");return i(o)}var p=this.signInUserSession.getRefreshToken().getToken(),s=this.signInUserSession.getAccessToken();if(this.isSessionRevocable(s)&&p)return this.revokeToken({token:p,callback:i});i()},t.isSessionRevocable=function(i){if(i&&typeof i.decodePayload=="function")try{var n=i.decodePayload(),o=n.origin_jti;return!!o}catch{}return!1},t.cleanClientData=function(){this.signInUserSession=null,this.clearCachedUser()},t.revokeToken=function(i){var n=i.token,o=i.callback;this.client.requestWithRetry("RevokeToken",{Token:n,ClientId:this.pool.getClientId()},function(p){if(p)return o(p);o()})},t.sendMFASelectionAnswer=function(i,n){var o=this,p={};p.USERNAME=this.username,p.ANSWER=i;var s={ChallengeName:"SELECT_MFA_TYPE",ChallengeResponses:p,ClientId:this.pool.getClientId(),Session:this.Session};this.getUserContextData()&&(s.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",s,function(a,c){if(a)return n.onFailure(a);if(o.Session=c.Session,i==="SMS_MFA")return n.mfaRequired(c.ChallengeName,c.ChallengeParameters);if(i==="SOFTWARE_TOKEN_MFA")return n.totpRequired(c.ChallengeName,c.ChallengeParameters)})},t.getUserContextData=function(){var i=this.pool;return i.getUserContextData(this.username)},t.associateSoftwareToken=function(i){var n=this;this.signInUserSession!=null&&this.signInUserSession.isValid()?this.client.request("AssociateSoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(o,p){return o?i.onFailure(o):i.associateSecretCode(p.SecretCode)}):this.client.request("AssociateSoftwareToken",{Session:this.Session},function(o,p){return o?i.onFailure(o):(n.Session=p.Session,i.associateSecretCode(p.SecretCode))})},t.verifySoftwareToken=function(i,n,o){var p=this;this.signInUserSession!=null&&this.signInUserSession.isValid()?this.client.request("VerifySoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserCode:i,FriendlyDeviceName:n},function(s,a){return s?o.onFailure(s):o.onSuccess(a)}):this.client.request("VerifySoftwareToken",{Session:this.Session,UserCode:i,FriendlyDeviceName:n},function(s,a){if(s)return o.onFailure(s);p.Session=a.Session;var c={};c.USERNAME=p.username;var _={ChallengeName:"MFA_SETUP",ClientId:p.pool.getClientId(),ChallengeResponses:c,Session:p.Session};p.getUserContextData()&&(_.UserContextData=p.getUserContextData()),p.client.request("RespondToAuthChallenge",_,function(d,m){return d?o.onFailure(d):(p.signInUserSession=p.getCognitoUserSession(m.AuthenticationResult),p.cacheTokens(),o.onSuccess(p.signInUserSession))})})},e}();function gc(e,t){return t=t||{},new Promise(function(r,i){var n=new XMLHttpRequest,o=[],p=[],s={},a=function(){return{ok:(n.status/100|0)==2,statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(n.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:a,headers:{keys:function(){return o},entries:function(){return p},get:function(_){return s[_.toLowerCase()]},has:function(_){return _.toLowerCase()in s}}}};for(var c in n.open(t.method||"get",e,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(_,d,m){o.push(d=d.toLowerCase()),p.push([d,m]),s[d]=s[d]?s[d]+","+m:m}),r(a())},n.onerror=i,n.withCredentials=t.credentials=="include",t.headers)n.setRequestHeader(c,t.headers[c]);n.send(t.body||null)})}const vc=Object.freeze(Object.defineProperty({__proto__:null,default:gc},Symbol.toStringTag,{value:"Module"})),Us=li(vc);self.fetch||(self.fetch=Us.default||Us);function St(){}St.prototype.userAgent=dc();var Sc=function(t){var r=St.category?" "+St.category:"",i=St.framework?" framework/"+St.framework:"",n=""+St.prototype.userAgent+r+i;return n};function yc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ht(e,t)}function ai(e){var t=typeof Map=="function"?new Map:void 0;return ai=function(i){if(i===null||!wc(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,n)}function n(){return tr(i,arguments,hi(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ht(n,i)},ai(e)}function tr(e,t,r){return Cc()?tr=Reflect.construct.bind():tr=function(n,o,p){var s=[null];s.push.apply(s,o);var a=Function.bind.apply(n,s),c=new a;return p&&Ht(c,p.prototype),c},tr.apply(null,arguments)}function Cc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wc(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function Ht(e,t){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Ht(e,t)}function hi(e){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hi(e)}var bc=function(e){yc(t,e);function t(r,i,n,o){var p;return p=e.call(this,r)||this,p.code=i,p.name=n,p.statusCode=o,p}return t}(ai(Error)),xc=function(){function e(r,i,n){this.endpoint=i||"https://cognito-idp."+r+".amazonaws.com/";var o=n||{},p=o.credentials;this.fetchOptions=p?{credentials:p}:{}}var t=e.prototype;return t.promisifyRequest=function(i,n){var o=this;return new Promise(function(p,s){o.request(i,n,function(a,c){a?s(new bc(a.message,a.code,a.name,a.statusCode)):p(c)})})},t.requestWithRetry=function(i,n,o){var p=this,s=5*1e3;Rc(function(a){return new Promise(function(c,_){p.request(i,a,function(d,m){d?_(d):c(m)})})},[n],s).then(function(a){return o(null,a)}).catch(function(a){return o(a)})},t.request=function(i,n,o){var p={"Content-Type":"application/x-amz-json-1.1","X-Amz-Target":"AWSCognitoIdentityProviderService."+i,"X-Amz-User-Agent":Sc(),"Cache-Control":"no-store"},s=Object.assign({},this.fetchOptions,{headers:p,method:"POST",mode:"cors",body:JSON.stringify(n)}),a;fetch(this.endpoint,s).then(function(c){return a=c,c},function(c){throw c instanceof TypeError?new Error("Network error"):c}).then(function(c){return c.json().catch(function(){return{}})}).then(function(c){if(a.ok)return o(null,c);var _=(c.__type||c.code).split("#").pop(),d=new Error(c.message||c.Message||null);return d.name=_,d.code=_,o(d)}).catch(function(c){if(a&&a.headers&&a.headers.get("x-amzn-errortype"))try{var _=a.headers.get("x-amzn-errortype").split(":")[0],d=new Error(a.status?a.status.toString():null);return d.code=_,d.name=_,d.statusCode=a.status,o(d)}catch{return o(c)}else c instanceof Error&&c.message==="Network error"&&(c.code="NetworkError");return o(c)})},e}(),zt={debug:function(){}},Ec=function(t){var r="nonRetryable";return t&&t[r]};function qn(e,t,r,i){if(i===void 0&&(i=1),typeof e!="function")throw Error("functionToRetry must be a function");return zt.debug(e.name+" attempt #"+i+" with args: "+JSON.stringify(t)),e.apply(void 0,t).catch(function(n){if(zt.debug("error on "+e.name,n),Ec(n))throw zt.debug(e.name+" non retryable error",n),n;var o=r(i,t,n);if(zt.debug(e.name+" retrying in "+o+" ms"),o!==!1)return new Promise(function(p){return setTimeout(p,o)}).then(function(){return qn(e,t,r,i+1)});throw n})}function kc(e){var t=100,r=100;return function(i){var n=Math.pow(2,i)*t+r*Math.random();return n>e?!1:n}}function Rc(e,t,r){return qn(e,t,kc(r))}/*!
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */var Tc=55,Ac=function(){function e(r,i){var n=r||{},o=n.UserPoolId,p=n.ClientId,s=n.endpoint,a=n.fetchOptions,c=n.AdvancedSecurityDataCollectionFlag;if(!o||!p)throw new Error("Both UserPoolId and ClientId are required.");if(o.length>Tc||!/^[\w-]+_[0-9a-zA-Z]+$/.test(o))throw new Error("Invalid UserPoolId format.");var _=o.split("_")[0];this.userPoolId=o,this.clientId=p,this.client=new xc(_,s,a),this.advancedSecurityDataCollectionFlag=c!==!1,this.storage=r.Storage||new Vn().getStorage(),i&&(this.wrapRefreshSessionCallback=i)}var t=e.prototype;return t.getUserPoolId=function(){return this.userPoolId},t.getUserPoolName=function(){return this.getUserPoolId().split("_")[1]},t.getClientId=function(){return this.clientId},t.signUp=function(i,n,o,p,s,a){var c=this,_={ClientId:this.clientId,Username:i,Password:n,UserAttributes:o,ValidationData:p,ClientMetadata:a};this.getUserContextData(i)&&(_.UserContextData=this.getUserContextData(i)),this.client.request("SignUp",_,function(d,m){if(d)return s(d,null);var S={Username:i,Pool:c,Storage:c.storage},b={user:new oi(S),userConfirmed:m.UserConfirmed,userSub:m.UserSub,codeDeliveryDetails:m.CodeDeliveryDetails};return s(null,b)})},t.getCurrentUser=function(){var i="CognitoIdentityServiceProvider."+this.clientId+".LastAuthUser",n=this.storage.getItem(i);if(n){var o={Username:n,Pool:this,Storage:this.storage};return new oi(o)}return null},t.getUserContextData=function(i){if(!(typeof AmazonCognitoAdvancedSecurityData>"u")){var n=AmazonCognitoAdvancedSecurityData;if(this.advancedSecurityDataCollectionFlag){var o=n.getData(i,this.userPoolId,this.clientId);if(o){var p={EncodedData:o};return p}}return{}}},e}(),Dc={exports:{}};/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(e,t){(function(r){var i;if(e.exports=r(),i=!0,!i){var n=window.Cookies,o=window.Cookies=r();o.noConflict=function(){return window.Cookies=n,o}}})(function(){function r(){for(var o=0,p={};o<arguments.length;o++){var s=arguments[o];for(var a in s)p[a]=s[a]}return p}function i(o){return o.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(o){function p(){}function s(c,_,d){if(!(typeof document>"u")){d=r({path:"/"},p.defaults,d),typeof d.expires=="number"&&(d.expires=new Date(new Date*1+d.expires*864e5)),d.expires=d.expires?d.expires.toUTCString():"";try{var m=JSON.stringify(_);/^[\{\[]/.test(m)&&(_=m)}catch{}_=o.write?o.write(_,c):encodeURIComponent(String(_)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),c=encodeURIComponent(String(c)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var S="";for(var b in d)d[b]&&(S+="; "+b,d[b]!==!0&&(S+="="+d[b].split(";")[0]));return document.cookie=c+"="+_+S}}function a(c,_){if(!(typeof document>"u")){for(var d={},m=document.cookie?document.cookie.split("; "):[],S=0;S<m.length;S++){var b=m[S].split("="),v=b.slice(1).join("=");!_&&v.charAt(0)==='"'&&(v=v.slice(1,-1));try{var l=i(b[0]);if(v=(o.read||o)(v,l)||i(v),_)try{v=JSON.parse(v)}catch{}if(d[l]=v,c===l)break}catch{}}return c?d[c]:d}}return p.set=s,p.get=function(c){return a(c,!1)},p.getJSON=function(c){return a(c,!0)},p.remove=function(c,_){s(c,"",r(_,{expires:-1}))},p.defaults={},p.withConverter=n,p}return n(function(){})})})(Dc);const Ic={UserPoolId:"us-east-1_apGvoR62E",ClientId:"776i4gt2nij7ce30m9jlo9fcq0"},ct=new Ac(Ic),Pc=()=>{const[e,t]=me.useState(!1),r=(a,c,_,d)=>{const m=[new Kn({Name:"email",Value:_})];ct.signUp(a,c,m,m,(S,b)=>{if(S){console.error(S),d(S,null);return}console.log("Sign up successful!",b),d(null,b)})},i=(a,c,_)=>{const d=ct.getCurrentUser();d?d.changePassword(a,c,(m,S)=>{if(m){console.error(m),_(m,null);return}console.log("Password changed successfully!",S),_(null,S)}):(console.error("User not authenticated!"),_("User not authenticated!",null))},n=()=>{var c;return(c=ct.getCurrentUser())==null?void 0:c.getUsername()},o=(a,c,_)=>{const d=new Lh({Username:a,Password:c});new oi({Username:a,Pool:ct}).authenticateUser(d,{onSuccess:S=>{console.log("Authentication successful!",S.getIdToken().getJwtToken()),t(!0),sessionStorage.setItem("idToken",S.getIdToken().getJwtToken()),sessionStorage.setItem("accessToken",S.getAccessToken().getJwtToken()),sessionStorage.setItem("refreshToken",S.getRefreshToken().getToken());const b=(S.getIdToken().getExpiration()-Math.floor(Date.now()/1e3)-300)*1e3;setTimeout(p,b),_(null,S)},onFailure:S=>{console.error("Authentication failed!",S),t(!1),_(S,null)}})},p=()=>{const a=ct.getCurrentUser();a!=null&&a.getSession((c,_)=>{if(c){console.error(c);return}_.isValid()&&a.refreshSession(_.getRefreshToken(),(d,m)=>{d?console.error(d):console.log("Session refreshed successfully.",m.getIdToken().getJwtToken())})})};return{isLoggedIn:e,login:o,logout:()=>{var a;ct.getCurrentUser()&&((a=ct.getCurrentUser())==null||a.signOut()),t(!1)},signUp:r,refreshSession:p,getCurrentUser:n,changePassword:i}},Bc=()=>{const e=ke.createRef(),[t,r]=ke.useState(0),i=me.useRef(null);me.useEffect(()=>{const o=n();r(o);const p=s=>{i.current&&i.current.adapterRef.current&&s.target.id!==Ie.Terminal&&(s.stopPropagation(),window.scrollTo(0,window.screen.height),i.current.adapterRef.current.focusTerminal(),(s instanceof MouseEvent||s instanceof TouchEvent&&s.touches.length===1)&&(i.current.adapterRef.current.focusTerminal(),setTimeout(()=>{i.current&&i.current.adapterRef.current&&i.current.adapterRef.current.focusTerminal()},1e3)))};return document.body.addEventListener("click",p),document.body.addEventListener("touchstart",p),()=>{document.body.removeEventListener("click",p)}},[]);const n=()=>{var o;return((o=e.current)==null?void 0:o.clientWidth)??0};return me.useEffect(()=>{const o=()=>{const p=n();r(p)};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),ne.jsx(Ph,{handTermRef:i,children:ne.jsx("div",{ref:e,children:ne.jsx(fr,{ref:i,auth:Pc(),terminalWidth:t})})})};export{Bc as default};
