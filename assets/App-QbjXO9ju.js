import{L as kt,R as pe,j as Y,T as Se,r as ae,P as Nt,c as co}from"./index-zCrxyNLg.js";class ho{previousTimestamp=0;keystrokes;getKeystrokes(){return this.keystrokes}constructor(){this.keystrokes=[]}clearKeystrokes(){this.keystrokes=[]}saveKeystrokes(t){let r=this.getWPMs();return localStorage.setItem(kt.CharTime+"_"+t,JSON.stringify(r.charWpms)),r.wpmAverage}addKeystroke(t){let r={character:t,durationMilliseconds:0};return this.previousTimestamp>0&&(r.durationMilliseconds=performance.now()-this.previousTimestamp),this.previousTimestamp=performance.now(),this.keystrokes.push(r),r}getWPMs(){let t=this.keystrokes.map(this.getWPM);const r=t.filter(p=>p.durationMilliseconds>1);let u=r.reduce((p,_)=>p+_.wpm,0)/r.length;return u=Math.round(u*1e3)/1e3,{wpmAverage:u,charWpms:t}}getWPM(t){let r={character:t.character,wpm:0,durationMilliseconds:0};if(t.durationMilliseconds>0){r.durationMilliseconds=t.durationMilliseconds;let i=t.durationMilliseconds/6e4;if(i>0){let u=1/i;r.wpm=u/5}r.wpm=Math.round(r.wpm*1e3)/1e3}return r}}class uo{saveCommandHistory(){}setItem(t,r){localStorage.setItem(t,r)}loadCommandHistory(){return[]}}function jr(e){return new DOMParser().parseFromString(e,"text/html").body.firstChild}var Ns={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(globalThis,()=>(()=>{var r={4567:function(_,s,c){var d=this&&this.__decorate||function(o,a,g,b){var w,k=arguments.length,S=k<3?a:b===null?b=Object.getOwnPropertyDescriptor(a,g):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,a,g,b);else for(var R=o.length-1;R>=0;R--)(w=o[R])&&(S=(k<3?w(S):k>3?w(a,g,S):w(a,g))||S);return k>3&&S&&Object.defineProperty(a,g,S),S},f=this&&this.__param||function(o,a){return function(g,b){a(g,b,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const h=c(9042),v=c(9924),y=c(844),C=c(4725),m=c(2585),n=c(3656);let l=s.AccessibilityManager=class extends y.Disposable{constructor(o,a,g,b){super(),this._terminal=o,this._coreBrowserService=g,this._renderService=b,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let w=0;w<this._terminal.rows;w++)this._rowElements[w]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[w]);if(this._topBoundaryFocusListener=w=>this._handleBoundaryFocus(w,0),this._bottomBoundaryFocusListener=w=>this._handleBoundaryFocus(w,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new v.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(w=>this._handleResize(w.rows))),this.register(this._terminal.onRender(w=>this._refreshRows(w.start,w.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(w=>this._handleChar(w))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(w=>this._handleTab(w))),this.register(this._terminal.onKey(w=>this._handleKey(w.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,n.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,y.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(o){for(let a=0;a<o;a++)this._handleChar(" ")}_handleChar(o){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==o&&(this._charsToAnnounce+=o):this._charsToAnnounce+=o,o===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(o){this._clearLiveRegion(),/\p{Control}/u.test(o)||this._charsToConsume.push(o)}_refreshRows(o,a){this._liveRegionDebouncer.refresh(o,a,this._terminal.rows)}_renderRows(o,a){const g=this._terminal.buffer,b=g.lines.length.toString();for(let w=o;w<=a;w++){const k=g.lines.get(g.ydisp+w),S=[],R=k?.translateToString(!0,void 0,void 0,S)||"",P=(g.ydisp+w+1).toString(),B=this._rowElements[w];B&&(R.length===0?(B.innerText="Â ",this._rowColumns.set(B,[0,1])):(B.textContent=R,this._rowColumns.set(B,S)),B.setAttribute("aria-posinset",P),B.setAttribute("aria-setsize",b))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(o,a){const g=o.target,b=this._rowElements[a===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(a===0?"1":`${this._terminal.buffer.lines.length}`)||o.relatedTarget!==b)return;let w,k;if(a===0?(w=g,k=this._rowElements.pop(),this._rowContainer.removeChild(k)):(w=this._rowElements.shift(),k=g,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),k.removeEventListener("focus",this._bottomBoundaryFocusListener),a===0){const S=this._createAccessibilityTreeNode();this._rowElements.unshift(S),this._rowContainer.insertAdjacentElement("afterbegin",S)}else{const S=this._createAccessibilityTreeNode();this._rowElements.push(S),this._rowContainer.appendChild(S)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(a===0?-1:1),this._rowElements[a===0?1:this._rowElements.length-2].focus(),o.preventDefault(),o.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const o=document.getSelection();if(!o)return;if(o.isCollapsed)return void(this._rowContainer.contains(o.anchorNode)&&this._terminal.clearSelection());if(!o.anchorNode||!o.focusNode)return void console.error("anchorNode and/or focusNode are null");let a={node:o.anchorNode,offset:o.anchorOffset},g={node:o.focusNode,offset:o.focusOffset};if((a.node.compareDocumentPosition(g.node)&Node.DOCUMENT_POSITION_PRECEDING||a.node===g.node&&a.offset>g.offset)&&([a,g]=[g,a]),a.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(a={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(a.node))return;const b=this._rowElements.slice(-1)[0];if(g.node.compareDocumentPosition(b)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(g={node:b,offset:b.textContent?.length??0}),!this._rowContainer.contains(g.node))return;const w=({node:R,offset:P})=>{const B=R instanceof Text?R.parentNode:R;let I=parseInt(B?.getAttribute("aria-posinset"),10)-1;if(isNaN(I))return console.warn("row is invalid. Race condition?"),null;const A=this._rowColumns.get(B);if(!A)return console.warn("columns is null. Race condition?"),null;let N=P<A.length?A[P]:A.slice(-1)[0]+1;return N>=this._terminal.cols&&(++I,N=0),{row:I,column:N}},k=w(a),S=w(g);if(k&&S){if(k.row>S.row||k.row===S.row&&k.column>=S.column)throw new Error("invalid range");this._terminal.select(k.column,k.row,(S.row-k.row)*this._terminal.cols-k.column+S.column)}}_handleResize(o){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let a=this._rowContainer.children.length;a<this._terminal.rows;a++)this._rowElements[a]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[a]);for(;this._rowElements.length>o;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const o=this._coreBrowserService.mainDocument.createElement("div");return o.setAttribute("role","listitem"),o.tabIndex=-1,this._refreshRowDimensions(o),o}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let o=0;o<this._terminal.rows;o++)this._refreshRowDimensions(this._rowElements[o])}}_refreshRowDimensions(o){o.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s.AccessibilityManager=l=d([f(1,m.IInstantiationService),f(2,C.ICoreBrowserService),f(3,C.IRenderService)],l)},3614:(_,s)=>{function c(v){return v.replace(/\r?\n/g,"\r")}function d(v,y){return y?"\x1B[200~"+v+"\x1B[201~":v}function f(v,y,C,m){v=d(v=c(v),C.decPrivateModes.bracketedPasteMode&&m.rawOptions.ignoreBracketedPasteMode!==!0),C.triggerDataEvent(v,!0),y.value=""}function h(v,y,C){const m=C.getBoundingClientRect(),n=v.clientX-m.left-10,l=v.clientY-m.top-10;y.style.width="20px",y.style.height="20px",y.style.left=`${n}px`,y.style.top=`${l}px`,y.style.zIndex="1000",y.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=c,s.bracketTextForPaste=d,s.copyHandler=function(v,y){v.clipboardData&&v.clipboardData.setData("text/plain",y.selectionText),v.preventDefault()},s.handlePasteEvent=function(v,y,C,m){v.stopPropagation(),v.clipboardData&&f(v.clipboardData.getData("text/plain"),y,C,m)},s.paste=f,s.moveTextAreaUnderMouseCursor=h,s.rightClickHandler=function(v,y,C,m,n){h(v,y,C),n&&m.rightClickSelect(v),y.value=m.selectionText,y.select()}},7239:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const d=c(1505);s.ColorContrastCache=class{constructor(){this._color=new d.TwoKeyMap,this._css=new d.TwoKeyMap}setCss(f,h,v){this._css.set(f,h,v)}getCss(f,h){return this._css.get(f,h)}setColor(f,h,v){this._color.set(f,h,v)}getColor(f,h){return this._color.get(f,h)}clear(){this._color.clear(),this._css.clear()}}},3656:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(c,d,f,h){c.addEventListener(d,f,h);let v=!1;return{dispose:()=>{v||(v=!0,c.removeEventListener(d,f,h))}}}},3551:function(_,s,c){var d=this&&this.__decorate||function(l,o,a,g){var b,w=arguments.length,k=w<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,a):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(l,o,a,g);else for(var S=l.length-1;S>=0;S--)(b=l[S])&&(k=(w<3?b(k):w>3?b(o,a,k):b(o,a))||k);return w>3&&k&&Object.defineProperty(o,a,k),k},f=this&&this.__param||function(l,o){return function(a,g){o(a,g,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier=void 0;const h=c(3656),v=c(8460),y=c(844),C=c(2585),m=c(4725);let n=s.Linkifier=class extends y.Disposable{get currentLink(){return this._currentLink}constructor(l,o,a,g,b){super(),this._element=l,this._mouseService=o,this._renderService=a,this._bufferService=g,this._linkProviderService=b,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new v.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new v.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,y.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,y.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,h.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,h.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(l){this._lastMouseEvent=l;const o=this._positionFromMouseEvent(l,this._element,this._mouseService);if(!o)return;this._isMouseOut=!1;const a=l.composedPath();for(let g=0;g<a.length;g++){const b=a[g];if(b.classList.contains("xterm"))break;if(b.classList.contains("xterm-hover"))return}this._lastBufferCell&&o.x===this._lastBufferCell.x&&o.y===this._lastBufferCell.y||(this._handleHover(o),this._lastBufferCell=o)}_handleHover(l){if(this._activeLine!==l.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(l,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,l)||(this._clearCurrentLink(),this._askForLink(l,!0))}_askForLink(l,o){this._activeProviderReplies&&o||(this._activeProviderReplies?.forEach(g=>{g?.forEach(b=>{b.link.dispose&&b.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=l.y);let a=!1;for(const[g,b]of this._linkProviderService.linkProviders.entries())o?this._activeProviderReplies?.get(g)&&(a=this._checkLinkProviderResult(g,l,a)):b.provideLinks(l.y,w=>{if(this._isMouseOut)return;const k=w?.map(S=>({link:S}));this._activeProviderReplies?.set(g,k),a=this._checkLinkProviderResult(g,l,a),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(l.y,this._activeProviderReplies)})}_removeIntersectingLinks(l,o){const a=new Set;for(let g=0;g<o.size;g++){const b=o.get(g);if(b)for(let w=0;w<b.length;w++){const k=b[w],S=k.link.range.start.y<l?0:k.link.range.start.x,R=k.link.range.end.y>l?this._bufferService.cols:k.link.range.end.x;for(let P=S;P<=R;P++){if(a.has(P)){b.splice(w--,1);break}a.add(P)}}}}_checkLinkProviderResult(l,o,a){if(!this._activeProviderReplies)return a;const g=this._activeProviderReplies.get(l);let b=!1;for(let w=0;w<l;w++)this._activeProviderReplies.has(w)&&!this._activeProviderReplies.get(w)||(b=!0);if(!b&&g){const w=g.find(k=>this._linkAtPosition(k.link,o));w&&(a=!0,this._handleNewLink(w))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!a)for(let w=0;w<this._activeProviderReplies.size;w++){const k=this._activeProviderReplies.get(w)?.find(S=>this._linkAtPosition(S.link,o));if(k){a=!0,this._handleNewLink(k);break}}return a}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(l){if(!this._currentLink)return;const o=this._positionFromMouseEvent(l,this._element,this._mouseService);o&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,o)&&this._currentLink.link.activate(l,this._currentLink.link.text)}_clearCurrentLink(l,o){this._currentLink&&this._lastMouseEvent&&(!l||!o||this._currentLink.link.range.start.y>=l&&this._currentLink.link.range.end.y<=o)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,y.disposeArray)(this._linkCacheDisposables))}_handleNewLink(l){if(!this._lastMouseEvent)return;const o=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);o&&this._linkAtPosition(l.link,o)&&(this._currentLink=l,this._currentLink.state={decorations:{underline:l.link.decorations===void 0||l.link.decorations.underline,pointerCursor:l.link.decorations===void 0||l.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,l.link,this._lastMouseEvent),l.link.decorations={},Object.defineProperties(l.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:a=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==a&&(this._currentLink.state.decorations.pointerCursor=a,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",a))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:a=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==a&&(this._currentLink.state.decorations.underline=a,this._currentLink.state.isHovered&&this._fireUnderlineEvent(l.link,a))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(a=>{if(!this._currentLink)return;const g=a.start===0?0:a.start+1+this._bufferService.buffer.ydisp,b=this._bufferService.buffer.ydisp+1+a.end;if(this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=b&&(this._clearCurrentLink(g,b),this._lastMouseEvent)){const w=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);w&&this._askForLink(w,!1)}})))}_linkHover(l,o,a){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!0),this._currentLink.state.decorations.pointerCursor&&l.classList.add("xterm-cursor-pointer")),o.hover&&o.hover(a,o.text)}_fireUnderlineEvent(l,o){const a=l.range,g=this._bufferService.buffer.ydisp,b=this._createLinkUnderlineEvent(a.start.x-1,a.start.y-g-1,a.end.x,a.end.y-g-1,void 0);(o?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(b)}_linkLeave(l,o,a){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(o,!1),this._currentLink.state.decorations.pointerCursor&&l.classList.remove("xterm-cursor-pointer")),o.leave&&o.leave(a,o.text)}_linkAtPosition(l,o){const a=l.range.start.y*this._bufferService.cols+l.range.start.x,g=l.range.end.y*this._bufferService.cols+l.range.end.x,b=o.y*this._bufferService.cols+o.x;return a<=b&&b<=g}_positionFromMouseEvent(l,o,a){const g=a.getCoords(l,o,this._bufferService.cols,this._bufferService.rows);if(g)return{x:g[0],y:g[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(l,o,a,g,b){return{x1:l,y1:o,x2:a,y2:g,cols:this._bufferService.cols,fg:b}}};s.Linkifier=n=d([f(1,m.IMouseService),f(2,m.IRenderService),f(3,C.IBufferService),f(4,m.ILinkProviderService)],n)},9042:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(_,s,c){var d=this&&this.__decorate||function(m,n,l,o){var a,g=arguments.length,b=g<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,l):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,n,l,o);else for(var w=m.length-1;w>=0;w--)(a=m[w])&&(b=(g<3?a(b):g>3?a(n,l,b):a(n,l))||b);return g>3&&b&&Object.defineProperty(n,l,b),b},f=this&&this.__param||function(m,n){return function(l,o){n(l,o,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const h=c(511),v=c(2585);let y=s.OscLinkProvider=class{constructor(m,n,l){this._bufferService=m,this._optionsService=n,this._oscLinkService=l}provideLinks(m,n){const l=this._bufferService.buffer.lines.get(m-1);if(!l)return void n(void 0);const o=[],a=this._optionsService.rawOptions.linkHandler,g=new h.CellData,b=l.getTrimmedLength();let w=-1,k=-1,S=!1;for(let R=0;R<b;R++)if(k!==-1||l.hasContent(R)){if(l.loadCell(R,g),g.hasExtendedAttrs()&&g.extended.urlId){if(k===-1){k=R,w=g.extended.urlId;continue}S=g.extended.urlId!==w}else k!==-1&&(S=!0);if(S||k!==-1&&R===b-1){const P=this._oscLinkService.getLinkData(w)?.uri;if(P){const B={start:{x:k+1,y:m},end:{x:R+(S||R!==b-1?0:1),y:m}};let I=!1;if(!a?.allowNonHttpProtocols)try{const A=new URL(P);["http:","https:"].includes(A.protocol)||(I=!0)}catch{I=!0}I||o.push({text:P,range:B,activate:(A,N)=>a?a.activate(A,N,B):C(0,N),hover:(A,N)=>a?.hover?.(A,N,B),leave:(A,N)=>a?.leave?.(A,N,B)})}S=!1,g.hasExtendedAttrs()&&g.extended.urlId?(k=R,w=g.extended.urlId):(k=-1,w=-1)}}n(o)}};function C(m,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const l=window.open();if(l){try{l.opener=null}catch{}l.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}s.OscLinkProvider=y=d([f(0,v.IBufferService),f(1,v.IOptionsService),f(2,v.IOscLinkService)],y)},6193:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(c,d){this._renderCallback=c,this._coreBrowserService=d,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(c){return this._refreshCallbacks.push(c),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(c,d,f){this._rowCount=f,c=c!==void 0?c:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,c):c,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const c=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(c,d),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const c of this._refreshCallbacks)c(0);this._refreshCallbacks=[]}}},3236:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const d=c(3614),f=c(3656),h=c(3551),v=c(9042),y=c(3730),C=c(1680),m=c(3107),n=c(5744),l=c(2950),o=c(1296),a=c(428),g=c(4269),b=c(5114),w=c(8934),k=c(3230),S=c(9312),R=c(4725),P=c(6731),B=c(8055),I=c(8969),A=c(8460),N=c(844),U=c(6114),X=c(8437),J=c(2584),K=c(7399),T=c(5941),E=c(9074),x=c(2585),D=c(5435),O=c(4567),$=c(779);class V extends I.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(M={}){super(M),this.browser=U,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new N.MutableDisposable),this._onCursorMove=this.register(new A.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new A.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new A.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new A.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new A.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new A.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new A.EventEmitter),this._onBlur=this.register(new A.EventEmitter),this._onA11yCharEmitter=this.register(new A.EventEmitter),this._onA11yTabEmitter=this.register(new A.EventEmitter),this._onWillOpen=this.register(new A.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(E.DecorationService),this._instantiationService.setService(x.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance($.LinkProviderService),this._instantiationService.setService(R.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(y.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((L,F)=>this.refresh(L,F))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(L=>this._reportWindowsOptions(L))),this.register(this._inputHandler.onColor(L=>this._handleColorEvent(L))),this.register((0,A.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,A.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(L=>this._afterResize(L.cols,L.rows))),this.register((0,N.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(M){if(this._themeService)for(const L of M){let F,W="";switch(L.index){case 256:F="foreground",W="10";break;case 257:F="background",W="11";break;case 258:F="cursor",W="12";break;default:F="ansi",W="4;"+L.index}switch(L.type){case 0:const z=B.color.toColorRGB(F==="ansi"?this._themeService.colors.ansi[L.index]:this._themeService.colors[F]);this.coreService.triggerDataEvent(`${J.C0.ESC}]${W};${(0,T.toRgbString)(z)}${J.C1_ESCAPED.ST}`);break;case 1:if(F==="ansi")this._themeService.modifyColors(j=>j.ansi[L.index]=B.channels.toColor(...L.color));else{const j=F;this._themeService.modifyColors(te=>te[j]=B.channels.toColor(...L.color))}break;case 2:this._themeService.restoreColor(L.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(M){M?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(O.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(M){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const M=this.buffer.ybase+this.buffer.y,L=this.buffer.lines.get(M);if(!L)return;const F=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,z=L.getWidth(F),j=this._renderService.dimensions.css.cell.width*z,te=this.buffer.y*this._renderService.dimensions.css.cell.height,Q=F*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Q+"px",this.textarea.style.top=te+"px",this.textarea.style.width=j+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,f.addDisposableDomListener)(this.element,"copy",L=>{this.hasSelection()&&(0,d.copyHandler)(L,this._selectionService)}));const M=L=>(0,d.handlePasteEvent)(L,this.textarea,this.coreService,this.optionsService);this.register((0,f.addDisposableDomListener)(this.textarea,"paste",M)),this.register((0,f.addDisposableDomListener)(this.element,"paste",M)),U.isFirefox?this.register((0,f.addDisposableDomListener)(this.element,"mousedown",L=>{L.button===2&&(0,d.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,f.addDisposableDomListener)(this.element,"contextmenu",L=>{(0,d.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),U.isLinux&&this.register((0,f.addDisposableDomListener)(this.element,"auxclick",L=>{L.button===1&&(0,d.moveTextAreaUnderMouseCursor)(L,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,f.addDisposableDomListener)(this.textarea,"keyup",M=>this._keyUp(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keydown",M=>this._keyDown(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keypress",M=>this._keyPress(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionupdate",M=>this._compositionHelper.compositionupdate(M))),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,f.addDisposableDomListener)(this.textarea,"input",M=>this._inputEvent(M),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(M){if(!M)throw new Error("Terminal requires a parent element.");if(M.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=M.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),M.appendChild(this.element);const L=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),L.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,f.addDisposableDomListener)(this.screenElement,"mousemove",F=>this.updateCursorStyle(F))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),L.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",v.promptLabel),U.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,M.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(R.ICoreBrowserService,this._coreBrowserService),this.register((0,f.addDisposableDomListener)(this.textarea,"focus",F=>this._handleTextAreaFocus(F))),this.register((0,f.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(a.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(R.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(P.ThemeService),this._instantiationService.setService(R.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(g.CharacterJoinerService),this._instantiationService.setService(R.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(R.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(F=>this._onRender.fire(F))),this.onResize(F=>this._renderService.resize(F.cols,F.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(l.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(w.MouseService),this._instantiationService.setService(R.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(h.Linkifier,this.screenElement)),this.element.appendChild(L);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(C.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(S.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(R.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(F=>this._renderService.handleSelectionChanged(F.start,F.end,F.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(F=>{this.textarea.value=F,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(F=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,f.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(m.BufferDecorationRenderer,this.screenElement)),this.register((0,f.addDisposableDomListener)(this.element,"mousedown",F=>this._selectionService.handleMouseDown(F))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(O.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",F=>this._handleScreenReaderModeOptionChange(F))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",F=>{!this._overviewRulerRenderer&&F&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(o.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const M=this,L=this.element;function F(j){const te=M._mouseService.getMouseReportCoords(j,M.screenElement);if(!te)return!1;let Q,oe;switch(j.overrideType||j.type){case"mousemove":oe=32,j.buttons===void 0?(Q=3,j.button!==void 0&&(Q=j.button<3?j.button:3)):Q=1&j.buttons?0:4&j.buttons?1:2&j.buttons?2:3;break;case"mouseup":oe=0,Q=j.button<3?j.button:3;break;case"mousedown":oe=1,Q=j.button<3?j.button:3;break;case"wheel":if(M._customWheelEventHandler&&M._customWheelEventHandler(j)===!1||M.viewport.getLinesScrolled(j)===0)return!1;oe=j.deltaY<0?0:1,Q=4;break;default:return!1}return!(oe===void 0||Q===void 0||Q>4)&&M.coreMouseService.triggerMouseEvent({col:te.col,row:te.row,x:te.x,y:te.y,button:Q,action:oe,ctrl:j.ctrlKey,alt:j.altKey,shift:j.shiftKey})}const W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},z={mouseup:j=>(F(j),j.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(j)),wheel:j=>(F(j),this.cancel(j,!0)),mousedrag:j=>{j.buttons&&F(j)},mousemove:j=>{j.buttons||F(j)}};this.register(this.coreMouseService.onProtocolChange(j=>{j?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(j)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&j?W.mousemove||(L.addEventListener("mousemove",z.mousemove),W.mousemove=z.mousemove):(L.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&j?W.wheel||(L.addEventListener("wheel",z.wheel,{passive:!1}),W.wheel=z.wheel):(L.removeEventListener("wheel",W.wheel),W.wheel=null),2&j?W.mouseup||(W.mouseup=z.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&j?W.mousedrag||(W.mousedrag=z.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,f.addDisposableDomListener)(L,"mousedown",j=>{if(j.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(j))return F(j),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(j)})),this.register((0,f.addDisposableDomListener)(L,"wheel",j=>{if(!W.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(j)===!1)return!1;if(!this.buffer.hasScrollback){const te=this.viewport.getLinesScrolled(j);if(te===0)return;const Q=J.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(j.deltaY<0?"A":"B");let oe="";for(let ce=0;ce<Math.abs(te);ce++)oe+=Q;return this.coreService.triggerDataEvent(oe,!0),this.cancel(j,!0)}return this.viewport.handleWheel(j)?this.cancel(j):void 0}},{passive:!1})),this.register((0,f.addDisposableDomListener)(L,"touchstart",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(j),this.cancel(j)},{passive:!0})),this.register((0,f.addDisposableDomListener)(L,"touchmove",j=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(j)?void 0:this.cancel(j)},{passive:!1}))}refresh(M,L){this._renderService?.refreshRows(M,L)}updateCursorStyle(M){this._selectionService?.shouldColumnSelect(M)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(M,L,F=0){F===1?(super.scrollLines(M,L,F),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(M)}paste(M){(0,d.paste)(M,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(M){this._customKeyEventHandler=M}attachCustomWheelEventHandler(M){this._customWheelEventHandler=M}registerLinkProvider(M){return this._linkProviderService.registerLinkProvider(M)}registerCharacterJoiner(M){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const L=this._characterJoinerService.register(M);return this.refresh(0,this.rows-1),L}deregisterCharacterJoiner(M){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(M)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(M){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+M)}registerDecoration(M){return this._decorationService.registerDecoration(M)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(M,L,F){this._selectionService.setSelection(M,L,F)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(M,L){this._selectionService?.selectLines(M,L)}_keyDown(M){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(M)===!1)return!1;const L=this.browser.isMac&&this.options.macOptionIsMeta&&M.altKey;if(!L&&!this._compositionHelper.keydown(M))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;L||M.key!=="Dead"&&M.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const F=(0,K.evaluateKeyboardEvent)(M,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(M),F.type===3||F.type===2){const W=this.rows-1;return this.scrollLines(F.type===2?-W:W),this.cancel(M,!0)}return F.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,M)||(F.cancel&&this.cancel(M,!0),!F.key||!!(M.key&&!M.ctrlKey&&!M.altKey&&!M.metaKey&&M.key.length===1&&M.key.charCodeAt(0)>=65&&M.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(F.key!==J.C0.ETX&&F.key!==J.C0.CR||(this.textarea.value=""),this._onKey.fire({key:F.key,domEvent:M}),this._showCursor(),this.coreService.triggerDataEvent(F.key,!0),!this.optionsService.rawOptions.screenReaderMode||M.altKey||M.ctrlKey?this.cancel(M,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(M,L){const F=M.isMac&&!this.options.macOptionIsMeta&&L.altKey&&!L.ctrlKey&&!L.metaKey||M.isWindows&&L.altKey&&L.ctrlKey&&!L.metaKey||M.isWindows&&L.getModifierState("AltGraph");return L.type==="keypress"?F:F&&(!L.keyCode||L.keyCode>47)}_keyUp(M){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(M)===!1||(function(L){return L.keyCode===16||L.keyCode===17||L.keyCode===18}(M)||this.focus(),this.updateCursorStyle(M),this._keyPressHandled=!1)}_keyPress(M){let L;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(M)===!1)return!1;if(this.cancel(M),M.charCode)L=M.charCode;else if(M.which===null||M.which===void 0)L=M.keyCode;else{if(M.which===0||M.charCode===0)return!1;L=M.which}return!(!L||(M.altKey||M.ctrlKey||M.metaKey)&&!this._isThirdLevelShift(this.browser,M)||(L=String.fromCharCode(L),this._onKey.fire({key:L,domEvent:M}),this._showCursor(),this.coreService.triggerDataEvent(L,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(M){if(M.data&&M.inputType==="insertText"&&(!M.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const L=M.data;return this.coreService.triggerDataEvent(L,!0),this.cancel(M),!0}return!1}resize(M,L){M!==this.cols||L!==this.rows?super.resize(M,L):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(M,L){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let M=1;M<this.rows;M++)this.buffer.lines.push(this.buffer.getBlankLine(X.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const M=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=M,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(J.C0.ESC+"[I"):this.coreService.triggerDataEvent(J.C0.ESC+"[O")}_reportWindowsOptions(M){if(this._renderService)switch(M){case D.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const L=this._renderService.dimensions.css.canvas.width.toFixed(0),F=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[4;${F};${L}t`);break;case D.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const W=this._renderService.dimensions.css.cell.width.toFixed(0),z=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[6;${z};${W}t`)}}cancel(M,L){if(this.options.cancelEvents||L)return M.preventDefault(),M.stopPropagation(),!1}}s.Terminal=V},9924:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(c,d=1e3){this._renderCallback=c,this._debounceThresholdMS=d,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(c,d,f){this._rowCount=f,c=c!==void 0?c:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,c):c,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d;const h=Date.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){const v=h-this._lastRefreshMs,y=this._debounceThresholdMS-v;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},y)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const c=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(c,d)}}},1680:function(_,s,c){var d=this&&this.__decorate||function(l,o,a,g){var b,w=arguments.length,k=w<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,a):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(l,o,a,g);else for(var S=l.length-1;S>=0;S--)(b=l[S])&&(k=(w<3?b(k):w>3?b(o,a,k):b(o,a))||k);return w>3&&k&&Object.defineProperty(o,a,k),k},f=this&&this.__param||function(l,o){return function(a,g){o(a,g,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const h=c(3656),v=c(4725),y=c(8460),C=c(844),m=c(2585);let n=s.Viewport=class extends C.Disposable{constructor(l,o,a,g,b,w,k,S){super(),this._viewportElement=l,this._scrollArea=o,this._bufferService=a,this._optionsService=g,this._charSizeService=b,this._renderService=w,this._coreBrowserService=k,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new y.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(R=>this._renderDimensions=R)),this._handleThemeChange(S.colors),this.register(S.onChangeColors(R=>this._handleThemeChange(R))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(l){this._viewportElement.style.backgroundColor=l.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(l){if(l)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const o=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==o&&(this._lastRecordedBufferHeight=o,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const l=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==l&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=l),this._refreshAnimationFrame=null}syncScrollArea(l=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(l);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(l)}_handleScroll(l){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const o=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const l=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(l*(this._smoothScrollState.target-this._smoothScrollState.origin)),l<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(l,o){const a=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(o<0&&this._viewportElement.scrollTop!==0||o>0&&a<this._lastRecordedBufferHeight)||(l.cancelable&&l.preventDefault(),!1)}handleWheel(l){const o=this._getPixelsScrolled(l);return o!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+o:this._smoothScrollState.target+=o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=o,this._bubbleScroll(l,o))}scrollLines(l){if(l!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const o=l*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:l,suppressScrollEvent:!1})}_getPixelsScrolled(l){if(l.deltaY===0||l.shiftKey)return 0;let o=this._applyScrollModifier(l.deltaY,l);return l.deltaMode===WheelEvent.DOM_DELTA_LINE?o*=this._currentRowHeight:l.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._currentRowHeight*this._bufferService.rows),o}getBufferElements(l,o){let a,g="";const b=[],w=o??this._bufferService.buffer.lines.length,k=this._bufferService.buffer.lines;for(let S=l;S<w;S++){const R=k.get(S);if(!R)continue;const P=k.get(S+1)?.isWrapped;if(g+=R.translateToString(!P),!P||S===k.length-1){const B=document.createElement("div");B.textContent=g,b.push(B),g.length>0&&(a=B),g=""}}return{bufferElements:b,cursorElement:a}}getLinesScrolled(l){if(l.deltaY===0||l.shiftKey)return 0;let o=this._applyScrollModifier(l.deltaY,l);return l.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(o/=this._currentRowHeight+0,this._wheelPartialScroll+=o,o=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):l.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._bufferService.rows),o}_applyScrollModifier(l,o){const a=this._optionsService.rawOptions.fastScrollModifier;return a==="alt"&&o.altKey||a==="ctrl"&&o.ctrlKey||a==="shift"&&o.shiftKey?l*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:l*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(l){this._lastTouchY=l.touches[0].pageY}handleTouchMove(l){const o=this._lastTouchY-l.touches[0].pageY;return this._lastTouchY=l.touches[0].pageY,o!==0&&(this._viewportElement.scrollTop+=o,this._bubbleScroll(l,o))}};s.Viewport=n=d([f(2,m.IBufferService),f(3,m.IOptionsService),f(4,v.ICharSizeService),f(5,v.IRenderService),f(6,v.ICoreBrowserService),f(7,v.IThemeService)],n)},3107:function(_,s,c){var d=this&&this.__decorate||function(m,n,l,o){var a,g=arguments.length,b=g<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,l):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,n,l,o);else for(var w=m.length-1;w>=0;w--)(a=m[w])&&(b=(g<3?a(b):g>3?a(n,l,b):a(n,l))||b);return g>3&&b&&Object.defineProperty(n,l,b),b},f=this&&this.__param||function(m,n){return function(l,o){n(l,o,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const h=c(4725),v=c(844),y=c(2585);let C=s.BufferDecorationRenderer=class extends v.Disposable{constructor(m,n,l,o,a){super(),this._screenElement=m,this._bufferService=n,this._coreBrowserService=l,this._decorationService=o,this._renderService=a,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(g=>this._removeDecoration(g))),this.register((0,v.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const m of this._decorationService.decorations)this._renderDecoration(m);this._dimensionsChanged=!1}_renderDecoration(m){this._refreshStyle(m),this._dimensionsChanged&&this._refreshXPosition(m)}_createElement(m){const n=this._coreBrowserService.mainDocument.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer",m?.options?.layer==="top"),n.style.width=`${Math.round((m.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(m.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(m.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const l=m.options.x??0;return l&&l>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(m,n),n}_refreshStyle(m){const n=m.marker.line-this._bufferService.buffers.active.ydisp;if(n<0||n>=this._bufferService.rows)m.element&&(m.element.style.display="none",m.onRenderEmitter.fire(m.element));else{let l=this._decorationElements.get(m);l||(l=this._createElement(m),m.element=l,this._decorationElements.set(m,l),this._container.appendChild(l),m.onDispose(()=>{this._decorationElements.delete(m),l.remove()})),l.style.top=n*this._renderService.dimensions.css.cell.height+"px",l.style.display=this._altBufferIsActive?"none":"block",m.onRenderEmitter.fire(l)}}_refreshXPosition(m,n=m.element){if(!n)return;const l=m.options.x??0;(m.options.anchor||"left")==="right"?n.style.right=l?l*this._renderService.dimensions.css.cell.width+"px":"":n.style.left=l?l*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(m){this._decorationElements.get(m)?.remove(),this._decorationElements.delete(m),m.dispose()}};s.BufferDecorationRenderer=C=d([f(1,y.IBufferService),f(2,h.ICoreBrowserService),f(3,y.IDecorationService),f(4,h.IRenderService)],C)},5871:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(c){if(c.options.overviewRulerOptions){for(const d of this._zones)if(d.color===c.options.overviewRulerOptions.color&&d.position===c.options.overviewRulerOptions.position){if(this._lineIntersectsZone(d,c.marker.line))return;if(this._lineAdjacentToZone(d,c.marker.line,c.options.overviewRulerOptions.position))return void this._addLineToZone(d,c.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=c.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=c.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=c.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=c.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:c.options.overviewRulerOptions.color,position:c.options.overviewRulerOptions.position,startBufferLine:c.marker.line,endBufferLine:c.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(c){this._linePadding=c}_lineIntersectsZone(c,d){return d>=c.startBufferLine&&d<=c.endBufferLine}_lineAdjacentToZone(c,d,f){return d>=c.startBufferLine-this._linePadding[f||"full"]&&d<=c.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(c,d){c.startBufferLine=Math.min(c.startBufferLine,d),c.endBufferLine=Math.max(c.endBufferLine,d)}}},5744:function(_,s,c){var d=this&&this.__decorate||function(a,g,b,w){var k,S=arguments.length,R=S<3?g:w===null?w=Object.getOwnPropertyDescriptor(g,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(a,g,b,w);else for(var P=a.length-1;P>=0;P--)(k=a[P])&&(R=(S<3?k(R):S>3?k(g,b,R):k(g,b))||R);return S>3&&R&&Object.defineProperty(g,b,R),R},f=this&&this.__param||function(a,g){return function(b,w){g(b,w,a)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const h=c(5871),v=c(4725),y=c(844),C=c(2585),m={full:0,left:0,center:0,right:0},n={full:0,left:0,center:0,right:0},l={full:0,left:0,center:0,right:0};let o=s.OverviewRulerRenderer=class extends y.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(a,g,b,w,k,S,R){super(),this._viewportElement=a,this._screenElement=g,this._bufferService=b,this._decorationService=w,this._renderService=k,this._optionsService=S,this._coreBrowserService=R,this._colorZoneStore=new h.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const P=this._canvas.getContext("2d");if(!P)throw new Error("Ctx cannot be null");this._ctx=P,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,y.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const a=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);n.full=this._canvas.width,n.left=a,n.center=g,n.right=a,this._refreshDrawHeightConstants(),l.full=0,l.left=0,l.center=n.left,l.right=n.left+n.center}_refreshDrawHeightConstants(){m.full=Math.round(2*this._coreBrowserService.dpr);const a=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(a,12),6)*this._coreBrowserService.dpr);m.left=g,m.center=g,m.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*m.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const a=this._colorZoneStore.zones;for(const g of a)g.position!=="full"&&this._renderColorZone(g);for(const g of a)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(a){this._ctx.fillStyle=a.color,this._ctx.fillRect(l[a.position||"full"],Math.round((this._canvas.height-1)*(a.startBufferLine/this._bufferService.buffers.active.lines.length)-m[a.position||"full"]/2),n[a.position||"full"],Math.round((this._canvas.height-1)*((a.endBufferLine-a.startBufferLine)/this._bufferService.buffers.active.lines.length)+m[a.position||"full"]))}_queueRefresh(a,g){this._shouldUpdateDimensions=a||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s.OverviewRulerRenderer=o=d([f(2,C.IBufferService),f(3,C.IDecorationService),f(4,v.IRenderService),f(5,C.IOptionsService),f(6,v.ICoreBrowserService)],o)},2950:function(_,s,c){var d=this&&this.__decorate||function(m,n,l,o){var a,g=arguments.length,b=g<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,l):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,n,l,o);else for(var w=m.length-1;w>=0;w--)(a=m[w])&&(b=(g<3?a(b):g>3?a(n,l,b):a(n,l))||b);return g>3&&b&&Object.defineProperty(n,l,b),b},f=this&&this.__param||function(m,n){return function(l,o){n(l,o,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const h=c(4725),v=c(2585),y=c(2584);let C=s.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(m,n,l,o,a,g){this._textarea=m,this._compositionView=n,this._bufferService=l,this._optionsService=o,this._coreService=a,this._renderService=g,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(m){this._compositionView.textContent=m.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(m){if(this._isComposing||this._isSendingComposition){if(m.keyCode===229||m.keyCode===16||m.keyCode===17||m.keyCode===18)return!1;this._finalizeComposition(!1)}return m.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(m){if(this._compositionView.classList.remove("active"),this._isComposing=!1,m){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let l;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,l=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),l.length>0&&this._coreService.triggerDataEvent(l,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const m=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,l=n.replace(m,"");this._dataAlreadySent=l,n.length>m.length?this._coreService.triggerDataEvent(l,!0):n.length<m.length?this._coreService.triggerDataEvent(`${y.C0.DEL}`,!0):n.length===m.length&&n!==m&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(m){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),l=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,a=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=a+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=l+"px",this._compositionView.style.lineHeight=l+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const g=this._compositionView.getBoundingClientRect();this._textarea.style.left=a+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(g.width,1)+"px",this._textarea.style.height=Math.max(g.height,1)+"px",this._textarea.style.lineHeight=g.height+"px"}m||setTimeout(()=>this.updateCompositionElements(!0),0)}}};s.CompositionHelper=C=d([f(2,v.IBufferService),f(3,v.IOptionsService),f(4,v.ICoreService),f(5,h.IRenderService)],C)},9806:(_,s)=>{function c(d,f,h){const v=h.getBoundingClientRect(),y=d.getComputedStyle(h),C=parseInt(y.getPropertyValue("padding-left")),m=parseInt(y.getPropertyValue("padding-top"));return[f.clientX-v.left-C,f.clientY-v.top-m]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=c,s.getCoords=function(d,f,h,v,y,C,m,n,l){if(!C)return;const o=c(d,f,h);return o?(o[0]=Math.ceil((o[0]+(l?m/2:0))/m),o[1]=Math.ceil(o[1]/n),o[0]=Math.min(Math.max(o[0],1),v+(l?1:0)),o[1]=Math.min(Math.max(o[1],1),y),o):void 0}},9504:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const d=c(2584);function f(n,l,o,a){const g=n-h(n,o),b=l-h(l,o),w=Math.abs(g-b)-function(k,S,R){let P=0;const B=k-h(k,R),I=S-h(S,R);for(let A=0;A<Math.abs(B-I);A++){const N=v(k,S)==="A"?-1:1;R.buffer.lines.get(B+N*A)?.isWrapped&&P++}return P}(n,l,o);return m(w,C(v(n,l),a))}function h(n,l){let o=0,a=l.buffer.lines.get(n),g=a?.isWrapped;for(;g&&n>=0&&n<l.rows;)o++,a=l.buffer.lines.get(--n),g=a?.isWrapped;return o}function v(n,l){return n>l?"A":"B"}function y(n,l,o,a,g,b){let w=n,k=l,S="";for(;w!==o||k!==a;)w+=g?1:-1,g&&w>b.cols-1?(S+=b.buffer.translateBufferLineToString(k,!1,n,w),w=0,n=0,k++):!g&&w<0&&(S+=b.buffer.translateBufferLineToString(k,!1,0,n+1),w=b.cols-1,n=w,k--);return S+b.buffer.translateBufferLineToString(k,!1,n,w)}function C(n,l){const o=l?"O":"[";return d.C0.ESC+o+n}function m(n,l){n=Math.floor(n);let o="";for(let a=0;a<n;a++)o+=l;return o}s.moveToCellSequence=function(n,l,o,a){const g=o.buffer.x,b=o.buffer.y;if(!o.buffer.hasScrollback)return function(S,R,P,B,I,A){return f(R,B,I,A).length===0?"":m(y(S,R,S,R-h(R,I),!1,I).length,C("D",A))}(g,b,0,l,o,a)+f(b,l,o,a)+function(S,R,P,B,I,A){let N;N=f(R,B,I,A).length>0?B-h(B,I):R;const U=B,X=function(J,K,T,E,x,D){let O;return O=f(T,E,x,D).length>0?E-h(E,x):K,J<T&&O<=E||J>=T&&O<E?"C":"D"}(S,R,P,B,I,A);return m(y(S,N,P,U,X==="C",I).length,C(X,A))}(g,b,n,l,o,a);let w;if(b===l)return w=g>n?"D":"C",m(Math.abs(g-n),C(w,a));w=b>l?"D":"C";const k=Math.abs(b-l);return m(function(S,R){return R.cols-S}(b>l?n:g,o)+(k-1)*o.cols+1+((b>l?g:n)-1),C(w,a))}},1296:function(_,s,c){var d=this&&this.__decorate||function(A,N,U,X){var J,K=arguments.length,T=K<3?N:X===null?X=Object.getOwnPropertyDescriptor(N,U):X;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(A,N,U,X);else for(var E=A.length-1;E>=0;E--)(J=A[E])&&(T=(K<3?J(T):K>3?J(N,U,T):J(N,U))||T);return K>3&&T&&Object.defineProperty(N,U,T),T},f=this&&this.__param||function(A,N){return function(U,X){N(U,X,A)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const h=c(3787),v=c(2550),y=c(2223),C=c(6171),m=c(6052),n=c(4725),l=c(8055),o=c(8460),a=c(844),g=c(2585),b="xterm-dom-renderer-owner-",w="xterm-rows",k="xterm-fg-",S="xterm-bg-",R="xterm-focus",P="xterm-selection";let B=1,I=s.DomRenderer=class extends a.Disposable{constructor(A,N,U,X,J,K,T,E,x,D,O,$,V){super(),this._terminal=A,this._document=N,this._element=U,this._screenElement=X,this._viewportElement=J,this._helperContainer=K,this._linkifier2=T,this._charSizeService=x,this._optionsService=D,this._bufferService=O,this._coreBrowserService=$,this._themeService=V,this._terminalClass=B++,this._rowElements=[],this._selectionRenderModel=(0,m.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new o.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(w),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(P),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,C.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(q=>this._injectCss(q))),this._injectCss(this._themeService.colors),this._rowFactory=E.createInstance(h.DomRendererRowFactory,document),this._element.classList.add(b+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(q=>this._handleLinkHover(q))),this.register(this._linkifier2.onHideLinkUnderline(q=>this._handleLinkLeave(q))),this.register((0,a.toDisposable)(()=>{this._element.classList.remove(b+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new v.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const A=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*A,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*A),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/A),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/A),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const U of this._rowElements)U.style.width=`${this.dimensions.css.canvas.width}px`,U.style.height=`${this.dimensions.css.cell.height}px`,U.style.lineHeight=`${this.dimensions.css.cell.height}px`,U.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const N=`${this._terminalSelector} .${w} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=N,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(A){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let N=`${this._terminalSelector} .${w} { color: ${A.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;N+=`${this._terminalSelector} .${w} .xterm-dim { color: ${l.color.multiplyOpacity(A.foreground,.5).css};}`,N+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const U=`blink_underline_${this._terminalClass}`,X=`blink_bar_${this._terminalClass}`,J=`blink_block_${this._terminalClass}`;N+=`@keyframes ${U} { 50% {  border-bottom-style: hidden; }}`,N+=`@keyframes ${X} { 50% {  box-shadow: none; }}`,N+=`@keyframes ${J} { 0% {  background-color: ${A.cursor.css};  color: ${A.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${A.cursor.css}; }}`,N+=`${this._terminalSelector} .${w}.${R} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${U} 1s step-end infinite;}${this._terminalSelector} .${w}.${R} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${w}.${R} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${J} 1s step-end infinite;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-block { background-color: ${A.cursor.css}; color: ${A.cursorAccent.css};}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${A.cursor.css} !important; color: ${A.cursorAccent.css} !important;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${A.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${A.cursor.css} inset;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${A.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,N+=`${this._terminalSelector} .${P} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${P} div { position: absolute; background-color: ${A.selectionBackgroundOpaque.css};}${this._terminalSelector} .${P} div { position: absolute; background-color: ${A.selectionInactiveBackgroundOpaque.css};}`;for(const[K,T]of A.ansi.entries())N+=`${this._terminalSelector} .${k}${K} { color: ${T.css}; }${this._terminalSelector} .${k}${K}.xterm-dim { color: ${l.color.multiplyOpacity(T,.5).css}; }${this._terminalSelector} .${S}${K} { background-color: ${T.css}; }`;N+=`${this._terminalSelector} .${k}${y.INVERTED_DEFAULT_COLOR} { color: ${l.color.opaque(A.background).css}; }${this._terminalSelector} .${k}${y.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${l.color.multiplyOpacity(l.color.opaque(A.background),.5).css}; }${this._terminalSelector} .${S}${y.INVERTED_DEFAULT_COLOR} { background-color: ${A.foreground.css}; }`,this._themeStyleElement.textContent=N}_setDefaultSpacing(){const A=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${A}px`,this._rowFactory.defaultSpacing=A}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(A,N){for(let U=this._rowElements.length;U<=N;U++){const X=this._document.createElement("div");this._rowContainer.appendChild(X),this._rowElements.push(X)}for(;this._rowElements.length>N;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(A,N){this._refreshRowElements(A,N),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(R),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(R),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(A,N,U){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(A,N,U),this.renderRows(0,this._bufferService.rows-1),!A||!N)return;this._selectionRenderModel.update(this._terminal,A,N,U);const X=this._selectionRenderModel.viewportStartRow,J=this._selectionRenderModel.viewportEndRow,K=this._selectionRenderModel.viewportCappedStartRow,T=this._selectionRenderModel.viewportCappedEndRow;if(K>=this._bufferService.rows||T<0)return;const E=this._document.createDocumentFragment();if(U){const x=A[0]>N[0];E.appendChild(this._createSelectionElement(K,x?N[0]:A[0],x?A[0]:N[0],T-K+1))}else{const x=X===K?A[0]:0,D=K===J?N[0]:this._bufferService.cols;E.appendChild(this._createSelectionElement(K,x,D));const O=T-K-1;if(E.appendChild(this._createSelectionElement(K+1,0,this._bufferService.cols,O)),K!==T){const $=J===T?N[0]:this._bufferService.cols;E.appendChild(this._createSelectionElement(T,0,$))}}this._selectionContainer.appendChild(E)}_createSelectionElement(A,N,U,X=1){const J=this._document.createElement("div"),K=N*this.dimensions.css.cell.width;let T=this.dimensions.css.cell.width*(U-N);return K+T>this.dimensions.css.canvas.width&&(T=this.dimensions.css.canvas.width-K),J.style.height=X*this.dimensions.css.cell.height+"px",J.style.top=A*this.dimensions.css.cell.height+"px",J.style.left=`${K}px`,J.style.width=`${T}px`,J}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const A of this._rowElements)A.replaceChildren()}renderRows(A,N){const U=this._bufferService.buffer,X=U.ybase+U.y,J=Math.min(U.x,this._bufferService.cols-1),K=this._optionsService.rawOptions.cursorBlink,T=this._optionsService.rawOptions.cursorStyle,E=this._optionsService.rawOptions.cursorInactiveStyle;for(let x=A;x<=N;x++){const D=x+U.ydisp,O=this._rowElements[x],$=U.lines.get(D);if(!O||!$)break;O.replaceChildren(...this._rowFactory.createRow($,D,D===X,T,E,J,K,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${b}${this._terminalClass}`}_handleLinkHover(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!0)}_handleLinkLeave(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!1)}_setCellUnderline(A,N,U,X,J,K){U<0&&(A=0),X<0&&(N=0);const T=this._bufferService.rows-1;U=Math.max(Math.min(U,T),0),X=Math.max(Math.min(X,T),0),J=Math.min(J,this._bufferService.cols);const E=this._bufferService.buffer,x=E.ybase+E.y,D=Math.min(E.x,J-1),O=this._optionsService.rawOptions.cursorBlink,$=this._optionsService.rawOptions.cursorStyle,V=this._optionsService.rawOptions.cursorInactiveStyle;for(let q=U;q<=X;++q){const M=q+E.ydisp,L=this._rowElements[q],F=E.lines.get(M);if(!L||!F)break;L.replaceChildren(...this._rowFactory.createRow(F,M,M===x,$,V,D,O,this.dimensions.css.cell.width,this._widthCache,K?q===U?A:0:-1,K?(q===X?N:J)-1:-1))}}};s.DomRenderer=I=d([f(7,g.IInstantiationService),f(8,n.ICharSizeService),f(9,g.IOptionsService),f(10,g.IBufferService),f(11,n.ICoreBrowserService),f(12,n.IThemeService)],I)},3787:function(_,s,c){var d=this&&this.__decorate||function(w,k,S,R){var P,B=arguments.length,I=B<3?k:R===null?R=Object.getOwnPropertyDescriptor(k,S):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(w,k,S,R);else for(var A=w.length-1;A>=0;A--)(P=w[A])&&(I=(B<3?P(I):B>3?P(k,S,I):P(k,S))||I);return B>3&&I&&Object.defineProperty(k,S,I),I},f=this&&this.__param||function(w,k){return function(S,R){k(S,R,w)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=void 0;const h=c(2223),v=c(643),y=c(511),C=c(2585),m=c(8055),n=c(4725),l=c(4269),o=c(6171),a=c(3734);let g=s.DomRendererRowFactory=class{constructor(w,k,S,R,P,B,I){this._document=w,this._characterJoinerService=k,this._optionsService=S,this._coreBrowserService=R,this._coreService=P,this._decorationService=B,this._themeService=I,this._workCell=new y.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(w,k,S){this._selectionStart=w,this._selectionEnd=k,this._columnSelectMode=S}createRow(w,k,S,R,P,B,I,A,N,U,X){const J=[],K=this._characterJoinerService.getJoinedCharacters(k),T=this._themeService.colors;let E,x=w.getNoBgTrimmedLength();S&&x<B+1&&(x=B+1);let D=0,O="",$=0,V=0,q=0,M=!1,L=0,F=!1,W=0;const z=[],j=U!==-1&&X!==-1;for(let te=0;te<x;te++){w.loadCell(te,this._workCell);let Q=this._workCell.getWidth();if(Q===0)continue;let oe=!1,ce=te,ee=this._workCell;if(K.length>0&&te===K[0][0]){oe=!0;const de=K.shift();ee=new l.JoinedCellData(this._workCell,w.translateToString(!0,de[0],de[1]),de[1]-de[0]),ce=de[1]-1,Q=ee.getWidth()}const ve=this._isCellInSelection(te,k),Fe=S&&te===B,be=j&&te>=U&&te<=X;let yt=!1;this._decorationService.forEachDecorationAtCell(te,k,void 0,de=>{yt=!0});let ft=ee.getChars()||v.WHITESPACE_CELL_CHAR;if(ft===" "&&(ee.isUnderline()||ee.isOverline())&&(ft="Â "),W=Q*A-N.get(ft,ee.isBold(),ee.isItalic()),E){if(D&&(ve&&F||!ve&&!F&&ee.bg===$)&&(ve&&F&&T.selectionForeground||ee.fg===V)&&ee.extended.ext===q&&be===M&&W===L&&!Fe&&!oe&&!yt){ee.isInvisible()?O+=v.WHITESPACE_CELL_CHAR:O+=ft,D++;continue}D&&(E.textContent=O),E=this._document.createElement("span"),D=0,O=""}else E=this._document.createElement("span");if($=ee.bg,V=ee.fg,q=ee.extended.ext,M=be,L=W,F=ve,oe&&B>=te&&B<=ce&&(B=te),!this._coreService.isCursorHidden&&Fe&&this._coreService.isCursorInitialized){if(z.push("xterm-cursor"),this._coreBrowserService.isFocused)I&&z.push("xterm-cursor-blink"),z.push(R==="bar"?"xterm-cursor-bar":R==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(P)switch(P){case"outline":z.push("xterm-cursor-outline");break;case"block":z.push("xterm-cursor-block");break;case"bar":z.push("xterm-cursor-bar");break;case"underline":z.push("xterm-cursor-underline")}}if(ee.isBold()&&z.push("xterm-bold"),ee.isItalic()&&z.push("xterm-italic"),ee.isDim()&&z.push("xterm-dim"),O=ee.isInvisible()?v.WHITESPACE_CELL_CHAR:ee.getChars()||v.WHITESPACE_CELL_CHAR,ee.isUnderline()&&(z.push(`xterm-underline-${ee.extended.underlineStyle}`),O===" "&&(O="Â "),!ee.isUnderlineColorDefault()))if(ee.isUnderlineColorRGB())E.style.textDecorationColor=`rgb(${a.AttributeData.toColorRGB(ee.getUnderlineColor()).join(",")})`;else{let de=ee.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ee.isBold()&&de<8&&(de+=8),E.style.textDecorationColor=T.ansi[de].css}ee.isOverline()&&(z.push("xterm-overline"),O===" "&&(O="Â ")),ee.isStrikethrough()&&z.push("xterm-strikethrough"),be&&(E.style.textDecoration="underline");let xe=ee.getFgColor(),Je=ee.getFgColorMode(),Ie=ee.getBgColor(),Ye=ee.getBgColorMode();const Ct=!!ee.isInverse();if(Ct){const de=xe;xe=Ie,Ie=de;const Tr=Je;Je=Ye,Ye=Tr}let Ue,nt,He,qe=!1;switch(this._decorationService.forEachDecorationAtCell(te,k,void 0,de=>{de.options.layer!=="top"&&qe||(de.backgroundColorRGB&&(Ye=50331648,Ie=de.backgroundColorRGB.rgba>>8&16777215,Ue=de.backgroundColorRGB),de.foregroundColorRGB&&(Je=50331648,xe=de.foregroundColorRGB.rgba>>8&16777215,nt=de.foregroundColorRGB),qe=de.options.layer==="top")}),!qe&&ve&&(Ue=this._coreBrowserService.isFocused?T.selectionBackgroundOpaque:T.selectionInactiveBackgroundOpaque,Ie=Ue.rgba>>8&16777215,Ye=50331648,qe=!0,T.selectionForeground&&(Je=50331648,xe=T.selectionForeground.rgba>>8&16777215,nt=T.selectionForeground)),qe&&z.push("xterm-decoration-top"),Ye){case 16777216:case 33554432:He=T.ansi[Ie],z.push(`xterm-bg-${Ie}`);break;case 50331648:He=m.channels.toColor(Ie>>16,Ie>>8&255,255&Ie),this._addStyle(E,`background-color:#${b((Ie>>>0).toString(16),"0",6)}`);break;default:Ct?(He=T.foreground,z.push(`xterm-bg-${h.INVERTED_DEFAULT_COLOR}`)):He=T.background}switch(Ue||ee.isDim()&&(Ue=m.color.multiplyOpacity(He,.5)),Je){case 16777216:case 33554432:ee.isBold()&&xe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(xe+=8),this._applyMinimumContrast(E,He,T.ansi[xe],ee,Ue,void 0)||z.push(`xterm-fg-${xe}`);break;case 50331648:const de=m.channels.toColor(xe>>16&255,xe>>8&255,255&xe);this._applyMinimumContrast(E,He,de,ee,Ue,nt)||this._addStyle(E,`color:#${b(xe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(E,He,T.foreground,ee,Ue,nt)||Ct&&z.push(`xterm-fg-${h.INVERTED_DEFAULT_COLOR}`)}z.length&&(E.className=z.join(" "),z.length=0),Fe||oe||yt?E.textContent=O:D++,W!==this.defaultSpacing&&(E.style.letterSpacing=`${W}px`),J.push(E),te=ce}return E&&D&&(E.textContent=O),J}_applyMinimumContrast(w,k,S,R,P,B){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.treatGlyphAsBackgroundColor)(R.getCode()))return!1;const I=this._getContrastCache(R);let A;if(P||B||(A=I.getColor(k.rgba,S.rgba)),A===void 0){const N=this._optionsService.rawOptions.minimumContrastRatio/(R.isDim()?2:1);A=m.color.ensureContrastRatio(P||k,B||S,N),I.setColor((P||k).rgba,(B||S).rgba,A??null)}return!!A&&(this._addStyle(w,`color:${A.css}`),!0)}_getContrastCache(w){return w.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(w,k){w.setAttribute("style",`${w.getAttribute("style")||""}${k};`)}_isCellInSelection(w,k){const S=this._selectionStart,R=this._selectionEnd;return!(!S||!R)&&(this._columnSelectMode?S[0]<=R[0]?w>=S[0]&&k>=S[1]&&w<R[0]&&k<=R[1]:w<S[0]&&k>=S[1]&&w>=R[0]&&k<=R[1]:k>S[1]&&k<R[1]||S[1]===R[1]&&k===S[1]&&w>=S[0]&&w<R[0]||S[1]<R[1]&&k===R[1]&&w<R[0]||S[1]<R[1]&&k===S[1]&&w>=S[0])}};function b(w,k,S){for(;w.length<S;)w=k+w;return w}s.DomRendererRowFactory=g=d([f(1,n.ICharacterJoinerService),f(2,C.IOptionsService),f(3,n.ICoreBrowserService),f(4,C.ICoreService),f(5,C.IDecorationService),f(6,n.IThemeService)],g)},2550:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WidthCache=void 0,s.WidthCache=class{constructor(c,d){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=c.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const f=c.createElement("span");f.classList.add("xterm-char-measure-element");const h=c.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontWeight="bold";const v=c.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontStyle="italic";const y=c.createElement("span");y.classList.add("xterm-char-measure-element"),y.style.fontWeight="bold",y.style.fontStyle="italic",this._measureElements=[f,h,v,y],this._container.appendChild(f),this._container.appendChild(h),this._container.appendChild(v),this._container.appendChild(y),d.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(c,d,f,h){c===this._font&&d===this._fontSize&&f===this._weight&&h===this._weightBold||(this._font=c,this._fontSize=d,this._weight=f,this._weightBold=h,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${f}`,this._measureElements[1].style.fontWeight=`${h}`,this._measureElements[2].style.fontWeight=`${f}`,this._measureElements[3].style.fontWeight=`${h}`,this.clear())}get(c,d,f){let h=0;if(!d&&!f&&c.length===1&&(h=c.charCodeAt(0))<256){if(this._flat[h]!==-9999)return this._flat[h];const C=this._measure(c,0);return C>0&&(this._flat[h]=C),C}let v=c;d&&(v+="B"),f&&(v+="I");let y=this._holey.get(v);if(y===void 0){let C=0;d&&(C|=1),f&&(C|=2),y=this._measure(c,C),y>0&&this._holey.set(v,y)}return y}_measure(c,d){const f=this._measureElements[d];return f.textContent=c.repeat(32),f.offsetWidth/32}}},2223:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const d=c(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=d.isFirefox||d.isLegacyEdge?"bottom":"ideographic"},6171:(_,s)=>{function c(f){return 57508<=f&&f<=57558}function d(f){return f>=128512&&f<=128591||f>=127744&&f<=128511||f>=128640&&f<=128767||f>=9728&&f<=9983||f>=9984&&f<=10175||f>=65024&&f<=65039||f>=129280&&f<=129535||f>=127462&&f<=127487}Object.defineProperty(s,"__esModule",{value:!0}),s.computeNextVariantOffset=s.createRenderDimensions=s.treatGlyphAsBackgroundColor=s.allowRescaling=s.isEmoji=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},s.isPowerlineGlyph=c,s.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},s.isEmoji=d,s.allowRescaling=function(f,h,v,y){return h===1&&v>Math.ceil(1.5*y)&&f!==void 0&&f>255&&!d(f)&&!c(f)&&!function(C){return 57344<=C&&C<=63743}(f)},s.treatGlyphAsBackgroundColor=function(f){return c(f)||function(h){return 9472<=h&&h<=9631}(f)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},s.computeNextVariantOffset=function(f,h,v=0){return(f-(2*Math.round(h)-v))%(2*Math.round(h))}},6052:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createSelectionRenderModel=void 0;class c{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,h,v,y=!1){if(this.selectionStart=h,this.selectionEnd=v,!h||!v||h[0]===v[0]&&h[1]===v[1])return void this.clear();const C=f.buffers.active.ydisp,m=h[1]-C,n=v[1]-C,l=Math.max(m,0),o=Math.min(n,f.rows-1);l>=f.rows||o<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=y,this.viewportStartRow=m,this.viewportEndRow=n,this.viewportCappedStartRow=l,this.viewportCappedEndRow=o,this.startCol=h[0],this.endCol=v[0])}isCellSelected(f,h,v){return!!this.hasSelection&&(v-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?h>=this.startCol&&v>=this.viewportCappedStartRow&&h<this.endCol&&v<=this.viewportCappedEndRow:h<this.startCol&&v>=this.viewportCappedStartRow&&h>=this.endCol&&v<=this.viewportCappedEndRow:v>this.viewportStartRow&&v<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&v===this.viewportStartRow&&h>=this.startCol&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportEndRow&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportStartRow&&h>=this.startCol)}}s.createSelectionRenderModel=function(){return new c}},456:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(c){this._bufferService=c,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const c=this.selectionStart[0]+this.selectionStartLength;return c>this._bufferService.cols?c%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(c/this._bufferService.cols)-1]:[c%this._bufferService.cols,this.selectionStart[1]+Math.floor(c/this._bufferService.cols)]:[c,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const c=this.selectionStart[0]+this.selectionStartLength;return c>this._bufferService.cols?[c%this._bufferService.cols,this.selectionStart[1]+Math.floor(c/this._bufferService.cols)]:[Math.max(c,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const c=this.selectionStart,d=this.selectionEnd;return!(!c||!d)&&(c[1]>d[1]||c[1]===d[1]&&c[0]>d[0])}handleTrim(c){return this.selectionStart&&(this.selectionStart[1]-=c),this.selectionEnd&&(this.selectionEnd[1]-=c),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(_,s,c){var d=this&&this.__decorate||function(o,a,g,b){var w,k=arguments.length,S=k<3?a:b===null?b=Object.getOwnPropertyDescriptor(a,g):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,a,g,b);else for(var R=o.length-1;R>=0;R--)(w=o[R])&&(S=(k<3?w(S):k>3?w(a,g,S):w(a,g))||S);return k>3&&S&&Object.defineProperty(a,g,S),S},f=this&&this.__param||function(o,a){return function(g,b){a(g,b,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const h=c(2585),v=c(8460),y=c(844);let C=s.CharSizeService=class extends y.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(o,a,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new v.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new l(this._optionsService))}catch{this._measureStrategy=this.register(new n(o,a,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const o=this._measureStrategy.measure();o.width===this.width&&o.height===this.height||(this.width=o.width,this.height=o.height,this._onCharSizeChange.fire())}};s.CharSizeService=C=d([f(2,h.IOptionsService)],C);class m extends y.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(a,g){a!==void 0&&a>0&&g!==void 0&&g>0&&(this._result.width=a,this._result.height=g)}}class n extends m{constructor(a,g,b){super(),this._document=a,this._parentElement=g,this._optionsService=b,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class l extends m{constructor(a){super(),this._optionsService=a,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const g=this._ctx.measureText("W");if(!("width"in g&&"fontBoundingBoxAscent"in g&&"fontBoundingBoxDescent"in g))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const a=this._ctx.measureText("W");return this._validateAndSet(a.width,a.fontBoundingBoxAscent+a.fontBoundingBoxDescent),this._result}}},4269:function(_,s,c){var d=this&&this.__decorate||function(l,o,a,g){var b,w=arguments.length,k=w<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,a):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(l,o,a,g);else for(var S=l.length-1;S>=0;S--)(b=l[S])&&(k=(w<3?b(k):w>3?b(o,a,k):b(o,a))||k);return w>3&&k&&Object.defineProperty(o,a,k),k},f=this&&this.__param||function(l,o){return function(a,g){o(a,g,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const h=c(3734),v=c(643),y=c(511),C=c(2585);class m extends h.AttributeData{constructor(o,a,g){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=a,this._width=g}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=m;let n=s.CharacterJoinerService=class Ws{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new y.CellData}register(o){const a={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(a),a.id}deregister(o){for(let a=0;a<this._characterJoiners.length;a++)if(this._characterJoiners[a].id===o)return this._characterJoiners.splice(a,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];const a=this._bufferService.buffer.lines.get(o);if(!a||a.length===0)return[];const g=[],b=a.translateToString(!0);let w=0,k=0,S=0,R=a.getFg(0),P=a.getBg(0);for(let B=0;B<a.getTrimmedLength();B++)if(a.loadCell(B,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==R||this._workCell.bg!==P){if(B-w>1){const I=this._getJoinedRanges(b,S,k,a,w);for(let A=0;A<I.length;A++)g.push(I[A])}w=B,S=k,R=this._workCell.fg,P=this._workCell.bg}k+=this._workCell.getChars().length||v.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-w>1){const B=this._getJoinedRanges(b,S,k,a,w);for(let I=0;I<B.length;I++)g.push(B[I])}return g}_getJoinedRanges(o,a,g,b,w){const k=o.substring(a,g);let S=[];try{S=this._characterJoiners[0].handler(k)}catch(R){console.error(R)}for(let R=1;R<this._characterJoiners.length;R++)try{const P=this._characterJoiners[R].handler(k);for(let B=0;B<P.length;B++)Ws._mergeRanges(S,P[B])}catch(P){console.error(P)}return this._stringRangesToCellRanges(S,b,w),S}_stringRangesToCellRanges(o,a,g){let b=0,w=!1,k=0,S=o[b];if(S){for(let R=g;R<this._bufferService.cols;R++){const P=a.getWidth(R),B=a.getString(R).length||v.WHITESPACE_CELL_CHAR.length;if(P!==0){if(!w&&S[0]<=k&&(S[0]=R,w=!0),S[1]<=k){if(S[1]=R,S=o[++b],!S)break;S[0]<=k?(S[0]=R,w=!0):w=!1}k+=B}}S&&(S[1]=this._bufferService.cols)}}static _mergeRanges(o,a){let g=!1;for(let b=0;b<o.length;b++){const w=o[b];if(g){if(a[1]<=w[0])return o[b-1][1]=a[1],o;if(a[1]<=w[1])return o[b-1][1]=Math.max(a[1],w[1]),o.splice(b,1),o;o.splice(b,1),b--}else{if(a[1]<=w[0])return o.splice(b,0,a),o;if(a[1]<=w[1])return w[0]=Math.min(a[0],w[0]),o;a[0]<w[1]&&(w[0]=Math.min(a[0],w[0]),g=!0)}}return g?o[o.length-1][1]=a[1]:o.push(a),o}};s.CharacterJoinerService=n=d([f(0,C.IBufferService)],n)},5114:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0;const d=c(844),f=c(8460),h=c(3656);class v extends d.Disposable{constructor(m,n,l){super(),this._textarea=m,this._window=n,this.mainDocument=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new y(this._window),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new f.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(o=>this._screenDprMonitor.setWindow(o))),this.register((0,f.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(m){this._window!==m&&(this._window=m,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}s.CoreBrowserService=v;class y extends d.Disposable{constructor(m){super(),this._parentWindow=m,this._windowResizeListener=this.register(new d.MutableDisposable),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,d.toDisposable)(()=>this.clearListener()))}setWindow(m){this._parentWindow=m,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,h.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LinkProviderService=void 0;const d=c(844);class f extends d.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,d.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(v){return this.linkProviders.push(v),{dispose:()=>{const y=this.linkProviders.indexOf(v);y!==-1&&this.linkProviders.splice(y,1)}}}}s.LinkProviderService=f},8934:function(_,s,c){var d=this&&this.__decorate||function(C,m,n,l){var o,a=arguments.length,g=a<3?m:l===null?l=Object.getOwnPropertyDescriptor(m,n):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(C,m,n,l);else for(var b=C.length-1;b>=0;b--)(o=C[b])&&(g=(a<3?o(g):a>3?o(m,n,g):o(m,n))||g);return a>3&&g&&Object.defineProperty(m,n,g),g},f=this&&this.__param||function(C,m){return function(n,l){m(n,l,C)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const h=c(4725),v=c(9806);let y=s.MouseService=class{constructor(C,m){this._renderService=C,this._charSizeService=m}getCoords(C,m,n,l,o){return(0,v.getCoords)(window,C,m,n,l,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(C,m){const n=(0,v.getCoordsRelativeToElement)(window,C,m);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};s.MouseService=y=d([f(0,h.IRenderService),f(1,h.ICharSizeService)],y)},3230:function(_,s,c){var d=this&&this.__decorate||function(o,a,g,b){var w,k=arguments.length,S=k<3?a:b===null?b=Object.getOwnPropertyDescriptor(a,g):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,a,g,b);else for(var R=o.length-1;R>=0;R--)(w=o[R])&&(S=(k<3?w(S):k>3?w(a,g,S):w(a,g))||S);return k>3&&S&&Object.defineProperty(a,g,S),S},f=this&&this.__param||function(o,a){return function(g,b){a(g,b,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const h=c(6193),v=c(4725),y=c(8460),C=c(844),m=c(7226),n=c(2585);let l=s.RenderService=class extends C.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(o,a,g,b,w,k,S,R){super(),this._rowCount=o,this._charSizeService=b,this._renderer=this.register(new C.MutableDisposable),this._pausedResizeTask=new m.DebouncedIdleTask,this._observerDisposable=this.register(new C.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new y.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new y.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new y.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer((P,B)=>this._renderRows(P,B),S),this.register(this._renderDebouncer),this.register(S.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(w.onDecorationRegistered(()=>this._fullRefresh())),this.register(w.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,!0))),this.register(R.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(S.window,a),this.register(S.onWindowChange(P=>this._registerIntersectionObserver(P,a)))}_registerIntersectionObserver(o,a){if("IntersectionObserver"in o){const g=new o.IntersectionObserver(b=>this._handleIntersectionChange(b[b.length-1]),{threshold:0});g.observe(a),this._observerDisposable.value=(0,C.toDisposable)(()=>g.disconnect())}}_handleIntersectionChange(o){this._isPaused=o.isIntersecting===void 0?o.intersectionRatio===0:!o.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(o,a,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(o,a,this._rowCount))}_renderRows(o,a){this._renderer.value&&(o=Math.min(o,this._rowCount-1),a=Math.min(a,this._rowCount-1),this._renderer.value.renderRows(o,a),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:o,end:a}),this._onRender.fire({start:o,end:a}),this._isNextRenderRedrawOnly=!0)}resize(o,a){this._rowCount=a,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(o){this._renderer.value=o,this._renderer.value&&(this._renderer.value.onRequestRedraw(a=>this.refreshRows(a.start,a.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(o){return this._renderDebouncer.addRefreshCallback(o)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(o,a){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(o,a)):this._renderer.value.handleResize(o,a),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(o,a,g){this._selectionState.start=o,this._selectionState.end=a,this._selectionState.columnSelectMode=g,this._renderer.value?.handleSelectionChanged(o,a,g)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};s.RenderService=l=d([f(2,n.IOptionsService),f(3,v.ICharSizeService),f(4,n.IDecorationService),f(5,n.IBufferService),f(6,v.ICoreBrowserService),f(7,v.IThemeService)],l)},9312:function(_,s,c){var d=this&&this.__decorate||function(S,R,P,B){var I,A=arguments.length,N=A<3?R:B===null?B=Object.getOwnPropertyDescriptor(R,P):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(S,R,P,B);else for(var U=S.length-1;U>=0;U--)(I=S[U])&&(N=(A<3?I(N):A>3?I(R,P,N):I(R,P))||N);return A>3&&N&&Object.defineProperty(R,P,N),N},f=this&&this.__param||function(S,R){return function(P,B){R(P,B,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const h=c(9806),v=c(9504),y=c(456),C=c(4725),m=c(8460),n=c(844),l=c(6114),o=c(4841),a=c(511),g=c(2585),b="Â ",w=new RegExp(b,"g");let k=s.SelectionService=class extends n.Disposable{constructor(S,R,P,B,I,A,N,U,X){super(),this._element=S,this._screenElement=R,this._linkifier=P,this._bufferService=B,this._coreService=I,this._mouseService=A,this._optionsService=N,this._renderService=U,this._coreBrowserService=X,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new a.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=J=>this._handleMouseMove(J),this._mouseUpListener=J=>this._handleMouseUp(J),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(J=>this._handleTrim(J)),this.register(this._bufferService.buffers.onBufferActivate(J=>this._handleBufferActivate(J))),this.enable(),this._model=new y.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const S=this._model.finalSelectionStart,R=this._model.finalSelectionEnd;return!(!S||!R||S[0]===R[0]&&S[1]===R[1])}get selectionText(){const S=this._model.finalSelectionStart,R=this._model.finalSelectionEnd;if(!S||!R)return"";const P=this._bufferService.buffer,B=[];if(this._activeSelectionMode===3){if(S[0]===R[0])return"";const I=S[0]<R[0]?S[0]:R[0],A=S[0]<R[0]?R[0]:S[0];for(let N=S[1];N<=R[1];N++){const U=P.translateBufferLineToString(N,!0,I,A);B.push(U)}}else{const I=S[1]===R[1]?R[0]:void 0;B.push(P.translateBufferLineToString(S[1],!0,S[0],I));for(let A=S[1]+1;A<=R[1]-1;A++){const N=P.lines.get(A),U=P.translateBufferLineToString(A,!0);N?.isWrapped?B[B.length-1]+=U:B.push(U)}if(S[1]!==R[1]){const A=P.lines.get(R[1]),N=P.translateBufferLineToString(R[1],!0,0,R[0]);A&&A.isWrapped?B[B.length-1]+=N:B.push(N)}}return B.map(I=>I.replace(w," ")).join(l.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(S){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),l.isLinux&&S&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(S){const R=this._getMouseBufferCoords(S),P=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!!(P&&B&&R)&&this._areCoordsInSelection(R,P,B)}isCellInSelection(S,R){const P=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!(!P||!B)&&this._areCoordsInSelection([S,R],P,B)}_areCoordsInSelection(S,R,P){return S[1]>R[1]&&S[1]<P[1]||R[1]===P[1]&&S[1]===R[1]&&S[0]>=R[0]&&S[0]<P[0]||R[1]<P[1]&&S[1]===P[1]&&S[0]<P[0]||R[1]<P[1]&&S[1]===R[1]&&S[0]>=R[0]}_selectWordAtCursor(S,R){const P=this._linkifier.currentLink?.link?.range;if(P)return this._model.selectionStart=[P.start.x-1,P.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(P,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(S);return!!B&&(this._selectWordAt(B,R),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(S,R){this._model.clearSelection(),S=Math.max(S,0),R=Math.min(R,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,S],this._model.selectionEnd=[this._bufferService.cols,R],this.refresh(),this._onSelectionChange.fire()}_handleTrim(S){this._model.handleTrim(S)&&this.refresh()}_getMouseBufferCoords(S){const R=this._mouseService.getCoords(S,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(R)return R[0]--,R[1]--,R[1]+=this._bufferService.buffer.ydisp,R}_getMouseEventScrollAmount(S){let R=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,S,this._screenElement)[1];const P=this._renderService.dimensions.css.canvas.height;return R>=0&&R<=P?0:(R>P&&(R-=P),R=Math.min(Math.max(R,-50),50),R/=50,R/Math.abs(R)+Math.round(14*R))}shouldForceSelection(S){return l.isMac?S.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:S.shiftKey}handleMouseDown(S){if(this._mouseDownTimeStamp=S.timeStamp,(S.button!==2||!this.hasSelection)&&S.button===0){if(!this._enabled){if(!this.shouldForceSelection(S))return;S.stopPropagation()}S.preventDefault(),this._dragScrollAmount=0,this._enabled&&S.shiftKey?this._handleIncrementalClick(S):S.detail===1?this._handleSingleClick(S):S.detail===2?this._handleDoubleClick(S):S.detail===3&&this._handleTripleClick(S),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(S){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(S))}_handleSingleClick(S){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(S)?3:0,this._model.selectionStart=this._getMouseBufferCoords(S),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const R=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);R&&R.length!==this._model.selectionStart[0]&&R.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(S){this._selectWordAtCursor(S,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(S){const R=this._getMouseBufferCoords(S);R&&(this._activeSelectionMode=2,this._selectLineAt(R[1]))}shouldColumnSelect(S){return S.altKey&&!(l.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(S){if(S.stopImmediatePropagation(),!this._model.selectionStart)return;const R=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(S),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(S),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const P=this._bufferService.buffer;if(this._model.selectionEnd[1]<P.lines.length){const B=P.lines.get(this._model.selectionEnd[1]);B&&B.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}R&&R[0]===this._model.selectionEnd[0]&&R[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const S=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(S.ydisp+this._bufferService.rows,S.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=S.ydisp),this.refresh()}}_handleMouseUp(S){const R=S.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&R<500&&S.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const P=this._mouseService.getCoords(S,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(P&&P[0]!==void 0&&P[1]!==void 0){const B=(0,v.moveToCellSequence)(P[0]-1,P[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(B,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const S=this._model.finalSelectionStart,R=this._model.finalSelectionEnd,P=!(!S||!R||S[0]===R[0]&&S[1]===R[1]);P?S&&R&&(this._oldSelectionStart&&this._oldSelectionEnd&&S[0]===this._oldSelectionStart[0]&&S[1]===this._oldSelectionStart[1]&&R[0]===this._oldSelectionEnd[0]&&R[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(S,R,P)):this._oldHasSelection&&this._fireOnSelectionChange(S,R,P)}_fireOnSelectionChange(S,R,P){this._oldSelectionStart=S,this._oldSelectionEnd=R,this._oldHasSelection=P,this._onSelectionChange.fire()}_handleBufferActivate(S){this.clearSelection(),this._trimListener.dispose(),this._trimListener=S.activeBuffer.lines.onTrim(R=>this._handleTrim(R))}_convertViewportColToCharacterIndex(S,R){let P=R;for(let B=0;R>=B;B++){const I=S.loadCell(B,this._workCell).getChars().length;this._workCell.getWidth()===0?P--:I>1&&R!==B&&(P+=I-1)}return P}setSelection(S,R,P){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[S,R],this._model.selectionStartLength=P,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(S){this._isClickInSelection(S)||(this._selectWordAtCursor(S,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(S,R,P=!0,B=!0){if(S[0]>=this._bufferService.cols)return;const I=this._bufferService.buffer,A=I.lines.get(S[1]);if(!A)return;const N=I.translateBufferLineToString(S[1],!1);let U=this._convertViewportColToCharacterIndex(A,S[0]),X=U;const J=S[0]-U;let K=0,T=0,E=0,x=0;if(N.charAt(U)===" "){for(;U>0&&N.charAt(U-1)===" ";)U--;for(;X<N.length&&N.charAt(X+1)===" ";)X++}else{let $=S[0],V=S[0];A.getWidth($)===0&&(K++,$--),A.getWidth(V)===2&&(T++,V++);const q=A.getString(V).length;for(q>1&&(x+=q-1,X+=q-1);$>0&&U>0&&!this._isCharWordSeparator(A.loadCell($-1,this._workCell));){A.loadCell($-1,this._workCell);const M=this._workCell.getChars().length;this._workCell.getWidth()===0?(K++,$--):M>1&&(E+=M-1,U-=M-1),U--,$--}for(;V<A.length&&X+1<N.length&&!this._isCharWordSeparator(A.loadCell(V+1,this._workCell));){A.loadCell(V+1,this._workCell);const M=this._workCell.getChars().length;this._workCell.getWidth()===2?(T++,V++):M>1&&(x+=M-1,X+=M-1),X++,V++}}X++;let D=U+J-K+E,O=Math.min(this._bufferService.cols,X-U+K+T-E-x);if(R||N.slice(U,X).trim()!==""){if(P&&D===0&&A.getCodePoint(0)!==32){const $=I.lines.get(S[1]-1);if($&&A.isWrapped&&$.getCodePoint(this._bufferService.cols-1)!==32){const V=this._getWordAt([this._bufferService.cols-1,S[1]-1],!1,!0,!1);if(V){const q=this._bufferService.cols-V.start;D-=q,O+=q}}}if(B&&D+O===this._bufferService.cols&&A.getCodePoint(this._bufferService.cols-1)!==32){const $=I.lines.get(S[1]+1);if($?.isWrapped&&$.getCodePoint(0)!==32){const V=this._getWordAt([0,S[1]+1],!1,!1,!0);V&&(O+=V.length)}}return{start:D,length:O}}}_selectWordAt(S,R){const P=this._getWordAt(S,R);if(P){for(;P.start<0;)P.start+=this._bufferService.cols,S[1]--;this._model.selectionStart=[P.start,S[1]],this._model.selectionStartLength=P.length}}_selectToWordAt(S){const R=this._getWordAt(S,!0);if(R){let P=S[1];for(;R.start<0;)R.start+=this._bufferService.cols,P--;if(!this._model.areSelectionValuesReversed())for(;R.start+R.length>this._bufferService.cols;)R.length-=this._bufferService.cols,P++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?R.start:R.start+R.length,P]}}_isCharWordSeparator(S){return S.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(S.getChars())>=0}_selectLineAt(S){const R=this._bufferService.buffer.getWrappedRangeForLine(S),P={start:{x:0,y:R.first},end:{x:this._bufferService.cols-1,y:R.last}};this._model.selectionStart=[0,R.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(P,this._bufferService.cols)}};s.SelectionService=k=d([f(3,g.IBufferService),f(4,g.ICoreService),f(5,C.IMouseService),f(6,g.IOptionsService),f(7,C.IRenderService),f(8,C.ICoreBrowserService)],k)},4725:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ILinkProviderService=s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const d=c(8343);s.ICharSizeService=(0,d.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,d.createDecorator)("CoreBrowserService"),s.IMouseService=(0,d.createDecorator)("MouseService"),s.IRenderService=(0,d.createDecorator)("RenderService"),s.ISelectionService=(0,d.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,d.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,d.createDecorator)("ThemeService"),s.ILinkProviderService=(0,d.createDecorator)("LinkProviderService")},6731:function(_,s,c){var d=this&&this.__decorate||function(k,S,R,P){var B,I=arguments.length,A=I<3?S:P===null?P=Object.getOwnPropertyDescriptor(S,R):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(k,S,R,P);else for(var N=k.length-1;N>=0;N--)(B=k[N])&&(A=(I<3?B(A):I>3?B(S,R,A):B(S,R))||A);return I>3&&A&&Object.defineProperty(S,R,A),A},f=this&&this.__param||function(k,S){return function(R,P){S(R,P,k)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const h=c(7239),v=c(8055),y=c(8460),C=c(844),m=c(2585),n=v.css.toColor("#ffffff"),l=v.css.toColor("#000000"),o=v.css.toColor("#ffffff"),a=v.css.toColor("#000000"),g={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const k=[v.css.toColor("#2e3436"),v.css.toColor("#cc0000"),v.css.toColor("#4e9a06"),v.css.toColor("#c4a000"),v.css.toColor("#3465a4"),v.css.toColor("#75507b"),v.css.toColor("#06989a"),v.css.toColor("#d3d7cf"),v.css.toColor("#555753"),v.css.toColor("#ef2929"),v.css.toColor("#8ae234"),v.css.toColor("#fce94f"),v.css.toColor("#729fcf"),v.css.toColor("#ad7fa8"),v.css.toColor("#34e2e2"),v.css.toColor("#eeeeec")],S=[0,95,135,175,215,255];for(let R=0;R<216;R++){const P=S[R/36%6|0],B=S[R/6%6|0],I=S[R%6];k.push({css:v.channels.toCss(P,B,I),rgba:v.channels.toRgba(P,B,I)})}for(let R=0;R<24;R++){const P=8+10*R;k.push({css:v.channels.toCss(P,P,P),rgba:v.channels.toRgba(P,P,P)})}return k})());let b=s.ThemeService=class extends C.Disposable{get colors(){return this._colors}constructor(k){super(),this._optionsService=k,this._contrastCache=new h.ColorContrastCache,this._halfContrastCache=new h.ColorContrastCache,this._onChangeColors=this.register(new y.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:l,cursor:o,cursorAccent:a,selectionForeground:void 0,selectionBackgroundTransparent:g,selectionBackgroundOpaque:v.color.blend(l,g),selectionInactiveBackgroundTransparent:g,selectionInactiveBackgroundOpaque:v.color.blend(l,g),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(k={}){const S=this._colors;if(S.foreground=w(k.foreground,n),S.background=w(k.background,l),S.cursor=w(k.cursor,o),S.cursorAccent=w(k.cursorAccent,a),S.selectionBackgroundTransparent=w(k.selectionBackground,g),S.selectionBackgroundOpaque=v.color.blend(S.background,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundTransparent=w(k.selectionInactiveBackground,S.selectionBackgroundTransparent),S.selectionInactiveBackgroundOpaque=v.color.blend(S.background,S.selectionInactiveBackgroundTransparent),S.selectionForeground=k.selectionForeground?w(k.selectionForeground,v.NULL_COLOR):void 0,S.selectionForeground===v.NULL_COLOR&&(S.selectionForeground=void 0),v.color.isOpaque(S.selectionBackgroundTransparent)&&(S.selectionBackgroundTransparent=v.color.opacity(S.selectionBackgroundTransparent,.3)),v.color.isOpaque(S.selectionInactiveBackgroundTransparent)&&(S.selectionInactiveBackgroundTransparent=v.color.opacity(S.selectionInactiveBackgroundTransparent,.3)),S.ansi=s.DEFAULT_ANSI_COLORS.slice(),S.ansi[0]=w(k.black,s.DEFAULT_ANSI_COLORS[0]),S.ansi[1]=w(k.red,s.DEFAULT_ANSI_COLORS[1]),S.ansi[2]=w(k.green,s.DEFAULT_ANSI_COLORS[2]),S.ansi[3]=w(k.yellow,s.DEFAULT_ANSI_COLORS[3]),S.ansi[4]=w(k.blue,s.DEFAULT_ANSI_COLORS[4]),S.ansi[5]=w(k.magenta,s.DEFAULT_ANSI_COLORS[5]),S.ansi[6]=w(k.cyan,s.DEFAULT_ANSI_COLORS[6]),S.ansi[7]=w(k.white,s.DEFAULT_ANSI_COLORS[7]),S.ansi[8]=w(k.brightBlack,s.DEFAULT_ANSI_COLORS[8]),S.ansi[9]=w(k.brightRed,s.DEFAULT_ANSI_COLORS[9]),S.ansi[10]=w(k.brightGreen,s.DEFAULT_ANSI_COLORS[10]),S.ansi[11]=w(k.brightYellow,s.DEFAULT_ANSI_COLORS[11]),S.ansi[12]=w(k.brightBlue,s.DEFAULT_ANSI_COLORS[12]),S.ansi[13]=w(k.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),S.ansi[14]=w(k.brightCyan,s.DEFAULT_ANSI_COLORS[14]),S.ansi[15]=w(k.brightWhite,s.DEFAULT_ANSI_COLORS[15]),k.extendedAnsi){const R=Math.min(S.ansi.length-16,k.extendedAnsi.length);for(let P=0;P<R;P++)S.ansi[P+16]=w(k.extendedAnsi[P],s.DEFAULT_ANSI_COLORS[P+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(k){this._restoreColor(k),this._onChangeColors.fire(this.colors)}_restoreColor(k){if(k!==void 0)switch(k){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[k]=this._restoreColors.ansi[k]}else for(let S=0;S<this._restoreColors.ansi.length;++S)this._colors.ansi[S]=this._restoreColors.ansi[S]}modifyColors(k){k(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function w(k,S){if(k!==void 0)try{return v.css.toColor(k)}catch{}return S}s.ThemeService=b=d([f(0,m.IOptionsService)],b)},6349:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const d=c(8460),f=c(844);class h extends f.Disposable{constructor(y){super(),this._maxLength=y,this.onDeleteEmitter=this.register(new d.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new d.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new d.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(y){if(this._maxLength===y)return;const C=new Array(y);for(let m=0;m<Math.min(y,this.length);m++)C[m]=this._array[this._getCyclicIndex(m)];this._array=C,this._maxLength=y,this._startIndex=0}get length(){return this._length}set length(y){if(y>this._length)for(let C=this._length;C<y;C++)this._array[C]=void 0;this._length=y}get(y){return this._array[this._getCyclicIndex(y)]}set(y,C){this._array[this._getCyclicIndex(y)]=C}push(y){this._array[this._getCyclicIndex(this._length)]=y,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(y,C,...m){if(C){for(let n=y;n<this._length-C;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+C)];this._length-=C,this.onDeleteEmitter.fire({index:y,amount:C})}for(let n=this._length-1;n>=y;n--)this._array[this._getCyclicIndex(n+m.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<m.length;n++)this._array[this._getCyclicIndex(y+n)]=m[n];if(m.length&&this.onInsertEmitter.fire({index:y,amount:m.length}),this._length+m.length>this._maxLength){const n=this._length+m.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=m.length}trimStart(y){y>this._length&&(y=this._length),this._startIndex+=y,this._length-=y,this.onTrimEmitter.fire(y)}shiftElements(y,C,m){if(!(C<=0)){if(y<0||y>=this._length)throw new Error("start argument out of range");if(y+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(let l=C-1;l>=0;l--)this.set(y+l+m,this.get(y+l));const n=y+C+m-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<C;n++)this.set(y+n+m,this.get(y+n))}}_getCyclicIndex(y){return(this._startIndex+y)%this._maxLength}}s.CircularList=h},1439:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function c(d,f=5){if(typeof d!="object")return d;const h=Array.isArray(d)?[]:{};for(const v in d)h[v]=f<=1?d[v]:d[v]&&c(d[v],f-1);return h}},8055:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;let c=0,d=0,f=0,h=0;var v,y,C,m,n;function l(a){const g=a.toString(16);return g.length<2?"0"+g:g}function o(a,g){return a<g?(g+.05)/(a+.05):(a+.05)/(g+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(a){a.toCss=function(g,b,w,k){return k!==void 0?`#${l(g)}${l(b)}${l(w)}${l(k)}`:`#${l(g)}${l(b)}${l(w)}`},a.toRgba=function(g,b,w,k=255){return(g<<24|b<<16|w<<8|k)>>>0},a.toColor=function(g,b,w,k){return{css:a.toCss(g,b,w,k),rgba:a.toRgba(g,b,w,k)}}}(v||(s.channels=v={})),function(a){function g(b,w){return h=Math.round(255*w),[c,d,f]=n.toChannels(b.rgba),{css:v.toCss(c,d,f,h),rgba:v.toRgba(c,d,f,h)}}a.blend=function(b,w){if(h=(255&w.rgba)/255,h===1)return{css:w.css,rgba:w.rgba};const k=w.rgba>>24&255,S=w.rgba>>16&255,R=w.rgba>>8&255,P=b.rgba>>24&255,B=b.rgba>>16&255,I=b.rgba>>8&255;return c=P+Math.round((k-P)*h),d=B+Math.round((S-B)*h),f=I+Math.round((R-I)*h),{css:v.toCss(c,d,f),rgba:v.toRgba(c,d,f)}},a.isOpaque=function(b){return(255&b.rgba)==255},a.ensureContrastRatio=function(b,w,k){const S=n.ensureContrastRatio(b.rgba,w.rgba,k);if(S)return v.toColor(S>>24&255,S>>16&255,S>>8&255)},a.opaque=function(b){const w=(255|b.rgba)>>>0;return[c,d,f]=n.toChannels(w),{css:v.toCss(c,d,f),rgba:w}},a.opacity=g,a.multiplyOpacity=function(b,w){return h=255&b.rgba,g(b,h*w/255)},a.toColorRGB=function(b){return[b.rgba>>24&255,b.rgba>>16&255,b.rgba>>8&255]}}(y||(s.color=y={})),function(a){let g,b;try{const w=document.createElement("canvas");w.width=1,w.height=1;const k=w.getContext("2d",{willReadFrequently:!0});k&&(g=k,g.globalCompositeOperation="copy",b=g.createLinearGradient(0,0,1,1))}catch{}a.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return c=parseInt(w.slice(1,2).repeat(2),16),d=parseInt(w.slice(2,3).repeat(2),16),f=parseInt(w.slice(3,4).repeat(2),16),v.toColor(c,d,f);case 5:return c=parseInt(w.slice(1,2).repeat(2),16),d=parseInt(w.slice(2,3).repeat(2),16),f=parseInt(w.slice(3,4).repeat(2),16),h=parseInt(w.slice(4,5).repeat(2),16),v.toColor(c,d,f,h);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const k=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return c=parseInt(k[1]),d=parseInt(k[2]),f=parseInt(k[3]),h=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),v.toColor(c,d,f,h);if(!g||!b)throw new Error("css.toColor: Unsupported css format");if(g.fillStyle=b,g.fillStyle=w,typeof g.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(g.fillRect(0,0,1,1),[c,d,f,h]=g.getImageData(0,0,1,1).data,h!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(c,d,f,h),css:w}}}(C||(s.css=C={})),function(a){function g(b,w,k){const S=b/255,R=w/255,P=k/255;return .2126*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))+.7152*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))+.0722*(P<=.03928?P/12.92:Math.pow((P+.055)/1.055,2.4))}a.relativeLuminance=function(b){return g(b>>16&255,b>>8&255,255&b)},a.relativeLuminance2=g}(m||(s.rgb=m={})),function(a){function g(w,k,S){const R=w>>24&255,P=w>>16&255,B=w>>8&255;let I=k>>24&255,A=k>>16&255,N=k>>8&255,U=o(m.relativeLuminance2(I,A,N),m.relativeLuminance2(R,P,B));for(;U<S&&(I>0||A>0||N>0);)I-=Math.max(0,Math.ceil(.1*I)),A-=Math.max(0,Math.ceil(.1*A)),N-=Math.max(0,Math.ceil(.1*N)),U=o(m.relativeLuminance2(I,A,N),m.relativeLuminance2(R,P,B));return(I<<24|A<<16|N<<8|255)>>>0}function b(w,k,S){const R=w>>24&255,P=w>>16&255,B=w>>8&255;let I=k>>24&255,A=k>>16&255,N=k>>8&255,U=o(m.relativeLuminance2(I,A,N),m.relativeLuminance2(R,P,B));for(;U<S&&(I<255||A<255||N<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),A=Math.min(255,A+Math.ceil(.1*(255-A))),N=Math.min(255,N+Math.ceil(.1*(255-N))),U=o(m.relativeLuminance2(I,A,N),m.relativeLuminance2(R,P,B));return(I<<24|A<<16|N<<8|255)>>>0}a.blend=function(w,k){if(h=(255&k)/255,h===1)return k;const S=k>>24&255,R=k>>16&255,P=k>>8&255,B=w>>24&255,I=w>>16&255,A=w>>8&255;return c=B+Math.round((S-B)*h),d=I+Math.round((R-I)*h),f=A+Math.round((P-A)*h),v.toRgba(c,d,f)},a.ensureContrastRatio=function(w,k,S){const R=m.relativeLuminance(w>>8),P=m.relativeLuminance(k>>8);if(o(R,P)<S){if(P<R){const A=g(w,k,S),N=o(R,m.relativeLuminance(A>>8));if(N<S){const U=b(w,k,S);return N>o(R,m.relativeLuminance(U>>8))?A:U}return A}const B=b(w,k,S),I=o(R,m.relativeLuminance(B>>8));if(I<S){const A=g(w,k,S);return I>o(R,m.relativeLuminance(A>>8))?B:A}return B}},a.reduceLuminance=g,a.increaseLuminance=b,a.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]}}(n||(s.rgba=n={})),s.toPaddedHex=l,s.contrastRatio=o},8969:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const d=c(844),f=c(2585),h=c(4348),v=c(7866),y=c(744),C=c(7302),m=c(6975),n=c(8460),l=c(1753),o=c(1480),a=c(7994),g=c(9282),b=c(5435),w=c(5981),k=c(2660);let S=!1;class R extends d.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(B=>{this._onScrollApi?.fire(B.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(B){for(const I in B)this.optionsService.options[I]=B[I]}constructor(B){super(),this._windowsWrappingHeuristics=this.register(new d.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new h.InstantiationService,this.optionsService=this.register(new C.OptionsService(B)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(y.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(v.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(m.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(l.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(a.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(k.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new w.WriteBuffer((I,A)=>this._inputHandler.parse(I,A))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(B,I){this._writeBuffer.write(B,I)}writeSync(B,I){this._logService.logLevel<=f.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(B,I)}input(B,I=!0){this.coreService.triggerDataEvent(B,I)}resize(B,I){isNaN(B)||isNaN(I)||(B=Math.max(B,y.MINIMUM_COLS),I=Math.max(I,y.MINIMUM_ROWS),this._bufferService.resize(B,I))}scroll(B,I=!1){this._bufferService.scroll(B,I)}scrollLines(B,I,A){this._bufferService.scrollLines(B,I,A)}scrollPages(B){this.scrollLines(B*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(B){const I=B-this._bufferService.buffer.ydisp;I!==0&&this.scrollLines(I)}registerEscHandler(B,I){return this._inputHandler.registerEscHandler(B,I)}registerDcsHandler(B,I){return this._inputHandler.registerDcsHandler(B,I)}registerCsiHandler(B,I){return this._inputHandler.registerCsiHandler(B,I)}registerOscHandler(B,I){return this._inputHandler.registerOscHandler(B,I)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let B=!1;const I=this.optionsService.rawOptions.windowsPty;I&&I.buildNumber!==void 0&&I.buildNumber!==void 0?B=I.backend==="conpty"&&I.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(B=!0),B?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const B=[];B.push(this.onLineFeed(g.updateWindowsModeWrappedState.bind(null,this._bufferService))),B.push(this.registerCsiHandler({final:"H"},()=>((0,g.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,d.toDisposable)(()=>{for(const I of B)I.dispose()})}}}s.CoreTerminal=R},8460:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.runAndSubscribe=s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=c=>(this._listeners.push(c),{dispose:()=>{if(!this._disposed){for(let d=0;d<this._listeners.length;d++)if(this._listeners[d]===c)return void this._listeners.splice(d,1)}}})),this._event}fire(c,d){const f=[];for(let h=0;h<this._listeners.length;h++)f.push(this._listeners[h]);for(let h=0;h<f.length;h++)f[h].call(void 0,c,d)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},s.forwardEvent=function(c,d){return c(f=>d.fire(f))},s.runAndSubscribe=function(c,d){return d(void 0),c(f=>d(f))}},5435:function(_,s,c){var d=this&&this.__decorate||function(K,T,E,x){var D,O=arguments.length,$=O<3?T:x===null?x=Object.getOwnPropertyDescriptor(T,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")$=Reflect.decorate(K,T,E,x);else for(var V=K.length-1;V>=0;V--)(D=K[V])&&($=(O<3?D($):O>3?D(T,E,$):D(T,E))||$);return O>3&&$&&Object.defineProperty(T,E,$),$},f=this&&this.__param||function(K,T){return function(E,x){T(E,x,K)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const h=c(2584),v=c(7116),y=c(2015),C=c(844),m=c(482),n=c(8437),l=c(8460),o=c(643),a=c(511),g=c(3734),b=c(2585),w=c(1480),k=c(6242),S=c(6351),R=c(5941),P={"(":0,")":1,"*":2,"+":3,"-":1,".":2},B=131072;function I(K,T){if(K>24)return T.setWinLines||!1;switch(K){case 1:return!!T.restoreWin;case 2:return!!T.minimizeWin;case 3:return!!T.setWinPosition;case 4:return!!T.setWinSizePixels;case 5:return!!T.raiseWin;case 6:return!!T.lowerWin;case 7:return!!T.refreshWin;case 8:return!!T.setWinSizeChars;case 9:return!!T.maximizeWin;case 10:return!!T.fullscreenWin;case 11:return!!T.getWinState;case 13:return!!T.getWinPosition;case 14:return!!T.getWinSizePixels;case 15:return!!T.getScreenSizePixels;case 16:return!!T.getCellSizePixels;case 18:return!!T.getWinSizeChars;case 19:return!!T.getScreenSizeChars;case 20:return!!T.getIconTitle;case 21:return!!T.getWinTitle;case 22:return!!T.pushTitle;case 23:return!!T.popTitle;case 24:return!!T.setWinLines}return!1}var A;(function(K){K[K.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",K[K.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(A||(s.WindowsOptionsReportType=A={}));let N=0;class U extends C.Disposable{getAttrData(){return this._curAttrData}constructor(T,E,x,D,O,$,V,q,M=new y.EscapeSequenceParser){super(),this._bufferService=T,this._charsetService=E,this._coreService=x,this._logService=D,this._optionsService=O,this._oscLinkService=$,this._coreMouseService=V,this._unicodeService=q,this._parser=M,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new m.StringToUtf32,this._utf8Decoder=new m.Utf8ToUtf32,this._workCell=new a.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new l.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new l.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new l.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new l.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new l.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new l.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new l.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new l.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new l.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new l.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new l.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new l.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new l.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new X(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._parser.setCsiHandlerFallback((L,F)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(L),params:F.toArray()})}),this._parser.setEscHandlerFallback(L=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(L)})}),this._parser.setExecuteHandlerFallback(L=>{this._logService.debug("Unknown EXECUTE code: ",{code:L})}),this._parser.setOscHandlerFallback((L,F,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:L,action:F,data:W})}),this._parser.setDcsHandlerFallback((L,F,W)=>{F==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(L),action:F,payload:W})}),this._parser.setPrintHandler((L,F,W)=>this.print(L,F,W)),this._parser.registerCsiHandler({final:"@"},L=>this.insertChars(L)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},L=>this.scrollLeft(L)),this._parser.registerCsiHandler({final:"A"},L=>this.cursorUp(L)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},L=>this.scrollRight(L)),this._parser.registerCsiHandler({final:"B"},L=>this.cursorDown(L)),this._parser.registerCsiHandler({final:"C"},L=>this.cursorForward(L)),this._parser.registerCsiHandler({final:"D"},L=>this.cursorBackward(L)),this._parser.registerCsiHandler({final:"E"},L=>this.cursorNextLine(L)),this._parser.registerCsiHandler({final:"F"},L=>this.cursorPrecedingLine(L)),this._parser.registerCsiHandler({final:"G"},L=>this.cursorCharAbsolute(L)),this._parser.registerCsiHandler({final:"H"},L=>this.cursorPosition(L)),this._parser.registerCsiHandler({final:"I"},L=>this.cursorForwardTab(L)),this._parser.registerCsiHandler({final:"J"},L=>this.eraseInDisplay(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},L=>this.eraseInDisplay(L,!0)),this._parser.registerCsiHandler({final:"K"},L=>this.eraseInLine(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},L=>this.eraseInLine(L,!0)),this._parser.registerCsiHandler({final:"L"},L=>this.insertLines(L)),this._parser.registerCsiHandler({final:"M"},L=>this.deleteLines(L)),this._parser.registerCsiHandler({final:"P"},L=>this.deleteChars(L)),this._parser.registerCsiHandler({final:"S"},L=>this.scrollUp(L)),this._parser.registerCsiHandler({final:"T"},L=>this.scrollDown(L)),this._parser.registerCsiHandler({final:"X"},L=>this.eraseChars(L)),this._parser.registerCsiHandler({final:"Z"},L=>this.cursorBackwardTab(L)),this._parser.registerCsiHandler({final:"`"},L=>this.charPosAbsolute(L)),this._parser.registerCsiHandler({final:"a"},L=>this.hPositionRelative(L)),this._parser.registerCsiHandler({final:"b"},L=>this.repeatPrecedingCharacter(L)),this._parser.registerCsiHandler({final:"c"},L=>this.sendDeviceAttributesPrimary(L)),this._parser.registerCsiHandler({prefix:">",final:"c"},L=>this.sendDeviceAttributesSecondary(L)),this._parser.registerCsiHandler({final:"d"},L=>this.linePosAbsolute(L)),this._parser.registerCsiHandler({final:"e"},L=>this.vPositionRelative(L)),this._parser.registerCsiHandler({final:"f"},L=>this.hVPosition(L)),this._parser.registerCsiHandler({final:"g"},L=>this.tabClear(L)),this._parser.registerCsiHandler({final:"h"},L=>this.setMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"h"},L=>this.setModePrivate(L)),this._parser.registerCsiHandler({final:"l"},L=>this.resetMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"l"},L=>this.resetModePrivate(L)),this._parser.registerCsiHandler({final:"m"},L=>this.charAttributes(L)),this._parser.registerCsiHandler({final:"n"},L=>this.deviceStatus(L)),this._parser.registerCsiHandler({prefix:"?",final:"n"},L=>this.deviceStatusPrivate(L)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},L=>this.softReset(L)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},L=>this.setCursorStyle(L)),this._parser.registerCsiHandler({final:"r"},L=>this.setScrollRegion(L)),this._parser.registerCsiHandler({final:"s"},L=>this.saveCursor(L)),this._parser.registerCsiHandler({final:"t"},L=>this.windowOptions(L)),this._parser.registerCsiHandler({final:"u"},L=>this.restoreCursor(L)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},L=>this.insertColumns(L)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},L=>this.deleteColumns(L)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},L=>this.selectProtected(L)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},L=>this.requestMode(L,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},L=>this.requestMode(L,!1)),this._parser.setExecuteHandler(h.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(h.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(h.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(h.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(h.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(h.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(h.C1.IND,()=>this.index()),this._parser.setExecuteHandler(h.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(h.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new k.OscHandler(L=>(this.setTitle(L),this.setIconName(L),!0))),this._parser.registerOscHandler(1,new k.OscHandler(L=>this.setIconName(L))),this._parser.registerOscHandler(2,new k.OscHandler(L=>this.setTitle(L))),this._parser.registerOscHandler(4,new k.OscHandler(L=>this.setOrReportIndexedColor(L))),this._parser.registerOscHandler(8,new k.OscHandler(L=>this.setHyperlink(L))),this._parser.registerOscHandler(10,new k.OscHandler(L=>this.setOrReportFgColor(L))),this._parser.registerOscHandler(11,new k.OscHandler(L=>this.setOrReportBgColor(L))),this._parser.registerOscHandler(12,new k.OscHandler(L=>this.setOrReportCursorColor(L))),this._parser.registerOscHandler(104,new k.OscHandler(L=>this.restoreIndexedColor(L))),this._parser.registerOscHandler(110,new k.OscHandler(L=>this.restoreFgColor(L))),this._parser.registerOscHandler(111,new k.OscHandler(L=>this.restoreBgColor(L))),this._parser.registerOscHandler(112,new k.OscHandler(L=>this.restoreCursorColor(L))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const L in v.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:L},()=>this.selectCharset("("+L)),this._parser.registerEscHandler({intermediates:")",final:L},()=>this.selectCharset(")"+L)),this._parser.registerEscHandler({intermediates:"*",final:L},()=>this.selectCharset("*"+L)),this._parser.registerEscHandler({intermediates:"+",final:L},()=>this.selectCharset("+"+L)),this._parser.registerEscHandler({intermediates:"-",final:L},()=>this.selectCharset("-"+L)),this._parser.registerEscHandler({intermediates:".",final:L},()=>this.selectCharset("."+L)),this._parser.registerEscHandler({intermediates:"/",final:L},()=>this.selectCharset("/"+L));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(L=>(this._logService.error("Parsing error: ",L),L)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new S.DcsHandler((L,F)=>this.requestStatusString(L,F)))}_preserveStack(T,E,x,D){this._parseStack.paused=!0,this._parseStack.cursorStartX=T,this._parseStack.cursorStartY=E,this._parseStack.decodedLength=x,this._parseStack.position=D}_logSlowResolvingAsync(T){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([T,new Promise((E,x)=>setTimeout(()=>x("#SLOW_TIMEOUT"),5e3))]).catch(E=>{if(E!=="#SLOW_TIMEOUT")throw E;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(T,E){let x,D=this._activeBuffer.x,O=this._activeBuffer.y,$=0;const V=this._parseStack.paused;if(V){if(x=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,E))return this._logSlowResolvingAsync(x),x;D=this._parseStack.cursorStartX,O=this._parseStack.cursorStartY,this._parseStack.paused=!1,T.length>B&&($=this._parseStack.position+B)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof T=="string"?` "${T}"`:` "${Array.prototype.map.call(T,L=>String.fromCharCode(L)).join("")}"`),typeof T=="string"?T.split("").map(L=>L.charCodeAt(0)):T),this._parseBuffer.length<T.length&&this._parseBuffer.length<B&&(this._parseBuffer=new Uint32Array(Math.min(T.length,B))),V||this._dirtyRowTracker.clearRange(),T.length>B)for(let L=$;L<T.length;L+=B){const F=L+B<T.length?L+B:T.length,W=typeof T=="string"?this._stringDecoder.decode(T.substring(L,F),this._parseBuffer):this._utf8Decoder.decode(T.subarray(L,F),this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,W))return this._preserveStack(D,O,W,L),this._logSlowResolvingAsync(x),x}else if(!V){const L=typeof T=="string"?this._stringDecoder.decode(T,this._parseBuffer):this._utf8Decoder.decode(T,this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,L))return this._preserveStack(D,O,L,0),this._logSlowResolvingAsync(x),x}this._activeBuffer.x===D&&this._activeBuffer.y===O||this._onCursorMove.fire();const q=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),M=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);M<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(M,this._bufferService.rows-1),Math.min(q,this._bufferService.rows-1))}print(T,E,x){let D,O;const $=this._charsetService.charset,V=this._optionsService.rawOptions.screenReaderMode,q=this._bufferService.cols,M=this._coreService.decPrivateModes.wraparound,L=this._coreService.modes.insertMode,F=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&x-E>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodepoint(this._activeBuffer.x-1,0,1,F);let z=this._parser.precedingJoinState;for(let j=E;j<x;++j){if(D=T[j],D<127&&$){const ce=$[String.fromCharCode(D)];ce&&(D=ce.charCodeAt(0))}const te=this._unicodeService.charProperties(D,z);O=w.UnicodeService.extractWidth(te);const Q=w.UnicodeService.extractShouldJoin(te),oe=Q?w.UnicodeService.extractWidth(z):0;if(z=te,V&&this._onA11yChar.fire((0,m.stringFromCodePoint)(D)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+O-oe>q){if(M){const ce=W;let ee=this._activeBuffer.x-oe;for(this._activeBuffer.x=oe,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),oe>0&&W instanceof n.BufferLine&&W.copyCellsFrom(ce,ee,0,oe,!1);ee<q;)ce.setCellFromCodepoint(ee++,0,1,F)}else if(this._activeBuffer.x=q-1,O===2)continue}if(Q&&this._activeBuffer.x){const ce=W.getWidth(this._activeBuffer.x-1)?1:2;W.addCodepointToCell(this._activeBuffer.x-ce,D,O);for(let ee=O-oe;--ee>=0;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,F)}else if(L&&(W.insertCells(this._activeBuffer.x,O-oe,this._activeBuffer.getNullCell(F)),W.getWidth(q-1)===2&&W.setCellFromCodepoint(q-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,F)),W.setCellFromCodepoint(this._activeBuffer.x++,D,O,F),O>0)for(;--O;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,F)}this._parser.precedingJoinState=z,this._activeBuffer.x<q&&x-E>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodepoint(this._activeBuffer.x,0,1,F),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(T,E){return T.final!=="t"||T.prefix||T.intermediates?this._parser.registerCsiHandler(T,E):this._parser.registerCsiHandler(T,x=>!I(x.params[0],this._optionsService.rawOptions.windowOptions)||E(x))}registerDcsHandler(T,E){return this._parser.registerDcsHandler(T,new S.DcsHandler(E))}registerEscHandler(T,E){return this._parser.registerEscHandler(T,E)}registerOscHandler(T,E){return this._parser.registerOscHandler(T,new k.OscHandler(E))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);T.hasWidth(this._activeBuffer.x)&&!T.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const T=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-T),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(T=this._bufferService.cols-1){this._activeBuffer.x=Math.min(T,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(T,E){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=T,this._activeBuffer.y=this._activeBuffer.scrollTop+E):(this._activeBuffer.x=T,this._activeBuffer.y=E),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(T,E){this._restrictCursor(),this._setCursor(this._activeBuffer.x+T,this._activeBuffer.y+E)}cursorUp(T){const E=this._activeBuffer.y-this._activeBuffer.scrollTop;return E>=0?this._moveCursor(0,-Math.min(E,T.params[0]||1)):this._moveCursor(0,-(T.params[0]||1)),!0}cursorDown(T){const E=this._activeBuffer.scrollBottom-this._activeBuffer.y;return E>=0?this._moveCursor(0,Math.min(E,T.params[0]||1)):this._moveCursor(0,T.params[0]||1),!0}cursorForward(T){return this._moveCursor(T.params[0]||1,0),!0}cursorBackward(T){return this._moveCursor(-(T.params[0]||1),0),!0}cursorNextLine(T){return this.cursorDown(T),this._activeBuffer.x=0,!0}cursorPrecedingLine(T){return this.cursorUp(T),this._activeBuffer.x=0,!0}cursorCharAbsolute(T){return this._setCursor((T.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(T){return this._setCursor(T.length>=2?(T.params[1]||1)-1:0,(T.params[0]||1)-1),!0}charPosAbsolute(T){return this._setCursor((T.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(T){return this._moveCursor(T.params[0]||1,0),!0}linePosAbsolute(T){return this._setCursor(this._activeBuffer.x,(T.params[0]||1)-1),!0}vPositionRelative(T){return this._moveCursor(0,T.params[0]||1),!0}hVPosition(T){return this.cursorPosition(T),!0}tabClear(T){const E=T.params[0];return E===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:E===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(T){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=T.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(T){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=T.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(T){const E=T.params[0];return E===1&&(this._curAttrData.bg|=536870912),E!==2&&E!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(T,E,x,D=!1,O=!1){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);$.replaceCells(E,x,this._activeBuffer.getNullCell(this._eraseAttrData()),O),D&&($.isWrapped=!1)}_resetBufferLine(T,E=!1){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+T);x&&(x.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),E),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+T),x.isWrapped=!1)}eraseInDisplay(T,E=!1){let x;switch(this._restrictCursor(this._bufferService.cols),T.params[0]){case 0:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);x<this._bufferService.rows;x++)this._resetBufferLine(x,E);this._dirtyRowTracker.markDirty(x);break;case 1:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x,0,this._activeBuffer.x+1,!0,E),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(x+1).isWrapped=!1);x--;)this._resetBufferLine(x,E);this._dirtyRowTracker.markDirty(0);break;case 2:for(x=this._bufferService.rows,this._dirtyRowTracker.markDirty(x-1);x--;)this._resetBufferLine(x,E);this._dirtyRowTracker.markDirty(0);break;case 3:const D=this._activeBuffer.lines.length-this._bufferService.rows;D>0&&(this._activeBuffer.lines.trimStart(D),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-D,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-D,0),this._onScroll.fire(0))}return!0}eraseInLine(T,E=!1){switch(this._restrictCursor(this._bufferService.cols),T.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,E);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,E)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(T){this._restrictCursor();let E=T.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const x=this._activeBuffer.ybase+this._activeBuffer.y,D=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-D+1;for(;E--;)this._activeBuffer.lines.splice(O-1,1),this._activeBuffer.lines.splice(x,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(T){this._restrictCursor();let E=T.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const x=this._activeBuffer.ybase+this._activeBuffer.y;let D;for(D=this._bufferService.rows-1-this._activeBuffer.scrollBottom,D=this._bufferService.rows-1+this._activeBuffer.ybase-D;E--;)this._activeBuffer.lines.splice(x,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(T){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.insertCells(this._activeBuffer.x,T.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(T){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.deleteCells(this._activeBuffer.x,T.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(T){let E=T.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(T){let E=T.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(T){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=T.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);D.deleteCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData())),D.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(T){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=T.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);D.insertCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData())),D.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(T){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=T.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);D.insertCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData())),D.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(T){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=T.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);D.deleteCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData())),D.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(T){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(T.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(T){const E=this._parser.precedingJoinState;if(!E)return!0;const x=T.params[0]||1,D=w.UnicodeService.extractWidth(E),O=this._activeBuffer.x-D,$=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(O),V=new Uint32Array($.length*x);let q=0;for(let L=0;L<$.length;){const F=$.codePointAt(L)||0;V[q++]=F,L+=F>65535?2:1}let M=q;for(let L=1;L<x;++L)V.copyWithin(M,0,q),M+=q;return this.print(V,0,M),!0}sendDeviceAttributesPrimary(T){return T.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(h.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(h.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(T){return T.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(h.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(h.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(T.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(h.C0.ESC+"[>83;40003;0c")),!0}_is(T){return(this._optionsService.rawOptions.termName+"").indexOf(T)===0}setMode(T){for(let E=0;E<T.length;E++)switch(T.params[E]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(T){for(let E=0;E<T.length;E++)switch(T.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),this._charsetService.setgCharset(1,v.DEFAULT_CHARSET),this._charsetService.setgCharset(2,v.DEFAULT_CHARSET),this._charsetService.setgCharset(3,v.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(T){for(let E=0;E<T.length;E++)switch(T.params[E]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(T){for(let E=0;E<T.length;E++)switch(T.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),T.params[E]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(T,E){const x=this._coreService.decPrivateModes,{activeProtocol:D,activeEncoding:O}=this._coreMouseService,$=this._coreService,{buffers:V,cols:q}=this._bufferService,{active:M,alt:L}=V,F=this._optionsService.rawOptions,W=Q=>Q?1:2,z=T.params[0];return j=z,te=E?z===2?4:z===4?W($.modes.insertMode):z===12?3:z===20?W(F.convertEol):0:z===1?W(x.applicationCursorKeys):z===3?F.windowOptions.setWinLines?q===80?2:q===132?1:0:0:z===6?W(x.origin):z===7?W(x.wraparound):z===8?3:z===9?W(D==="X10"):z===12?W(F.cursorBlink):z===25?W(!$.isCursorHidden):z===45?W(x.reverseWraparound):z===66?W(x.applicationKeypad):z===67?4:z===1e3?W(D==="VT200"):z===1002?W(D==="DRAG"):z===1003?W(D==="ANY"):z===1004?W(x.sendFocus):z===1005?4:z===1006?W(O==="SGR"):z===1015?4:z===1016?W(O==="SGR_PIXELS"):z===1048?1:z===47||z===1047||z===1049?W(M===L):z===2004?W(x.bracketedPasteMode):0,$.triggerDataEvent(`${h.C0.ESC}[${E?"":"?"}${j};${te}$y`),!0;var j,te}_updateAttrColor(T,E,x,D,O){return E===2?(T|=50331648,T&=-16777216,T|=g.AttributeData.fromColorRGB([x,D,O])):E===5&&(T&=-50331904,T|=33554432|255&x),T}_extractColor(T,E,x){const D=[0,0,-1,0,0,0];let O=0,$=0;do{if(D[$+O]=T.params[E+$],T.hasSubParams(E+$)){const V=T.getSubParams(E+$);let q=0;do D[1]===5&&(O=1),D[$+q+1+O]=V[q];while(++q<V.length&&q+$+1+O<D.length);break}if(D[1]===5&&$+O>=2||D[1]===2&&$+O>=5)break;D[1]&&(O=1)}while(++$+E<T.length&&$+O<D.length);for(let V=2;V<D.length;++V)D[V]===-1&&(D[V]=0);switch(D[0]){case 38:x.fg=this._updateAttrColor(x.fg,D[1],D[3],D[4],D[5]);break;case 48:x.bg=this._updateAttrColor(x.bg,D[1],D[3],D[4],D[5]);break;case 58:x.extended=x.extended.clone(),x.extended.underlineColor=this._updateAttrColor(x.extended.underlineColor,D[1],D[3],D[4],D[5])}return $}_processUnderline(T,E){E.extended=E.extended.clone(),(!~T||T>5)&&(T=1),E.extended.underlineStyle=T,E.fg|=268435456,T===0&&(E.fg&=-268435457),E.updateExtended()}_processSGR0(T){T.fg=n.DEFAULT_ATTR_DATA.fg,T.bg=n.DEFAULT_ATTR_DATA.bg,T.extended=T.extended.clone(),T.extended.underlineStyle=0,T.extended.underlineColor&=-67108864,T.updateExtended()}charAttributes(T){if(T.length===1&&T.params[0]===0)return this._processSGR0(this._curAttrData),!0;const E=T.length;let x;const D=this._curAttrData;for(let O=0;O<E;O++)x=T.params[O],x>=30&&x<=37?(D.fg&=-50331904,D.fg|=16777216|x-30):x>=40&&x<=47?(D.bg&=-50331904,D.bg|=16777216|x-40):x>=90&&x<=97?(D.fg&=-50331904,D.fg|=16777224|x-90):x>=100&&x<=107?(D.bg&=-50331904,D.bg|=16777224|x-100):x===0?this._processSGR0(D):x===1?D.fg|=134217728:x===3?D.bg|=67108864:x===4?(D.fg|=268435456,this._processUnderline(T.hasSubParams(O)?T.getSubParams(O)[0]:1,D)):x===5?D.fg|=536870912:x===7?D.fg|=67108864:x===8?D.fg|=1073741824:x===9?D.fg|=2147483648:x===2?D.bg|=134217728:x===21?this._processUnderline(2,D):x===22?(D.fg&=-134217729,D.bg&=-134217729):x===23?D.bg&=-67108865:x===24?(D.fg&=-268435457,this._processUnderline(0,D)):x===25?D.fg&=-536870913:x===27?D.fg&=-67108865:x===28?D.fg&=-1073741825:x===29?D.fg&=2147483647:x===39?(D.fg&=-67108864,D.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):x===49?(D.bg&=-67108864,D.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):x===38||x===48||x===58?O+=this._extractColor(T,O,D):x===53?D.bg|=1073741824:x===55?D.bg&=-1073741825:x===59?(D.extended=D.extended.clone(),D.extended.underlineColor=-1,D.updateExtended()):x===100?(D.fg&=-67108864,D.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,D.bg&=-67108864,D.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",x);return!0}deviceStatus(T){switch(T.params[0]){case 5:this._coreService.triggerDataEvent(`${h.C0.ESC}[0n`);break;case 6:const E=this._activeBuffer.y+1,x=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[${E};${x}R`)}return!0}deviceStatusPrivate(T){if(T.params[0]===6){const E=this._activeBuffer.y+1,x=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[?${E};${x}R`)}return!0}softReset(T){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(T){const E=T.params[0]||1;switch(E){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const x=E%2==1;return this._optionsService.options.cursorBlink=x,!0}setScrollRegion(T){const E=T.params[0]||1;let x;return(T.length<2||(x=T.params[1])>this._bufferService.rows||x===0)&&(x=this._bufferService.rows),x>E&&(this._activeBuffer.scrollTop=E-1,this._activeBuffer.scrollBottom=x-1,this._setCursor(0,0)),!0}windowOptions(T){if(!I(T.params[0],this._optionsService.rawOptions.windowOptions))return!0;const E=T.length>1?T.params[1]:0;switch(T.params[0]){case 14:E!==2&&this._onRequestWindowsOptionsReport.fire(A.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(A.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${h.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:E!==0&&E!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),E!==0&&E!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:E!==0&&E!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),E!==0&&E!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(T){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(T){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(T){return this._windowTitle=T,this._onTitleChange.fire(T),!0}setIconName(T){return this._iconName=T,!0}setOrReportIndexedColor(T){const E=[],x=T.split(";");for(;x.length>1;){const D=x.shift(),O=x.shift();if(/^\d+$/.exec(D)){const $=parseInt(D);if(J($))if(O==="?")E.push({type:0,index:$});else{const V=(0,R.parseColor)(O);V&&E.push({type:1,index:$,color:V})}}}return E.length&&this._onColor.fire(E),!0}setHyperlink(T){const E=T.split(";");return!(E.length<2)&&(E[1]?this._createHyperlink(E[0],E[1]):!E[0]&&this._finishHyperlink())}_createHyperlink(T,E){this._getCurrentLinkId()&&this._finishHyperlink();const x=T.split(":");let D;const O=x.findIndex($=>$.startsWith("id="));return O!==-1&&(D=x[O].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:D,uri:E}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(T,E){const x=T.split(";");for(let D=0;D<x.length&&!(E>=this._specialColors.length);++D,++E)if(x[D]==="?")this._onColor.fire([{type:0,index:this._specialColors[E]}]);else{const O=(0,R.parseColor)(x[D]);O&&this._onColor.fire([{type:1,index:this._specialColors[E],color:O}])}return!0}setOrReportFgColor(T){return this._setOrReportSpecialColor(T,0)}setOrReportBgColor(T){return this._setOrReportSpecialColor(T,1)}setOrReportCursorColor(T){return this._setOrReportSpecialColor(T,2)}restoreIndexedColor(T){if(!T)return this._onColor.fire([{type:2}]),!0;const E=[],x=T.split(";");for(let D=0;D<x.length;++D)if(/^\d+$/.exec(x[D])){const O=parseInt(x[D]);J(O)&&E.push({type:2,index:O})}return E.length&&this._onColor.fire(E),!0}restoreFgColor(T){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(T){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(T){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),!0}selectCharset(T){return T.length!==2?(this.selectDefaultCharset(),!0):(T[0]==="/"||this._charsetService.setgCharset(P[T[0]],v.CHARSETS[T[1]]||v.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const T=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,T,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(T){return this._charsetService.setgLevel(T),!0}screenAlignmentPattern(){const T=new a.CellData;T.content=4194373,T.fg=this._curAttrData.fg,T.bg=this._curAttrData.bg,this._setCursor(0,0);for(let E=0;E<this._bufferService.rows;++E){const x=this._activeBuffer.ybase+this._activeBuffer.y+E,D=this._activeBuffer.lines.get(x);D&&(D.fill(T),D.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(T,E){const x=this._bufferService.buffer,D=this._optionsService.rawOptions;return(O=>(this._coreService.triggerDataEvent(`${h.C0.ESC}${O}${h.C0.ESC}\\`),!0))(T==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:T==='"p'?'P1$r61;1"p':T==="r"?`P1$r${x.scrollTop+1};${x.scrollBottom+1}r`:T==="m"?"P1$r0m":T===" q"?`P1$r${{block:2,underline:4,bar:6}[D.cursorStyle]-(D.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(T,E){this._dirtyRowTracker.markRangeDirty(T,E)}}s.InputHandler=U;let X=class{constructor(K){this._bufferService=K,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(K){K<this.start?this.start=K:K>this.end&&(this.end=K)}markRangeDirty(K,T){K>T&&(N=K,K=T,T=N),K<this.start&&(this.start=K),T>this.end&&(this.end=T)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function J(K){return 0<=K&&K<256}X=d([f(0,b.IBufferService)],X)},844:(_,s)=>{function c(d){for(const f of d)f.dispose();d.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.MutableDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const d of this._disposables)d.dispose();this._disposables.length=0}register(d){return this._disposables.push(d),d}unregister(d){const f=this._disposables.indexOf(d);f!==-1&&this._disposables.splice(f,1)}},s.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(d){this._isDisposed||d===this._value||(this._value?.dispose(),this._value=d)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},s.toDisposable=function(d){return{dispose:d}},s.disposeArray=c,s.getDisposeArrayDisposable=function(d){return{dispose:()=>c(d)}}},1505:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class c{constructor(){this._data={}}set(f,h,v){this._data[f]||(this._data[f]={}),this._data[f][h]=v}get(f,h){return this._data[f]?this._data[f][h]:void 0}clear(){this._data={}}}s.TwoKeyMap=c,s.FourKeyMap=class{constructor(){this._data=new c}set(d,f,h,v,y){this._data.get(d,f)||this._data.set(d,f,new c),this._data.get(d,f).set(h,v,y)}get(d,f,h,v){return this._data.get(d,f)?.get(h,v)}clear(){this._data.clear()}}},6114:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof process<"u"&&"title"in process;const c=s.isNode?"node":navigator.userAgent,d=s.isNode?"node":navigator.platform;s.isFirefox=c.includes("Firefox"),s.isLegacyEdge=c.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(c),s.getSafariVersion=function(){if(!s.isSafari)return 0;const f=c.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(d),s.isIpad=d==="iPad",s.isIphone=d==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(d),s.isLinux=d.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(c)},6106:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let c=0;s.SortedList=class{constructor(d){this._getKey=d,this._array=[]}clear(){this._array.length=0}insert(d){this._array.length!==0?(c=this._search(this._getKey(d)),this._array.splice(c,0,d)):this._array.push(d)}delete(d){if(this._array.length===0)return!1;const f=this._getKey(d);if(f===void 0||(c=this._search(f),c===-1)||this._getKey(this._array[c])!==f)return!1;do if(this._array[c]===d)return this._array.splice(c,1),!0;while(++c<this._array.length&&this._getKey(this._array[c])===f);return!1}*getKeyIterator(d){if(this._array.length!==0&&(c=this._search(d),!(c<0||c>=this._array.length)&&this._getKey(this._array[c])===d))do yield this._array[c];while(++c<this._array.length&&this._getKey(this._array[c])===d)}forEachByKey(d,f){if(this._array.length!==0&&(c=this._search(d),!(c<0||c>=this._array.length)&&this._getKey(this._array[c])===d))do f(this._array[c]);while(++c<this._array.length&&this._getKey(this._array[c])===d)}values(){return[...this._array].values()}_search(d){let f=0,h=this._array.length-1;for(;h>=f;){let v=f+h>>1;const y=this._getKey(this._array[v]);if(y>d)h=v-1;else{if(!(y<d)){for(;v>0&&this._getKey(this._array[v-1])===d;)v--;return v}f=v+1}}return f}}},7226:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const d=c(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(y){this._tasks.push(y),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(y){this._idleCallback=void 0;let C=0,m=0,n=y.timeRemaining(),l=0;for(;this._i<this._tasks.length;){if(C=Date.now(),this._tasks[this._i]()||this._i++,C=Math.max(1,Date.now()-C),m=Math.max(C,m),l=y.timeRemaining(),1.5*m>l)return n-C<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-C))}ms`),void this._start();n=l}this.clear()}}class h extends f{_requestCallback(y){return setTimeout(()=>y(this._createDeadline(16)))}_cancelCallback(y){clearTimeout(y)}_createDeadline(y){const C=Date.now()+y;return{timeRemaining:()=>Math.max(0,C-Date.now())}}}s.PriorityTaskQueue=h,s.IdleTaskQueue=!d.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(v){return requestIdleCallback(v)}_cancelCallback(v){cancelIdleCallback(v)}}:h,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(v){this._queue.clear(),this._queue.enqueue(v)}flush(){this._queue.flush()}}},9282:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const d=c(643);s.updateWindowsModeWrappedState=function(f){const h=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),v=h?.get(f.cols-1),y=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);y&&v&&(y.isWrapped=v[d.CHAR_DATA_CODE_INDEX]!==d.NULL_CELL_CODE&&v[d.CHAR_DATA_CODE_INDEX]!==d.WHITESPACE_CELL_CODE)}},3734:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class c{constructor(){this.fg=0,this.bg=0,this.extended=new d}static toColorRGB(h){return[h>>>16&255,h>>>8&255,255&h]}static fromColorRGB(h){return(255&h[0])<<16|(255&h[1])<<8|255&h[2]}clone(){const h=new c;return h.fg=this.fg,h.bg=this.bg,h.extended=this.extended.clone(),h}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}s.AttributeData=c;class d{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(h){this._ext=h}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(h){this._ext&=-469762049,this._ext|=h<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(h){this._ext&=-67108864,this._ext|=67108863&h}get urlId(){return this._urlId}set urlId(h){this._urlId=h}get underlineVariantOffset(){const h=(3758096384&this._ext)>>29;return h<0?4294967288^h:h}set underlineVariantOffset(h){this._ext&=536870911,this._ext|=h<<29&3758096384}constructor(h=0,v=0){this._ext=0,this._urlId=0,this._ext=h,this._urlId=v}clone(){return new d(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=d},9092:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const d=c(6349),f=c(7226),h=c(3734),v=c(8437),y=c(4634),C=c(511),m=c(643),n=c(4863),l=c(7116);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(o,a,g){this._hasScrollback=o,this._optionsService=a,this._bufferService=g,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=l.DEFAULT_CHARSET,this.markers=[],this._nullCell=C.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]),this._whitespaceCell=C.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new f.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(o,a){return new v.BufferLine(this._bufferService.cols,this.getNullCell(o),a)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows}_getCorrectBufferLength(o){if(!this._hasScrollback)return o;const a=o+this._optionsService.rawOptions.scrollback;return a>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:a}fillViewportRows(o){if(this.lines.length===0){o===void 0&&(o=v.DEFAULT_ATTR_DATA);let a=this._rows;for(;a--;)this.lines.push(this.getBlankLine(o))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(o,a){const g=this.getNullCell(v.DEFAULT_ATTR_DATA);let b=0;const w=this._getCorrectBufferLength(a);if(w>this.lines.maxLength&&(this.lines.maxLength=w),this.lines.length>0){if(this._cols<o)for(let S=0;S<this.lines.length;S++)b+=+this.lines.get(S).resize(o,g);let k=0;if(this._rows<a)for(let S=this._rows;S<a;S++)this.lines.length<a+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new v.BufferLine(o,g)):this.ybase>0&&this.lines.length<=this.ybase+this.y+k+1?(this.ybase--,k++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(o,g)));else for(let S=this._rows;S>a;S--)this.lines.length>a+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(w<this.lines.maxLength){const S=this.lines.length-w;S>0&&(this.lines.trimStart(S),this.ybase=Math.max(this.ybase-S,0),this.ydisp=Math.max(this.ydisp-S,0),this.savedY=Math.max(this.savedY-S,0)),this.lines.maxLength=w}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,a-1),k&&(this.y+=k),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=a-1,this._isReflowEnabled&&(this._reflow(o,a),this._cols>o))for(let k=0;k<this.lines.length;k++)b+=+this.lines.get(k).resize(o,g);this._cols=o,this._rows=a,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let o=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,o=!1);let a=0;for(;this._memoryCleanupPosition<this.lines.length;)if(a+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),a>100)return!0;return o}get _isReflowEnabled(){const o=this._optionsService.rawOptions.windowsPty;return o&&o.buildNumber?this._hasScrollback&&o.backend==="conpty"&&o.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(o,a){this._cols!==o&&(o>this._cols?this._reflowLarger(o,a):this._reflowSmaller(o,a))}_reflowLarger(o,a){const g=(0,y.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(g.length>0){const b=(0,y.reflowLargerCreateNewLayout)(this.lines,g);(0,y.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(o,a,b.countRemoved)}}_reflowLargerAdjustViewport(o,a,g){const b=this.getNullCell(v.DEFAULT_ATTR_DATA);let w=g;for(;w-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<a&&this.lines.push(new v.BufferLine(o,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-g,0)}_reflowSmaller(o,a){const g=this.getNullCell(v.DEFAULT_ATTR_DATA),b=[];let w=0;for(let k=this.lines.length-1;k>=0;k--){let S=this.lines.get(k);if(!S||!S.isWrapped&&S.getTrimmedLength()<=o)continue;const R=[S];for(;S.isWrapped&&k>0;)S=this.lines.get(--k),R.unshift(S);const P=this.ybase+this.y;if(P>=k&&P<k+R.length)continue;const B=R[R.length-1].getTrimmedLength(),I=(0,y.reflowSmallerGetNewLineLengths)(R,this._cols,o),A=I.length-R.length;let N;N=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+A):Math.max(0,this.lines.length-this.lines.maxLength+A);const U=[];for(let x=0;x<A;x++){const D=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);U.push(D)}U.length>0&&(b.push({start:k+R.length+w,newLines:U}),w+=U.length),R.push(...U);let X=I.length-1,J=I[X];J===0&&(X--,J=I[X]);let K=R.length-A-1,T=B;for(;K>=0;){const x=Math.min(T,J);if(R[X]===void 0)break;if(R[X].copyCellsFrom(R[K],T-x,J-x,x,!0),J-=x,J===0&&(X--,J=I[X]),T-=x,T===0){K--;const D=Math.max(K,0);T=(0,y.getWrappedLineTrimmedLength)(R,D,this._cols)}}for(let x=0;x<R.length;x++)I[x]<o&&R[x].setCell(I[x],g);let E=A-N;for(;E-- >0;)this.ybase===0?this.y<a-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+w)-a&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+A,this.ybase+a-1)}if(b.length>0){const k=[],S=[];for(let X=0;X<this.lines.length;X++)S.push(this.lines.get(X));const R=this.lines.length;let P=R-1,B=0,I=b[B];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+w);let A=0;for(let X=Math.min(this.lines.maxLength-1,R+w-1);X>=0;X--)if(I&&I.start>P+A){for(let J=I.newLines.length-1;J>=0;J--)this.lines.set(X--,I.newLines[J]);X++,k.push({index:P+1,amount:I.newLines.length}),A+=I.newLines.length,I=b[++B]}else this.lines.set(X,S[P--]);let N=0;for(let X=k.length-1;X>=0;X--)k[X].index+=N,this.lines.onInsertEmitter.fire(k[X]),N+=k[X].amount;const U=Math.max(0,R+w-this.lines.maxLength);U>0&&this.lines.onTrimEmitter.fire(U)}}translateBufferLineToString(o,a,g=0,b){const w=this.lines.get(o);return w?w.translateToString(a,g,b):""}getWrappedRangeForLine(o){let a=o,g=o;for(;a>0&&this.lines.get(a).isWrapped;)a--;for(;g+1<this.lines.length&&this.lines.get(g+1).isWrapped;)g++;return{first:a,last:g}}setupTabStops(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.rawOptions.tabStopWidth)this.tabs[o]=!0}prevStop(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o}nextStop(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o}clearMarkers(o){this._isClearing=!0;for(let a=0;a<this.markers.length;a++)this.markers[a].line===o&&(this.markers[a].dispose(),this.markers.splice(a--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].dispose(),this.markers.splice(o--,1);this._isClearing=!1}addMarker(o){const a=new n.Marker(o);return this.markers.push(a),a.register(this.lines.onTrim(g=>{a.line-=g,a.line<0&&a.dispose()})),a.register(this.lines.onInsert(g=>{a.line>=g.index&&(a.line+=g.amount)})),a.register(this.lines.onDelete(g=>{a.line>=g.index&&a.line<g.index+g.amount&&a.dispose(),a.line>g.index&&(a.line-=g.amount)})),a.register(a.onDispose(()=>this._removeMarker(a))),a}_removeMarker(o){this._isClearing||this.markers.splice(this.markers.indexOf(o),1)}}},8437:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const d=c(3734),f=c(511),h=c(643),v=c(482);s.DEFAULT_ATTR_DATA=Object.freeze(new d.AttributeData);let y=0;class C{constructor(n,l,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const a=l||f.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]);for(let g=0;g<n;++g)this.setCell(g,a);this.length=n}get(n){const l=this._data[3*n+0],o=2097151&l;return[this._data[3*n+1],2097152&l?this._combined[n]:o?(0,v.stringFromCodePoint)(o):"",l>>22,2097152&l?this._combined[n].charCodeAt(this._combined[n].length-1):o]}set(n,l){this._data[3*n+1]=l[h.CHAR_DATA_ATTR_INDEX],l[h.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=l[1],this._data[3*n+0]=2097152|n|l[h.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=l[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|l[h.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const l=this._data[3*n+0];return 2097152&l?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&l}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const l=this._data[3*n+0];return 2097152&l?this._combined[n]:2097151&l?(0,v.stringFromCodePoint)(2097151&l):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,l){return y=3*n,l.content=this._data[y+0],l.fg=this._data[y+1],l.bg=this._data[y+2],2097152&l.content&&(l.combinedData=this._combined[n]),268435456&l.bg&&(l.extended=this._extendedAttrs[n]),l}setCell(n,l){2097152&l.content&&(this._combined[n]=l.combinedData),268435456&l.bg&&(this._extendedAttrs[n]=l.extended),this._data[3*n+0]=l.content,this._data[3*n+1]=l.fg,this._data[3*n+2]=l.bg}setCellFromCodepoint(n,l,o,a){268435456&a.bg&&(this._extendedAttrs[n]=a.extended),this._data[3*n+0]=l|o<<22,this._data[3*n+1]=a.fg,this._data[3*n+2]=a.bg}addCodepointToCell(n,l,o){let a=this._data[3*n+0];2097152&a?this._combined[n]+=(0,v.stringFromCodePoint)(l):2097151&a?(this._combined[n]=(0,v.stringFromCodePoint)(2097151&a)+(0,v.stringFromCodePoint)(l),a&=-2097152,a|=2097152):a=l|4194304,o&&(a&=-12582913,a|=o<<22),this._data[3*n+0]=a}insertCells(n,l,o){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,o),l<this.length-n){const a=new f.CellData;for(let g=this.length-n-l-1;g>=0;--g)this.setCell(n+l+g,this.loadCell(n+g,a));for(let g=0;g<l;++g)this.setCell(n+g,o)}else for(let a=n;a<this.length;++a)this.setCell(a,o);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,o)}deleteCells(n,l,o){if(n%=this.length,l<this.length-n){const a=new f.CellData;for(let g=0;g<this.length-n-l;++g)this.setCell(n+g,this.loadCell(n+l+g,a));for(let g=this.length-l;g<this.length;++g)this.setCell(g,o)}else for(let a=n;a<this.length;++a)this.setCell(a,o);n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,o),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodepoint(n,0,1,o)}replaceCells(n,l,o,a=!1){if(a)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodepoint(n-1,0,1,o),l<this.length&&this.getWidth(l-1)===2&&!this.isProtected(l)&&this.setCellFromCodepoint(l,0,1,o);n<l&&n<this.length;)this.isProtected(n)||this.setCell(n,o),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,o),l<this.length&&this.getWidth(l-1)===2&&this.setCellFromCodepoint(l,0,1,o);n<l&&n<this.length;)this.setCell(n++,o)}resize(n,l){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const o=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{const a=new Uint32Array(o);a.set(this._data),this._data=a}for(let a=this.length;a<n;++a)this.setCell(a,l)}else{this._data=this._data.subarray(0,o);const a=Object.keys(this._combined);for(let b=0;b<a.length;b++){const w=parseInt(a[b],10);w>=n&&delete this._combined[w]}const g=Object.keys(this._extendedAttrs);for(let b=0;b<g.length;b++){const w=parseInt(g[b],10);w>=n&&delete this._extendedAttrs[w]}}return this.length=n,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,l=!1){if(l)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,n);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const l in n._combined)this._combined[l]=n._combined[l];this._extendedAttrs={};for(const l in n._extendedAttrs)this._extendedAttrs[l]=n._extendedAttrs[l];this.isWrapped=n.isWrapped}clone(){const n=new C(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const l in this._combined)n._combined[l]=this._combined[l];for(const l in this._extendedAttrs)n._extendedAttrs[l]=this._extendedAttrs[l];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,l,o,a,g){const b=n._data;if(g)for(let k=a-1;k>=0;k--){for(let S=0;S<3;S++)this._data[3*(o+k)+S]=b[3*(l+k)+S];268435456&b[3*(l+k)+2]&&(this._extendedAttrs[o+k]=n._extendedAttrs[l+k])}else for(let k=0;k<a;k++){for(let S=0;S<3;S++)this._data[3*(o+k)+S]=b[3*(l+k)+S];268435456&b[3*(l+k)+2]&&(this._extendedAttrs[o+k]=n._extendedAttrs[l+k])}const w=Object.keys(n._combined);for(let k=0;k<w.length;k++){const S=parseInt(w[k],10);S>=l&&(this._combined[S-l+o]=n._combined[S])}}translateToString(n,l,o,a){l=l??0,o=o??this.length,n&&(o=Math.min(o,this.getTrimmedLength())),a&&(a.length=0);let g="";for(;l<o;){const b=this._data[3*l+0],w=2097151&b,k=2097152&b?this._combined[l]:w?(0,v.stringFromCodePoint)(w):h.WHITESPACE_CELL_CHAR;if(g+=k,a)for(let S=0;S<k.length;++S)a.push(l);l+=b>>22||1}return a&&a.push(l),g}}s.BufferLine=C},4841:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(c,d){if(c.start.y>c.end.y)throw new Error(`Buffer range end (${c.end.x}, ${c.end.y}) cannot be before start (${c.start.x}, ${c.start.y})`);return d*(c.end.y-c.start.y)+(c.end.x-c.start.x+1)}},4634:(_,s)=>{function c(d,f,h){if(f===d.length-1)return d[f].getTrimmedLength();const v=!d[f].hasContent(h-1)&&d[f].getWidth(h-1)===1,y=d[f+1].getWidth(0)===2;return v&&y?h-1:h}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(d,f,h,v,y){const C=[];for(let m=0;m<d.length-1;m++){let n=m,l=d.get(++n);if(!l.isWrapped)continue;const o=[d.get(m)];for(;n<d.length&&l.isWrapped;)o.push(l),l=d.get(++n);if(v>=m&&v<n){m+=o.length-1;continue}let a=0,g=c(o,a,f),b=1,w=0;for(;b<o.length;){const S=c(o,b,f),R=S-w,P=h-g,B=Math.min(R,P);o[a].copyCellsFrom(o[b],w,g,B,!1),g+=B,g===h&&(a++,g=0),w+=B,w===S&&(b++,w=0),g===0&&a!==0&&o[a-1].getWidth(h-1)===2&&(o[a].copyCellsFrom(o[a-1],h-1,g++,1,!1),o[a-1].setCell(h-1,y))}o[a].replaceCells(g,h,y);let k=0;for(let S=o.length-1;S>0&&(S>a||o[S].getTrimmedLength()===0);S--)k++;k>0&&(C.push(m+o.length-k),C.push(k)),m+=o.length-1}return C},s.reflowLargerCreateNewLayout=function(d,f){const h=[];let v=0,y=f[v],C=0;for(let m=0;m<d.length;m++)if(y===m){const n=f[++v];d.onDeleteEmitter.fire({index:m-C,amount:n}),m+=n-1,C+=n,y=f[++v]}else h.push(m);return{layout:h,countRemoved:C}},s.reflowLargerApplyNewLayout=function(d,f){const h=[];for(let v=0;v<f.length;v++)h.push(d.get(f[v]));for(let v=0;v<h.length;v++)d.set(v,h[v]);d.length=f.length},s.reflowSmallerGetNewLineLengths=function(d,f,h){const v=[],y=d.map((l,o)=>c(d,o,f)).reduce((l,o)=>l+o);let C=0,m=0,n=0;for(;n<y;){if(y-n<h){v.push(y-n);break}C+=h;const l=c(d,m,f);C>l&&(C-=l,m++);const o=d[m].getWidth(C-1)===2;o&&C--;const a=o?h-1:h;v.push(a),n+=a}return v},s.getWrappedLineTrimmedLength=c},5295:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const d=c(8460),f=c(844),h=c(9092);class v extends f.Disposable{constructor(C,m){super(),this._optionsService=C,this._bufferService=m,this._onBufferActivate=this.register(new d.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(C){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(C),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(C,m){this._normal.resize(C,m),this._alt.resize(C,m),this.setupTabStops(C)}setupTabStops(C){this._normal.setupTabStops(C),this._alt.setupTabStops(C)}}s.BufferSet=v},511:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const d=c(482),f=c(643),h=c(3734);class v extends h.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new h.ExtendedAttrs,this.combinedData=""}static fromCharData(C){const m=new v;return m.setFromCharData(C),m}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,d.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(C){this.fg=C[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let m=!1;if(C[f.CHAR_DATA_CHAR_INDEX].length>2)m=!0;else if(C[f.CHAR_DATA_CHAR_INDEX].length===2){const n=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const l=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=l&&l<=57343?this.content=1024*(n-55296)+l-56320+65536|C[f.CHAR_DATA_WIDTH_INDEX]<<22:m=!0}else m=!0}else this.content=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|C[f.CHAR_DATA_WIDTH_INDEX]<<22;m&&(this.combinedData=C[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|C[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=v},643:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const d=c(8460),f=c(844);class h{get id(){return this._id}constructor(y){this.line=y,this.isDisposed=!1,this._disposables=[],this._id=h._nextId++,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(y){return this._disposables.push(y),y}}s.Marker=h,h._nextId=1},7116:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},s.CHARSETS.A={"#":"Â£"},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},s.CHARSETS.C=s.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},s.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},s.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},s.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},s.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},s.CHARSETS.E=s.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},s.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},s.CHARSETS.H=s.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},s.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(_,s)=>{var c,d,f;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(h){h.NUL="\0",h.SOH="",h.STX="",h.ETX="",h.EOT="",h.ENQ="",h.ACK="",h.BEL="\x07",h.BS="\b",h.HT="	",h.LF=`
`,h.VT="\v",h.FF="\f",h.CR="\r",h.SO="",h.SI="",h.DLE="",h.DC1="",h.DC2="",h.DC3="",h.DC4="",h.NAK="",h.SYN="",h.ETB="",h.CAN="",h.EM="",h.SUB="",h.ESC="\x1B",h.FS="",h.GS="",h.RS="",h.US="",h.SP=" ",h.DEL=""}(c||(s.C0=c={})),function(h){h.PAD="Â",h.HOP="Â",h.BPH="Â",h.NBH="Â",h.IND="Â",h.NEL="Â",h.SSA="Â",h.ESA="Â",h.HTS="Â",h.HTJ="Â",h.VTS="Â",h.PLD="Â",h.PLU="Â",h.RI="Â",h.SS2="Â",h.SS3="Â",h.DCS="Â",h.PU1="Â",h.PU2="Â",h.STS="Â",h.CCH="Â",h.MW="Â",h.SPA="Â",h.EPA="Â",h.SOS="Â",h.SGCI="Â",h.SCI="Â",h.CSI="Â",h.ST="Â",h.OSC="Â",h.PM="Â",h.APC="Â"}(d||(s.C1=d={})),function(h){h.ST=`${c.ESC}\\`}(f||(s.C1_ESCAPED=f={}))},7399:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const d=c(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(h,v,y,C){const m={type:0,cancel:!1,key:void 0},n=(h.shiftKey?1:0)|(h.altKey?2:0)|(h.ctrlKey?4:0)|(h.metaKey?8:0);switch(h.keyCode){case 0:h.key==="UIKeyInputUpArrow"?m.key=v?d.C0.ESC+"OA":d.C0.ESC+"[A":h.key==="UIKeyInputLeftArrow"?m.key=v?d.C0.ESC+"OD":d.C0.ESC+"[D":h.key==="UIKeyInputRightArrow"?m.key=v?d.C0.ESC+"OC":d.C0.ESC+"[C":h.key==="UIKeyInputDownArrow"&&(m.key=v?d.C0.ESC+"OB":d.C0.ESC+"[B");break;case 8:m.key=h.ctrlKey?"\b":d.C0.DEL,h.altKey&&(m.key=d.C0.ESC+m.key);break;case 9:if(h.shiftKey){m.key=d.C0.ESC+"[Z";break}m.key=d.C0.HT,m.cancel=!0;break;case 13:m.key=h.altKey?d.C0.ESC+d.C0.CR:d.C0.CR,m.cancel=!0;break;case 27:m.key=d.C0.ESC,h.altKey&&(m.key=d.C0.ESC+d.C0.ESC),m.cancel=!0;break;case 37:if(h.metaKey)break;n?(m.key=d.C0.ESC+"[1;"+(n+1)+"D",m.key===d.C0.ESC+"[1;3D"&&(m.key=d.C0.ESC+(y?"b":"[1;5D"))):m.key=v?d.C0.ESC+"OD":d.C0.ESC+"[D";break;case 39:if(h.metaKey)break;n?(m.key=d.C0.ESC+"[1;"+(n+1)+"C",m.key===d.C0.ESC+"[1;3C"&&(m.key=d.C0.ESC+(y?"f":"[1;5C"))):m.key=v?d.C0.ESC+"OC":d.C0.ESC+"[C";break;case 38:if(h.metaKey)break;n?(m.key=d.C0.ESC+"[1;"+(n+1)+"A",y||m.key!==d.C0.ESC+"[1;3A"||(m.key=d.C0.ESC+"[1;5A")):m.key=v?d.C0.ESC+"OA":d.C0.ESC+"[A";break;case 40:if(h.metaKey)break;n?(m.key=d.C0.ESC+"[1;"+(n+1)+"B",y||m.key!==d.C0.ESC+"[1;3B"||(m.key=d.C0.ESC+"[1;5B")):m.key=v?d.C0.ESC+"OB":d.C0.ESC+"[B";break;case 45:h.shiftKey||h.ctrlKey||(m.key=d.C0.ESC+"[2~");break;case 46:m.key=n?d.C0.ESC+"[3;"+(n+1)+"~":d.C0.ESC+"[3~";break;case 36:m.key=n?d.C0.ESC+"[1;"+(n+1)+"H":v?d.C0.ESC+"OH":d.C0.ESC+"[H";break;case 35:m.key=n?d.C0.ESC+"[1;"+(n+1)+"F":v?d.C0.ESC+"OF":d.C0.ESC+"[F";break;case 33:h.shiftKey?m.type=2:h.ctrlKey?m.key=d.C0.ESC+"[5;"+(n+1)+"~":m.key=d.C0.ESC+"[5~";break;case 34:h.shiftKey?m.type=3:h.ctrlKey?m.key=d.C0.ESC+"[6;"+(n+1)+"~":m.key=d.C0.ESC+"[6~";break;case 112:m.key=n?d.C0.ESC+"[1;"+(n+1)+"P":d.C0.ESC+"OP";break;case 113:m.key=n?d.C0.ESC+"[1;"+(n+1)+"Q":d.C0.ESC+"OQ";break;case 114:m.key=n?d.C0.ESC+"[1;"+(n+1)+"R":d.C0.ESC+"OR";break;case 115:m.key=n?d.C0.ESC+"[1;"+(n+1)+"S":d.C0.ESC+"OS";break;case 116:m.key=n?d.C0.ESC+"[15;"+(n+1)+"~":d.C0.ESC+"[15~";break;case 117:m.key=n?d.C0.ESC+"[17;"+(n+1)+"~":d.C0.ESC+"[17~";break;case 118:m.key=n?d.C0.ESC+"[18;"+(n+1)+"~":d.C0.ESC+"[18~";break;case 119:m.key=n?d.C0.ESC+"[19;"+(n+1)+"~":d.C0.ESC+"[19~";break;case 120:m.key=n?d.C0.ESC+"[20;"+(n+1)+"~":d.C0.ESC+"[20~";break;case 121:m.key=n?d.C0.ESC+"[21;"+(n+1)+"~":d.C0.ESC+"[21~";break;case 122:m.key=n?d.C0.ESC+"[23;"+(n+1)+"~":d.C0.ESC+"[23~";break;case 123:m.key=n?d.C0.ESC+"[24;"+(n+1)+"~":d.C0.ESC+"[24~";break;default:if(!h.ctrlKey||h.shiftKey||h.altKey||h.metaKey)if(y&&!C||!h.altKey||h.metaKey)!y||h.altKey||h.ctrlKey||h.shiftKey||!h.metaKey?h.key&&!h.ctrlKey&&!h.altKey&&!h.metaKey&&h.keyCode>=48&&h.key.length===1?m.key=h.key:h.key&&h.ctrlKey&&(h.key==="_"&&(m.key=d.C0.US),h.key==="@"&&(m.key=d.C0.NUL)):h.keyCode===65&&(m.type=1);else{const l=f[h.keyCode],o=l?.[h.shiftKey?1:0];if(o)m.key=d.C0.ESC+o;else if(h.keyCode>=65&&h.keyCode<=90){const a=h.ctrlKey?h.keyCode-64:h.keyCode+32;let g=String.fromCharCode(a);h.shiftKey&&(g=g.toUpperCase()),m.key=d.C0.ESC+g}else if(h.keyCode===32)m.key=d.C0.ESC+(h.ctrlKey?d.C0.NUL:" ");else if(h.key==="Dead"&&h.code.startsWith("Key")){let a=h.code.slice(3,4);h.shiftKey||(a=a.toLowerCase()),m.key=d.C0.ESC+a,m.cancel=!0}}else h.keyCode>=65&&h.keyCode<=90?m.key=String.fromCharCode(h.keyCode-64):h.keyCode===32?m.key=d.C0.NUL:h.keyCode>=51&&h.keyCode<=55?m.key=String.fromCharCode(h.keyCode-51+27):h.keyCode===56?m.key=d.C0.DEL:h.keyCode===219?m.key=d.C0.ESC:h.keyCode===220?m.key=d.C0.FS:h.keyCode===221&&(m.key=d.C0.GS)}return m}},482:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(c){return c>65535?(c-=65536,String.fromCharCode(55296+(c>>10))+String.fromCharCode(c%1024+56320)):String.fromCharCode(c)},s.utf32ToString=function(c,d=0,f=c.length){let h="";for(let v=d;v<f;++v){let y=c[v];y>65535?(y-=65536,h+=String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):h+=String.fromCharCode(y)}return h},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(c,d){const f=c.length;if(!f)return 0;let h=0,v=0;if(this._interim){const y=c.charCodeAt(v++);56320<=y&&y<=57343?d[h++]=1024*(this._interim-55296)+y-56320+65536:(d[h++]=this._interim,d[h++]=y),this._interim=0}for(let y=v;y<f;++y){const C=c.charCodeAt(y);if(55296<=C&&C<=56319){if(++y>=f)return this._interim=C,h;const m=c.charCodeAt(y);56320<=m&&m<=57343?d[h++]=1024*(C-55296)+m-56320+65536:(d[h++]=C,d[h++]=m)}else C!==65279&&(d[h++]=C)}return h}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(c,d){const f=c.length;if(!f)return 0;let h,v,y,C,m=0,n=0,l=0;if(this.interim[0]){let g=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let w,k=0;for(;(w=63&this.interim[++k])&&k<4;)b<<=6,b|=w;const S=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,R=S-k;for(;l<R;){if(l>=f)return 0;if(w=c[l++],(192&w)!=128){l--,g=!0;break}this.interim[k++]=w,b<<=6,b|=63&w}g||(S===2?b<128?l--:d[m++]=b:S===3?b<2048||b>=55296&&b<=57343||b===65279||(d[m++]=b):b<65536||b>1114111||(d[m++]=b)),this.interim.fill(0)}const o=f-4;let a=l;for(;a<f;){for(;!(!(a<o)||128&(h=c[a])||128&(v=c[a+1])||128&(y=c[a+2])||128&(C=c[a+3]));)d[m++]=h,d[m++]=v,d[m++]=y,d[m++]=C,a+=4;if(h=c[a++],h<128)d[m++]=h;else if((224&h)==192){if(a>=f)return this.interim[0]=h,m;if(v=c[a++],(192&v)!=128){a--;continue}if(n=(31&h)<<6|63&v,n<128){a--;continue}d[m++]=n}else if((240&h)==224){if(a>=f)return this.interim[0]=h,m;if(v=c[a++],(192&v)!=128){a--;continue}if(a>=f)return this.interim[0]=h,this.interim[1]=v,m;if(y=c[a++],(192&y)!=128){a--;continue}if(n=(15&h)<<12|(63&v)<<6|63&y,n<2048||n>=55296&&n<=57343||n===65279)continue;d[m++]=n}else if((248&h)==240){if(a>=f)return this.interim[0]=h,m;if(v=c[a++],(192&v)!=128){a--;continue}if(a>=f)return this.interim[0]=h,this.interim[1]=v,m;if(y=c[a++],(192&y)!=128){a--;continue}if(a>=f)return this.interim[0]=h,this.interim[1]=v,this.interim[2]=y,m;if(C=c[a++],(192&C)!=128){a--;continue}if(n=(7&h)<<18|(63&v)<<12|(63&y)<<6|63&C,n<65536||n>1114111)continue;d[m++]=n}}return m}}},225:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const d=c(1480),f=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;s.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let y=0;y<f.length;++y)v.fill(0,f[y][0],f[y][1]+1)}}wcwidth(y){return y<32?0:y<127?1:y<65536?v[y]:function(C,m){let n,l=0,o=m.length-1;if(C<m[0][0]||C>m[o][1])return!1;for(;o>=l;)if(n=l+o>>1,C>m[n][1])l=n+1;else{if(!(C<m[n][0]))return!0;o=n-1}return!1}(y,h)?0:y>=131072&&y<=196605||y>=196608&&y<=262141?2:1}charProperties(y,C){let m=this.wcwidth(y),n=m===0&&C!==0;if(n){const l=d.UnicodeService.extractWidth(C);l===0?n=!1:l>m&&(m=l)}return d.UnicodeService.createPropertyValue(0,m,n)}}},5981:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const d=c(8460),f=c(844);class h extends f.Disposable{constructor(y){super(),this._action=y,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new d.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(y,C){if(C!==void 0&&this._syncCalls>C)return void(this._syncCalls=0);if(this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let m;for(this._isSyncWriting=!0;m=this._writeBuffer.shift();){this._action(m);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(y,C){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(C),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(C)}_innerWrite(y=0,C=!0){const m=y||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],l=this._action(n,C);if(l){const a=g=>Date.now()-m>=12?setTimeout(()=>this._innerWrite(0,g)):this._innerWrite(m,g);return void l.catch(g=>(queueMicrotask(()=>{throw g}),Promise.resolve(!1))).then(a)}const o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=h},5941:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const c=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,d=/^[\da-f]+$/;function f(h,v){const y=h.toString(16),C=y.length<2?"0"+y:y;switch(v){case 4:return y[0];case 8:return C;case 12:return(C+C).slice(0,3);default:return C+C}}s.parseColor=function(h){if(!h)return;let v=h.toLowerCase();if(v.indexOf("rgb:")===0){v=v.slice(4);const y=c.exec(v);if(y){const C=y[1]?15:y[4]?255:y[7]?4095:65535;return[Math.round(parseInt(y[1]||y[4]||y[7]||y[10],16)/C*255),Math.round(parseInt(y[2]||y[5]||y[8]||y[11],16)/C*255),Math.round(parseInt(y[3]||y[6]||y[9]||y[12],16)/C*255)]}}else if(v.indexOf("#")===0&&(v=v.slice(1),d.exec(v)&&[3,6,9,12].includes(v.length))){const y=v.length/3,C=[0,0,0];for(let m=0;m<3;++m){const n=parseInt(v.slice(y*m,y*m+y),16);C[m]=y===1?n<<4:y===2?n:y===3?n>>4:n>>8}return C}},s.toRgbString=function(h,v=16){const[y,C,m]=h;return`rgb:${f(y,v)}/${f(C,v)}/${f(m,v)}`}},5770:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const d=c(482),f=c(8742),h=c(5770),v=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=v,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=v}registerHandler(C,m){this._handlers[C]===void 0&&(this._handlers[C]=[]);const n=this._handlers[C];return n.push(m),{dispose:()=>{const l=n.indexOf(m);l!==-1&&n.splice(l,1)}}}clearHandler(C){this._handlers[C]&&delete this._handlers[C]}setHandlerFallback(C){this._handlerFb=C}reset(){if(this._active.length)for(let C=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;C>=0;--C)this._active[C].unhook(!1);this._stack.paused=!1,this._active=v,this._ident=0}hook(C,m){if(this.reset(),this._ident=C,this._active=this._handlers[C]||v,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(m);else this._handlerFb(this._ident,"HOOK",m)}put(C,m,n){if(this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].put(C,m,n);else this._handlerFb(this._ident,"PUT",(0,d.utf32ToString)(C,m,n))}unhook(C,m=!0){if(this._active.length){let n=!1,l=this._active.length-1,o=!1;if(this._stack.paused&&(l=this._stack.loopPosition-1,n=m,o=this._stack.fallThrough,this._stack.paused=!1),!o&&n===!1){for(;l>=0&&(n=this._active[l].unhook(C),n!==!0);l--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!1,n;l--}for(;l>=0;l--)if(n=this._active[l].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",C);this._active=v,this._ident=0}};const y=new f.Params;y.addParam(0),s.DcsHandler=class{constructor(C){this._handler=C,this._data="",this._params=y,this._hitLimit=!1}hook(C){this._params=C.length>1||C.params[0]?C.clone():y,this._data="",this._hitLimit=!1}put(C,m,n){this._hitLimit||(this._data+=(0,d.utf32ToString)(C,m,n),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(C){let m=!1;if(this._hitLimit)m=!1;else if(C&&(m=this._handler(this._data,this._params),m instanceof Promise))return m.then(n=>(this._params=y,this._data="",this._hitLimit=!1,n));return this._params=y,this._data="",this._hitLimit=!1,m}}},2015:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const d=c(844),f=c(8742),h=c(6242),v=c(6351);class y{constructor(l){this.table=new Uint8Array(l)}setDefault(l,o){this.table.fill(l<<4|o)}add(l,o,a,g){this.table[o<<8|l]=a<<4|g}addMany(l,o,a,g){for(let b=0;b<l.length;b++)this.table[o<<8|l[b]]=a<<4|g}}s.TransitionTable=y;const C=160;s.VT500_TRANSITION_TABLE=function(){const n=new y(4095),l=Array.apply(null,Array(256)).map((k,S)=>S),o=(k,S)=>l.slice(k,S),a=o(32,127),g=o(0,24);g.push(25),g.push.apply(g,o(28,32));const b=o(0,14);let w;for(w in n.setDefault(1,0),n.addMany(a,0,2,0),b)n.addMany([24,26,153,154],w,3,0),n.addMany(o(128,144),w,3,0),n.addMany(o(144,152),w,3,0),n.add(156,w,0,0),n.add(27,w,11,1),n.add(157,w,4,8),n.addMany([152,158,159],w,0,7),n.add(155,w,11,3),n.add(144,w,11,9);return n.addMany(g,0,3,0),n.addMany(g,1,3,1),n.add(127,1,0,1),n.addMany(g,8,0,8),n.addMany(g,3,3,3),n.add(127,3,0,3),n.addMany(g,4,3,4),n.add(127,4,0,4),n.addMany(g,6,3,6),n.addMany(g,5,3,5),n.add(127,5,0,5),n.addMany(g,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(a,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(o(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(a,7,0,7),n.addMany(g,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(o(64,127),3,7,0),n.addMany(o(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(o(48,60),4,8,4),n.addMany(o(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(o(32,64),6,0,6),n.add(127,6,0,6),n.addMany(o(64,127),6,0,0),n.addMany(o(32,48),3,9,5),n.addMany(o(32,48),5,9,5),n.addMany(o(48,64),5,0,6),n.addMany(o(64,127),5,7,0),n.addMany(o(32,48),4,9,5),n.addMany(o(32,48),1,9,2),n.addMany(o(32,48),2,9,2),n.addMany(o(48,127),2,10,0),n.addMany(o(48,80),1,10,0),n.addMany(o(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(o(96,127),1,10,0),n.add(80,1,11,9),n.addMany(g,9,0,9),n.add(127,9,0,9),n.addMany(o(28,32),9,0,9),n.addMany(o(32,48),9,9,12),n.addMany(o(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(g,11,0,11),n.addMany(o(32,128),11,0,11),n.addMany(o(28,32),11,0,11),n.addMany(g,10,0,10),n.add(127,10,0,10),n.addMany(o(28,32),10,0,10),n.addMany(o(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(o(32,48),10,9,12),n.addMany(g,12,0,12),n.add(127,12,0,12),n.addMany(o(28,32),12,0,12),n.addMany(o(32,48),12,9,12),n.addMany(o(48,64),12,0,11),n.addMany(o(64,127),12,12,13),n.addMany(o(64,127),10,12,13),n.addMany(o(64,127),9,12,13),n.addMany(g,13,13,13),n.addMany(a,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(C,0,2,0),n.add(C,8,5,8),n.add(C,6,0,6),n.add(C,11,0,11),n.add(C,13,13,13),n}();class m extends d.Disposable{constructor(l=s.VT500_TRANSITION_TABLE){super(),this._transitions=l,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(o,a,g)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,a)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,d.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new h.OscParser),this._dcsParser=this.register(new v.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(l,o=[64,126]){let a=0;if(l.prefix){if(l.prefix.length>1)throw new Error("only one byte as prefix supported");if(a=l.prefix.charCodeAt(0),a&&60>a||a>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(l.intermediates){if(l.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<l.intermediates.length;++b){const w=l.intermediates.charCodeAt(b);if(32>w||w>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");a<<=8,a|=w}}if(l.final.length!==1)throw new Error("final must be a single byte");const g=l.final.charCodeAt(0);if(o[0]>g||g>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return a<<=8,a|=g,a}identToString(l){const o=[];for(;l;)o.push(String.fromCharCode(255&l)),l>>=8;return o.reverse().join("")}setPrintHandler(l){this._printHandler=l}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(l,o){const a=this._identifier(l,[48,126]);this._escHandlers[a]===void 0&&(this._escHandlers[a]=[]);const g=this._escHandlers[a];return g.push(o),{dispose:()=>{const b=g.indexOf(o);b!==-1&&g.splice(b,1)}}}clearEscHandler(l){this._escHandlers[this._identifier(l,[48,126])]&&delete this._escHandlers[this._identifier(l,[48,126])]}setEscHandlerFallback(l){this._escHandlerFb=l}setExecuteHandler(l,o){this._executeHandlers[l.charCodeAt(0)]=o}clearExecuteHandler(l){this._executeHandlers[l.charCodeAt(0)]&&delete this._executeHandlers[l.charCodeAt(0)]}setExecuteHandlerFallback(l){this._executeHandlerFb=l}registerCsiHandler(l,o){const a=this._identifier(l);this._csiHandlers[a]===void 0&&(this._csiHandlers[a]=[]);const g=this._csiHandlers[a];return g.push(o),{dispose:()=>{const b=g.indexOf(o);b!==-1&&g.splice(b,1)}}}clearCsiHandler(l){this._csiHandlers[this._identifier(l)]&&delete this._csiHandlers[this._identifier(l)]}setCsiHandlerFallback(l){this._csiHandlerFb=l}registerDcsHandler(l,o){return this._dcsParser.registerHandler(this._identifier(l),o)}clearDcsHandler(l){this._dcsParser.clearHandler(this._identifier(l))}setDcsHandlerFallback(l){this._dcsParser.setHandlerFallback(l)}registerOscHandler(l,o){return this._oscParser.registerHandler(l,o)}clearOscHandler(l){this._oscParser.clearHandler(l)}setOscHandlerFallback(l){this._oscParser.setHandlerFallback(l)}setErrorHandler(l){this._errorHandler=l}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(l,o,a,g,b){this._parseStack.state=l,this._parseStack.handlers=o,this._parseStack.handlerPos=a,this._parseStack.transition=g,this._parseStack.chunkPos=b}parse(l,o,a){let g,b=0,w=0,k=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,k=this._parseStack.chunkPos+1;else{if(a===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const S=this._parseStack.handlers;let R=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(a===!1&&R>-1){for(;R>=0&&(g=S[R](this._params),g!==!0);R--)if(g instanceof Promise)return this._parseStack.handlerPos=R,g}this._parseStack.handlers=[];break;case 4:if(a===!1&&R>-1){for(;R>=0&&(g=S[R](),g!==!0);R--)if(g instanceof Promise)return this._parseStack.handlerPos=R,g}this._parseStack.handlers=[];break;case 6:if(b=l[this._parseStack.chunkPos],g=this._dcsParser.unhook(b!==24&&b!==26,a),g)return g;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=l[this._parseStack.chunkPos],g=this._oscParser.end(b!==24&&b!==26,a),g)return g;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,k=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let S=k;S<o;++S){switch(b=l[S],w=this._transitions.table[this.currentState<<8|(b<160?b:C)],w>>4){case 2:for(let A=S+1;;++A){if(A>=o||(b=l[A])<32||b>126&&b<C){this._printHandler(l,S,A),S=A-1;break}if(++A>=o||(b=l[A])<32||b>126&&b<C){this._printHandler(l,S,A),S=A-1;break}if(++A>=o||(b=l[A])<32||b>126&&b<C){this._printHandler(l,S,A),S=A-1;break}if(++A>=o||(b=l[A])<32||b>126&&b<C){this._printHandler(l,S,A),S=A-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:S,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const R=this._csiHandlers[this._collect<<8|b];let P=R?R.length-1:-1;for(;P>=0&&(g=R[P](this._params),g!==!0);P--)if(g instanceof Promise)return this._preserveStack(3,R,P,w,S),g;P<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingJoinState=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++S<o&&(b=l[S])>47&&b<60);S--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const B=this._escHandlers[this._collect<<8|b];let I=B?B.length-1:-1;for(;I>=0&&(g=B[I](),g!==!0);I--)if(g instanceof Promise)return this._preserveStack(4,B,I,w,S),g;I<0&&this._escHandlerFb(this._collect<<8|b),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let A=S+1;;++A)if(A>=o||(b=l[A])===24||b===26||b===27||b>127&&b<C){this._dcsParser.put(l,S,A),S=A-1;break}break;case 14:if(g=this._dcsParser.unhook(b!==24&&b!==26),g)return this._preserveStack(6,[],0,w,S),g;b===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let A=S+1;;A++)if(A>=o||(b=l[A])<32||b>127&&b<C){this._oscParser.put(l,S,A),S=A-1;break}break;case 6:if(g=this._oscParser.end(b!==24&&b!==26),g)return this._preserveStack(5,[],0,w,S),g;b===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&w}}}s.EscapeSequenceParser=m},6242:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const d=c(5770),f=c(482),h=[];s.OscParser=class{constructor(){this._state=0,this._active=h,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(v,y){this._handlers[v]===void 0&&(this._handlers[v]=[]);const C=this._handlers[v];return C.push(y),{dispose:()=>{const m=C.indexOf(y);m!==-1&&C.splice(m,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}reset(){if(this._state===2)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].end(!1);this._stack.paused=!1,this._active=h,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||h,this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].start();else this._handlerFb(this._id,"START")}_put(v,y,C){if(this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].put(v,y,C);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(v,y,C))}start(){this.reset(),this._state=1}put(v,y,C){if(this._state!==3){if(this._state===1)for(;y<C;){const m=v[y++];if(m===59){this._state=2,this._start();break}if(m<48||57<m)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+m-48}this._state===2&&C-y>0&&this._put(v,y,C)}}end(v,y=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let C=!1,m=this._active.length-1,n=!1;if(this._stack.paused&&(m=this._stack.loopPosition-1,C=y,n=this._stack.fallThrough,this._stack.paused=!1),!n&&C===!1){for(;m>=0&&(C=this._active[m].end(v),C!==!0);m--)if(C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!1,C;m--}for(;m>=0;m--)if(C=this._active[m].end(!1),C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!0,C}else this._handlerFb(this._id,"END",v);this._active=h,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(v){this._handler=v,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(v,y,C){this._hitLimit||(this._data+=(0,f.utf32ToString)(v,y,C),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(v){let y=!1;if(this._hitLimit)y=!1;else if(v&&(y=this._handler(this._data),y instanceof Promise))return y.then(C=>(this._data="",this._hitLimit=!1,C));return this._data="",this._hitLimit=!1,y}}},8742:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const c=2147483647;class d{static fromArray(h){const v=new d;if(!h.length)return v;for(let y=Array.isArray(h[0])?1:0;y<h.length;++y){const C=h[y];if(Array.isArray(C))for(let m=0;m<C.length;++m)v.addSubParam(C[m]);else v.addParam(C)}return v}constructor(h=32,v=32){if(this.maxLength=h,this.maxSubParamsLength=v,v>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(h),this.length=0,this._subParams=new Int32Array(v),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(h),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const h=new d(this.maxLength,this.maxSubParamsLength);return h.params.set(this.params),h.length=this.length,h._subParams.set(this._subParams),h._subParamsLength=this._subParamsLength,h._subParamsIdx.set(this._subParamsIdx),h._rejectDigits=this._rejectDigits,h._rejectSubDigits=this._rejectSubDigits,h._digitIsSub=this._digitIsSub,h}toArray(){const h=[];for(let v=0;v<this.length;++v){h.push(this.params[v]);const y=this._subParamsIdx[v]>>8,C=255&this._subParamsIdx[v];C-y>0&&h.push(Array.prototype.slice.call(this._subParams,y,C))}return h}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(h){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=h>c?c:h}}addSubParam(h){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=h>c?c:h,this._subParamsIdx[this.length-1]++}}hasSubParams(h){return(255&this._subParamsIdx[h])-(this._subParamsIdx[h]>>8)>0}getSubParams(h){const v=this._subParamsIdx[h]>>8,y=255&this._subParamsIdx[h];return y-v>0?this._subParams.subarray(v,y):null}getSubParamsAll(){const h={};for(let v=0;v<this.length;++v){const y=this._subParamsIdx[v]>>8,C=255&this._subParamsIdx[v];C-y>0&&(h[v]=this._subParams.slice(y,C))}return h}addDigit(h){let v;if(this._rejectDigits||!(v=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const y=this._digitIsSub?this._subParams:this.params,C=y[v-1];y[v-1]=~C?Math.min(10*C+h,c):h}}s.Params=d},5741:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let c=this._addons.length-1;c>=0;c--)this._addons[c].instance.dispose()}loadAddon(c,d){const f={instance:d,dispose:d.dispose,isDisposed:!1};this._addons.push(f),d.dispose=()=>this._wrappedAddonDispose(f),d.activate(c)}_wrappedAddonDispose(c){if(c.isDisposed)return;let d=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===c){d=f;break}if(d===-1)throw new Error("Could not dispose an addon that has not been loaded");c.isDisposed=!0,c.dispose.apply(c.instance),this._addons.splice(d,1)}}},8771:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const d=c(3785),f=c(511);s.BufferApiView=class{constructor(h,v){this._buffer=h,this.type=v}init(h){return this._buffer=h,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(h){const v=this._buffer.lines.get(h);if(v)return new d.BufferLineApiView(v)}getNullCell(){return new f.CellData}}},3785:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const d=c(511);s.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,h){if(!(f<0||f>=this._line.length))return h?(this._line.loadCell(f,h),h):this._line.loadCell(f,new d.CellData)}translateToString(f,h,v){return this._line.translateToString(f,h,v)}}},8285:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const d=c(8771),f=c(8460),h=c(844);class v extends h.Disposable{constructor(C){super(),this._core=C,this._onBufferChange=this.register(new f.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new d.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new d.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}s.BufferNamespaceApi=v},7975:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(c){this._core=c}registerCsiHandler(c,d){return this._core.registerCsiHandler(c,f=>d(f.toArray()))}addCsiHandler(c,d){return this.registerCsiHandler(c,d)}registerDcsHandler(c,d){return this._core.registerDcsHandler(c,(f,h)=>d(f,h.toArray()))}addDcsHandler(c,d){return this.registerDcsHandler(c,d)}registerEscHandler(c,d){return this._core.registerEscHandler(c,d)}addEscHandler(c,d){return this.registerEscHandler(c,d)}registerOscHandler(c,d){return this._core.registerOscHandler(c,d)}addOscHandler(c,d){return this.registerOscHandler(c,d)}}},7090:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(c){this._core=c}register(c){this._core.unicodeService.register(c)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(c){this._core.unicodeService.activeVersion=c}}},744:function(_,s,c){var d=this&&this.__decorate||function(n,l,o,a){var g,b=arguments.length,w=b<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(n,l,o,a);else for(var k=n.length-1;k>=0;k--)(g=n[k])&&(w=(b<3?g(w):b>3?g(l,o,w):g(l,o))||w);return b>3&&w&&Object.defineProperty(l,o,w),w},f=this&&this.__param||function(n,l){return function(o,a){l(o,a,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const h=c(8460),v=c(844),y=c(5295),C=c(2585);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let m=s.BufferService=class extends v.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new y.BufferSet(n,this))}resize(n,l){this.cols=n,this.rows=l,this.buffers.resize(n,l),this._onResize.fire({cols:n,rows:l})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,l=!1){const o=this.buffer;let a;a=this._cachedBlankLine,a&&a.length===this.cols&&a.getFg(0)===n.fg&&a.getBg(0)===n.bg||(a=o.getBlankLine(n,l),this._cachedBlankLine=a),a.isWrapped=l;const g=o.ybase+o.scrollTop,b=o.ybase+o.scrollBottom;if(o.scrollTop===0){const w=o.lines.isFull;b===o.lines.length-1?w?o.lines.recycle().copyFrom(a):o.lines.push(a.clone()):o.lines.splice(b+1,0,a.clone()),w?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{const w=b-g+1;o.lines.shiftElements(g+1,w-1,-1),o.lines.set(b,a.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(n,l,o){const a=this.buffer;if(n<0){if(a.ydisp===0)return;this.isUserScrolling=!0}else n+a.ydisp>=a.ybase&&(this.isUserScrolling=!1);const g=a.ydisp;a.ydisp=Math.max(Math.min(a.ydisp+n,a.ybase),0),g!==a.ydisp&&(l||this._onScroll.fire(a.ydisp))}};s.BufferService=m=d([f(0,C.IOptionsService)],m)},7994:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(c){this.glevel=c,this.charset=this._charsets[c]}setgCharset(c,d){this._charsets[c]=d,this.glevel===c&&(this.charset=d)}}},1753:function(_,s,c){var d=this&&this.__decorate||function(a,g,b,w){var k,S=arguments.length,R=S<3?g:w===null?w=Object.getOwnPropertyDescriptor(g,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(a,g,b,w);else for(var P=a.length-1;P>=0;P--)(k=a[P])&&(R=(S<3?k(R):S>3?k(g,b,R):k(g,b))||R);return S>3&&R&&Object.defineProperty(g,b,R),R},f=this&&this.__param||function(a,g){return function(b,w){g(b,w,a)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const h=c(2585),v=c(8460),y=c(844),C={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:a=>a.button!==4&&a.action===1&&(a.ctrl=!1,a.alt=!1,a.shift=!1,!0)},VT200:{events:19,restrict:a=>a.action!==32},DRAG:{events:23,restrict:a=>a.action!==32||a.button!==3},ANY:{events:31,restrict:a=>!0}};function m(a,g){let b=(a.ctrl?16:0)|(a.shift?4:0)|(a.alt?8:0);return a.button===4?(b|=64,b|=a.action):(b|=3&a.button,4&a.button&&(b|=64),8&a.button&&(b|=128),a.action===32?b|=32:a.action!==0||g||(b|=3)),b}const n=String.fromCharCode,l={DEFAULT:a=>{const g=[m(a,!1)+32,a.col+32,a.row+32];return g[0]>255||g[1]>255||g[2]>255?"":`\x1B[M${n(g[0])}${n(g[1])}${n(g[2])}`},SGR:a=>{const g=a.action===0&&a.button!==4?"m":"M";return`\x1B[<${m(a,!0)};${a.col};${a.row}${g}`},SGR_PIXELS:a=>{const g=a.action===0&&a.button!==4?"m":"M";return`\x1B[<${m(a,!0)};${a.x};${a.y}${g}`}};let o=s.CoreMouseService=class extends y.Disposable{constructor(a,g){super(),this._bufferService=a,this._coreService=g,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new v.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(C))this.addProtocol(b,C[b]);for(const b of Object.keys(l))this.addEncoding(b,l[b]);this.reset()}addProtocol(a,g){this._protocols[a]=g}addEncoding(a,g){this._encodings[a]=g}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(a){if(!this._protocols[a])throw new Error(`unknown protocol "${a}"`);this._activeProtocol=a,this._onProtocolChange.fire(this._protocols[a].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(a){if(!this._encodings[a])throw new Error(`unknown encoding "${a}"`);this._activeEncoding=a}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(a){if(a.col<0||a.col>=this._bufferService.cols||a.row<0||a.row>=this._bufferService.rows||a.button===4&&a.action===32||a.button===3&&a.action!==32||a.button!==4&&(a.action===2||a.action===3)||(a.col++,a.row++,a.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,a,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(a))return!1;const g=this._encodings[this._activeEncoding](a);return g&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(g):this._coreService.triggerDataEvent(g,!0)),this._lastEvent=a,!0}explainEvents(a){return{down:!!(1&a),up:!!(2&a),drag:!!(4&a),move:!!(8&a),wheel:!!(16&a)}}_equalEvents(a,g,b){if(b){if(a.x!==g.x||a.y!==g.y)return!1}else if(a.col!==g.col||a.row!==g.row)return!1;return a.button===g.button&&a.action===g.action&&a.ctrl===g.ctrl&&a.alt===g.alt&&a.shift===g.shift}};s.CoreMouseService=o=d([f(0,h.IBufferService),f(1,h.ICoreService)],o)},6975:function(_,s,c){var d=this&&this.__decorate||function(o,a,g,b){var w,k=arguments.length,S=k<3?a:b===null?b=Object.getOwnPropertyDescriptor(a,g):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(o,a,g,b);else for(var R=o.length-1;R>=0;R--)(w=o[R])&&(S=(k<3?w(S):k>3?w(a,g,S):w(a,g))||S);return k>3&&S&&Object.defineProperty(a,g,S),S},f=this&&this.__param||function(o,a){return function(g,b){a(g,b,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const h=c(1439),v=c(8460),y=c(844),C=c(2585),m=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let l=s.CoreService=class extends y.Disposable{constructor(o,a,g){super(),this._bufferService=o,this._logService=a,this._optionsService=g,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new v.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new v.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new v.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new v.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,h.clone)(m),this.decPrivateModes=(0,h.clone)(n)}reset(){this.modes=(0,h.clone)(m),this.decPrivateModes=(0,h.clone)(n)}triggerDataEvent(o,a=!1){if(this._optionsService.rawOptions.disableStdin)return;const g=this._bufferService.buffer;a&&this._optionsService.rawOptions.scrollOnUserInput&&g.ybase!==g.ydisp&&this._onRequestScrollToBottom.fire(),a&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(b=>b.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(a=>a.charCodeAt(0))),this._onBinary.fire(o))}};s.CoreService=l=d([f(0,C.IBufferService),f(1,C.ILogService),f(2,C.IOptionsService)],l)},9074:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const d=c(8055),f=c(8460),h=c(844),v=c(6106);let y=0,C=0;class m extends h.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new v.SortedList(o=>o?.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,h.toDisposable)(()=>this.reset()))}registerDecoration(o){if(o.marker.isDisposed)return;const a=new n(o);if(a){const g=a.marker.onDispose(()=>a.dispose());a.onDispose(()=>{a&&(this._decorations.delete(a)&&this._onDecorationRemoved.fire(a),g.dispose())}),this._decorations.insert(a),this._onDecorationRegistered.fire(a)}return a}reset(){for(const o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,a,g){let b=0,w=0;for(const k of this._decorations.getKeyIterator(a))b=k.options.x??0,w=b+(k.options.width??1),o>=b&&o<w&&(!g||(k.options.layer??"bottom")===g)&&(yield k)}forEachDecorationAtCell(o,a,g,b){this._decorations.forEachByKey(a,w=>{y=w.options.x??0,C=y+(w.options.width??1),o>=y&&o<C&&(!g||(w.options.layer??"bottom")===g)&&b(w)})}}s.DecorationService=m;class n extends h.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=d.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=d.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(o){super(),this.options=o,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const d=c(2585),f=c(8343);class h{constructor(...y){this._entries=new Map;for(const[C,m]of y)this.set(C,m)}set(y,C){const m=this._entries.get(y);return this._entries.set(y,C),m}forEach(y){for(const[C,m]of this._entries.entries())y(C,m)}has(y){return this._entries.has(y)}get(y){return this._entries.get(y)}}s.ServiceCollection=h,s.InstantiationService=class{constructor(){this._services=new h,this._services.set(d.IInstantiationService,this)}setService(v,y){this._services.set(v,y)}getService(v){return this._services.get(v)}createInstance(v,...y){const C=(0,f.getServiceDependencies)(v).sort((l,o)=>l.index-o.index),m=[];for(const l of C){const o=this._services.get(l.id);if(!o)throw new Error(`[createInstance] ${v.name} depends on UNKNOWN service ${l.id}.`);m.push(o)}const n=C.length>0?C[0].index:y.length;if(y.length!==n)throw new Error(`[createInstance] First service dependency of ${v.name} at position ${n+1} conflicts with ${y.length} static arguments`);return new v(...y,...m)}}},7866:function(_,s,c){var d=this&&this.__decorate||function(n,l,o,a){var g,b=arguments.length,w=b<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(n,l,o,a);else for(var k=n.length-1;k>=0;k--)(g=n[k])&&(w=(b<3?g(w):b>3?g(l,o,w):g(l,o))||w);return b>3&&w&&Object.defineProperty(l,o,w),w},f=this&&this.__param||function(n,l){return function(o,a){l(o,a,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.traceCall=s.setTraceLogger=s.LogService=void 0;const h=c(844),v=c(2585),y={trace:v.LogLevelEnum.TRACE,debug:v.LogLevelEnum.DEBUG,info:v.LogLevelEnum.INFO,warn:v.LogLevelEnum.WARN,error:v.LogLevelEnum.ERROR,off:v.LogLevelEnum.OFF};let C,m=s.LogService=class extends h.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=v.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),C=this}_updateLogLevel(){this._logLevel=y[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let l=0;l<n.length;l++)typeof n[l]=="function"&&(n[l]=n[l]())}_log(n,l,o){this._evalLazyOptionalParams(o),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+l,...o)}trace(n,...l){this._logLevel<=v.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,n,l)}debug(n,...l){this._logLevel<=v.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,n,l)}info(n,...l){this._logLevel<=v.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,n,l)}warn(n,...l){this._logLevel<=v.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,n,l)}error(n,...l){this._logLevel<=v.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,n,l)}};s.LogService=m=d([f(0,v.IOptionsService)],m),s.setTraceLogger=function(n){C=n},s.traceCall=function(n,l,o){if(typeof o.value!="function")throw new Error("not supported");const a=o.value;o.value=function(...g){if(C.logLevel!==v.LogLevelEnum.TRACE)return a.apply(this,g);C.trace(`GlyphRenderer#${a.name}(${g.map(w=>JSON.stringify(w)).join(", ")})`);const b=a.apply(this,g);return C.trace(`GlyphRenderer#${a.name} return`,b),b}}},7302:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const d=c(8460),f=c(844),h=c(6114);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:h.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const v=["normal","bold","100","200","300","400","500","600","700","800","900"];class y extends f.Disposable{constructor(m){super(),this._onOptionChange=this.register(new d.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n={...s.DEFAULT_OPTIONS};for(const l in m)if(l in n)try{const o=m[l];n[l]=this._sanitizeAndValidateOption(l,o)}catch(o){console.error(o)}this.rawOptions=n,this.options={...n},this._setupOptions(),this.register((0,f.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(m,n){return this.onOptionChange(l=>{l===m&&n(this.rawOptions[m])})}onMultipleOptionChange(m,n){return this.onOptionChange(l=>{m.indexOf(l)!==-1&&n()})}_setupOptions(){const m=l=>{if(!(l in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${l}"`);return this.rawOptions[l]},n=(l,o)=>{if(!(l in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${l}"`);o=this._sanitizeAndValidateOption(l,o),this.rawOptions[l]!==o&&(this.rawOptions[l]=o,this._onOptionChange.fire(l))};for(const l in this.rawOptions){const o={get:m.bind(this,l),set:n.bind(this,l)};Object.defineProperty(this.options,l,o)}}_sanitizeAndValidateOption(m,n){switch(m){case"cursorStyle":if(n||(n=s.DEFAULT_OPTIONS[m]),!function(l){return l==="block"||l==="underline"||l==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${m}`);break;case"wordSeparator":n||(n=s.DEFAULT_OPTIONS[m]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=v.includes(n)?n:s.DEFAULT_OPTIONS[m];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${m} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${m} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${m} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${m} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}s.OptionsService=y},2660:function(_,s,c){var d=this&&this.__decorate||function(y,C,m,n){var l,o=arguments.length,a=o<3?C:n===null?n=Object.getOwnPropertyDescriptor(C,m):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(y,C,m,n);else for(var g=y.length-1;g>=0;g--)(l=y[g])&&(a=(o<3?l(a):o>3?l(C,m,a):l(C,m))||a);return o>3&&a&&Object.defineProperty(C,m,a),a},f=this&&this.__param||function(y,C){return function(m,n){C(m,n,y)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const h=c(2585);let v=s.OscLinkService=class{constructor(y){this._bufferService=y,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(y){const C=this._bufferService.buffer;if(y.id===void 0){const g=C.addMarker(C.ybase+C.y),b={data:y,id:this._nextId++,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(b,g)),this._dataByLinkId.set(b.id,b),b.id}const m=y,n=this._getEntryIdKey(m),l=this._entriesWithId.get(n);if(l)return this.addLineToLink(l.id,C.ybase+C.y),l.id;const o=C.addMarker(C.ybase+C.y),a={id:this._nextId++,key:this._getEntryIdKey(m),data:m,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(a,o)),this._entriesWithId.set(a.key,a),this._dataByLinkId.set(a.id,a),a.id}addLineToLink(y,C){const m=this._dataByLinkId.get(y);if(m&&m.lines.every(n=>n.line!==C)){const n=this._bufferService.buffer.addMarker(C);m.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(m,n))}}getLinkData(y){return this._dataByLinkId.get(y)?.data}_getEntryIdKey(y){return`${y.id};;${y.uri}`}_removeMarkerFromLink(y,C){const m=y.lines.indexOf(C);m!==-1&&(y.lines.splice(m,1),y.lines.length===0&&(y.data.id!==void 0&&this._entriesWithId.delete(y.key),this._dataByLinkId.delete(y.id)))}};s.OscLinkService=v=d([f(0,h.IBufferService)],v)},8343:(_,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0;const c="di$target",d="di$dependencies";s.serviceRegistry=new Map,s.getServiceDependencies=function(f){return f[d]||[]},s.createDecorator=function(f){if(s.serviceRegistry.has(f))return s.serviceRegistry.get(f);const h=function(v,y,C){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(m,n,l){n[c]===n?n[d].push({id:m,index:l}):(n[d]=[{id:m,index:l}],n[c]=n)})(h,v,C)};return h.toString=()=>f,s.serviceRegistry.set(f,h),h}},2585:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const d=c(8343);var f;s.IBufferService=(0,d.createDecorator)("BufferService"),s.ICoreMouseService=(0,d.createDecorator)("CoreMouseService"),s.ICoreService=(0,d.createDecorator)("CoreService"),s.ICharsetService=(0,d.createDecorator)("CharsetService"),s.IInstantiationService=(0,d.createDecorator)("InstantiationService"),function(h){h[h.TRACE=0]="TRACE",h[h.DEBUG=1]="DEBUG",h[h.INFO=2]="INFO",h[h.WARN=3]="WARN",h[h.ERROR=4]="ERROR",h[h.OFF=5]="OFF"}(f||(s.LogLevelEnum=f={})),s.ILogService=(0,d.createDecorator)("LogService"),s.IOptionsService=(0,d.createDecorator)("OptionsService"),s.IOscLinkService=(0,d.createDecorator)("OscLinkService"),s.IUnicodeService=(0,d.createDecorator)("UnicodeService"),s.IDecorationService=(0,d.createDecorator)("DecorationService")},1480:(_,s,c)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const d=c(8460),f=c(225);class h{static extractShouldJoin(y){return(1&y)!=0}static extractWidth(y){return y>>1&3}static extractCharKind(y){return y>>3}static createPropertyValue(y,C,m=!1){return(16777215&y)<<3|(3&C)<<1|(m?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new d.EventEmitter,this.onChange=this._onChange.event;const y=new f.UnicodeV6;this.register(y),this._active=y.version,this._activeProvider=y}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(y){if(!this._providers[y])throw new Error(`unknown Unicode version "${y}"`);this._active=y,this._activeProvider=this._providers[y],this._onChange.fire(y)}register(y){this._providers[y.version]=y}wcwidth(y){return this._activeProvider.wcwidth(y)}getStringCellWidth(y){let C=0,m=0;const n=y.length;for(let l=0;l<n;++l){let o=y.charCodeAt(l);if(55296<=o&&o<=56319){if(++l>=n)return C+this.wcwidth(o);const b=y.charCodeAt(l);56320<=b&&b<=57343?o=1024*(o-55296)+b-56320+65536:C+=this.wcwidth(b)}const a=this.charProperties(o,m);let g=h.extractWidth(a);h.extractShouldJoin(a)&&(g-=h.extractWidth(m)),C+=g,m=a}return C}charProperties(y,C){return this._activeProvider.charProperties(y,C)}}s.UnicodeService=h}},i={};function u(_){var s=i[_];if(s!==void 0)return s.exports;var c=i[_]={exports:{}};return r[_].call(c.exports,c,c.exports,u),c.exports}var p={};return(()=>{var _=p;Object.defineProperty(_,"__esModule",{value:!0}),_.Terminal=void 0;const s=u(9042),c=u(3236),d=u(844),f=u(5741),h=u(8285),v=u(7975),y=u(7090),C=["cols","rows"];class m extends d.Disposable{constructor(l){super(),this._core=this.register(new c.Terminal(l)),this._addonManager=this.register(new f.AddonManager),this._publicOptions={...this._core.options};const o=g=>this._core.options[g],a=(g,b)=>{this._checkReadonlyOptions(g),this._core.options[g]=b};for(const g in this._core.options){const b={get:o.bind(this,g),set:a.bind(this,g)};Object.defineProperty(this._publicOptions,g,b)}}_checkReadonlyOptions(l){if(C.includes(l))throw new Error(`Option "${l}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new v.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new y.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new h.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const l=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:l.applicationCursorKeys,applicationKeypadMode:l.applicationKeypad,bracketedPasteMode:l.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:l.origin,reverseWraparoundMode:l.reverseWraparound,sendFocusMode:l.sendFocus,wraparoundMode:l.wraparound}}get options(){return this._publicOptions}set options(l){for(const o in l)this._publicOptions[o]=l[o]}blur(){this._core.blur()}focus(){this._core.focus()}input(l,o=!0){this._core.input(l,o)}resize(l,o){this._verifyIntegers(l,o),this._core.resize(l,o)}open(l){this._core.open(l)}attachCustomKeyEventHandler(l){this._core.attachCustomKeyEventHandler(l)}attachCustomWheelEventHandler(l){this._core.attachCustomWheelEventHandler(l)}registerLinkProvider(l){return this._core.registerLinkProvider(l)}registerCharacterJoiner(l){return this._checkProposedApi(),this._core.registerCharacterJoiner(l)}deregisterCharacterJoiner(l){this._checkProposedApi(),this._core.deregisterCharacterJoiner(l)}registerMarker(l=0){return this._verifyIntegers(l),this._core.registerMarker(l)}registerDecoration(l){return this._checkProposedApi(),this._verifyPositiveIntegers(l.x??0,l.width??0,l.height??0),this._core.registerDecoration(l)}hasSelection(){return this._core.hasSelection()}select(l,o,a){this._verifyIntegers(l,o,a),this._core.select(l,o,a)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(l,o){this._verifyIntegers(l,o),this._core.selectLines(l,o)}dispose(){super.dispose()}scrollLines(l){this._verifyIntegers(l),this._core.scrollLines(l)}scrollPages(l){this._verifyIntegers(l),this._core.scrollPages(l)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(l){this._verifyIntegers(l),this._core.scrollToLine(l)}clear(){this._core.clear()}write(l,o){this._core.write(l,o)}writeln(l,o){this._core.write(l),this._core.write(`\r
`,o)}paste(l){this._core.paste(l)}refresh(l,o){this._verifyIntegers(l,o),this._core.refresh(l,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(l){this._addonManager.loadAddon(this,l)}static get strings(){return s}_verifyIntegers(...l){for(const o of l)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...l){for(const o of l)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}_.Terminal=m})(),p})())})(Ns);var fo=Ns.exports,$s={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(self,()=>(()=>{var r={};return(()=>{var i=r;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{activate(u){this._terminal=u}dispose(){}fit(){const u=this.proposeDimensions();if(!u||!this._terminal||isNaN(u.cols)||isNaN(u.rows))return;const p=this._terminal._core;this._terminal.rows===u.rows&&this._terminal.cols===u.cols||(p._renderService.clear(),this._terminal.resize(u.cols,u.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const u=this._terminal._core,p=u._renderService.dimensions;if(p.css.cell.width===0||p.css.cell.height===0)return;const _=this._terminal.options.scrollback===0?0:u.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),c=parseInt(s.getPropertyValue("height")),d=Math.max(0,parseInt(s.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),h=c-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),v=d-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-_;return{cols:Math.max(2,Math.floor(v/p.css.cell.width)),rows:Math.max(1,Math.floor(h/p.css.cell.height))}}}})(),r})())})($s);var po=$s.exports;const _o={fontFamily:'"Fira Code", Menlo, "DejaVu Sans Mono", "Lucida Console", monospace',cursorBlink:!0,cursorStyle:"block",cursorInactiveStyle:"outline",rows:16,theme:{foreground:"white",background:"black",cursor:"white",cursorAccent:"yellow",selectionForeground:"gray",selectionBackground:"black",black:"#000000",red:"#ff0000",green:"#00ff00",yellow:"#ffff00",blue:"#4444ff",magenta:"#ff00ff",cyan:"#00ffff",white:"#ffffff",brightBlack:"#808080",brightRed:"#ff0000",brightGreen:"#00ff00",brightYellow:"#ffff00",brightBlue:"#66aaff",brightMagenta:"#ff00ff",brightCyan:"#00ffff",brightWhite:"#ffffff"}};class mo extends pe.Component{terminal;terminalRef;promptDelimiter="$";promptLength=0;isShowVideo=!1;fitAddon=new po.FitAddon;isDebug=!1;onDataDisposable=null;tempPassword="";constructor(t){super(t);const{terminalElementRef:r}=t;this.terminalRef=r,this.state={},this.terminal=new fo.Terminal(_o),this.onDataHandler=this.onDataHandler.bind(this)}initializeTerminal(){const{terminalElementRef:t}=this.props;t?.current&&(this.terminalRef=t,this.terminal.open(t.current),this.terminal.loadAddon(this.fitAddon),this.fitAddon.fit(),this.terminal.write("\x1B[4h"),this.focusTerminal())}focusTerminal(){this.terminal.focus(),this.terminal.scrollToBottom()}appendTempPassword(t){this.tempPassword+=t}resetTempPassword(){this.tempPassword=""}getTempPassword(){return this.tempPassword}terminalReset(){this.terminal.reset()}terminalWrite(t){this.terminal.write(t)}getTerminalText(){return this.getCurrentCommand()}handleResize=()=>{this.fitAddon?.fit()};componentDidMount(){const{terminalElementRef:t}=this.props;t?.current?this.initializeTerminal():console.error("terminalElementRef.current is NULL"),this.onDataDisposable=this.terminal.onData(this.onDataHandler),this.terminal.onCursorMove(()=>{}),this.setViewPortOpacity(),this.terminal.focus(),this.prompt(),window.addEventListener("resize",this.handleResize),this.scrollBottom(),this.focusTerminal()}scrollBottom=()=>{this.terminal.scrollToBottom()};componentDidUpdate(t){this.focusTerminal(),this.scrollBottom()}componentWillUnmount(){this.onDataDisposable&&this.onDataDisposable.dispose(),window.removeEventListener("resize",this.handleResize)}setCursorMode(t){t.options.cursorBlink=!0,t.options.cursorStyle="block",t.write("\x1B[4h")}handleBackSpaceAndNavigation(t){let r=!1;if(t.charCodeAt(0)===127){if(this.isCursorOnPrompt())return!0;this.tempPassword=this.tempPassword.slice(0,-1),this.terminal.write("\x1B[D\x1B[P"),r=!0}return r}isCursorOnPrompt(){const t=this.terminal.buffer.active.cursorY===0,r=this.terminal.buffer.active.cursorX<this.promptLength;return t&&r}isCursorOnFirstLine(){return this.terminal.buffer.active.cursorY===0}onDataHandler(t){const r=t.split("").map(i=>i.charCodeAt(0)).join(",");if(this.isDebug&&console.info("onDataHandler",t,r,this.terminal.buffer.active.cursorX,this.terminal.buffer.active.cursorY),this.setCursorMode(this.terminal),!this.handleBackSpaceAndNavigation(t)){if(t.charCodeAt(0)===27&&t.charCodeAt(1)===91){if(t.length>2&&t.charCodeAt(2)===72){this.terminal.write(`\x1B[${this.promptLength+1}G`);return}if(t.charCodeAt(2)===65&&this.isCursorOnFirstLine()){this.props.onAddCharacter("ArrowUp");return}if(t.charCodeAt(2)===68&&this.isCursorOnPrompt())return}this.props.onAddCharacter(t)}}setViewPortOpacity(){const t=document.getElementsByClassName("xterm-viewport")[0];t.style.opacity="0.0"}getCurrentCommand(){const t=this.terminal.buffer.active;let r="";for(let u=0;u<=t.cursorY;u++){const p=t.getLine(u);p&&(r+=p.translateToString(!0))}const i=r.indexOf(this.promptDelimiter)+1;return r.substring(i).trimStart()}prompt(t="guest",r="handex.io"){const i=`\x1B[1;34m${t}@${r} \x1B[0m\x1B[1;32m~${this.promptDelimiter}\x1B[0m `;this.promptLength=i.length-21,this.terminal.write(i)}promptLogin(){this.terminal.writeln("Welcome to Handex Term!"),this.terminal.writeln("Login:"),this.terminal.write("Username: ");let t=!1;this.terminal.onKey(({key:r,domEvent:i})=>{if(i.key,r==="Enter")t?this.terminal.writeln(""):(t=!0,this.terminal.writeln(""),this.terminal.write("Password: "));else if(r.charCodeAt(0)===127){if(this.isCursorOnPrompt())return!0;this.terminal.write("\x1B[D\x1B[P")}})}getTerminalSize(){if(this.terminalRef.current)return{width:this.terminalRef.current.clientWidth,height:this.terminalRef.current.clientHeight}}render(){return Y.jsx(Y.Fragment,{children:Y.jsx("div",{ref:this.terminalRef,id:Se.Terminal,className:Se.Terminal})})}}const go=ae.forwardRef((e,t)=>{const[r,i]=ae.useState(0),[u,p]=ae.useState(!1),[_,s]=ae.useState("start");ae.useEffect(()=>{let y=null;return u?(s("pause"),y=window.setInterval(()=>{i(C=>C+1)},10)):!u&&r!==0&&(s("start"),clearInterval(y)),()=>{y&&clearInterval(y)}},[u,r]);const c=()=>{p(!0)},d=()=>{p(!1)},f=()=>{p(!1);const y=r;return i(0),y},h=()=>{console.info("Timer Success"),i(0),p(!1)};ae.useImperativeHandle(t,()=>({start:c,stop:d,reset:f,success:h}));const v=()=>{switch(_){case"start":return Y.jsx("use",{href:"#start",transform:"scale(2,2)"});case"stop":return Y.jsx("use",{href:"#stop",transform:"scale(2,2)"});case"pause":return Y.jsx("use",{href:"#pause",transform:"scale(2,2)"});default:return Y.jsx("use",{href:"#stop",transform:"scale(2,2)"})}};return Y.jsxs(pe.Fragment,{children:[Y.jsx("span",{id:"timer",children:(r/100).toFixed(1)}),Y.jsx("svg",{width:"15",height:"20",style:{float:"left"},children:v()})]})}),zr=[{key:"a",chordCode:"4",index:0},{key:"A",chordCode:"54",index:0},{key:"b",chordCode:"17",index:1},{key:"B",chordCode:"517",index:1},{key:"c",chordCode:"37",index:2},{key:"C",chordCode:"537",index:2},{key:"d",chordCode:"2",index:3},{key:"D",chordCode:"52",index:3},{key:"e",chordCode:"32",index:4},{key:"E",chordCode:"532",index:4},{key:"f",chordCode:"1",index:5},{key:"F",chordCode:"51",index:5},{key:"g",chordCode:"21",index:6},{key:"G",chordCode:"521",index:6},{key:"h",chordCode:"76",index:7},{key:"H",chordCode:"576",index:7},{key:"i",chordCode:"72",index:8},{key:"I",chordCode:"572",index:8},{key:"j",chordCode:"6",index:9},{key:"J",chordCode:"56",index:9},{key:"k",chordCode:"7",index:10},{key:"K",chordCode:"57",index:10},{key:"l",chordCode:"8",index:11},{key:"L",chordCode:"58",index:11},{key:"m",chordCode:"27",index:12},{key:"M",chordCode:"527",index:12},{key:"n",chordCode:"16",index:13},{key:"N",chordCode:"516",index:13},{key:"o",chordCode:"83",index:14},{key:"O",chordCode:"583",index:14},{key:"p",chordCode:"94",index:15},{key:"P",chordCode:"594",index:15},{key:"q",chordCode:"43",index:16},{key:"Q",chordCode:"543",index:16},{key:"r",chordCode:"23",index:17},{key:"R",chordCode:"523",index:17},{key:"s",chordCode:"3",index:18},{key:"S",chordCode:"53",index:18},{key:"t",chordCode:"12",index:19},{key:"T",chordCode:"512",index:19},{key:"u",chordCode:"61",index:20},{key:"U",chordCode:"561",index:20},{key:"v",chordCode:"28",index:21},{key:"V",chordCode:"528",index:21},{key:"w",chordCode:"34",index:22},{key:"W",chordCode:"534",index:22},{key:"x",chordCode:"39",index:23},{key:"X",chordCode:"539",index:23},{key:"y",chordCode:"26",index:24},{key:"Y",chordCode:"526",index:24},{key:"z",chordCode:"48",index:25},{key:"Z",chordCode:"548",index:25},{key:"1",chordCode:"10",index:26},{key:"!",chordCode:"510",index:26},{key:"2",chordCode:"20",index:27},{key:"@",chordCode:"520",index:27},{key:"3",chordCode:"30",index:28},{key:"#",chordCode:"530",index:28},{key:"4",chordCode:"40",index:29},{key:"$",chordCode:"540",index:29},{key:"5",chordCode:"050",index:30},{key:"%",chordCode:"5050",index:30},{key:"6",chordCode:"60",index:31},{key:"^",chordCode:"560",index:31},{key:"7",chordCode:"70",index:32},{key:"&",chordCode:"570",index:32},{key:"8",chordCode:"80",index:33},{key:"*",chordCode:"580",index:33},{key:"9",chordCode:"90",index:34},{key:"(",chordCode:"590",index:34},{key:"0",chordCode:"C",index:35},{key:")",chordCode:"5C",index:35},{key:"Return (ENTER)",chordCode:"0",index:36},{key:"ESCAPE",chordCode:"491",index:37},{key:"DELETE (Backspace)",chordCode:"B",index:38},{key:"\\t",chordCode:"14",index:39},{key:"&#x2581;",chordCode:"5",index:40},{key:"-",chordCode:"B0",index:41},{key:"(underscore)",chordCode:"5B0",index:41},{key:"=",chordCode:"C0",index:42},{key:"+",chordCode:"5C0",index:42},{key:"[",chordCode:"45",index:43},{key:"{",chordCode:"545",index:43},{key:"]",chordCode:"495",index:44},{key:"}",chordCode:"5495",index:44},{key:"\\",chordCode:"15",index:45},{key:"|",chordCode:"515",index:45},{key:";",chordCode:"9",index:46},{key:":",chordCode:"59",index:46},{key:"'",chordCode:"89",index:47},{key:'"',chordCode:"589",index:47},{key:"`",chordCode:"101",index:48},{key:"~",chordCode:"5101",index:48},{key:",",chordCode:"38",index:49},{key:"<",chordCode:"538",index:49},{key:".",chordCode:"49",index:50},{key:">",chordCode:"549",index:50},{key:"/",chordCode:"96",index:51},{key:"?",chordCode:"596",index:51},{key:"Caps Lock",chordCode:"E",index:52},{key:"F1",chordCode:"131",index:53},{key:"F2",chordCode:"1D",index:54},{key:"F3",chordCode:"370",index:55},{key:"F4",chordCode:"B0B",index:56},{key:"F5",chordCode:"1C",index:57},{key:"F6",chordCode:"B06",index:58},{key:"F7",chordCode:"B12",index:59},{key:"F8",chordCode:"B7",index:60},{key:"F9",chordCode:"B2",index:61},{key:"F10",chordCode:"BC",index:62},{key:"F11",chordCode:"B8B",index:63},{key:"F12",chordCode:"B3B",index:64},{key:"PrintScreen",chordCode:"BD",index:65},{key:"Scroll Lock",chordCode:"7E7",index:66},{key:"Pause",chordCode:"206",index:67},{key:"Insert",chordCode:"200",index:68},{key:"Home",chordCode:"B1",index:69},{key:"PageUp",chordCode:"B8",index:70},{key:"Delete Forward",chordCode:"7B",index:71},{key:"End",chordCode:"C2",index:72},{key:"PageDown",chordCode:"8B",index:73},{key:"RightArrow",chordCode:"2C",index:74},{key:"LeftArrow",chordCode:"1B",index:75},{key:"DownArrow",chordCode:"71",index:76},{key:"UpArrow",chordCode:"73",index:77},{key:"Keypad Num Lock",chordCode:"202",index:78},{key:"Clear",chordCode:"5202",index:78},{key:"Keypad /",chordCode:"2A2",index:79},{key:"Keypad *",chordCode:"717",index:80},{key:"Keypad -",chordCode:"212",index:81},{key:"Keypad +",chordCode:"2B",index:82},{key:"Keypad ENTER",chordCode:"27E",index:83},{key:"Keypad 1",chordCode:"2C4",index:84},{key:"End",chordCode:"52C4",index:84},{key:"Keypad 2",chordCode:"282",index:85},{key:"Down Arrow",chordCode:"5282",index:85},{key:"Keypad 3",chordCode:"23278",index:86},{key:"PageDn",chordCode:"523278",index:86},{key:"Keypad 4",chordCode:"2D",index:87},{key:"Left Arrow",chordCode:"52D",index:87},{key:"Keypad 5",chordCode:"CE",index:88},{key:"Keypad 6",chordCode:"C0C",index:89},{key:"Right Arrow",chordCode:"5C0C",index:89},{key:"Keypad 7",chordCode:"CA",index:90},{key:"Home",chordCode:"5CA",index:90},{key:"Keypad 8",chordCode:"C6",index:91},{key:"Up Arrow",chordCode:"5C6",index:91},{key:"Keypad 9",chordCode:"C1",index:92},{key:"PageUp",chordCode:"5C1",index:92},{key:"Keypad 0",chordCode:"CB",index:93},{key:"Insert",chordCode:"5CB",index:93},{key:"Keypad .",chordCode:"C7E",index:94},{key:"Delete",chordCode:"5C7E",index:94},{key:"Non-US \\",chordCode:"C2E",index:95},{key:"|",chordCode:"5C2E",index:95},{key:"Application",chordCode:"C8",index:96},{key:"Power",chordCode:"321",index:97},{key:"Keypad =",chordCode:"CD",index:98},{key:"F13",chordCode:"8E",index:99},{key:"F14",chordCode:"850",index:100},{key:"F15",chordCode:"8A",index:101},{key:"F16",chordCode:"6C6",index:102},{key:"F17",chordCode:"801",index:103},{key:"F18",chordCode:"8B8",index:104},{key:"F19",chordCode:"878",index:105},{key:"F20",chordCode:"82",index:106},{key:"F21",chordCode:"8C",index:107},{key:"F22",chordCode:"8383",index:108},{key:"F23",chordCode:"8D",index:109},{key:"F24",chordCode:"3E",index:110},{key:"Execute",chordCode:"1A1",index:111},{key:"Help",chordCode:"7E",index:112},{key:"Menu",chordCode:"36",index:113},{key:"Select",chordCode:"313",index:114},{key:"Stop",chordCode:"123",index:115},{key:"Again",chordCode:"7A7",index:116},{key:"Undo",chordCode:"232",index:117},{key:"Cut",chordCode:"3C",index:118},{key:"Copy",chordCode:"383",index:119},{key:"Paste",chordCode:"838",index:120},{key:"Find",chordCode:"DE",index:121},{key:"Mute",chordCode:"D0D",index:122},{key:"Volume Up",chordCode:"DA",index:123},{key:"Volume Down",chordCode:"D6",index:124},{key:"Locking Caps Lock",chordCode:"D1",index:125},{key:"Locking Num Lock",chordCode:"DB",index:126},{key:"Locking Scroll Lock",chordCode:"D7",index:127},{key:"Keypad Comma",chordCode:"D2",index:128},{key:"Keypad Equal Sign",chordCode:"DC",index:129},{key:"International1",chordCode:"D82",index:130},{key:"International2",chordCode:"D3D",index:131},{key:"International3",chordCode:"700",index:132},{key:"International4",chordCode:"7E0",index:133},{key:"International5",chordCode:"7EA",index:134},{key:"International6",chordCode:"7E6",index:135},{key:"International7",chordCode:"6E1",index:136},{key:"International8",chordCode:"7EB",index:137},{key:"International9",chordCode:"7E73",index:138},{key:"LANG1",chordCode:"7E2",index:139},{key:"LANG2",chordCode:"7EC",index:140},{key:"LANG3",chordCode:"7E8",index:141},{key:"LANG4",chordCode:"7E3",index:142},{key:"LANG5",chordCode:"7ED",index:143},{key:"LANG6",chordCode:"70C",index:144},{key:"LeftControl",chordCode:"09999",index:145},{key:"LeftShift",chordCode:"59999",index:146},{key:"LeftAlt",chordCode:"A",index:147},{key:"Left GUI",chordCode:"2121",index:148},{key:"RightControl",chordCode:"7A0",index:149},{key:"RightShift",chordCode:"7EA7",index:150},{key:"RightAlt",chordCode:"7A6",index:151},{key:"Right GUI",chordCode:"1212",index:152}];function rr(e){const t=Array.from(zr).find(i=>i.key.replace("&#x2581;"," ").replace("(underscore)","_").replace("Return (ENTER)","\r")==e.displayChar),r=t?.key.replace("Arrow","").replace("Return (ENTER)","Enter");return Y.jsx("div",{className:"chord-image-holder",id:"chord-image-holder","data-source":"ErrorDisplay.tsx",children:Y.jsxs("div",{className:"col-sm-2 row generated next",id:"chord2",children:[Y.jsx("span",{id:"char15",className:"char",children:r}),Y.jsx("img",{loading:"lazy",alt:"2",src:`/images/svgs/${t?.chordCode}.svg`,width:"75",className:"hand"})]})})}const vo=ae.forwardRef((e,t)=>{const[r,i]=ae.useState(0),{mismatchedChar:u}=e,p=()=>{i(_=>_+1)};return ae.useImperativeHandle(t,()=>({showError:p})),Y.jsxs("div",{style:{display:e.isVisible?"block":"none"},children:[Y.jsxs("div",{children:["Error Count: ",r]}),u&&Y.jsx(rr,{displayChar:u})]})});class _t{_value;_chords=[];_chordsHTML=[];constructor(t){if(!t||!Array.isArray(t)||t.length==0)throw new Error("Phrase value must be an array with at least one element");this._value=t,t[0]&&Array.isArray(t)&&this.setChords(t)}get value(){return this._value}get chordsHTML(){return this._chordsHTML}get chords(){return this._chords}setChords(t){t.forEach(r=>{const i=_t.findChordHTML(r);i&&this._chordsHTML.push(i);const u=zr.find(p=>p.key==r);u&&this._chords.push(u)})}static createChordHTML(t){return jr(`<div class="col-sm-2 row generated" id="chord2">
                <span id="char${t.index}">${t.key}</span>
                <img loading="lazy" alt="2" src="/images/svgs/${t.chordCode}.svg" width="100" class="hand">
            </div>`)}static findChordHTML(t){let r=null;const i=Array.from(zr).filter(u=>u.key.replace("&#x2581;"," ").replace("(underscore)","_")==t);if(i.length>0){const u=i[0];r=this.createChordHTML(u),r.setAttribute("name",u.key.replace("(","").replace(")","").replace(" ","-"))}else console.error("Missing chord:",t?.charCodeAt(0));return r}}class So extends pe.Component{_nextCharsRef;_nextCharsRateRef;_timerRef;voiceSynth;_wpmRef;isTestMode;_nextCharsLength=60;constructor(t){super(t),this.voiceSynth=window.speechSynthesis,this._nextCharsRef=pe.createRef(),this._nextCharsRateRef=pe.createRef(),this._wpmRef=pe.createRef(),this.isTestMode=localStorage.getItem("testMode")=="true",this._timerRef=ae.createRef(),this.state={mismatchedChar:null,mismatchedIsVisible:!1,nextChars:this.props.newPhrase,nextCharsIsVisible:!1,isActive:!1,phrase:new _t(this.props.newPhrase.split(""))}}componentDidMount(){this.props.isInPhraseMode&&this.setState({phrase:new _t(this.props.newPhrase.split(""))})}componentDidUpdate(t){if(this.props.newPhrase!==t.newPhrase&&this.props.isInPhraseMode&&this.setState({phrase:new _t(this.props.newPhrase.split("")),nextChars:this.props.newPhrase}),this.props.commandLine!==t.commandLine){const r=this.getNextCharacters(this.props.commandLine);this.setState({nextChars:r}),this.handleCommandLineChange(this.props.commandLine)}}handleCommandLineChange(t){this.testInput(t)}showError=t=>{this.setState({mismatchedChar:t,mismatchedIsVisible:!0})};hideError=()=>{this.setState({mismatchedChar:null,mismatchedIsVisible:!1})};handleSuccess=()=>{this.setState({isActive:!1,mismatchedChar:"",mismatchedIsVisible:!1,nextChars:""}),this.props.onPhraseSuccess(this.state.phrase.value.join(""))};stopTimer(){this._timerRef.current&&this._timerRef.current.stop()}startTImer(){this._timerRef.current&&this._timerRef.current.start()}resetTimer(){this._timerRef.current&&this._timerRef.current.reset()}cancelTimer=()=>{this._timerRef.current&&this._timerRef.current.reset(),this._nextCharsRef.current&&(this._nextCharsRef.current.innerText=this.state.phrase.value.join(""))};reset(){this.setNext(""),this._nextCharsRef?.current&&(this._nextCharsRef.current.hidden=!0)}get nextChars(){return this._nextCharsRef?.current}set wpm(t){this._wpmRef.current&&(this._wpmRef.current.innerText=t)}get phrase(){return this.state.phrase}get nextCharsRate(){return this._nextCharsRateRef.current}set phrase(t){this.setState({phrase:new _t(t.value.split(""))})}getNextCharacters(t){const r=this.getFirstNonMatchingChar(t);return this.state.phrase.value.join("").substring(r,r+this._nextCharsLength)||t.substring(r,r+this._nextCharsLength)}setNext=t=>{const r=this.getFirstNonMatchingChar(t);return r<0||r>this.state.phrase.value.length-1?null:(this.setState({nextChars:this.getNextCharacters(t)}),this.state.phrase.chordsHTML[r])};cancel=()=>{this.wpm&&(this.wpm="0"),this.setNext("")};testInput=t=>{this.startTImer();const r=this.setNext(t);if(r&&r.classList.remove("error"),t.length===0){this.cancelTimer();return}if(t==this.state.phrase.value.join("").trim().substring(0,t.length))this.hideError();else{const i=this.getFirstNonMatchingChar(t),u=this.state.phrase.value[i];this.setState({mismatchedIsVisible:!0,mismatchedChar:u}),this.showError(u)}if(t.trim()==this.state.phrase.value.join("").trim()){this.stopTimer(),this.handleSuccess();return}};getFirstNonMatchingChar=t=>{if(!this.state.phrase.value)return 0;const r=this.state.phrase.value;if(t.length==0)return 0;var i=0;for(let u=0;u<t.length;u++){if(t[u]!==r[u])return u;i++}return i};sayText=t=>{const r=t.target;if(!r||!r.value)return;let i=r.value;const u=t.key;if(u){if(this.voiceSynth||(this.voiceSynth=window.speechSynthesis),this.voiceSynth.speaking&&this.voiceSynth.cancel(),u?.match(/^[a-z0-9]$/i))i=u;else if(u=="Backspace")i="delete";else if(u=="Enter")i=i;else{const _=i.trim().split(" ");i=_[_.length-1]}var p=new SpeechSynthesisUtterance(i);p.pitch=1,p.rate=.7,this.voiceSynth.speak(p)}};render(){return Y.jsxs("div",{hidden:!this.props.isInPhraseMode,children:[this.state.mismatchedChar&&Y.jsx(vo,{isVisible:this.state.mismatchedIsVisible,mismatchedChar:this.state.mismatchedChar}),Y.jsx(go,{ref:this._timerRef}),Y.jsx("div",{id:Se.NextCharsRate,ref:this._nextCharsRateRef}),Y.jsx("span",{id:Se.WPM,ref:this._wpmRef}),Y.jsx("pre",{id:Se.NextChars,ref:this._nextCharsRef,children:this.state.nextChars})]})}}const yo=pe.forwardRef(({elements:e,onTouchStart:t,onTouchEnd:r},i)=>Y.jsx("div",{id:Se.Output,className:Se.Output,onTouchStart:t,onTouchEnd:r,ref:i,children:e.map((u,p)=>typeof u=="string"?Y.jsx("div",{dangerouslySetInnerHTML:{__html:u}},p):Y.jsx("div",{children:u},p))}));function Co(e,t){if(!e)throw new Error(`Assertion failed: ${t}`)}class wo{image;frameCount;frameWidth;frameHeight;frameSequence;constructor(t,r,i,u,p){this.image=new Image,this.image.onload=()=>{Co(this.image.complete,"Image failed to load: "+t),this.frameWidth||(this.frameWidth=this.image.width/this.frameCount),this.frameHeight||(this.frameHeight=this.image.height)},this.image.onerror=()=>{console.error("Image failed to load: "+t)},this.image.src=t,this.frameCount=r,this.frameWidth=i||0,this.frameHeight=u||0,this.frameSequence=p}updateFrameIndex(t,r,i,u){return r-i>u?(t+1)%this.frameCount:t}draw=(t,r,i,u,p=1.5)=>{let _=0,s=0;if(this.frameSequence){const c=this.frameSequence[r];c?(_=c.leftX,s=c.topY):console.error("No frameCoords found for frameIndex:",r,this.frameSequence)}else _=this.frameWidth*r,s=0;t.drawImage(this.image,_,s,this.frameWidth,this.frameHeight,i,u,this.frameWidth*p,this.frameHeight*p)}}class bo{spriteCache=new Map;async loadSprite(t){if(this.spriteCache.has(t.imagePath)){const i=this.spriteCache.get(t.imagePath);if(i!==void 0)return i}const r=new wo(t.imagePath,t.frameCount,t.frameWidth,t.frameHeight,t.framePositions);return await this.waitForManagerImageLoad(r.image),this.spriteCache.set(t.imagePath,r),r}waitForManagerImageLoad(t){return new Promise((r,i)=>{const u=()=>{t.removeEventListener("load",u),t.removeEventListener("error",p),r()},p=()=>{t.removeEventListener("load",u),t.removeEventListener("error",p),console.error("Image failed to load: "+t.src),i(new Error(`Image failed to load: ${t.src}`))};t.addEventListener("load",u),t.addEventListener("error",p)})}}const Us=e=>{const[,t]=ae.useState(null),r=new bo,i=ae.useRef(e.currentActionType),u=ae.useRef(0),p=ae.useRef({}),_=async(h,v)=>{const y=await r.loadSprite(v);y&&(p.current[h]=y,h===e.currentActionType&&t(y))},s=(h,v,y)=>{const C=p.current[e.currentActionType],m=e.actions[e.currentActionType],n=v.leftX+m.dx;return f(),C&&C.draw(h,u.current,n,v.topY,y??e.scale),m.dx},c=()=>{Object.entries(e.actions).forEach(([h,v])=>{_(h,v.animation)})};ae.useEffect(()=>(c(),()=>{}),[]),ae.useEffect(()=>{const h=p.current[e.currentActionType];h?t(h):_(e.currentActionType,e.actions[e.currentActionType].animation)},[e.currentActionType,e.actions]),ae.useEffect(()=>(e.name.toLocaleLowerCase()==="hero"&&d(e.currentActionType),()=>{}),[e.currentActionType]),ae.useEffect(()=>{const h=p.current[e.currentActionType];h&&h.frameCount&&(e.currentActionType!==i.current?u.current=0:f()),i.current=e.currentActionType},[e.currentActionType,e.actions]);const d=h=>{if(e.currentActionType===h)return;e.currentActionType=h,u.current=0;const v=p.current[h];v?t(v):console.error(`Sprite not found for action type: ${h}`)},f=()=>{const h=p.current[e.currentActionType];if(h){const v=(u.current+1)%h.frameCount;u.current=v}};return{draw:s}},Ze={Run:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:6,frameWidth:50,frameHeight:37,framePositions:[{leftX:50,topY:37},{leftX:100,topY:37},{leftX:150,topY:37},{leftX:200,topY:37},{leftX:250,topY:37},{leftX:300,topY:37}]},Idle:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Walk:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Attack:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Summersault:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:200,topY:74},{leftX:250,topY:74},{leftX:300,topY:74},{leftX:0,topY:106}]},Hurt:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Death:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]},Jump:{imagePath:"/images/Adventurer/Adventurer-1.5/adventurer-v1.5-Sheet.png",frameCount:4,frameWidth:50,frameHeight:37,framePositions:[{leftX:0,topY:0},{leftX:50,topY:0},{leftX:100,topY:0},{leftX:150,topY:0}]}},wt={Idle:{imagePath:"images/Zombie4Package/Sprites/Idle.png",frameCount:5,frameWidth:62,frameHeight:62},Walk:{imagePath:"images/Zombie4Package/Sprites/Walk.png",frameCount:13,frameWidth:62,frameHeight:62},Attack:{imagePath:"images/Zombie4Package/Sprites/Attack.png",frameCount:15,frameWidth:62,frameHeight:62},Hurt:{imagePath:"images/Zombie4Package/Sprites/Hurt.png",frameCount:7,frameWidth:62,frameHeight:62},Death:{imagePath:"images/Zombie4Package/Sprites/Death.png",frameCount:12,frameWidth:62,frameHeight:62},Spawn:{imagePath:"images/Zombie4Package/Sprites/Spawn.png",frameCount:10,frameWidth:62,frameHeight:62}},xo={Run:{animation:Ze.Run,dx:2,dy:0,continueous:!0},Idle:{animation:Ze.Idle,dx:0,dy:0,continueous:!0},Walk:{animation:Ze.Walk,dx:1,dy:0,continueous:!0},Jump:{animation:Ze.Jump,dx:0,dy:0,continueous:!1},Attack:{animation:Ze.Attack,dx:0,dy:0,continueous:!1},Summersault:{animation:Ze.Summersault,dx:3,dy:1,continueous:!1},Death:{animation:Ze.Death,dx:0,dy:0,continueous:!1},Hurt:{animation:Ze.Hurt,dx:0,dy:0,continueous:!1}},ko={Attack:{animation:wt.Attack,dx:2,dy:0,continueous:!1},Idle:{animation:wt.Idle,dx:0,dy:0,continueous:!0},Walk:{animation:wt.Walk,dx:1,dy:0,continueous:!0},Hurt:{animation:wt.Hurt,dx:0,dy:0,continueous:!1},Death:{animation:wt.Death,dx:0,dy:0,continueous:!1}},Eo=ae.forwardRef((e,t)=>{const{draw:r}=Us({actions:ko,currentActionType:e.currentActionType,name:"Zombie4",scale:e.scale});return ae.useImperativeHandle(t,()=>({draw:r})),null}),Ro=ae.forwardRef((e,t)=>{const{draw:r}=Us({actions:xo,currentActionType:e.currentActionType,name:"Hero",scale:e.scale});return ae.useImperativeHandle(t,()=>({draw:r})),null}),Vr=[[{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0003_bg.png",scale:1,movementRate:0},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0002_far-buildings.png",scale:.8,movementRate:.4},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0001_buildings.png",scale:.6,movementRate:.6},{imageSrc:"/images/parallax-industrial-pack/parallax-industrial-pack/layers/skill-desc_0000_foreground.png",scale:.6,movementRate:1}],[{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/far-buildings.png",scale:1,movementRate:.4},{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/back-buildings.png",scale:.8,movementRate:.6},{imageSrc:"/images/cyberpunk-street-files/cyberpunk-street-files/PNG/layers/foreground.png",scale:1,movementRate:1}],[{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_1_ground.png",scale:1,movementRate:1},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_2_stars.png",scale:.8,movementRate:0},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_3_moon.png",scale:.8,movementRate:0},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_4_clouds_1.png",scale:.8,movementRate:.2},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_6_far_buildings.png",scale:.8,movementRate:.3},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_7_bg_buildings.png",scale:.8,movementRate:.5},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_8_fg_buildings.png",scale:.6,movementRate:.6},{imageSrc:"/images/post_soviet_city_parallax/post_soviet_city_parallax/layer_9_wall.png",scale:.6,movementRate:1}],[{imageSrc:"/images/parallax-city-background-pack/1BG.png",scale:1,movementRate:0},{imageSrc:"/images/parallax-city-background-pack/2Mountain.png",scale:1,movementRate:.2},{imageSrc:"/images/parallax-city-background-pack/3MountainCloser.png",scale:1,movementRate:.3},{imageSrc:"/images/parallax-city-background-pack/3MountainCloserWCranes.png",scale:1,movementRate:.4},{imageSrc:"/images/parallax-city-background-pack/5Buildings.png",scale:1,movementRate:.5},{imageSrc:"/images/parallax-city-background-pack/6BlueBuildings.png",scale:1,movementRate:.7},{imageSrc:"/images/parallax-city-background-pack/7FireDept.png",scale:1,movementRate:.8},{imageSrc:"/images/parallax-city-background-pack/8Player.png",scale:1,movementRate:1}],[{imageSrc:"/images/city-ruins/post_apocalipse1.png",scale:1.3,movementRate:0},{imageSrc:"/images/city-ruins/post_apocalipse2.png",scale:1.3,movementRate:.5},{imageSrc:"/images/city-ruins/post_apocalipse3.png",scale:1,movementRate:1}],[{imageSrc:"/images/haunted-forest-parallaxing-background/background_1.png",scale:1,movementRate:0},{imageSrc:"/images/haunted-forest-parallaxing-background/background_2.png",scale:1,movementRate:.2},{imageSrc:"/images/haunted-forest-parallaxing-background/background_3.png",scale:1,movementRate:.4},{imageSrc:"/images/haunted-forest-parallaxing-background/background_4.png",scale:1,movementRate:.6},{imageSrc:"/images/haunted-forest-parallaxing-background/background_5.png",scale:1,movementRate:1}]],Lr=()=>Vr.length,To=({layer:e,offset:t,canvasHeight:r})=>{const i=r*e.scale,u=r-r*e.scale,p={backgroundImage:`url(${e.imageSrc})`,backgroundPositionX:-t*e.movementRate,backgroundRepeat:"repeat-x",backgroundSize:`auto ${i}px`,willChange:"transform",height:`${i}px`,width:"100%",position:"absolute",top:u};return Y.jsx("div",{className:"parallax-layer",style:p})},Lo=e=>{const t=60-e.canvasHeight;return Y.jsx("div",{className:"scrolling-text-container",style:{position:"absolute",bottom:t,height:e.canvasHeight,width:"100%",zIndex:1,overflow:"hidden"},children:Y.jsx("div",{className:"scrolling-text",style:{whiteSpace:"nowrap"},children:e.text})})};var ci={};(function e(t,r,i,u){var p=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),_=typeof Path2D=="function"&&typeof DOMMatrix=="function",s=function(){if(!t.OffscreenCanvas)return!1;var E=new OffscreenCanvas(1,1),x=E.getContext("2d");x.fillRect(0,0,1,1);var D=E.transferToImageBitmap();try{x.createPattern(D,"no-repeat")}catch{return!1}return!0}();function c(){}function d(E){var x=r.exports.Promise,D=x!==void 0?x:t.Promise;return typeof D=="function"?new D(E):(E(c,c),null)}var f=function(E,x){return{transform:function(D){if(E)return D;if(x.has(D))return x.get(D);var O=new OffscreenCanvas(D.width,D.height),$=O.getContext("2d");return $.drawImage(D,0,0),x.set(D,O),O},clear:function(){x.clear()}}}(s,new Map),h=function(){var E=Math.floor(16.666666666666668),x,D,O={},$=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(x=function(V){var q=Math.random();return O[q]=requestAnimationFrame(function M(L){$===L||$+E-1<L?($=L,delete O[q],V()):O[q]=requestAnimationFrame(M)}),q},D=function(V){O[V]&&cancelAnimationFrame(O[V])}):(x=function(V){return setTimeout(V,E)},D=function(V){return clearTimeout(V)}),{frame:x,cancel:D}}(),v=function(){var E,x,D={};function O($){function V(q,M){$.postMessage({options:q||{},callback:M})}$.init=function(M){var L=M.transferControlToOffscreen();$.postMessage({canvas:L},[L])},$.fire=function(M,L,F){if(x)return V(M,null),x;var W=Math.random().toString(36).slice(2);return x=d(function(z){function j(te){te.data.callback===W&&(delete D[W],$.removeEventListener("message",j),x=null,f.clear(),F(),z())}$.addEventListener("message",j),V(M,W),D[W]=j.bind(null,{data:{callback:W}})}),x},$.reset=function(){$.postMessage({reset:!0});for(var M in D)D[M](),delete D[M]}}return function(){if(E)return E;if(!i&&p){var $=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{E=new Worker(URL.createObjectURL(new Blob([$])))}catch(V){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("ð Could not load worker",V),null}O(E)}return E}}(),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function C(E,x){return x?x(E):E}function m(E){return E!=null}function n(E,x,D){return C(E&&m(E[x])?E[x]:y[x],D)}function l(E){return E<0?0:Math.floor(E)}function o(E,x){return Math.floor(Math.random()*(x-E))+E}function a(E){return parseInt(E,16)}function g(E){return E.map(b)}function b(E){var x=String(E).replace(/[^0-9a-f]/gi,"");return x.length<6&&(x=x[0]+x[0]+x[1]+x[1]+x[2]+x[2]),{r:a(x.substring(0,2)),g:a(x.substring(2,4)),b:a(x.substring(4,6))}}function w(E){var x=n(E,"origin",Object);return x.x=n(x,"x",Number),x.y=n(x,"y",Number),x}function k(E){E.width=document.documentElement.clientWidth,E.height=document.documentElement.clientHeight}function S(E){var x=E.getBoundingClientRect();E.width=x.width,E.height=x.height}function R(E){var x=document.createElement("canvas");return x.style.position="fixed",x.style.top="0px",x.style.left="0px",x.style.pointerEvents="none",x.style.zIndex=E,x}function P(E,x,D,O,$,V,q,M,L){E.save(),E.translate(x,D),E.rotate(V),E.scale(O,$),E.arc(0,0,1,q,M,L),E.restore()}function B(E){var x=E.angle*(Math.PI/180),D=E.spread*(Math.PI/180);return{x:E.x,y:E.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:E.startVelocity*.5+Math.random()*E.startVelocity,angle2D:-x+(.5*D-Math.random()*D),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:E.color,shape:E.shape,tick:0,totalTicks:E.ticks,decay:E.decay,drift:E.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:E.gravity*3,ovalScalar:.6,scalar:E.scalar,flat:E.flat}}function I(E,x){x.x+=Math.cos(x.angle2D)*x.velocity+x.drift,x.y+=Math.sin(x.angle2D)*x.velocity+x.gravity,x.velocity*=x.decay,x.flat?(x.wobble=0,x.wobbleX=x.x+10*x.scalar,x.wobbleY=x.y+10*x.scalar,x.tiltSin=0,x.tiltCos=0,x.random=1):(x.wobble+=x.wobbleSpeed,x.wobbleX=x.x+10*x.scalar*Math.cos(x.wobble),x.wobbleY=x.y+10*x.scalar*Math.sin(x.wobble),x.tiltAngle+=.1,x.tiltSin=Math.sin(x.tiltAngle),x.tiltCos=Math.cos(x.tiltAngle),x.random=Math.random()+2);var D=x.tick++/x.totalTicks,O=x.x+x.random*x.tiltCos,$=x.y+x.random*x.tiltSin,V=x.wobbleX+x.random*x.tiltCos,q=x.wobbleY+x.random*x.tiltSin;if(E.fillStyle="rgba("+x.color.r+", "+x.color.g+", "+x.color.b+", "+(1-D)+")",E.beginPath(),_&&x.shape.type==="path"&&typeof x.shape.path=="string"&&Array.isArray(x.shape.matrix))E.fill(J(x.shape.path,x.shape.matrix,x.x,x.y,Math.abs(V-O)*.1,Math.abs(q-$)*.1,Math.PI/10*x.wobble));else if(x.shape.type==="bitmap"){var M=Math.PI/10*x.wobble,L=Math.abs(V-O)*.1,F=Math.abs(q-$)*.1,W=x.shape.bitmap.width*x.scalar,z=x.shape.bitmap.height*x.scalar,j=new DOMMatrix([Math.cos(M)*L,Math.sin(M)*L,-Math.sin(M)*F,Math.cos(M)*F,x.x,x.y]);j.multiplySelf(new DOMMatrix(x.shape.matrix));var te=E.createPattern(f.transform(x.shape.bitmap),"no-repeat");te.setTransform(j),E.globalAlpha=1-D,E.fillStyle=te,E.fillRect(x.x-W/2,x.y-z/2,W,z),E.globalAlpha=1}else if(x.shape==="circle")E.ellipse?E.ellipse(x.x,x.y,Math.abs(V-O)*x.ovalScalar,Math.abs(q-$)*x.ovalScalar,Math.PI/10*x.wobble,0,2*Math.PI):P(E,x.x,x.y,Math.abs(V-O)*x.ovalScalar,Math.abs(q-$)*x.ovalScalar,Math.PI/10*x.wobble,0,2*Math.PI);else if(x.shape==="star")for(var Q=Math.PI/2*3,oe=4*x.scalar,ce=8*x.scalar,ee=x.x,ve=x.y,Fe=5,be=Math.PI/Fe;Fe--;)ee=x.x+Math.cos(Q)*ce,ve=x.y+Math.sin(Q)*ce,E.lineTo(ee,ve),Q+=be,ee=x.x+Math.cos(Q)*oe,ve=x.y+Math.sin(Q)*oe,E.lineTo(ee,ve),Q+=be;else E.moveTo(Math.floor(x.x),Math.floor(x.y)),E.lineTo(Math.floor(x.wobbleX),Math.floor($)),E.lineTo(Math.floor(V),Math.floor(q)),E.lineTo(Math.floor(O),Math.floor(x.wobbleY));return E.closePath(),E.fill(),x.tick<x.totalTicks}function A(E,x,D,O,$){var V=x.slice(),q=E.getContext("2d"),M,L,F=d(function(W){function z(){M=L=null,q.clearRect(0,0,O.width,O.height),f.clear(),$(),W()}function j(){i&&!(O.width===u.width&&O.height===u.height)&&(O.width=E.width=u.width,O.height=E.height=u.height),!O.width&&!O.height&&(D(E),O.width=E.width,O.height=E.height),q.clearRect(0,0,O.width,O.height),V=V.filter(function(te){return I(q,te)}),V.length?M=h.frame(j):z()}M=h.frame(j),L=z});return{addFettis:function(W){return V=V.concat(W),F},canvas:E,promise:F,reset:function(){M&&h.cancel(M),L&&L()}}}function N(E,x){var D=!E,O=!!n(x||{},"resize"),$=!1,V=n(x,"disableForReducedMotion",Boolean),q=p&&!!n(x||{},"useWorker"),M=q?v():null,L=D?k:S,F=E&&M?!!E.__confetti_initialized:!1,W=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,z;function j(Q,oe,ce){for(var ee=n(Q,"particleCount",l),ve=n(Q,"angle",Number),Fe=n(Q,"spread",Number),be=n(Q,"startVelocity",Number),yt=n(Q,"decay",Number),ft=n(Q,"gravity",Number),xe=n(Q,"drift",Number),Je=n(Q,"colors",g),Ie=n(Q,"ticks",Number),Ye=n(Q,"shapes"),Ct=n(Q,"scalar"),Ue=!!n(Q,"flat"),nt=w(Q),He=ee,qe=[],de=E.width*nt.x,Tr=E.height*nt.y;He--;)qe.push(B({x:de,y:Tr,angle:ve,spread:Fe,startVelocity:be,color:Je[He%Je.length],shape:Ye[o(0,Ye.length)],ticks:Ie,decay:yt,gravity:ft,drift:xe,scalar:Ct,flat:Ue}));return z?z.addFettis(qe):(z=A(E,qe,L,oe,ce),z.promise)}function te(Q){var oe=V||n(Q,"disableForReducedMotion",Boolean),ce=n(Q,"zIndex",Number);if(oe&&W)return d(function(be){be()});D&&z?E=z.canvas:D&&!E&&(E=R(ce),document.body.appendChild(E)),O&&!F&&L(E);var ee={width:E.width,height:E.height};M&&!F&&M.init(E),F=!0,M&&(E.__confetti_initialized=!0);function ve(){if(M){var be={getBoundingClientRect:function(){if(!D)return E.getBoundingClientRect()}};L(be),M.postMessage({resize:{width:be.width,height:be.height}});return}ee.width=ee.height=null}function Fe(){z=null,O&&($=!1,t.removeEventListener("resize",ve)),D&&E&&(document.body.contains(E)&&document.body.removeChild(E),E=null,F=!1)}return O&&!$&&($=!0,t.addEventListener("resize",ve,!1)),M?M.fire(Q,ee,Fe):j(Q,ee,Fe)}return te.reset=function(){M&&M.reset(),z&&z.reset()},te}var U;function X(){return U||(U=N(null,{useWorker:!0,resize:!0})),U}function J(E,x,D,O,$,V,q){var M=new Path2D(E),L=new Path2D;L.addPath(M,new DOMMatrix(x));var F=new Path2D;return F.addPath(L,new DOMMatrix([Math.cos(q)*$,Math.sin(q)*$,-Math.sin(q)*V,Math.cos(q)*V,D,O])),F}function K(E){if(!_)throw new Error("path confetti are not supported in this browser");var x,D;typeof E=="string"?x=E:(x=E.path,D=E.matrix);var O=new Path2D(x),$=document.createElement("canvas"),V=$.getContext("2d");if(!D){for(var q=1e3,M=q,L=q,F=0,W=0,z,j,te=0;te<q;te+=2)for(var Q=0;Q<q;Q+=2)V.isPointInPath(O,te,Q,"nonzero")&&(M=Math.min(M,te),L=Math.min(L,Q),F=Math.max(F,te),W=Math.max(W,Q));z=F-M,j=W-L;var oe=10,ce=Math.min(oe/z,oe/j);D=[ce,0,0,ce,-Math.round(z/2+M)*ce,-Math.round(j/2+L)*ce]}return{type:"path",path:x,matrix:D}}function T(E){var x,D=1,O="#000000",$='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof E=="string"?x=E:(x=E.text,D="scalar"in E?E.scalar:D,$="fontFamily"in E?E.fontFamily:$,O="color"in E?E.color:O);var V=10*D,q=""+V+"px "+$,M=new OffscreenCanvas(V,V),L=M.getContext("2d");L.font=q;var F=L.measureText(x),W=Math.ceil(F.actualBoundingBoxRight+F.actualBoundingBoxLeft),z=Math.ceil(F.actualBoundingBoxAscent+F.actualBoundingBoxDescent),j=2,te=F.actualBoundingBoxLeft+j,Q=F.actualBoundingBoxAscent+j;W+=j+j,z+=j+j,M=new OffscreenCanvas(W,z),L=M.getContext("2d"),L.font=q,L.fillStyle=O,L.fillText(x,te,Q);var oe=1/D;return{type:"bitmap",bitmap:M.transferToImageBitmap(),matrix:[oe,0,0,oe,-W*oe/2,-z*oe/2]}}r.exports=function(){return X().apply(this,arguments)},r.exports.reset=function(){X().reset()},r.exports.create=N,r.exports.shapeFromPath=K,r.exports.shapeFromText=T})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ci,!1);const Ao=ci.exports;ci.exports.create;class Do extends pe.Component{canvasRef=pe.createRef();animationFrameIndex;context=null;heroXPercent=.23;zombie4DeathTimeout=null;heroRef=pe.createRef();zombie4Ref=pe.createRef();getInitState(t){return{currentLevel:1,heroPosition:{leftX:t.canvasWidth*this.heroXPercent,topY:30},heroReady:!1,zombie4Position:{leftX:50,topY:0},zombie4Ready:!1,context:null,contextBackground:null,idleStartTime:null,backgroundOffsetX:0,isPhraseComplete:!1,textScrollX:this.props.canvasWidth,textToScroll:"Terminal Velocity!",isTextScrolling:!1,isInScrollMode:!0,layers:Vr[0]}}getLevel=()=>this.state.currentLevel;setLevel=t=>{const r=Vr[t-1];this.setState({currentLevel:t,layers:r})};levelUp=(t=null)=>{t&&t>Lr()&&(t=Lr());let r=t||this.getLevel()+1;r>Lr()&&(r=0),r<1&&(r=1),this.setLevel(r)};resetGame(){}changeLevel=t=>{this.setState({currentLevel:t})};constructor(t){super(t),this.state=this.getInitState(t)}componentDidMount(){const t=this.canvasRef.current;if(t){const r=t.getContext("2d");r&&this.setupCanvas(r.canvas)}}componentDidUpdate(t,r,i){this.state.currentLevel,r.currentLevel,this.animationFrameIndex||this.startAnimationLoop(this.state.context)}componentWillUnmount(){this.animationFrameIndex&&cancelAnimationFrame(this.animationFrameIndex),this.stopAnimationLoop(),this.zombie4DeathTimeout&&clearTimeout(this.zombie4DeathTimeout)}setupCanvas(t){if(t){const r=t.getContext("2d");r instanceof CanvasRenderingContext2D?this.setState({context:r}):console.error("Obtained context is not a CanvasRenderingContext2D instance.")}else console.error("Failed to get canvas element.")}toggleScrollingText=(t=null)=>{t===null&&(t=!this.state.isTextScrolling),this.setState({isTextScrolling:t})};drawScrollingText(){this.toggleScrollingText(!0),setTimeout(()=>{this.toggleScrollingText(!1)},3e3)}completeGame(){this.setZombie4ToDeathThenResetPosition(),this.triggerConfettiCannon(),this.setState({isPhraseComplete:!0,textScrollX:this.props.canvasWidth})}setZombie4ToDeathThenResetPosition=()=>{this.zombie4DeathTimeout&&(clearTimeout(this.zombie4DeathTimeout),this.zombie4DeathTimeout=null),this.setZombie4Action("Death"),this.zombie4DeathTimeout=setTimeout(()=>{this.setZombie4Action("Walk"),this.setState({zombie4Position:{topY:0,leftX:-70},isPhraseComplete:!1,textScrollX:this.props.canvasWidth}),this.zombie4DeathTimeout=null},3e3)};checkProximityAndSetAction(){const r=this.state.heroPosition.leftX-this.state.zombie4Position.leftX;25<r&&r<100?this.setZombie4Action("Attack"):this.props.zombie4ActionType==="Attack"&&this.setZombie4Action("Walk")}setZombie4Action(t){this.props.onSetZombie4Action(t)}updateCharacterAndBackgroundPostion=t=>{const i=this.props.canvasWidth*this.heroXPercent;t.clearRect(0,0,this.props.canvasWidth,this.props.canvasHeight);let u=0;if(this.heroRef.current&&t&&(u=this.heroRef.current.draw(t,this.state.heroPosition)),this.zombie4Ref.current&&t){const p=this.zombie4Ref.current.draw(t,this.state.zombie4Position);this.setState(_=>({zombie4Position:{..._.zombie4Position,leftX:_.zombie4Position.leftX+p}}))}if(this.state.isInScrollMode&&u!==0){this.setState(_=>({backgroundOffsetX:_.backgroundOffsetX+u})),this.state.heroPosition.leftX>=i&&this.setState({heroPosition:{...this.state.heroPosition,leftX:i}});const p=this.state.zombie4Position.leftX-u;this.setState({zombie4Position:{...this.state.zombie4Position,leftX:p}})}return u};startAnimationLoop(t){let i=performance.now();const u=()=>{const p=performance.now(),_=p-i;_>=150&&(i=p-_%150,this.state.isPhraseComplete&&this.drawScrollingText(),this.updateCharacterAndBackgroundPostion(t),this.checkProximityAndSetAction()),this.animationFrameIndex=requestAnimationFrame(u)};this.animationFrameIndex=requestAnimationFrame(u)}maybeStartAnimationLoop(){this.state.context&&this.state.contextBackground&&this.startAnimationLoop(this.state.context)}stopAnimationLoop(){this.animationFrameIndex&&(cancelAnimationFrame(this.animationFrameIndex),this.animationFrameIndex=void 0)}triggerConfettiCannon(){Ao({zIndex:3,angle:160,spread:45,startVelocity:45,particleCount:150,origin:{x:.99,y:.8}})}handleHeroPositionChange=t=>{this.setState({heroPosition:t})};handleZombie4PositionChange=t=>{this.setState({zombie4Position:t})};render(){return Y.jsxs("div",{id:Se.TerminalGame,hidden:!this.props.isInPhraseMode,style:{position:"relative",height:this.props.canvasHeight},children:[Y.jsxs("div",{className:"parallax-background",children:[this.state.isTextScrolling&&Y.jsx(Lo,{text:this.state.textToScroll,canvasHeight:this.props.canvasHeight}),this.state.layers.map((t,r)=>Y.jsx(To,{layer:t,offset:this.state.backgroundOffsetX,canvasHeight:this.props.canvasHeight},r))]}),Y.jsx("canvas",{style:{position:"absolute",top:0,left:0,zIndex:2},ref:this.canvasRef,width:this.props.canvasWidth,height:this.props.canvasHeight}),Y.jsx(Ro,{ref:this.heroRef,currentActionType:this.props.heroActionType,scale:1.95}),Y.jsx(Eo,{ref:this.zombie4Ref,currentActionType:this.props.zombie4ActionType,scale:1.9})]})}}var st={},mt={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=ae;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ke=Object.prototype.hasOwnProperty,Po=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mi={},Bi={};function zs(e){return ke.call(Bi,e)?!0:ke.call(Mi,e)?!1:Po.test(e)?Bi[e]=!0:(Mi[e]=!0,!1)}function Ce(e,t,r,i,u,p,_){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=u,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=p,this.removeEmptyString=_}var me={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){me[e]=new Ce(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];me[t]=new Ce(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){me[e]=new Ce(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){me[e]=new Ce(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){me[e]=new Ce(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){me[e]=new Ce(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){me[e]=new Ce(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){me[e]=new Ce(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){me[e]=new Ce(e,5,!1,e.toLowerCase(),null,!1,!1)});var hi=/[\-:]([a-z])/g;function ui(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hi,ui);me[t]=new Ce(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hi,ui);me[t]=new Ce(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hi,ui);me[t]=new Ce(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){me[e]=new Ce(e,1,!1,e.toLowerCase(),null,!1,!1)});me.xlinkHref=new Ce("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){me[e]=new Ce(e,1,!1,e.toLowerCase(),null,!0,!0)});var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mo=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(e){Mo.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zt[t]=zt[e]})});var Bo=/["'&<>]/;function ye(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=Bo.exec(e);if(t){var r="",i,u=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}u!==i&&(r+=e.substring(u,i)),u=i+1,r+=t}e=u!==i?r+e.substring(u,i):r}return e}var Io=/([A-Z])/g,Oo=/^ms-/,qr=Array.isArray;function Ke(e,t){return{insertionMode:e,selectedValue:t}}function Fo(e,t,r){switch(t){case"select":return Ke(1,r.value!=null?r.value:r.defaultValue);case"svg":return Ke(2,null);case"math":return Ke(3,null);case"foreignObject":return Ke(1,null);case"table":return Ke(4,null);case"thead":case"tbody":case"tfoot":return Ke(5,null);case"colgroup":return Ke(7,null);case"tr":return Ke(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Ke(1,null):e}var Ii=new Map;function Vs(e,t,r){if(typeof r!="object")throw Error(re(62));t=!0;for(var i in r)if(ke.call(r,i)){var u=r[i];if(u!=null&&typeof u!="boolean"&&u!==""){if(i.indexOf("--")===0){var p=ye(i);u=ye((""+u).trim())}else{p=i;var _=Ii.get(p);_!==void 0||(_=ye(p.replace(Io,"-$1").toLowerCase().replace(Oo,"-ms-")),Ii.set(p,_)),p=_,u=typeof u=="number"?u===0||ke.call(zt,i)?""+u:u+"px":ye((""+u).trim())}t?(t=!1,e.push(' style="',p,":",u)):e.push(";",p,":",u)}}t||e.push('"')}function Te(e,t,r,i){switch(r){case"style":Vs(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(t=me.hasOwnProperty(r)?me[r]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(r=t.attributeName,t.type){case 3:i&&e.push(" ",r,'=""');break;case 4:i===!0?e.push(" ",r,'=""'):i!==!1&&e.push(" ",r,'="',ye(i),'"');break;case 5:isNaN(i)||e.push(" ",r,'="',ye(i),'"');break;case 6:!isNaN(i)&&1<=i&&e.push(" ",r,'="',ye(i),'"');break;default:t.sanitizeURL&&(i=""+i),e.push(" ",r,'="',ye(i),'"')}}else if(zs(r)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=r.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",r,'="',ye(i),'"')}}}function Vt(e,t,r){if(t!=null){if(r!=null)throw Error(re(60));if(typeof t!="object"||!("__html"in t))throw Error(re(61));t=t.__html,t!=null&&e.push(""+t)}}function Ho(e){var t="";return js.Children.forEach(e,function(r){r!=null&&(t+=r)}),t}function Ar(e,t,r,i){e.push(je(r));var u=r=null,p;for(p in t)if(ke.call(t,p)){var _=t[p];if(_!=null)switch(p){case"children":r=_;break;case"dangerouslySetInnerHTML":u=_;break;default:Te(e,i,p,_)}}return e.push(">"),Vt(e,u,r),typeof r=="string"?(e.push(ye(r)),null):r}var No=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Oi=new Map;function je(e){var t=Oi.get(e);if(t===void 0){if(!No.test(e))throw Error(re(65,e));t="<"+e,Oi.set(e,t)}return t}function Wo(e,t,r,i,u){switch(t){case"select":e.push(je("select"));var p=null,_=null;for(f in r)if(ke.call(r,f)){var s=r[f];if(s!=null)switch(f){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;case"defaultValue":case"value":break;default:Te(e,i,f,s)}}return e.push(">"),Vt(e,_,p),p;case"option":_=u.selectedValue,e.push(je("option"));var c=s=null,d=null,f=null;for(p in r)if(ke.call(r,p)){var h=r[p];if(h!=null)switch(p){case"children":s=h;break;case"selected":d=h;break;case"dangerouslySetInnerHTML":f=h;break;case"value":c=h;default:Te(e,i,p,h)}}if(_!=null)if(r=c!==null?""+c:Ho(s),qr(_)){for(i=0;i<_.length;i++)if(""+_[i]===r){e.push(' selected=""');break}}else""+_===r&&e.push(' selected=""');else d&&e.push(' selected=""');return e.push(">"),Vt(e,f,s),s;case"textarea":e.push(je("textarea")),f=_=p=null;for(s in r)if(ke.call(r,s)&&(c=r[s],c!=null))switch(s){case"children":f=c;break;case"value":p=c;break;case"defaultValue":_=c;break;case"dangerouslySetInnerHTML":throw Error(re(91));default:Te(e,i,s,c)}if(p===null&&_!==null&&(p=_),e.push(">"),f!=null){if(p!=null)throw Error(re(92));if(qr(f)&&1<f.length)throw Error(re(93));p=""+f}return typeof p=="string"&&p[0]===`
`&&e.push(`
`),p!==null&&e.push(ye(""+p)),null;case"input":e.push(je("input")),c=f=s=p=null;for(_ in r)if(ke.call(r,_)&&(d=r[_],d!=null))switch(_){case"children":case"dangerouslySetInnerHTML":throw Error(re(399,"input"));case"defaultChecked":c=d;break;case"defaultValue":s=d;break;case"checked":f=d;break;case"value":p=d;break;default:Te(e,i,_,d)}return f!==null?Te(e,i,"checked",f):c!==null&&Te(e,i,"checked",c),p!==null?Te(e,i,"value",p):s!==null&&Te(e,i,"value",s),e.push("/>"),null;case"menuitem":e.push(je("menuitem"));for(var v in r)if(ke.call(r,v)&&(p=r[v],p!=null))switch(v){case"children":case"dangerouslySetInnerHTML":throw Error(re(400));default:Te(e,i,v,p)}return e.push(">"),null;case"title":e.push(je("title")),p=null;for(h in r)if(ke.call(r,h)&&(_=r[h],_!=null))switch(h){case"children":p=_;break;case"dangerouslySetInnerHTML":throw Error(re(434));default:Te(e,i,h,_)}return e.push(">"),p;case"listing":case"pre":e.push(je(t)),_=p=null;for(c in r)if(ke.call(r,c)&&(s=r[c],s!=null))switch(c){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;default:Te(e,i,c,s)}if(e.push(">"),_!=null){if(p!=null)throw Error(re(60));if(typeof _!="object"||!("__html"in _))throw Error(re(61));r=_.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?e.push(`
`,r):e.push(""+r))}return typeof p=="string"&&p[0]===`
`&&e.push(`
`),p;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(je(t));for(var y in r)if(ke.call(r,y)&&(p=r[y],p!=null))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(re(399,t));default:Te(e,i,y,p)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Ar(e,r,t,i);case"html":return u.insertionMode===0&&e.push("<!DOCTYPE html>"),Ar(e,r,t,i);default:if(t.indexOf("-")===-1&&typeof r.is!="string")return Ar(e,r,t,i);e.push(je(t)),_=p=null;for(d in r)if(ke.call(r,d)&&(s=r[d],s!=null))switch(d){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;case"style":Vs(e,i,s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:zs(d)&&typeof s!="function"&&typeof s!="symbol"&&e.push(" ",d,'="',ye(s),'"')}return e.push(">"),Vt(e,_,p),p}}function Fi(e,t,r){if(e.push('<!--$?--><template id="'),r===null)throw Error(re(395));return e.push(r),e.push('"></template>')}function $o(e,t,r,i){switch(r.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');default:throw Error(re(397))}}function Uo(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(re(397))}}var jo=/[<\u2028\u2029]/g;function Dr(e){return JSON.stringify(e).replace(jo,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function zo(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function Hi(e,t,r,i){return r.generateStaticMarkup?(e.push(ye(t)),!1):(t===""?e=i:(i&&e.push("<!-- -->"),e.push(ye(t)),e=!0),e)}var At=Object.assign,Vo=Symbol.for("react.element"),qs=Symbol.for("react.portal"),Ks=Symbol.for("react.fragment"),Xs=Symbol.for("react.strict_mode"),Gs=Symbol.for("react.profiler"),Js=Symbol.for("react.provider"),Ys=Symbol.for("react.context"),Zs=Symbol.for("react.forward_ref"),Qs=Symbol.for("react.suspense"),en=Symbol.for("react.suspense_list"),tn=Symbol.for("react.memo"),di=Symbol.for("react.lazy"),qo=Symbol.for("react.scope"),Ko=Symbol.for("react.debug_trace_mode"),Xo=Symbol.for("react.legacy_hidden"),Go=Symbol.for("react.default_value"),Ni=Symbol.iterator;function Kr(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ks:return"Fragment";case qs:return"Portal";case Gs:return"Profiler";case Xs:return"StrictMode";case Qs:return"Suspense";case en:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ys:return(e.displayName||"Context")+".Consumer";case Js:return(e._context.displayName||"Context")+".Provider";case Zs:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tn:return t=e.displayName||null,t!==null?t:Kr(e.type)||"Memo";case di:t=e._payload,e=e._init;try{return Kr(e(t))}catch{}}return null}var rn={};function Wi(e,t){if(e=e.contextTypes,!e)return rn;var r={},i;for(i in e)r[i]=t[i];return r}var ct=null;function mr(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var r=t.parent;if(e===null){if(r!==null)throw Error(re(401))}else{if(r===null)throw Error(re(401));mr(e,r)}t.context._currentValue2=t.value}}function sn(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&sn(e)}function nn(e){var t=e.parent;t!==null&&nn(t),e.context._currentValue2=e.value}function on(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(re(402));e.depth===t.depth?mr(e,t):on(e,t)}function an(e,t){var r=t.parent;if(r===null)throw Error(re(402));e.depth===r.depth?mr(e,r):an(e,r),t.context._currentValue2=t.value}function ir(e){var t=ct;t!==e&&(t===null?nn(e):e===null?sn(t):t.depth===e.depth?mr(t,e):t.depth>e.depth?on(t,e):an(t,e),ct=e)}var $i={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function Ui(e,t,r,i){var u=e.state!==void 0?e.state:null;e.updater=$i,e.props=r,e.state=u;var p={queue:[],replace:!1};e._reactInternals=p;var _=t.contextType;if(e.context=typeof _=="object"&&_!==null?_._currentValue2:i,_=t.getDerivedStateFromProps,typeof _=="function"&&(_=_(r,u),u=_==null?u:At({},u,_),e.state=u),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&$i.enqueueReplaceState(e,e.state,null),p.queue!==null&&0<p.queue.length)if(t=p.queue,_=p.replace,p.queue=null,p.replace=!1,_&&t.length===1)e.state=t[0];else{for(p=_?t[0]:e.state,u=!0,_=_?1:0;_<t.length;_++){var s=t[_];s=typeof s=="function"?s.call(e,p,r,i):s,s!=null&&(u?(u=!1,p=At({},p,s)):At(p,s))}e.state=p}else p.queue=null}var Jo={id:1,overflow:""};function Xr(e,t,r){var i=e.id;e=e.overflow;var u=32-qt(i)-1;i&=~(1<<u),r+=1;var p=32-qt(t)+u;if(30<p){var _=u-u%5;return p=(i&(1<<_)-1).toString(32),i>>=_,u-=_,{id:1<<32-qt(t)+u|r<<u|i,overflow:p+e}}return{id:1<<p|r<<u|i,overflow:e}}var qt=Math.clz32?Math.clz32:Qo,Yo=Math.log,Zo=Math.LN2;function Qo(e){return e>>>=0,e===0?32:31-(Yo(e)/Zo|0)|0}function ea(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ta=typeof Object.is=="function"?Object.is:ea,Xe=null,fi=null,Kt=null,he=null,Et=!1,sr=!1,Pt=0,rt=null,gr=0;function ot(){if(Xe===null)throw Error(re(321));return Xe}function ji(){if(0<gr)throw Error(re(312));return{memoizedState:null,queue:null,next:null}}function pi(){return he===null?Kt===null?(Et=!1,Kt=he=ji()):(Et=!0,he=Kt):he.next===null?(Et=!1,he=he.next=ji()):(Et=!0,he=he.next),he}function _i(){fi=Xe=null,sr=!1,Kt=null,gr=0,he=rt=null}function ln(e,t){return typeof t=="function"?t(e):t}function zi(e,t,r){if(Xe=ot(),he=pi(),Et){var i=he.queue;if(t=i.dispatch,rt!==null&&(r=rt.get(i),r!==void 0)){rt.delete(i),i=he.memoizedState;do i=e(i,r.action),r=r.next;while(r!==null);return he.memoizedState=i,[i,t]}return[he.memoizedState,t]}return e=e===ln?typeof t=="function"?t():t:r!==void 0?r(t):t,he.memoizedState=e,e=he.queue={last:null,dispatch:null},e=e.dispatch=ra.bind(null,Xe,e),[he.memoizedState,e]}function Vi(e,t){if(Xe=ot(),he=pi(),t=t===void 0?null:t,he!==null){var r=he.memoizedState;if(r!==null&&t!==null){var i=r[1];e:if(i===null)i=!1;else{for(var u=0;u<i.length&&u<t.length;u++)if(!ta(t[u],i[u])){i=!1;break e}i=!0}if(i)return r[0]}}return e=e(),he.memoizedState=[e,t],e}function ra(e,t,r){if(25<=gr)throw Error(re(301));if(e===Xe)if(sr=!0,e={action:r,next:null},rt===null&&(rt=new Map),r=rt.get(t),r===void 0)rt.set(t,e);else{for(t=r;t.next!==null;)t=t.next;t.next=e}}function ia(){throw Error(re(394))}function Wt(){}var qi={readContext:function(e){return e._currentValue2},useContext:function(e){return ot(),e._currentValue2},useMemo:Vi,useReducer:zi,useRef:function(e){Xe=ot(),he=pi();var t=he.memoizedState;return t===null?(e={current:e},he.memoizedState=e):t},useState:function(e){return zi(ln,e)},useInsertionEffect:Wt,useLayoutEffect:function(){},useCallback:function(e,t){return Vi(function(){return e},t)},useImperativeHandle:Wt,useEffect:Wt,useDebugValue:Wt,useDeferredValue:function(e){return ot(),e},useTransition:function(){return ot(),[!1,ia]},useId:function(){var e=fi.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-qt(e)-1)).toString(32)+t;var r=Xt;if(r===null)throw Error(re(404));return t=Pt++,e=":"+r.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return ot(),t(e._source)},useSyncExternalStore:function(e,t,r){if(r===void 0)throw Error(re(407));return r()}},Xt=null,Pr=js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function sa(e){return console.error(e),null}function Rt(){}function na(e,t,r,i,u,p,_,s,c){var d=[],f=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:f,pingedTasks:d,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:u===void 0?sa:u,onAllReady:Rt,onShellReady:_===void 0?Rt:_,onShellError:Rt,onFatalError:Rt},r=nr(t,0,null,r,!1,!1),r.parentFlushed=!0,e=mi(t,e,null,r,f,rn,null,Jo),d.push(e),t}function mi(e,t,r,i,u,p,_,s){e.allPendingTasks++,r===null?e.pendingRootTasks++:r.pendingTasks++;var c={node:t,ping:function(){var d=e.pingedTasks;d.push(c),d.length===1&&un(e)},blockedBoundary:r,blockedSegment:i,abortSet:u,legacyContext:p,context:_,treeContext:s};return u.add(c),c}function nr(e,t,r,i,u,p){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:r,lastPushedText:u,textEmbedded:p}}function Mt(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function or(e,t){var r=e.onShellError;r(t),r=e.onFatalError,r(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function Ki(e,t,r,i,u){for(Xe={},fi=t,Pt=0,e=r(i,u);sr;)sr=!1,Pt=0,gr+=1,he=null,e=r(i,u);return _i(),e}function Xi(e,t,r,i){var u=r.render(),p=i.childContextTypes;if(p!=null){var _=t.legacyContext;if(typeof r.getChildContext!="function")i=_;else{r=r.getChildContext();for(var s in r)if(!(s in p))throw Error(re(108,Kr(i)||"Unknown",s));i=At({},_,r)}t.legacyContext=i,De(e,t,u),t.legacyContext=_}else De(e,t,u)}function Gi(e,t){if(e&&e.defaultProps){t=At({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Gr(e,t,r,i,u){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){u=Wi(r,t.legacyContext);var p=r.contextType;p=new r(i,typeof p=="object"&&p!==null?p._currentValue2:u),Ui(p,r,i,u),Xi(e,t,p,r)}else{p=Wi(r,t.legacyContext),u=Ki(e,t,r,i,p);var _=Pt!==0;if(typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0)Ui(u,r,i,p),Xi(e,t,u,r);else if(_){i=t.treeContext,t.treeContext=Xr(i,1,0);try{De(e,t,u)}finally{t.treeContext=i}}else De(e,t,u)}else if(typeof r=="string"){switch(u=t.blockedSegment,p=Wo(u.chunks,r,i,e.responseState,u.formatContext),u.lastPushedText=!1,_=u.formatContext,u.formatContext=Fo(_,r,i),Jr(e,t,p),u.formatContext=_,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:u.chunks.push("</",r,">")}u.lastPushedText=!1}else{switch(r){case Xo:case Ko:case Xs:case Gs:case Ks:De(e,t,i.children);return;case en:De(e,t,i.children);return;case qo:throw Error(re(343));case Qs:e:{r=t.blockedBoundary,u=t.blockedSegment,p=i.fallback,i=i.children,_=new Set;var s={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:_,errorDigest:null},c=nr(e,u.chunks.length,s,u.formatContext,!1,!1);u.children.push(c),u.lastPushedText=!1;var d=nr(e,0,null,u.formatContext,!1,!1);d.parentFlushed=!0,t.blockedBoundary=s,t.blockedSegment=d;try{if(Jr(e,t,i),e.responseState.generateStaticMarkup||d.lastPushedText&&d.textEmbedded&&d.chunks.push("<!-- -->"),d.status=1,ar(s,d),s.pendingTasks===0)break e}catch(f){d.status=4,s.forceClientRender=!0,s.errorDigest=Mt(e,f)}finally{t.blockedBoundary=r,t.blockedSegment=u}t=mi(e,p,r,c,_,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Zs:if(i=Ki(e,t,r.render,i,u),Pt!==0){r=t.treeContext,t.treeContext=Xr(r,1,0);try{De(e,t,i)}finally{t.treeContext=r}}else De(e,t,i);return;case tn:r=r.type,i=Gi(r,i),Gr(e,t,r,i,u);return;case Js:if(u=i.children,r=r._context,i=i.value,p=r._currentValue2,r._currentValue2=i,_=ct,ct=i={parent:_,depth:_===null?0:_.depth+1,context:r,parentValue:p,value:i},t.context=i,De(e,t,u),e=ct,e===null)throw Error(re(403));i=e.parentValue,e.context._currentValue2=i===Go?e.context._defaultValue:i,e=ct=e.parent,t.context=e;return;case Ys:i=i.children,i=i(r._currentValue2),De(e,t,i);return;case di:u=r._init,r=u(r._payload),i=Gi(r,i),Gr(e,t,r,i,void 0);return}throw Error(re(130,r==null?r:typeof r,""))}}function De(e,t,r){if(t.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case Vo:Gr(e,t,r.type,r.props,r.ref);return;case qs:throw Error(re(257));case di:var i=r._init;r=i(r._payload),De(e,t,r);return}if(qr(r)){Ji(e,t,r);return}if(r===null||typeof r!="object"?i=null:(i=Ni&&r[Ni]||r["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(r))){if(r=i.next(),!r.done){var u=[];do u.push(r.value),r=i.next();while(!r.done);Ji(e,t,u)}return}throw e=Object.prototype.toString.call(r),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}typeof r=="string"?(i=t.blockedSegment,i.lastPushedText=Hi(t.blockedSegment.chunks,r,e.responseState,i.lastPushedText)):typeof r=="number"&&(i=t.blockedSegment,i.lastPushedText=Hi(t.blockedSegment.chunks,""+r,e.responseState,i.lastPushedText))}function Ji(e,t,r){for(var i=r.length,u=0;u<i;u++){var p=t.treeContext;t.treeContext=Xr(p,i,u);try{Jr(e,t,r[u])}finally{t.treeContext=p}}}function Jr(e,t,r){var i=t.blockedSegment.formatContext,u=t.legacyContext,p=t.context;try{return De(e,t,r)}catch(c){if(_i(),typeof c=="object"&&c!==null&&typeof c.then=="function"){r=c;var _=t.blockedSegment,s=nr(e,_.chunks.length,null,_.formatContext,_.lastPushedText,!0);_.children.push(s),_.lastPushedText=!1,e=mi(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,r.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=u,t.context=p,ir(p)}else throw t.blockedSegment.formatContext=i,t.legacyContext=u,t.context=p,ir(p),c}}function oa(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,hn(this,t,e)}function cn(e,t,r){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=r===void 0?Error(re(432)):r,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(u){return cn(u,t,r)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function ar(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var r=t.children[0];r.id=t.id,r.parentFlushed=!0,r.status===1&&ar(e,r)}else e.completedSegments.push(t)}function hn(e,t,r){if(t===null){if(r.parentFlushed){if(e.completedRootSegment!==null)throw Error(re(389));e.completedRootSegment=r}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Rt,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(r.parentFlushed&&r.status===1&&ar(t,r),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(oa,e),t.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(ar(t,r),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function un(e){if(e.status!==2){var t=ct,r=Pr.current;Pr.current=qi;var i=Xt;Xt=e.responseState;try{var u=e.pingedTasks,p;for(p=0;p<u.length;p++){var _=u[p],s=e,c=_.blockedSegment;if(c.status===0){ir(_.context);try{De(s,_,_.node),s.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),_.abortSet.delete(_),c.status=1,hn(s,_.blockedBoundary,c)}catch(C){if(_i(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var d=_.ping;C.then(d,d)}else{_.abortSet.delete(_),c.status=4;var f=_.blockedBoundary,h=C,v=Mt(s,h);if(f===null?or(s,h):(f.pendingTasks--,f.forceClientRender||(f.forceClientRender=!0,f.errorDigest=v,f.parentFlushed&&s.clientRenderedBoundaries.push(f))),s.allPendingTasks--,s.allPendingTasks===0){var y=s.onAllReady;y()}}}finally{}}}u.splice(0,p),e.destination!==null&&gi(e,e.destination)}catch(C){Mt(e,C),or(e,C)}finally{Xt=i,Pr.current=r,r===qi&&ir(t)}}}function $t(e,t,r){switch(r.parentFlushed=!0,r.status){case 0:var i=r.id=e.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=i.toString(16),t.push(e),t.push('"></template>');case 1:r.status=2;var u=!0;i=r.chunks;var p=0;r=r.children;for(var _=0;_<r.length;_++){for(u=r[_];p<u.index;p++)t.push(i[p]);u=vr(e,t,u)}for(;p<i.length-1;p++)t.push(i[p]);return p<i.length&&(u=t.push(i[p])),u;default:throw Error(re(390))}}function vr(e,t,r){var i=r.boundary;if(i===null)return $t(e,t,r);if(i.parentFlushed=!0,i.forceClientRender)return e.responseState.generateStaticMarkup||(i=i.errorDigest,t.push("<!--$!-->"),t.push("<template"),i&&(t.push(' data-dgst="'),i=ye(i),t.push(i),t.push('"')),t.push("></template>")),$t(e,t,r),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var u=e.responseState,p=u.nextSuspenseID++;return u=u.boundaryPrefix+p.toString(16),i=i.id=u,Fi(t,e.responseState,i),$t(e,t,r),t.push("<!--/$-->")}if(i.byteSize>e.progressiveChunkSize)return i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),Fi(t,e.responseState,i.id),$t(e,t,r),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),r=i.completedSegments,r.length!==1)throw Error(re(391));return vr(e,t,r[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function Yi(e,t,r){return $o(t,e.responseState,r.formatContext,r.id),vr(e,t,r),Uo(t,r.formatContext)}function Zi(e,t,r){for(var i=r.completedSegments,u=0;u<i.length;u++)dn(e,t,r,i[u]);if(i.length=0,e=e.responseState,i=r.id,r=r.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),i===null)throw Error(re(395));return r=r.toString(16),t.push(i),t.push('","'),t.push(e.segmentPrefix),t.push(r),t.push('")<\/script>')}function dn(e,t,r,i){if(i.status===2)return!0;var u=i.id;if(u===-1){if((i.id=r.rootSegmentID)===-1)throw Error(re(392));return Yi(e,t,i)}return Yi(e,t,i),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),u=u.toString(16),t.push(u),t.push('","'),t.push(e.placeholderPrefix),t.push(u),t.push('")<\/script>')}function gi(e,t){try{var r=e.completedRootSegment;if(r!==null&&e.pendingRootTasks===0){vr(e,t,r),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(r=0;r<i.length-1;r++)t.push(i[r]);r<i.length&&t.push(i[r])}var u=e.clientRenderedBoundaries,p;for(p=0;p<u.length;p++){var _=u[p];i=t;var s=e.responseState,c=_.id,d=_.errorDigest,f=_.errorMessage,h=_.errorComponentStack;if(i.push(s.startInlineScript),s.sentClientRenderFunction?i.push('$RX("'):(s.sentClientRenderFunction=!0,i.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(re(395));if(i.push(c),i.push('"'),d||f||h){i.push(",");var v=Dr(d||"");i.push(v)}if(f||h){i.push(",");var y=Dr(f||"");i.push(y)}if(h){i.push(",");var C=Dr(h);i.push(C)}if(!i.push(")<\/script>")){e.destination=null,p++,u.splice(0,p);return}}u.splice(0,p);var m=e.completedBoundaries;for(p=0;p<m.length;p++)if(!Zi(e,t,m[p])){e.destination=null,p++,m.splice(0,p);return}m.splice(0,p);var n=e.partialBoundaries;for(p=0;p<n.length;p++){var l=n[p];e:{u=e,_=t;var o=l.completedSegments;for(s=0;s<o.length;s++)if(!dn(u,_,l,o[s])){s++,o.splice(0,s);var a=!1;break e}o.splice(0,s),a=!0}if(!a){e.destination=null,p++,n.splice(0,p);return}}n.splice(0,p);var g=e.completedBoundaries;for(p=0;p<g.length;p++)if(!Zi(e,t,g[p])){e.destination=null,p++,g.splice(0,p);return}g.splice(0,p)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function aa(e,t){try{var r=e.abortableTasks;r.forEach(function(i){return cn(i,e,t)}),r.clear(),e.destination!==null&&gi(e,e.destination)}catch(i){Mt(e,i),or(e,i)}}function la(){}function fn(e,t,r,i){var u=!1,p=null,_="",s={push:function(d){return d!==null&&(_+=d),!0},destroy:function(d){u=!0,p=d}},c=!1;if(e=na(e,zo(r,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,la,void 0,function(){c=!0}),un(e),aa(e,i),e.status===1)e.status=2,s.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=s;try{gi(e,s)}catch(d){Mt(e,d),or(e,d)}}if(u)throw p;if(!c)throw Error(re(426));return _}mt.renderToNodeStream=function(){throw Error(re(207))};mt.renderToStaticMarkup=function(e,t){return fn(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};mt.renderToStaticNodeStream=function(){throw Error(re(208))};mt.renderToString=function(e,t){return fn(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};mt.version="18.3.1";var vi={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pn=ae;function se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Pe=null,Me=0;function Z(e,t){if(t.length!==0)if(512<t.length)0<Me&&(e.enqueue(new Uint8Array(Pe.buffer,0,Me)),Pe=new Uint8Array(512),Me=0),e.enqueue(t);else{var r=Pe.length-Me;r<t.length&&(r===0?e.enqueue(Pe):(Pe.set(t.subarray(0,r),Me),e.enqueue(Pe),t=t.subarray(r)),Pe=new Uint8Array(512),Me=0),Pe.set(t,Me),Me+=t.length}}function fe(e,t){return Z(e,t),!0}function Qi(e){Pe&&0<Me&&(e.enqueue(new Uint8Array(Pe.buffer,0,Me)),Pe=null,Me=0)}var _n=new TextEncoder;function ne(e){return _n.encode(e)}function G(e){return _n.encode(e)}function mn(e,t){typeof e.error=="function"?e.error(t):e.close()}var Ee=Object.prototype.hasOwnProperty,ca=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,es={},ts={};function gn(e){return Ee.call(ts,e)?!0:Ee.call(es,e)?!1:ca.test(e)?ts[e]=!0:(es[e]=!0,!1)}function we(e,t,r,i,u,p,_){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=u,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=p,this.removeEmptyString=_}var ge={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ge[e]=new we(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ge[t]=new we(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ge[e]=new we(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ge[e]=new we(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ge[e]=new we(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ge[e]=new we(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ge[e]=new we(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ge[e]=new we(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ge[e]=new we(e,5,!1,e.toLowerCase(),null,!1,!1)});var Si=/[\-:]([a-z])/g;function yi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Si,yi);ge[t]=new we(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Si,yi);ge[t]=new we(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Si,yi);ge[t]=new we(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ge[e]=new we(e,1,!1,e.toLowerCase(),null,!1,!1)});ge.xlinkHref=new we("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ge[e]=new we(e,1,!1,e.toLowerCase(),null,!0,!0)});var Gt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ha=["Webkit","ms","Moz","O"];Object.keys(Gt).forEach(function(e){ha.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gt[t]=Gt[e]})});var ua=/["'&<>]/;function _e(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=ua.exec(e);if(t){var r="",i,u=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}u!==i&&(r+=e.substring(u,i)),u=i+1,r+=t}e=u!==i?r+e.substring(u,i):r}return e}var da=/([A-Z])/g,fa=/^ms-/,Yr=Array.isArray,pa=G("<script>"),_a=G("<\/script>"),ma=G('<script src="'),ga=G('<script type="module" src="'),rs=G('" async=""><\/script>'),va=/(<\/|<)(s)(cript)/gi;function Sa(e,t,r,i){return""+t+(r==="s"?"\\u0073":"\\u0053")+i}function ya(e,t,r,i,u){e=e===void 0?"":e,t=t===void 0?pa:G('<script nonce="'+_e(t)+'">');var p=[];if(r!==void 0&&p.push(t,ne((""+r).replace(va,Sa)),_a),i!==void 0)for(r=0;r<i.length;r++)p.push(ma,ne(_e(i[r])),rs);if(u!==void 0)for(i=0;i<u.length;i++)p.push(ga,ne(_e(u[i])),rs);return{bootstrapChunks:p,startInlineScript:t,placeholderPrefix:G(e+"P:"),segmentPrefix:G(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function ze(e,t){return{insertionMode:e,selectedValue:t}}function Ca(e){return ze(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function wa(e,t,r){switch(t){case"select":return ze(1,r.value!=null?r.value:r.defaultValue);case"svg":return ze(2,null);case"math":return ze(3,null);case"foreignObject":return ze(1,null);case"table":return ze(4,null);case"thead":case"tbody":case"tfoot":return ze(5,null);case"colgroup":return ze(7,null);case"tr":return ze(6,null)}return 4<=e.insertionMode||e.insertionMode===0?ze(1,null):e}var Ci=G("<!-- -->");function is(e,t,r,i){return t===""?i:(i&&e.push(Ci),e.push(ne(_e(t))),!0)}var ss=new Map,ba=G(' style="'),ns=G(":"),xa=G(";");function vn(e,t,r){if(typeof r!="object")throw Error(se(62));t=!0;for(var i in r)if(Ee.call(r,i)){var u=r[i];if(u!=null&&typeof u!="boolean"&&u!==""){if(i.indexOf("--")===0){var p=ne(_e(i));u=ne(_e((""+u).trim()))}else{p=i;var _=ss.get(p);_!==void 0||(_=G(_e(p.replace(da,"-$1").toLowerCase().replace(fa,"-ms-"))),ss.set(p,_)),p=_,u=typeof u=="number"?u===0||Ee.call(Gt,i)?ne(""+u):ne(u+"px"):ne(_e((""+u).trim()))}t?(t=!1,e.push(ba,p,ns,u)):e.push(xa,p,ns,u)}}t||e.push(at)}var et=G(" "),pt=G('="'),at=G('"'),os=G('=""');function Le(e,t,r,i){switch(r){case"style":vn(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(t=ge.hasOwnProperty(r)?ge[r]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(r=ne(t.attributeName),t.type){case 3:i&&e.push(et,r,os);break;case 4:i===!0?e.push(et,r,os):i!==!1&&e.push(et,r,pt,ne(_e(i)),at);break;case 5:isNaN(i)||e.push(et,r,pt,ne(_e(i)),at);break;case 6:!isNaN(i)&&1<=i&&e.push(et,r,pt,ne(_e(i)),at);break;default:t.sanitizeURL&&(i=""+i),e.push(et,r,pt,ne(_e(i)),at)}}else if(gn(r)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=r.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(et,ne(r),pt,ne(_e(i)),at)}}}var tt=G(">"),as=G("/>");function Jt(e,t,r){if(t!=null){if(r!=null)throw Error(se(60));if(typeof t!="object"||!("__html"in t))throw Error(se(61));t=t.__html,t!=null&&e.push(ne(""+t))}}function ka(e){var t="";return pn.Children.forEach(e,function(r){r!=null&&(t+=r)}),t}var Mr=G(' selected=""');function Br(e,t,r,i){e.push(Ve(r));var u=r=null,p;for(p in t)if(Ee.call(t,p)){var _=t[p];if(_!=null)switch(p){case"children":r=_;break;case"dangerouslySetInnerHTML":u=_;break;default:Le(e,i,p,_)}}return e.push(tt),Jt(e,u,r),typeof r=="string"?(e.push(ne(_e(r))),null):r}var Ir=G(`
`),Ea=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ls=new Map;function Ve(e){var t=ls.get(e);if(t===void 0){if(!Ea.test(e))throw Error(se(65,e));t=G("<"+e),ls.set(e,t)}return t}var Ra=G("<!DOCTYPE html>");function Ta(e,t,r,i,u){switch(t){case"select":e.push(Ve("select"));var p=null,_=null;for(f in r)if(Ee.call(r,f)){var s=r[f];if(s!=null)switch(f){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;case"defaultValue":case"value":break;default:Le(e,i,f,s)}}return e.push(tt),Jt(e,_,p),p;case"option":_=u.selectedValue,e.push(Ve("option"));var c=s=null,d=null,f=null;for(p in r)if(Ee.call(r,p)){var h=r[p];if(h!=null)switch(p){case"children":s=h;break;case"selected":d=h;break;case"dangerouslySetInnerHTML":f=h;break;case"value":c=h;default:Le(e,i,p,h)}}if(_!=null)if(r=c!==null?""+c:ka(s),Yr(_)){for(i=0;i<_.length;i++)if(""+_[i]===r){e.push(Mr);break}}else""+_===r&&e.push(Mr);else d&&e.push(Mr);return e.push(tt),Jt(e,f,s),s;case"textarea":e.push(Ve("textarea")),f=_=p=null;for(s in r)if(Ee.call(r,s)&&(c=r[s],c!=null))switch(s){case"children":f=c;break;case"value":p=c;break;case"defaultValue":_=c;break;case"dangerouslySetInnerHTML":throw Error(se(91));default:Le(e,i,s,c)}if(p===null&&_!==null&&(p=_),e.push(tt),f!=null){if(p!=null)throw Error(se(92));if(Yr(f)&&1<f.length)throw Error(se(93));p=""+f}return typeof p=="string"&&p[0]===`
`&&e.push(Ir),p!==null&&e.push(ne(_e(""+p))),null;case"input":e.push(Ve("input")),c=f=s=p=null;for(_ in r)if(Ee.call(r,_)&&(d=r[_],d!=null))switch(_){case"children":case"dangerouslySetInnerHTML":throw Error(se(399,"input"));case"defaultChecked":c=d;break;case"defaultValue":s=d;break;case"checked":f=d;break;case"value":p=d;break;default:Le(e,i,_,d)}return f!==null?Le(e,i,"checked",f):c!==null&&Le(e,i,"checked",c),p!==null?Le(e,i,"value",p):s!==null&&Le(e,i,"value",s),e.push(as),null;case"menuitem":e.push(Ve("menuitem"));for(var v in r)if(Ee.call(r,v)&&(p=r[v],p!=null))switch(v){case"children":case"dangerouslySetInnerHTML":throw Error(se(400));default:Le(e,i,v,p)}return e.push(tt),null;case"title":e.push(Ve("title")),p=null;for(h in r)if(Ee.call(r,h)&&(_=r[h],_!=null))switch(h){case"children":p=_;break;case"dangerouslySetInnerHTML":throw Error(se(434));default:Le(e,i,h,_)}return e.push(tt),p;case"listing":case"pre":e.push(Ve(t)),_=p=null;for(c in r)if(Ee.call(r,c)&&(s=r[c],s!=null))switch(c){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;default:Le(e,i,c,s)}if(e.push(tt),_!=null){if(p!=null)throw Error(se(60));if(typeof _!="object"||!("__html"in _))throw Error(se(61));r=_.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?e.push(Ir,ne(r)):e.push(ne(""+r)))}return typeof p=="string"&&p[0]===`
`&&e.push(Ir),p;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(Ve(t));for(var y in r)if(Ee.call(r,y)&&(p=r[y],p!=null))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(se(399,t));default:Le(e,i,y,p)}return e.push(as),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Br(e,r,t,i);case"html":return u.insertionMode===0&&e.push(Ra),Br(e,r,t,i);default:if(t.indexOf("-")===-1&&typeof r.is!="string")return Br(e,r,t,i);e.push(Ve(t)),_=p=null;for(d in r)if(Ee.call(r,d)&&(s=r[d],s!=null))switch(d){case"children":p=s;break;case"dangerouslySetInnerHTML":_=s;break;case"style":vn(e,i,s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:gn(d)&&typeof s!="function"&&typeof s!="symbol"&&e.push(et,ne(d),pt,ne(_e(s)),at)}return e.push(tt),Jt(e,_,p),p}}var La=G("</"),Aa=G(">"),Da=G('<template id="'),Pa=G('"></template>'),Ma=G("<!--$-->"),Ba=G('<!--$?--><template id="'),Ia=G('"></template>'),Oa=G("<!--$!-->"),Fa=G("<!--/$-->"),Ha=G("<template"),Na=G('"'),Wa=G(' data-dgst="');G(' data-msg="');G(' data-stck="');var $a=G("></template>");function cs(e,t,r){if(Z(e,Ba),r===null)throw Error(se(395));return Z(e,r),fe(e,Ia)}var Ua=G('<div hidden id="'),ja=G('">'),za=G("</div>"),Va=G('<svg aria-hidden="true" style="display:none" id="'),qa=G('">'),Ka=G("</svg>"),Xa=G('<math aria-hidden="true" style="display:none" id="'),Ga=G('">'),Ja=G("</math>"),Ya=G('<table hidden id="'),Za=G('">'),Qa=G("</table>"),el=G('<table hidden><tbody id="'),tl=G('">'),rl=G("</tbody></table>"),il=G('<table hidden><tr id="'),sl=G('">'),nl=G("</tr></table>"),ol=G('<table hidden><colgroup id="'),al=G('">'),ll=G("</colgroup></table>");function cl(e,t,r,i){switch(r.insertionMode){case 0:case 1:return Z(e,Ua),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,ja);case 2:return Z(e,Va),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,qa);case 3:return Z(e,Xa),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,Ga);case 4:return Z(e,Ya),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,Za);case 5:return Z(e,el),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,tl);case 6:return Z(e,il),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,sl);case 7:return Z(e,ol),Z(e,t.segmentPrefix),Z(e,ne(i.toString(16))),fe(e,al);default:throw Error(se(397))}}function hl(e,t){switch(t.insertionMode){case 0:case 1:return fe(e,za);case 2:return fe(e,Ka);case 3:return fe(e,Ja);case 4:return fe(e,Qa);case 5:return fe(e,rl);case 6:return fe(e,nl);case 7:return fe(e,ll);default:throw Error(se(397))}}var ul=G('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),dl=G('$RS("'),fl=G('","'),pl=G('")<\/script>'),_l=G('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),ml=G('$RC("'),gl=G('","'),vl=G('")<\/script>'),Sl=G('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),yl=G('$RX("'),Cl=G('"'),wl=G(")<\/script>"),Or=G(","),bl=/[<\u2028\u2029]/g;function Fr(e){return JSON.stringify(e).replace(bl,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Dt=Object.assign,xl=Symbol.for("react.element"),Sn=Symbol.for("react.portal"),yn=Symbol.for("react.fragment"),Cn=Symbol.for("react.strict_mode"),wn=Symbol.for("react.profiler"),bn=Symbol.for("react.provider"),xn=Symbol.for("react.context"),kn=Symbol.for("react.forward_ref"),En=Symbol.for("react.suspense"),Rn=Symbol.for("react.suspense_list"),Tn=Symbol.for("react.memo"),wi=Symbol.for("react.lazy"),kl=Symbol.for("react.scope"),El=Symbol.for("react.debug_trace_mode"),Rl=Symbol.for("react.legacy_hidden"),Tl=Symbol.for("react.default_value"),hs=Symbol.iterator;function Zr(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yn:return"Fragment";case Sn:return"Portal";case wn:return"Profiler";case Cn:return"StrictMode";case En:return"Suspense";case Rn:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xn:return(e.displayName||"Context")+".Consumer";case bn:return(e._context.displayName||"Context")+".Provider";case kn:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tn:return t=e.displayName||null,t!==null?t:Zr(e.type)||"Memo";case wi:t=e._payload,e=e._init;try{return Zr(e(t))}catch{}}return null}var Ln={};function us(e,t){if(e=e.contextTypes,!e)return Ln;var r={},i;for(i in e)r[i]=t[i];return r}var ht=null;function Sr(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var r=t.parent;if(e===null){if(r!==null)throw Error(se(401))}else{if(r===null)throw Error(se(401));Sr(e,r)}t.context._currentValue=t.value}}function An(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&An(e)}function Dn(e){var t=e.parent;t!==null&&Dn(t),e.context._currentValue=e.value}function Pn(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(se(402));e.depth===t.depth?Sr(e,t):Pn(e,t)}function Mn(e,t){var r=t.parent;if(r===null)throw Error(se(402));e.depth===r.depth?Sr(e,r):Mn(e,r),t.context._currentValue=t.value}function lr(e){var t=ht;t!==e&&(t===null?Dn(e):e===null?An(t):t.depth===e.depth?Sr(t,e):t.depth>e.depth?Pn(t,e):Mn(t,e),ht=e)}var ds={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function fs(e,t,r,i){var u=e.state!==void 0?e.state:null;e.updater=ds,e.props=r,e.state=u;var p={queue:[],replace:!1};e._reactInternals=p;var _=t.contextType;if(e.context=typeof _=="object"&&_!==null?_._currentValue:i,_=t.getDerivedStateFromProps,typeof _=="function"&&(_=_(r,u),u=_==null?u:Dt({},u,_),e.state=u),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&ds.enqueueReplaceState(e,e.state,null),p.queue!==null&&0<p.queue.length)if(t=p.queue,_=p.replace,p.queue=null,p.replace=!1,_&&t.length===1)e.state=t[0];else{for(p=_?t[0]:e.state,u=!0,_=_?1:0;_<t.length;_++){var s=t[_];s=typeof s=="function"?s.call(e,p,r,i):s,s!=null&&(u?(u=!1,p=Dt({},p,s)):Dt(p,s))}e.state=p}else p.queue=null}var Ll={id:1,overflow:""};function Qr(e,t,r){var i=e.id;e=e.overflow;var u=32-Yt(i)-1;i&=~(1<<u),r+=1;var p=32-Yt(t)+u;if(30<p){var _=u-u%5;return p=(i&(1<<_)-1).toString(32),i>>=_,u-=_,{id:1<<32-Yt(t)+u|r<<u|i,overflow:p+e}}return{id:1<<p|r<<u|i,overflow:e}}var Yt=Math.clz32?Math.clz32:Pl,Al=Math.log,Dl=Math.LN2;function Pl(e){return e>>>=0,e===0?32:31-(Al(e)/Dl|0)|0}function Ml(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bl=typeof Object.is=="function"?Object.is:Ml,Ge=null,bi=null,Zt=null,ue=null,Tt=!1,cr=!1,Bt=0,it=null,yr=0;function lt(){if(Ge===null)throw Error(se(321));return Ge}function ps(){if(0<yr)throw Error(se(312));return{memoizedState:null,queue:null,next:null}}function xi(){return ue===null?Zt===null?(Tt=!1,Zt=ue=ps()):(Tt=!0,ue=Zt):ue.next===null?(Tt=!1,ue=ue.next=ps()):(Tt=!0,ue=ue.next),ue}function ki(){bi=Ge=null,cr=!1,Zt=null,yr=0,ue=it=null}function Bn(e,t){return typeof t=="function"?t(e):t}function _s(e,t,r){if(Ge=lt(),ue=xi(),Tt){var i=ue.queue;if(t=i.dispatch,it!==null&&(r=it.get(i),r!==void 0)){it.delete(i),i=ue.memoizedState;do i=e(i,r.action),r=r.next;while(r!==null);return ue.memoizedState=i,[i,t]}return[ue.memoizedState,t]}return e=e===Bn?typeof t=="function"?t():t:r!==void 0?r(t):t,ue.memoizedState=e,e=ue.queue={last:null,dispatch:null},e=e.dispatch=Il.bind(null,Ge,e),[ue.memoizedState,e]}function ms(e,t){if(Ge=lt(),ue=xi(),t=t===void 0?null:t,ue!==null){var r=ue.memoizedState;if(r!==null&&t!==null){var i=r[1];e:if(i===null)i=!1;else{for(var u=0;u<i.length&&u<t.length;u++)if(!Bl(t[u],i[u])){i=!1;break e}i=!0}if(i)return r[0]}}return e=e(),ue.memoizedState=[e,t],e}function Il(e,t,r){if(25<=yr)throw Error(se(301));if(e===Ge)if(cr=!0,e={action:r,next:null},it===null&&(it=new Map),r=it.get(t),r===void 0)it.set(t,e);else{for(t=r;t.next!==null;)t=t.next;t.next=e}}function Ol(){throw Error(se(394))}function Ut(){}var gs={readContext:function(e){return e._currentValue},useContext:function(e){return lt(),e._currentValue},useMemo:ms,useReducer:_s,useRef:function(e){Ge=lt(),ue=xi();var t=ue.memoizedState;return t===null?(e={current:e},ue.memoizedState=e):t},useState:function(e){return _s(Bn,e)},useInsertionEffect:Ut,useLayoutEffect:function(){},useCallback:function(e,t){return ms(function(){return e},t)},useImperativeHandle:Ut,useEffect:Ut,useDebugValue:Ut,useDeferredValue:function(e){return lt(),e},useTransition:function(){return lt(),[!1,Ol]},useId:function(){var e=bi.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Yt(e)-1)).toString(32)+t;var r=Qt;if(r===null)throw Error(se(404));return t=Bt++,e=":"+r.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return lt(),t(e._source)},useSyncExternalStore:function(e,t,r){if(r===void 0)throw Error(se(407));return r()}},Qt=null,Hr=pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Fl(e){return console.error(e),null}function Lt(){}function Hl(e,t,r,i,u,p,_,s,c){var d=[],f=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:f,pingedTasks:d,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:u===void 0?Fl:u,onAllReady:p===void 0?Lt:p,onShellReady:_===void 0?Lt:_,onShellError:s===void 0?Lt:s,onFatalError:c===void 0?Lt:c},r=hr(t,0,null,r,!1,!1),r.parentFlushed=!0,e=Ei(t,e,null,r,f,Ln,null,Ll),d.push(e),t}function Ei(e,t,r,i,u,p,_,s){e.allPendingTasks++,r===null?e.pendingRootTasks++:r.pendingTasks++;var c={node:t,ping:function(){var d=e.pingedTasks;d.push(c),d.length===1&&Fn(e)},blockedBoundary:r,blockedSegment:i,abortSet:u,legacyContext:p,context:_,treeContext:s};return u.add(c),c}function hr(e,t,r,i,u,p){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:r,lastPushedText:u,textEmbedded:p}}function It(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function ur(e,t){var r=e.onShellError;r(t),r=e.onFatalError,r(t),e.destination!==null?(e.status=2,mn(e.destination,t)):(e.status=1,e.fatalError=t)}function vs(e,t,r,i,u){for(Ge={},bi=t,Bt=0,e=r(i,u);cr;)cr=!1,Bt=0,yr+=1,ue=null,e=r(i,u);return ki(),e}function Ss(e,t,r,i){var u=r.render(),p=i.childContextTypes;if(p!=null){var _=t.legacyContext;if(typeof r.getChildContext!="function")i=_;else{r=r.getChildContext();for(var s in r)if(!(s in p))throw Error(se(108,Zr(i)||"Unknown",s));i=Dt({},_,r)}t.legacyContext=i,Be(e,t,u),t.legacyContext=_}else Be(e,t,u)}function ys(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ei(e,t,r,i,u){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){u=us(r,t.legacyContext);var p=r.contextType;p=new r(i,typeof p=="object"&&p!==null?p._currentValue:u),fs(p,r,i,u),Ss(e,t,p,r)}else{p=us(r,t.legacyContext),u=vs(e,t,r,i,p);var _=Bt!==0;if(typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0)fs(u,r,i,p),Ss(e,t,u,r);else if(_){i=t.treeContext,t.treeContext=Qr(i,1,0);try{Be(e,t,u)}finally{t.treeContext=i}}else Be(e,t,u)}else if(typeof r=="string"){switch(u=t.blockedSegment,p=Ta(u.chunks,r,i,e.responseState,u.formatContext),u.lastPushedText=!1,_=u.formatContext,u.formatContext=wa(_,r,i),ti(e,t,p),u.formatContext=_,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:u.chunks.push(La,ne(r),Aa)}u.lastPushedText=!1}else{switch(r){case Rl:case El:case Cn:case wn:case yn:Be(e,t,i.children);return;case Rn:Be(e,t,i.children);return;case kl:throw Error(se(343));case En:e:{r=t.blockedBoundary,u=t.blockedSegment,p=i.fallback,i=i.children,_=new Set;var s={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:_,errorDigest:null},c=hr(e,u.chunks.length,s,u.formatContext,!1,!1);u.children.push(c),u.lastPushedText=!1;var d=hr(e,0,null,u.formatContext,!1,!1);d.parentFlushed=!0,t.blockedBoundary=s,t.blockedSegment=d;try{if(ti(e,t,i),d.lastPushedText&&d.textEmbedded&&d.chunks.push(Ci),d.status=1,dr(s,d),s.pendingTasks===0)break e}catch(f){d.status=4,s.forceClientRender=!0,s.errorDigest=It(e,f)}finally{t.blockedBoundary=r,t.blockedSegment=u}t=Ei(e,p,r,c,_,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case kn:if(i=vs(e,t,r.render,i,u),Bt!==0){r=t.treeContext,t.treeContext=Qr(r,1,0);try{Be(e,t,i)}finally{t.treeContext=r}}else Be(e,t,i);return;case Tn:r=r.type,i=ys(r,i),ei(e,t,r,i,u);return;case bn:if(u=i.children,r=r._context,i=i.value,p=r._currentValue,r._currentValue=i,_=ht,ht=i={parent:_,depth:_===null?0:_.depth+1,context:r,parentValue:p,value:i},t.context=i,Be(e,t,u),e=ht,e===null)throw Error(se(403));i=e.parentValue,e.context._currentValue=i===Tl?e.context._defaultValue:i,e=ht=e.parent,t.context=e;return;case xn:i=i.children,i=i(r._currentValue),Be(e,t,i);return;case wi:u=r._init,r=u(r._payload),i=ys(r,i),ei(e,t,r,i,void 0);return}throw Error(se(130,r==null?r:typeof r,""))}}function Be(e,t,r){if(t.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case xl:ei(e,t,r.type,r.props,r.ref);return;case Sn:throw Error(se(257));case wi:var i=r._init;r=i(r._payload),Be(e,t,r);return}if(Yr(r)){Cs(e,t,r);return}if(r===null||typeof r!="object"?i=null:(i=hs&&r[hs]||r["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(r))){if(r=i.next(),!r.done){var u=[];do u.push(r.value),r=i.next();while(!r.done);Cs(e,t,u)}return}throw e=Object.prototype.toString.call(r),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}typeof r=="string"?(i=t.blockedSegment,i.lastPushedText=is(t.blockedSegment.chunks,r,e.responseState,i.lastPushedText)):typeof r=="number"&&(i=t.blockedSegment,i.lastPushedText=is(t.blockedSegment.chunks,""+r,e.responseState,i.lastPushedText))}function Cs(e,t,r){for(var i=r.length,u=0;u<i;u++){var p=t.treeContext;t.treeContext=Qr(p,i,u);try{ti(e,t,r[u])}finally{t.treeContext=p}}}function ti(e,t,r){var i=t.blockedSegment.formatContext,u=t.legacyContext,p=t.context;try{return Be(e,t,r)}catch(c){if(ki(),typeof c=="object"&&c!==null&&typeof c.then=="function"){r=c;var _=t.blockedSegment,s=hr(e,_.chunks.length,null,_.formatContext,_.lastPushedText,!0);_.children.push(s),_.lastPushedText=!1,e=Ei(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,r.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=u,t.context=p,lr(p)}else throw t.blockedSegment.formatContext=i,t.legacyContext=u,t.context=p,lr(p),c}}function Nl(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,On(this,t,e)}function In(e,t,r){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=r===void 0?Error(se(432)):r,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(u){return In(u,t,r)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function dr(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var r=t.children[0];r.id=t.id,r.parentFlushed=!0,r.status===1&&dr(e,r)}else e.completedSegments.push(t)}function On(e,t,r){if(t===null){if(r.parentFlushed){if(e.completedRootSegment!==null)throw Error(se(389));e.completedRootSegment=r}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Lt,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(r.parentFlushed&&r.status===1&&dr(t,r),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Nl,e),t.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(dr(t,r),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function Fn(e){if(e.status!==2){var t=ht,r=Hr.current;Hr.current=gs;var i=Qt;Qt=e.responseState;try{var u=e.pingedTasks,p;for(p=0;p<u.length;p++){var _=u[p],s=e,c=_.blockedSegment;if(c.status===0){lr(_.context);try{Be(s,_,_.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(Ci),_.abortSet.delete(_),c.status=1,On(s,_.blockedBoundary,c)}catch(C){if(ki(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var d=_.ping;C.then(d,d)}else{_.abortSet.delete(_),c.status=4;var f=_.blockedBoundary,h=C,v=It(s,h);if(f===null?ur(s,h):(f.pendingTasks--,f.forceClientRender||(f.forceClientRender=!0,f.errorDigest=v,f.parentFlushed&&s.clientRenderedBoundaries.push(f))),s.allPendingTasks--,s.allPendingTasks===0){var y=s.onAllReady;y()}}}finally{}}}u.splice(0,p),e.destination!==null&&Ri(e,e.destination)}catch(C){It(e,C),ur(e,C)}finally{Qt=i,Hr.current=r,r===gs&&lr(t)}}}function jt(e,t,r){switch(r.parentFlushed=!0,r.status){case 0:var i=r.id=e.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,e=e.responseState,Z(t,Da),Z(t,e.placeholderPrefix),e=ne(i.toString(16)),Z(t,e),fe(t,Pa);case 1:r.status=2;var u=!0;i=r.chunks;var p=0;r=r.children;for(var _=0;_<r.length;_++){for(u=r[_];p<u.index;p++)Z(t,i[p]);u=Cr(e,t,u)}for(;p<i.length-1;p++)Z(t,i[p]);return p<i.length&&(u=fe(t,i[p])),u;default:throw Error(se(390))}}function Cr(e,t,r){var i=r.boundary;if(i===null)return jt(e,t,r);if(i.parentFlushed=!0,i.forceClientRender)i=i.errorDigest,fe(t,Oa),Z(t,Ha),i&&(Z(t,Wa),Z(t,ne(_e(i))),Z(t,Na)),fe(t,$a),jt(e,t,r);else if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var u=e.responseState,p=u.nextSuspenseID++;u=G(u.boundaryPrefix+p.toString(16)),i=i.id=u,cs(t,e.responseState,i),jt(e,t,r)}else if(i.byteSize>e.progressiveChunkSize)i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),cs(t,e.responseState,i.id),jt(e,t,r);else{if(fe(t,Ma),r=i.completedSegments,r.length!==1)throw Error(se(391));Cr(e,t,r[0])}return fe(t,Fa)}function ws(e,t,r){return cl(t,e.responseState,r.formatContext,r.id),Cr(e,t,r),hl(t,r.formatContext)}function bs(e,t,r){for(var i=r.completedSegments,u=0;u<i.length;u++)Hn(e,t,r,i[u]);if(i.length=0,e=e.responseState,i=r.id,r=r.rootSegmentID,Z(t,e.startInlineScript),e.sentCompleteBoundaryFunction?Z(t,ml):(e.sentCompleteBoundaryFunction=!0,Z(t,_l)),i===null)throw Error(se(395));return r=ne(r.toString(16)),Z(t,i),Z(t,gl),Z(t,e.segmentPrefix),Z(t,r),fe(t,vl)}function Hn(e,t,r,i){if(i.status===2)return!0;var u=i.id;if(u===-1){if((i.id=r.rootSegmentID)===-1)throw Error(se(392));return ws(e,t,i)}return ws(e,t,i),e=e.responseState,Z(t,e.startInlineScript),e.sentCompleteSegmentFunction?Z(t,dl):(e.sentCompleteSegmentFunction=!0,Z(t,ul)),Z(t,e.segmentPrefix),u=ne(u.toString(16)),Z(t,u),Z(t,fl),Z(t,e.placeholderPrefix),Z(t,u),fe(t,pl)}function Ri(e,t){Pe=new Uint8Array(512),Me=0;try{var r=e.completedRootSegment;if(r!==null&&e.pendingRootTasks===0){Cr(e,t,r),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(r=0;r<i.length-1;r++)Z(t,i[r]);r<i.length&&fe(t,i[r])}var u=e.clientRenderedBoundaries,p;for(p=0;p<u.length;p++){var _=u[p];i=t;var s=e.responseState,c=_.id,d=_.errorDigest,f=_.errorMessage,h=_.errorComponentStack;if(Z(i,s.startInlineScript),s.sentClientRenderFunction?Z(i,yl):(s.sentClientRenderFunction=!0,Z(i,Sl)),c===null)throw Error(se(395));Z(i,c),Z(i,Cl),(d||f||h)&&(Z(i,Or),Z(i,ne(Fr(d||"")))),(f||h)&&(Z(i,Or),Z(i,ne(Fr(f||"")))),h&&(Z(i,Or),Z(i,ne(Fr(h)))),fe(i,wl)}u.splice(0,p);var v=e.completedBoundaries;for(p=0;p<v.length;p++)bs(e,t,v[p]);v.splice(0,p),Qi(t),Pe=new Uint8Array(512),Me=0;var y=e.partialBoundaries;for(p=0;p<y.length;p++){var C=y[p];e:{u=e,_=t;var m=C.completedSegments;for(s=0;s<m.length;s++)if(!Hn(u,_,C,m[s])){s++,m.splice(0,s);var n=!1;break e}m.splice(0,s),n=!0}if(!n){e.destination=null,p++,y.splice(0,p);return}}y.splice(0,p);var l=e.completedBoundaries;for(p=0;p<l.length;p++)bs(e,t,l[p]);l.splice(0,p)}finally{Qi(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function xs(e,t){try{var r=e.abortableTasks;r.forEach(function(i){return In(i,e,t)}),r.clear(),e.destination!==null&&Ri(e,e.destination)}catch(i){It(e,i),ur(e,i)}}vi.renderToReadableStream=function(e,t){return new Promise(function(r,i){var u,p,_=new Promise(function(f,h){p=f,u=h}),s=Hl(e,ya(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),Ca(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,p,function(){var f=new ReadableStream({type:"bytes",pull:function(h){if(s.status===1)s.status=2,mn(h,s.fatalError);else if(s.status!==2&&s.destination===null){s.destination=h;try{Ri(s,h)}catch(v){It(s,v),ur(s,v)}}},cancel:function(){xs(s)}},{highWaterMark:0});f.allReady=_,r(f)},function(f){_.catch(function(){}),i(f)},u);if(t&&t.signal){var c=t.signal,d=function(){xs(s,c.reason),c.removeEventListener("abort",d)};c.addEventListener("abort",d)}Fn(s)})};vi.version="18.3.1";var gt,Nn;gt=mt,Nn=vi;st.version=gt.version;st.renderToString=gt.renderToString;st.renderToStaticMarkup=gt.renderToStaticMarkup;st.renderToNodeStream=gt.renderToNodeStream;st.renderToStaticNodeStream=gt.renderToStaticNodeStream;st.renderToReadableStream=Nn.renderToReadableStream;class Wl{preview;constructor(t){this.preview=t,this.preview.autoplay=!0,this.preview.muted=!0,this.preview.setAttribute("playsinline",""),this.preview.setAttribute("webkit-playsinline",""),this.preview.setAttribute("x5-playsinline","")}toggleVideo=t=>{t?navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(r=>this.preview.srcObject=r):(console.log("this.preview.srcObject:",this.preview.srcObject,"setOn:",t),this.preview.srcObject&&(this.preview.srcObject.getTracks().forEach(i=>i.stop()),this.preview.srcObject=null),this.preview.srcObject=null),this.preview.hidden=!t}}const fr=pe.createContext(null),$l=[{prompt:"The most important key is the Return (ENTER) key. Press the thumb tip and release. You'll use this key to enter every command.",phrase:["Return (ENTER)"],unlocked:!1},{prompt:"Type `fdsa` & Enter. Notice that it requires finger-pinch only.",phrase:"fdsa".split(""),unlocked:!1},{prompt:"Type `jkl;`. Notice that it requires finger-grasp only.",phrase:"jkl;".split(""),unlocked:!1},{prompt:"Press the thumb tip followed by a finger tip to type numbers 1-4",phrase:"1234".split(""),unlocked:!1},{prompt:"Many characters require combinations followed by releasing all keys. Type `zxcv` and we'll show corrections as you type.",phrase:"zxcv".split(""),unlocked:!1}];function ks(e){if(!Array.isArray(e.achievement.phrase))throw new Error("achievement is undefined");const t=e.achievement.phrase;if(t.length===0)throw new Error("achievement is undefined");return Y.jsxs("div",{className:"tutorial-component",hidden:!e.isInTutorial,children:[Y.jsx("pre",{className:"tutorial-prompt",children:e.achievement.prompt}),Y.jsx("div",{className:"chord-display-container",children:t.map((r,i)=>Y.jsx(rr,{displayChar:r},i))})]})}function Wn(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ul}=Object.prototype,{getPrototypeOf:Ti}=Object,wr=(e=>t=>{const r=Ul.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),$e=e=>(e=e.toLowerCase(),t=>wr(t)===e),br=e=>t=>typeof t===e,{isArray:vt}=Array,Ot=br("undefined");function jl(e){return e!==null&&!Ot(e)&&e.constructor!==null&&!Ot(e.constructor)&&Oe(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const $n=$e("ArrayBuffer");function zl(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&$n(e.buffer),t}const Vl=br("string"),Oe=br("function"),Un=br("number"),xr=e=>e!==null&&typeof e=="object",ql=e=>e===!0||e===!1,er=e=>{if(wr(e)!=="object")return!1;const t=Ti(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Kl=$e("Date"),Xl=$e("File"),Gl=$e("Blob"),Jl=$e("FileList"),Yl=e=>xr(e)&&Oe(e.pipe),Zl=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Oe(e.append)&&((t=wr(e))==="formdata"||t==="object"&&Oe(e.toString)&&e.toString()==="[object FormData]"))},Ql=$e("URLSearchParams"),[ec,tc,rc,ic]=["ReadableStream","Request","Response","Headers"].map($e),sc=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ft(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,u;if(typeof e!="object"&&(e=[e]),vt(e))for(i=0,u=e.length;i<u;i++)t.call(null,e[i],i,e);else{const p=r?Object.getOwnPropertyNames(e):Object.keys(e),_=p.length;let s;for(i=0;i<_;i++)s=p[i],t.call(null,e[s],s,e)}}function jn(e,t){t=t.toLowerCase();const r=Object.keys(e);let i=r.length,u;for(;i-- >0;)if(u=r[i],t===u.toLowerCase())return u;return null}const zn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Vn=e=>!Ot(e)&&e!==zn;function ri(){const{caseless:e}=Vn(this)&&this||{},t={},r=(i,u)=>{const p=e&&jn(t,u)||u;er(t[p])&&er(i)?t[p]=ri(t[p],i):er(i)?t[p]=ri({},i):vt(i)?t[p]=i.slice():t[p]=i};for(let i=0,u=arguments.length;i<u;i++)arguments[i]&&Ft(arguments[i],r);return t}const nc=(e,t,r,{allOwnKeys:i}={})=>(Ft(t,(u,p)=>{r&&Oe(u)?e[p]=Wn(u,r):e[p]=u},{allOwnKeys:i}),e),oc=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ac=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},lc=(e,t,r,i)=>{let u,p,_;const s={};if(t=t||{},e==null)return t;do{for(u=Object.getOwnPropertyNames(e),p=u.length;p-- >0;)_=u[p],(!i||i(_,e,t))&&!s[_]&&(t[_]=e[_],s[_]=!0);e=r!==!1&&Ti(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},cc=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},hc=e=>{if(!e)return null;if(vt(e))return e;let t=e.length;if(!Un(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},uc=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ti(Uint8Array)),dc=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let u;for(;(u=i.next())&&!u.done;){const p=u.value;t.call(e,p[0],p[1])}},fc=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},pc=$e("HTMLFormElement"),_c=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,u){return i.toUpperCase()+u}),Es=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),mc=$e("RegExp"),qn=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};Ft(r,(u,p)=>{let _;(_=t(u,p,e))!==!1&&(i[p]=_||u)}),Object.defineProperties(e,i)},gc=e=>{qn(e,(t,r)=>{if(Oe(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(Oe(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},vc=(e,t)=>{const r={},i=u=>{u.forEach(p=>{r[p]=!0})};return vt(e)?i(e):i(String(e).split(t)),r},Sc=()=>{},yc=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Nr="abcdefghijklmnopqrstuvwxyz",Rs="0123456789",Kn={DIGIT:Rs,ALPHA:Nr,ALPHA_DIGIT:Nr+Nr.toUpperCase()+Rs},Cc=(e=16,t=Kn.ALPHA_DIGIT)=>{let r="";const{length:i}=t;for(;e--;)r+=t[Math.random()*i|0];return r};function wc(e){return!!(e&&Oe(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const bc=e=>{const t=new Array(10),r=(i,u)=>{if(xr(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[u]=i;const p=vt(i)?[]:{};return Ft(i,(_,s)=>{const c=r(_,u+1);!Ot(c)&&(p[s]=c)}),t[u]=void 0,p}}return i};return r(e,0)},xc=$e("AsyncFunction"),kc=e=>e&&(xr(e)||Oe(e))&&Oe(e.then)&&Oe(e.catch),H={isArray:vt,isArrayBuffer:$n,isBuffer:jl,isFormData:Zl,isArrayBufferView:zl,isString:Vl,isNumber:Un,isBoolean:ql,isObject:xr,isPlainObject:er,isReadableStream:ec,isRequest:tc,isResponse:rc,isHeaders:ic,isUndefined:Ot,isDate:Kl,isFile:Xl,isBlob:Gl,isRegExp:mc,isFunction:Oe,isStream:Yl,isURLSearchParams:Ql,isTypedArray:uc,isFileList:Jl,forEach:Ft,merge:ri,extend:nc,trim:sc,stripBOM:oc,inherits:ac,toFlatObject:lc,kindOf:wr,kindOfTest:$e,endsWith:cc,toArray:hc,forEachEntry:dc,matchAll:fc,isHTMLForm:pc,hasOwnProperty:Es,hasOwnProp:Es,reduceDescriptors:qn,freezeMethods:gc,toObjectSet:vc,toCamelCase:_c,noop:Sc,toFiniteNumber:yc,findKey:jn,global:zn,isContextDefined:Vn,ALPHABET:Kn,generateString:Cc,isSpecCompliantForm:wc,toJSONObject:bc,isAsyncFn:xc,isThenable:kc};function ie(e,t,r,i,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),u&&(this.response=u)}H.inherits(ie,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Xn=ie.prototype,Gn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Gn[e]={value:e}});Object.defineProperties(ie,Gn);Object.defineProperty(Xn,"isAxiosError",{value:!0});ie.from=(e,t,r,i,u,p)=>{const _=Object.create(Xn);return H.toFlatObject(e,_,function(c){return c!==Error.prototype},s=>s!=="isAxiosError"),ie.call(_,e.message,t,r,i,u),_.cause=e,_.name=e.name,p&&Object.assign(_,p),_};const Ec=null;function ii(e){return H.isPlainObject(e)||H.isArray(e)}function Jn(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function Ts(e,t,r){return e?e.concat(t).map(function(u,p){return u=Jn(u),!r&&p?"["+u+"]":u}).join(r?".":""):t}function Rc(e){return H.isArray(e)&&!e.some(ii)}const Tc=H.toFlatObject(H,{},null,function(t){return/^is[A-Z]/.test(t)});function kr(e,t,r){if(!H.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=H.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,n){return!H.isUndefined(n[m])});const i=r.metaTokens,u=r.visitor||f,p=r.dots,_=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(u))throw new TypeError("visitor must be a function");function d(C){if(C===null)return"";if(H.isDate(C))return C.toISOString();if(!c&&H.isBlob(C))throw new ie("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(C)||H.isTypedArray(C)?c&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function f(C,m,n){let l=C;if(C&&!n&&typeof C=="object"){if(H.endsWith(m,"{}"))m=i?m:m.slice(0,-2),C=JSON.stringify(C);else if(H.isArray(C)&&Rc(C)||(H.isFileList(C)||H.endsWith(m,"[]"))&&(l=H.toArray(C)))return m=Jn(m),l.forEach(function(a,g){!(H.isUndefined(a)||a===null)&&t.append(_===!0?Ts([m],g,p):_===null?m:m+"[]",d(a))}),!1}return ii(C)?!0:(t.append(Ts(n,m,p),d(C)),!1)}const h=[],v=Object.assign(Tc,{defaultVisitor:f,convertValue:d,isVisitable:ii});function y(C,m){if(!H.isUndefined(C)){if(h.indexOf(C)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(C),H.forEach(C,function(l,o){(!(H.isUndefined(l)||l===null)&&u.call(t,l,H.isString(o)?o.trim():o,m,v))===!0&&y(l,m?m.concat(o):[o])}),h.pop()}}if(!H.isObject(e))throw new TypeError("data must be an object");return y(e),t}function Ls(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Li(e,t){this._pairs=[],e&&kr(e,this,t)}const Yn=Li.prototype;Yn.append=function(t,r){this._pairs.push([t,r])};Yn.toString=function(t){const r=t?function(i){return t.call(this,i,Ls)}:Ls;return this._pairs.map(function(u){return r(u[0])+"="+r(u[1])},"").join("&")};function Lc(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Zn(e,t,r){if(!t)return e;const i=r&&r.encode||Lc,u=r&&r.serialize;let p;if(u?p=u(t,r):p=H.isURLSearchParams(t)?t.toString():new Li(t,r).toString(i),p){const _=e.indexOf("#");_!==-1&&(e=e.slice(0,_)),e+=(e.indexOf("?")===-1?"?":"&")+p}return e}class As{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){H.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Qn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ac=typeof URLSearchParams<"u"?URLSearchParams:Li,Dc=typeof FormData<"u"?FormData:null,Pc=typeof Blob<"u"?Blob:null,Mc={isBrowser:!0,classes:{URLSearchParams:Ac,FormData:Dc,Blob:Pc},protocols:["http","https","file","blob","url","data"]},Ai=typeof window<"u"&&typeof document<"u",Bc=(e=>Ai&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Ic=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Oc=Ai&&window.location.href||"http://localhost",Fc=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ai,hasStandardBrowserEnv:Bc,hasStandardBrowserWebWorkerEnv:Ic,origin:Oc},Symbol.toStringTag,{value:"Module"})),We={...Fc,...Mc};function Hc(e,t){return kr(e,new We.classes.URLSearchParams,Object.assign({visitor:function(r,i,u,p){return We.isNode&&H.isBuffer(r)?(this.append(i,r.toString("base64")),!1):p.defaultVisitor.apply(this,arguments)}},t))}function Nc(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Wc(e){const t={},r=Object.keys(e);let i;const u=r.length;let p;for(i=0;i<u;i++)p=r[i],t[p]=e[p];return t}function eo(e){function t(r,i,u,p){let _=r[p++];if(_==="__proto__")return!0;const s=Number.isFinite(+_),c=p>=r.length;return _=!_&&H.isArray(u)?u.length:_,c?(H.hasOwnProp(u,_)?u[_]=[u[_],i]:u[_]=i,!s):((!u[_]||!H.isObject(u[_]))&&(u[_]=[]),t(r,i,u[_],p)&&H.isArray(u[_])&&(u[_]=Wc(u[_])),!s)}if(H.isFormData(e)&&H.isFunction(e.entries)){const r={};return H.forEachEntry(e,(i,u)=>{t(Nc(i),u,r,0)}),r}return null}function $c(e,t,r){if(H.isString(e))try{return(t||JSON.parse)(e),H.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}const Ht={transitional:Qn,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",u=i.indexOf("application/json")>-1,p=H.isObject(t);if(p&&H.isHTMLForm(t)&&(t=new FormData(t)),H.isFormData(t))return u?JSON.stringify(eo(t)):t;if(H.isArrayBuffer(t)||H.isBuffer(t)||H.isStream(t)||H.isFile(t)||H.isBlob(t)||H.isReadableStream(t))return t;if(H.isArrayBufferView(t))return t.buffer;if(H.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(p){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Hc(t,this.formSerializer).toString();if((s=H.isFileList(t))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return kr(s?{"files[]":t}:t,c&&new c,this.formSerializer)}}return p||u?(r.setContentType("application/json",!1),$c(t)):t}],transformResponse:[function(t){const r=this.transitional||Ht.transitional,i=r&&r.forcedJSONParsing,u=this.responseType==="json";if(H.isResponse(t)||H.isReadableStream(t))return t;if(t&&H.isString(t)&&(i&&!this.responseType||u)){const _=!(r&&r.silentJSONParsing)&&u;try{return JSON.parse(t)}catch(s){if(_)throw s.name==="SyntaxError"?ie.from(s,ie.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:We.classes.FormData,Blob:We.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],e=>{Ht.headers[e]={}});const Uc=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jc=e=>{const t={};let r,i,u;return e&&e.split(`
`).forEach(function(_){u=_.indexOf(":"),r=_.substring(0,u).trim().toLowerCase(),i=_.substring(u+1).trim(),!(!r||t[r]&&Uc[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},Ds=Symbol("internals");function bt(e){return e&&String(e).trim().toLowerCase()}function tr(e){return e===!1||e==null?e:H.isArray(e)?e.map(tr):String(e)}function zc(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const Vc=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Wr(e,t,r,i,u){if(H.isFunction(i))return i.call(this,t,r);if(u&&(t=r),!!H.isString(t)){if(H.isString(i))return t.indexOf(i)!==-1;if(H.isRegExp(i))return i.test(t)}}function qc(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function Kc(e,t){const r=H.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(u,p,_){return this[i].call(this,t,u,p,_)},configurable:!0})})}class Re{constructor(t){t&&this.set(t)}set(t,r,i){const u=this;function p(s,c,d){const f=bt(c);if(!f)throw new Error("header name must be a non-empty string");const h=H.findKey(u,f);(!h||u[h]===void 0||d===!0||d===void 0&&u[h]!==!1)&&(u[h||c]=tr(s))}const _=(s,c)=>H.forEach(s,(d,f)=>p(d,f,c));if(H.isPlainObject(t)||t instanceof this.constructor)_(t,r);else if(H.isString(t)&&(t=t.trim())&&!Vc(t))_(jc(t),r);else if(H.isHeaders(t))for(const[s,c]of t.entries())p(c,s,i);else t!=null&&p(r,t,i);return this}get(t,r){if(t=bt(t),t){const i=H.findKey(this,t);if(i){const u=this[i];if(!r)return u;if(r===!0)return zc(u);if(H.isFunction(r))return r.call(this,u,i);if(H.isRegExp(r))return r.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=bt(t),t){const i=H.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||Wr(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let u=!1;function p(_){if(_=bt(_),_){const s=H.findKey(i,_);s&&(!r||Wr(i,i[s],s,r))&&(delete i[s],u=!0)}}return H.isArray(t)?t.forEach(p):p(t),u}clear(t){const r=Object.keys(this);let i=r.length,u=!1;for(;i--;){const p=r[i];(!t||Wr(this,this[p],p,t,!0))&&(delete this[p],u=!0)}return u}normalize(t){const r=this,i={};return H.forEach(this,(u,p)=>{const _=H.findKey(i,p);if(_){r[_]=tr(u),delete r[p];return}const s=t?qc(p):String(p).trim();s!==p&&delete r[p],r[s]=tr(u),i[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return H.forEach(this,(i,u)=>{i!=null&&i!==!1&&(r[u]=t&&H.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(u=>i.set(u)),i}static accessor(t){const i=(this[Ds]=this[Ds]={accessors:{}}).accessors,u=this.prototype;function p(_){const s=bt(_);i[s]||(Kc(u,_),i[s]=!0)}return H.isArray(t)?t.forEach(p):p(t),this}}Re.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(Re.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});H.freezeMethods(Re);function $r(e,t){const r=this||Ht,i=t||r,u=Re.from(i.headers);let p=i.data;return H.forEach(e,function(s){p=s.call(r,p,u.normalize(),t?t.status:void 0)}),u.normalize(),p}function to(e){return!!(e&&e.__CANCEL__)}function St(e,t,r){ie.call(this,e??"canceled",ie.ERR_CANCELED,t,r),this.name="CanceledError"}H.inherits(St,ie,{__CANCEL__:!0});function ro(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new ie("Request failed with status code "+r.status,[ie.ERR_BAD_REQUEST,ie.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Xc(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Gc(e,t){e=e||10;const r=new Array(e),i=new Array(e);let u=0,p=0,_;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),f=i[p];_||(_=d),r[u]=c,i[u]=d;let h=p,v=0;for(;h!==u;)v+=r[h++],h=h%e;if(u=(u+1)%e,u===p&&(p=(p+1)%e),d-_<t)return;const y=f&&d-f;return y?Math.round(v*1e3/y):void 0}}function Jc(e,t){let r=0;const i=1e3/t;let u=null;return function(){const _=this===!0,s=Date.now();if(_||s-r>i)return u&&(clearTimeout(u),u=null),r=s,e.apply(null,arguments);u||(u=setTimeout(()=>(u=null,r=Date.now(),e.apply(null,arguments)),i-(s-r)))}}const pr=(e,t,r=3)=>{let i=0;const u=Gc(50,250);return Jc(p=>{const _=p.loaded,s=p.lengthComputable?p.total:void 0,c=_-i,d=u(c),f=_<=s;i=_;const h={loaded:_,total:s,progress:s?_/s:void 0,bytes:c,rate:d||void 0,estimated:d&&s&&f?(s-_)/d:void 0,event:p,lengthComputable:s!=null};h[t?"download":"upload"]=!0,e(h)},r)},Yc=We.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let i;function u(p){let _=p;return t&&(r.setAttribute("href",_),_=r.href),r.setAttribute("href",_),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return i=u(window.location.href),function(_){const s=H.isString(_)?u(_):_;return s.protocol===i.protocol&&s.host===i.host}}():function(){return function(){return!0}}(),Zc=We.hasStandardBrowserEnv?{write(e,t,r,i,u,p){const _=[e+"="+encodeURIComponent(t)];H.isNumber(r)&&_.push("expires="+new Date(r).toGMTString()),H.isString(i)&&_.push("path="+i),H.isString(u)&&_.push("domain="+u),p===!0&&_.push("secure"),document.cookie=_.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Qc(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function eh(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function io(e,t){return e&&!Qc(t)?eh(e,t):t}const Ps=e=>e instanceof Re?{...e}:e;function dt(e,t){t=t||{};const r={};function i(d,f,h){return H.isPlainObject(d)&&H.isPlainObject(f)?H.merge.call({caseless:h},d,f):H.isPlainObject(f)?H.merge({},f):H.isArray(f)?f.slice():f}function u(d,f,h){if(H.isUndefined(f)){if(!H.isUndefined(d))return i(void 0,d,h)}else return i(d,f,h)}function p(d,f){if(!H.isUndefined(f))return i(void 0,f)}function _(d,f){if(H.isUndefined(f)){if(!H.isUndefined(d))return i(void 0,d)}else return i(void 0,f)}function s(d,f,h){if(h in t)return i(d,f);if(h in e)return i(void 0,d)}const c={url:p,method:p,data:p,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,withXSRFToken:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:s,headers:(d,f)=>u(Ps(d),Ps(f),!0)};return H.forEach(Object.keys(Object.assign({},e,t)),function(f){const h=c[f]||u,v=h(e[f],t[f],f);H.isUndefined(v)&&h!==s||(r[f]=v)}),r}const so=e=>{const t=dt({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:u,xsrfCookieName:p,headers:_,auth:s}=t;t.headers=_=Re.from(_),t.url=Zn(io(t.baseURL,t.url),e.params,e.paramsSerializer),s&&_.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let c;if(H.isFormData(r)){if(We.hasStandardBrowserEnv||We.hasStandardBrowserWebWorkerEnv)_.setContentType(void 0);else if((c=_.getContentType())!==!1){const[d,...f]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];_.setContentType([d||"multipart/form-data",...f].join("; "))}}if(We.hasStandardBrowserEnv&&(i&&H.isFunction(i)&&(i=i(t)),i||i!==!1&&Yc(t.url))){const d=u&&p&&Zc.read(p);d&&_.set(u,d)}return t},th=typeof XMLHttpRequest<"u",rh=th&&function(e){return new Promise(function(r,i){const u=so(e);let p=u.data;const _=Re.from(u.headers).normalize();let{responseType:s}=u,c;function d(){u.cancelToken&&u.cancelToken.unsubscribe(c),u.signal&&u.signal.removeEventListener("abort",c)}let f=new XMLHttpRequest;f.open(u.method.toUpperCase(),u.url,!0),f.timeout=u.timeout;function h(){if(!f)return;const y=Re.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),m={data:!s||s==="text"||s==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:y,config:e,request:f};ro(function(l){r(l),d()},function(l){i(l),d()},m),f=null}"onloadend"in f?f.onloadend=h:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(h)},f.onabort=function(){f&&(i(new ie("Request aborted",ie.ECONNABORTED,u,f)),f=null)},f.onerror=function(){i(new ie("Network Error",ie.ERR_NETWORK,u,f)),f=null},f.ontimeout=function(){let C=u.timeout?"timeout of "+u.timeout+"ms exceeded":"timeout exceeded";const m=u.transitional||Qn;u.timeoutErrorMessage&&(C=u.timeoutErrorMessage),i(new ie(C,m.clarifyTimeoutError?ie.ETIMEDOUT:ie.ECONNABORTED,u,f)),f=null},p===void 0&&_.setContentType(null),"setRequestHeader"in f&&H.forEach(_.toJSON(),function(C,m){f.setRequestHeader(m,C)}),H.isUndefined(u.withCredentials)||(f.withCredentials=!!u.withCredentials),s&&s!=="json"&&(f.responseType=u.responseType),typeof u.onDownloadProgress=="function"&&f.addEventListener("progress",pr(u.onDownloadProgress,!0)),typeof u.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",pr(u.onUploadProgress)),(u.cancelToken||u.signal)&&(c=y=>{f&&(i(!y||y.type?new St(null,e,f):y),f.abort(),f=null)},u.cancelToken&&u.cancelToken.subscribe(c),u.signal&&(u.signal.aborted?c():u.signal.addEventListener("abort",c)));const v=Xc(u.url);if(v&&We.protocols.indexOf(v)===-1){i(new ie("Unsupported protocol "+v+":",ie.ERR_BAD_REQUEST,e));return}f.send(p||null)})},ih=(e,t)=>{let r=new AbortController,i;const u=function(c){if(!i){i=!0,_();const d=c instanceof Error?c:this.reason;r.abort(d instanceof ie?d:new St(d instanceof Error?d.message:d))}};let p=t&&setTimeout(()=>{u(new ie(`timeout ${t} of ms exceeded`,ie.ETIMEDOUT))},t);const _=()=>{e&&(p&&clearTimeout(p),p=null,e.forEach(c=>{c&&(c.removeEventListener?c.removeEventListener("abort",u):c.unsubscribe(u))}),e=null)};e.forEach(c=>c&&c.addEventListener&&c.addEventListener("abort",u));const{signal:s}=r;return s.unsubscribe=_,[s,()=>{p&&clearTimeout(p),p=null}]},sh=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let i=0,u;for(;i<r;)u=i+t,yield e.slice(i,u),i=u},nh=async function*(e,t,r){for await(const i of e)yield*sh(ArrayBuffer.isView(i)?i:await r(String(i)),t)},Ms=(e,t,r,i,u)=>{const p=nh(e,t,u);let _=0;return new ReadableStream({type:"bytes",async pull(s){const{done:c,value:d}=await p.next();if(c){s.close(),i();return}let f=d.byteLength;r&&r(_+=f),s.enqueue(new Uint8Array(d))},cancel(s){return i(s),p.return()}},{highWaterMark:2})},Bs=(e,t)=>{const r=e!=null;return i=>setTimeout(()=>t({lengthComputable:r,total:e,loaded:i}))},Er=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",no=Er&&typeof ReadableStream=="function",si=Er&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),oh=no&&(()=>{let e=!1;const t=new Request(We.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),Is=64*1024,ni=no&&!!(()=>{try{return H.isReadableStream(new Response("").body)}catch{}})(),_r={stream:ni&&(e=>e.body)};Er&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!_r[t]&&(_r[t]=H.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new ie(`Response type '${t}' is not supported`,ie.ERR_NOT_SUPPORT,i)})})})(new Response);const ah=async e=>{if(e==null)return 0;if(H.isBlob(e))return e.size;if(H.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(H.isArrayBufferView(e))return e.byteLength;if(H.isURLSearchParams(e)&&(e=e+""),H.isString(e))return(await si(e)).byteLength},lh=async(e,t)=>{const r=H.toFiniteNumber(e.getContentLength());return r??ah(t)},ch=Er&&(async e=>{let{url:t,method:r,data:i,signal:u,cancelToken:p,timeout:_,onDownloadProgress:s,onUploadProgress:c,responseType:d,headers:f,withCredentials:h="same-origin",fetchOptions:v}=so(e);d=d?(d+"").toLowerCase():"text";let[y,C]=u||p||_?ih([u,p],_):[],m,n;const l=()=>{!m&&setTimeout(()=>{y&&y.unsubscribe()}),m=!0};let o;try{if(c&&oh&&r!=="get"&&r!=="head"&&(o=await lh(f,i))!==0){let w=new Request(t,{method:"POST",body:i,duplex:"half"}),k;H.isFormData(i)&&(k=w.headers.get("content-type"))&&f.setContentType(k),w.body&&(i=Ms(w.body,Is,Bs(o,pr(c)),null,si))}H.isString(h)||(h=h?"cors":"omit"),n=new Request(t,{...v,signal:y,method:r.toUpperCase(),headers:f.normalize().toJSON(),body:i,duplex:"half",withCredentials:h});let a=await fetch(n);const g=ni&&(d==="stream"||d==="response");if(ni&&(s||g)){const w={};["status","statusText","headers"].forEach(S=>{w[S]=a[S]});const k=H.toFiniteNumber(a.headers.get("content-length"));a=new Response(Ms(a.body,Is,s&&Bs(k,pr(s,!0)),g&&l,si),w)}d=d||"text";let b=await _r[H.findKey(_r,d)||"text"](a,e);return!g&&l(),C&&C(),await new Promise((w,k)=>{ro(w,k,{data:b,headers:Re.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:n})})}catch(a){throw l(),a&&a.name==="TypeError"&&/fetch/i.test(a.message)?Object.assign(new ie("Network Error",ie.ERR_NETWORK,e,n),{cause:a.cause||a}):ie.from(a,a&&a.code,e,n)}}),oi={http:Ec,xhr:rh,fetch:ch};H.forEach(oi,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Os=e=>`- ${e}`,hh=e=>H.isFunction(e)||e===null||e===!1,oo={getAdapter:e=>{e=H.isArray(e)?e:[e];const{length:t}=e;let r,i;const u={};for(let p=0;p<t;p++){r=e[p];let _;if(i=r,!hh(r)&&(i=oi[(_=String(r)).toLowerCase()],i===void 0))throw new ie(`Unknown adapter '${_}'`);if(i)break;u[_||"#"+p]=i}if(!i){const p=Object.entries(u).map(([s,c])=>`adapter ${s} `+(c===!1?"is not supported by the environment":"is not available in the build"));let _=t?p.length>1?`since :
`+p.map(Os).join(`
`):" "+Os(p[0]):"as no adapter specified";throw new ie("There is no suitable adapter to dispatch the request "+_,"ERR_NOT_SUPPORT")}return i},adapters:oi};function Ur(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new St(null,e)}function Fs(e){return Ur(e),e.headers=Re.from(e.headers),e.data=$r.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),oo.getAdapter(e.adapter||Ht.adapter)(e).then(function(i){return Ur(e),i.data=$r.call(e,e.transformResponse,i),i.headers=Re.from(i.headers),i},function(i){return to(i)||(Ur(e),i&&i.response&&(i.response.data=$r.call(e,e.transformResponse,i.response),i.response.headers=Re.from(i.response.headers))),Promise.reject(i)})}const ao="1.7.2",Di={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Di[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const Hs={};Di.transitional=function(t,r,i){function u(p,_){return"[Axios v"+ao+"] Transitional option '"+p+"'"+_+(i?". "+i:"")}return(p,_,s)=>{if(t===!1)throw new ie(u(_," has been removed"+(r?" in "+r:"")),ie.ERR_DEPRECATED);return r&&!Hs[_]&&(Hs[_]=!0,console.warn(u(_," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(p,_,s):!0}};function uh(e,t,r){if(typeof e!="object")throw new ie("options must be an object",ie.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let u=i.length;for(;u-- >0;){const p=i[u],_=t[p];if(_){const s=e[p],c=s===void 0||_(s,p,e);if(c!==!0)throw new ie("option "+p+" must be "+c,ie.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ie("Unknown option "+p,ie.ERR_BAD_OPTION)}}const ai={assertOptions:uh,validators:Di},Qe=ai.validators;class ut{constructor(t){this.defaults=t,this.interceptors={request:new As,response:new As}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let u;Error.captureStackTrace?Error.captureStackTrace(u={}):u=new Error;const p=u.stack?u.stack.replace(/^.+\n/,""):"";try{i.stack?p&&!String(i.stack).endsWith(p.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+p):i.stack=p}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=dt(this.defaults,r);const{transitional:i,paramsSerializer:u,headers:p}=r;i!==void 0&&ai.assertOptions(i,{silentJSONParsing:Qe.transitional(Qe.boolean),forcedJSONParsing:Qe.transitional(Qe.boolean),clarifyTimeoutError:Qe.transitional(Qe.boolean)},!1),u!=null&&(H.isFunction(u)?r.paramsSerializer={serialize:u}:ai.assertOptions(u,{encode:Qe.function,serialize:Qe.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let _=p&&H.merge(p.common,p[r.method]);p&&H.forEach(["delete","get","head","post","put","patch","common"],C=>{delete p[C]}),r.headers=Re.concat(_,p);const s=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,s.unshift(m.fulfilled,m.rejected))});const d=[];this.interceptors.response.forEach(function(m){d.push(m.fulfilled,m.rejected)});let f,h=0,v;if(!c){const C=[Fs.bind(this),void 0];for(C.unshift.apply(C,s),C.push.apply(C,d),v=C.length,f=Promise.resolve(r);h<v;)f=f.then(C[h++],C[h++]);return f}v=s.length;let y=r;for(h=0;h<v;){const C=s[h++],m=s[h++];try{y=C(y)}catch(n){m.call(this,n);break}}try{f=Fs.call(this,y)}catch(C){return Promise.reject(C)}for(h=0,v=d.length;h<v;)f=f.then(d[h++],d[h++]);return f}getUri(t){t=dt(this.defaults,t);const r=io(t.baseURL,t.url);return Zn(r,t.params,t.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(t){ut.prototype[t]=function(r,i){return this.request(dt(i||{},{method:t,url:r,data:(i||{}).data}))}});H.forEach(["post","put","patch"],function(t){function r(i){return function(p,_,s){return this.request(dt(s||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:p,data:_}))}}ut.prototype[t]=r(),ut.prototype[t+"Form"]=r(!0)});class Pi{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(p){r=p});const i=this;this.promise.then(u=>{if(!i._listeners)return;let p=i._listeners.length;for(;p-- >0;)i._listeners[p](u);i._listeners=null}),this.promise.then=u=>{let p;const _=new Promise(s=>{i.subscribe(s),p=s}).then(u);return _.cancel=function(){i.unsubscribe(p)},_},t(function(p,_,s){i.reason||(i.reason=new St(p,_,s),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new Pi(function(u){t=u}),cancel:t}}}function dh(e){return function(r){return e.apply(null,r)}}function fh(e){return H.isObject(e)&&e.isAxiosError===!0}const li={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(li).forEach(([e,t])=>{li[t]=e});function lo(e){const t=new ut(e),r=Wn(ut.prototype.request,t);return H.extend(r,ut.prototype,t,{allOwnKeys:!0}),H.extend(r,t,null,{allOwnKeys:!0}),r.create=function(u){return lo(dt(e,u))},r}const le=lo(Ht);le.Axios=ut;le.CanceledError=St;le.CancelToken=Pi;le.isCancel=to;le.VERSION=ao;le.toFormData=kr;le.AxiosError=ie;le.Cancel=le.CanceledError;le.all=function(t){return Promise.all(t)};le.spread=dh;le.isAxiosError=fh;le.mergeConfig=dt;le.AxiosHeaders=Re;le.formToJSON=e=>eo(H.isHTMLForm(e)?new FormData(e):e);le.getAdapter=oo.getAdapter;le.HttpStatusCode=li;le.default=le;const Ae={aws:{cognito:{url:"https://cognito-idp.us-east-1.amazonaws.com"},s3:{url:"https://s3.amazonaws.com",bucketName:"handterm",userKey:"user_data/{{userId}}/"}},api:{BaseUrl:"https://x7jzrjfuv8.execute-api.us-east-1.amazonaws.com",SignUp:"/signUp",GetLog:"/getLog",ListLog:"/listLog",SaveLog:"/saveLog",SignIn:"/signIn",SignOut:"/signOut",ChangePassword:"/changePassword",TokenHandler:"/tokenHandler",RefreshToken:"/refreshToken",CheckSession:"/checkSession",GetUser:"/getUser",SetUser:"/setUser"}};class Rr extends pe.Component{static contextType=fr;terminalElementRef=pe.createRef();adapterRef=pe.createRef();nextCharsDisplayRef=pe.createRef();terminalGameRef=pe.createRef();_persistence;_commandHistory=[];wpmCalculator=new ho;videoElementRef=pe.createRef();webCam=null;static commandHistoryLimit=120;isDebug=!1;heroRunTimeoutId=null;heroSummersaultTimeoutId=null;lastTouchDistance=null;currentFontSize=17;isShowVideo;outputRef=pe.createRef();inLoginProcess=!1;tempUserName="";tempNewPassword="";isInChangePasswordMode=!1;loadAchievements(){const t=localStorage.getItem("achievements");return t?JSON.parse(t):[]}saveAchievements(t){const r=localStorage.getItem("achievements")||"";let i=r?JSON.parse(r):[];i.push(t),localStorage.setItem("achievements",JSON.stringify(i))}saveDocument=async t=>(await le.post(`${Ae.api.BaseUrl}/saveDocument`,t)).data;getNextAchievement(){const t=this.loadAchievements()||[];return $l.find(i=>!t.some(u=>u===i.phrase.join("")))||null}focusTerminal(){this.adapterRef.current&&this.adapterRef.current.focusTerminal()}loadPhrasesAchieved(){const t=localStorage.getItem("phrasesAchieved");return t?JSON.parse(t):[]}savePhrasesAchieved(t){const r=localStorage.getItem("phrasesAchieved")||"";let i=r?JSON.parse(r):[];i.push(t),localStorage.setItem("phrasesAchieved",JSON.stringify(i))}loadTargetWPM(){const t=localStorage.getItem("targetWPM");return t?parseInt(t):30}constructor(t){super(t),this._persistence=new uo;const r=localStorage.getItem("canvasHeight")||"100",i=this.getNextAchievement();this.state={outputElements:this.getCommandResponseHistory().slice(-1),isInPhraseMode:!1,phraseValue:"",phraseName:"",phraseIndex:0,phrasesAchieved:this.loadPhrasesAchieved(),targetWPM:this.loadTargetWPM(),isActive:!1,commandLine:"",heroAction:"Idle",zombie4Action:"Walk",terminalSize:void 0,terminalFontSize:17,canvasHeight:parseInt(r),unlockedAchievements:this.loadAchievements(),nextAchievement:i,isInTutorial:!0,commandHistory:this.loadCommandHistory(),currentCommandIndex:-1,isInSvgMode:!1,lastTypedCharacter:null},this.loadDebugValue(),this.loadFontSize()}componentDidUpdate(t,r,i){}loadCommandHistory(){return JSON.parse(localStorage.getItem("commandHistory")||"[]")}saveCommandHistory(t){localStorage.setItem("commandHistory",JSON.stringify(t))}scrollToBottom(){this.adapterRef.current&&this.adapterRef.current.scrollBottom()}componentDidMount(){if(this.adapterRef.current){const t=this.adapterRef.current.getTerminalSize();t&&this.setState({terminalSize:t}),this.adapterRef.current.terminalWrite(localStorage.getItem("currentCommand")||"")}this.scrollToBottom(),this.videoElementRef.current&&(this.webCam=new Wl(this.videoElementRef.current)),this.addTouchListeners()}componentWillUnmount(){this.heroRunTimeoutId&&clearTimeout(this.heroRunTimeoutId),this.removeTouchListeners()}handleCommand=t=>{this.setState(s=>({commandHistory:[t,...s.commandHistory],currentCommandIndex:-1}),()=>this.saveCommandHistory(this.state.commandHistory)),this.state.isInTutorial&&(t===""&&(t="Return (ENTER)"),this.state.nextAchievement?.phrase.join("")===t&&this.unlockAchievement(t));const{command:r,args:i,switches:u}=this.parseCommand(t);if(this.context&&this.context.executeCommand(r,i,u).status===200)return;let p=404,_="Command not found.";if(this.terminalGameRef.current?.resetGame(),this.scrollToBottom(),this.state.isInPhraseMode&&(_=""),this.setState({isInPhraseMode:!1,commandLine:""}),(r==="help"||r==="411")&&(p=200,_="<div class='chord-display-container'>"+["UpArrow","LeftArrow","DownArrow","RightArrow"].map(d=>Y.jsx(rr,{displayChar:d})).map(d=>st.renderToStaticMarkup(d)).join("")+"</div>"),r.startsWith("profile"))if(i.length===0)(async()=>{try{const s=await this.props.auth.getUser();s.status===200?this.writeOutput("Fetched userId: "+s.data.userId.split("-").slice(-1)[0]+" username: "+s.data.content):this.writeOutput(s.error.join("<br/>"))}catch(s){console.error("Error fetching user:",s)}})(),_="Getting profile";else{const s=i.join(" ");this.props.auth.setUser(s)}if(r==="signup"){_="Signing up...";const s=t.split(" ");this.props.auth.signUp(s[1],s[2],s[1],(c,d)=>{c?(console.error(c),_="Error signing up."+d,p=500):(_="Sign up successful!"+d,p=200)})}if(r==="login"){_="Logging in...";const s=t.split(" ");s.length<2?(_="Please provide a username.",p=400):(this.inLoginProcess=!0,this.tempUserName=s[1])}if(r.startsWith("level")){if(!this.terminalGameRef.current)return;let s=r.match(/\d+/);const c=s&&s.length?parseInt(s[0]):null;this.terminalGameRef.current?.levelUp(c)}if((r==="play"||r==="phrase")&&(p=200,_="Type the phrase as fast as you can.",this.setNewPhrase(i.join(""))),r==="svg"&&this.setState({isInSvgMode:!this.state.isInSvgMode}),r.startsWith("video")&&(p=200,this.toggleVideo()?_="Starting video camera...":_="Stopping video camera..."),this.nextCharsDisplayRef.current&&this.nextCharsDisplayRef.current.cancelTimer(),this.state.isInPhraseMode&&this.setState({isInPhraseMode:!1}),this.adapterRef.current?.prompt(),r!==""){if(r.startsWith("debug")){let s=r.includes("--true")||r.includes("-t");this.toggleIsDebug(s);return}this._commandHistory.length>Rr.commandHistoryLimit&&this._commandHistory.shift(),this.saveCommandResponseHistory(r,_,p)}};prompt=()=>{this.adapterRef.current?.prompt()};handleCharacter=t=>{const r=this.wpmCalculator.addKeystroke(t);if(localStorage.setItem("currentCommand",this.adapterRef.current?.getCurrentCommand()+t),this.state.isInSvgMode?this.setState({lastTypedCharacter:t}):this.setState({lastTypedCharacter:null}),this.inLoginProcess)if(t==="\r")this.inLoginProcess=!1,(async()=>{try{const i=await this.props.auth.login(this.tempUserName,this.getTempPassword());this.terminalWrite("Login successful! Status: "+JSON.stringify(i.status)),this.prompt()}catch(i){this.terminalWrite("Login failed: "+i.message)}finally{this.tempUserName="",this.terminalReset(),this.resetTempPassword()}})();else{this.appendTempPassword(t),this.terminalWrite("*");return}if(this.isInChangePasswordMode)if(t==="\r")this.props.auth.changePassword(this.getTempPassword(),this.tempNewPassword,(i,u)=>{i?console.error(i):this.terminalWrite("Password changed successfully!"+u),this.isInChangePasswordMode=!1,this.terminalReset()}),this.resetTempPassword();else{this.appendTempPassword(t),this.terminalWrite("*");return}if(t.charCodeAt(0)===3&&(this.setState({isInPhraseMode:!1,commandLine:""}),this.adapterRef.current?.terminalReset(),this.adapterRef.current?.prompt()),t==="ArrowUp"){let i=(this.state.currentCommandIndex+1)%this.state.commandHistory.length,u=this.state.commandHistory[i];const p=this.getCommandResponseHistory().reverse();this.setState({currentCommandIndex:i,commandLine:u,outputElements:[p[i]]}),this.terminalReset(),this.terminalPrompt(),this.terminalWrite(u);return}if(t.charCodeAt(0)===4&&(console.log("Ctrl+D pressed"),this.increaseFontSize()),t.charCodeAt(0)===13){let i=this.adapterRef.current?.getCurrentCommand()??"";localStorage.setItem("currentCommand",""),this.terminalReset(),this.handleCommand(i)}else if(this.state.isInPhraseMode){this.terminalWrite(t);let i=this.adapterRef.current?.getCurrentCommand()+t;if(i.length===0){this.nextCharsDisplayRef.current&&this.nextCharsDisplayRef.current.resetTimer();return}this.setState({commandLine:i}),[",",".","!","?"].includes(t)||/[0-9]/.test(t)?this.setHeroSummersaultAction():this.setHeroRunAction()}else this.terminalWrite(t),[",",".","!","?"].includes(t)||/[0-9]/.test(t)?this.setHeroSummersaultAction():this.setHeroRunAction();return r.durationMilliseconds};unlockAchievement=t=>{this.setState(r=>{const i=r.unlockedAchievements;this.state.nextAchievement?.phrase.join("")===t&&this.saveAchievements(t);const u=this.getNextAchievement();return{...r,achievements:i,nextAchievement:u,isInTutorial:!!u}})};parseCommand(t){const r=t.split(/\s+/),i=r.shift(),u=[],p={};if(i)for(let _=0;_<r.length;_++){const s=r[_];if(s.startsWith("--")){const c=s.indexOf("=");if(c>-1){const d=s.substring(2,c),f=s.substring(c+1);p[d]=f}else{const d=s.substring(2);_+1<r.length&&!r[_+1].startsWith("--")?p[d]=r[++_]:p[d]=!0}}else u.push(s)}return{command:i||"",args:u,switches:p}}getCommandResponseHistory(){let t=[],r=[];for(let i=0;i<localStorage.length;i++){if(!localStorage.key(i)?.startsWith(kt.Command+"_"))continue;const u=localStorage.key(i);u&&t.push(u)}t.sort();for(let i of t){const u=localStorage.getItem(i);u&&r.push(u)}return r}WpmsToHTML(t,r){return r=r??"slowest-characters",Y.jsx("table",{className:"wpm-table",children:Y.jsxs("tbody",{children:[Y.jsx("tr",{children:Y.jsx("th",{colSpan:2,children:r})}),t.map((i,u)=>Y.jsx(pe.Fragment,{children:Y.jsxs("tr",{id:r,className:"wpm-table-row",children:[Y.jsx("td",{children:i.character.replace("\r","\\r").replace(" ","\\s")}),Y.jsx("td",{className:"number",children:i.wpm.toFixed(2)})]})},u))]})})}averageWpmByCharacter(t){const r={};return t.forEach(({character:i,wpm:u})=>{r[i]||(r[i]={totalWpm:0,count:0}),r[i].totalWpm+=u,r[i].count++}),Object.entries(r).map(([i,{totalWpm:u,count:p}])=>({character:i,wpm:u/p,durationMilliseconds:0}))}saveCommandResponseHistory(t,r,i){const u=new Date,p=this.createTimeCode(u).join(":");let _=this.createCommandRecord(t,u);const s=jr(_);let c=document.createElement("div");c.dataset.status=i.toString(),c.appendChild(s),c.appendChild(jr(`<div class="response">${r}</div>`));const d=this.wpmCalculator.getWPMs();let f=this.wpmCalculator.saveKeystrokes(p);this.wpmCalculator.clearKeystrokes(),c.innerHTML=c.innerHTML.replace(/{{wpm}}/g,("_____"+f.toFixed(0)).slice(-4)),_=_.replace(/{{wpm}}/g,("_____"+f.toFixed(0)).slice(-4)),this._commandHistory||(this._commandHistory=[]);const h=c.outerHTML,v=this.averageWpmByCharacter(d.charWpms.filter(m=>m.durationMilliseconds>1)),y=this.WpmsToHTML(v.sort((m,n)=>m.wpm-n.wpm).slice(0,3),"slow-chars"),C=st.renderToStaticMarkup(y);return c.innerHTML+=C,this.writeOutput(h),this._persistence.setItem(`${kt.Command}_${p}`,c.outerHTML),h}writeOutput(t){this._commandHistory=[t],this.setState({outputElements:[t]})}clearCommandHistory(t,r=[],i={}){let u=[];for(let p=localStorage.length;p>=0;p--){let _=localStorage.key(p);_&&((_.includes(kt.Command)||_.includes("terminalCommandHistory")||_.includes(kt.CharTime))&&u.push(_),r&&_.includes(r[0])&&u.push(_))}for(let p of u)localStorage.removeItem(p);this._commandHistory=[],this.setState({outputElements:[]}),this.adapterRef.current?.terminalReset(),this.adapterRef.current?.prompt()}createCommandRecord(t,r){return`<div class="log-line"><span class="log-time">[${this.createTimeHTML(r)}]</span><span class="wpm">{{wpm}}</span>${t}</div>`}createTimeCode(t=new Date){return t.toISOString().split(":")}createTimeHTML(t=new Date){const r=t.getHours().toString().padStart(2,"0"),i=t.getMinutes().toString().padStart(2,"0"),u=t.getSeconds().toString().padStart(2,"0");return`<span class="log-hour">${r}</span><span class="log-minute">${i}</span><span class="log-second">${u}</span>`}toggleIsDebug(t){this.isDebug=!this.isDebug,t&&(this.isDebug=t),localStorage.setItem("xterm-debug",String(this.isDebug)),console.log("Xterm debug:",localStorage.getItem("xterm-debug"))}loadDebugValue(){localStorage.getItem("xterm-debug")==="true"?this.isDebug=!0:this.isDebug=!1}handlePhraseSuccess=t=>{const r=this.wpmCalculator.getWPMs().wpmAverage;r>this.state.targetWPM&&(this.savePhrasesAchieved(this.state.phraseName),this.state.phrasesAchieved.includes(this.state.phraseName)||this.setState(u=>({phrasesAchieved:[...u.phrasesAchieved,this.state.phraseName]})));let i=r.toString(10)+":"+t;this.setState(u=>({outputElements:[...u.outputElements,i]})),this.saveCommandResponseHistory("game",i,200),this.terminalGameRef.current?.completeGame(),this.adapterRef.current?.terminalReset(),this.adapterRef.current?.prompt(),this.terminalGameRef.current?.levelUp(),this.handlePhraseComplete()};handlePhraseComplete=()=>{let t=(this.state.phraseIndex+1)%Nt.phrases.length,r=this.getPhrasesNotAchieved()[t];this.setState({phraseIndex:t,isInPhraseMode:!0,phraseValue:r.value,phraseName:r.key}),this.terminalGameRef.current?.completeGame()};getPhrasesNotAchieved=()=>Nt.phrases.filter(t=>!this.state.phrasesAchieved.includes(t.key));setNewPhrase=t=>{t=t.replace("phrase ","");const r=t&&t!=""&&Nt.getPhraseByKey(t)?Nt.getPhraseByKey(t):this.getPhrasesNotAchieved()[this.state.phraseIndex];this.setState(i=>({...i,isInPhraseMode:!0,phraseValue:r.value,phraseName:r.key,commandLine:r.value}))};setHeroRunAction=()=>{this.heroRunTimeoutId&&(clearTimeout(this.heroRunTimeoutId),this.heroRunTimeoutId=null),this.setState({heroAction:"Run"}),this.heroRunTimeoutId=window.setTimeout(()=>{this.setState({heroAction:"Idle"}),this.heroRunTimeoutId=null},800)};setHeroSummersaultAction=()=>{this.heroSummersaultTimeoutId&&(clearTimeout(this.heroSummersaultTimeoutId),this.heroSummersaultTimeoutId=null),this.setState({heroAction:"Summersault"}),this.heroSummersaultTimeoutId=window.setTimeout(()=>{this.setState({heroAction:"Idle"}),this.heroSummersaultTimeoutId=null},800)};setHeroAction=t=>{this.setState({heroAction:t})};setZombie4Action=t=>{this.setState({zombie4Action:t})};handleTimerStatusChange(t){this.setState({isActive:t})}terminalReset(){this.adapterRef.current?.terminalReset()}terminalPrompt(){this.adapterRef.current?.prompt()}terminalWrite(t){this.adapterRef.current?.terminalWrite(t)}appendTempPassword(t){this.adapterRef.current?.appendTempPassword(t)}resetTempPassword(){this.adapterRef.current?.resetTempPassword()}getTempPassword(){return this.adapterRef.current?.getTempPassword()||""}loadFontSize(){let t=localStorage.getItem("terminalFontSize")||this.currentFontSize.toString();const r=t&&t=="NaN"?this.currentFontSize:parseInt(t);r&&(this.currentFontSize=r,document.documentElement.style.setProperty("--terminal-font-size",`${this.currentFontSize}px`))}handleTouchStart=t=>{setTimeout(()=>{},500),t.touches.length===2&&(this.lastTouchDistance=this.getDistanceBetweenTouches(t.touches))};handleTouchMove=t=>{if(t.touches.length===2){t.preventDefault();const r=this.getDistanceBetweenTouches(t.touches);if(this.lastTouchDistance&&this.lastTouchDistance>0){const i=t.target,u=r/this.lastTouchDistance;if(i&&i.nodeName==="CANVAS"){this.setState(p=>({canvasHeight:p.canvasHeight*u}));return}this.currentFontSize*=u,document.documentElement.style.setProperty("--terminal-font-size",`${this.currentFontSize}pt`),this.lastTouchDistance=r}}};increaseFontSize(){this.currentFontSize+=1,localStorage.setItem("terminalFontSize",`${this.currentFontSize}`),console.log("INCREASE terminalFontSize",this.currentFontSize)}handleTouchEnd=()=>{localStorage.setItem("terminalFontSize",`${this.currentFontSize}`),console.log("SET terminalFontSize",this.currentFontSize),this.lastTouchDistance=null};addTouchListeners(){const t=window.document.getElementById(Se.Output);t&&t.addEventListener("touchmove",this.handleTouchMove,{passive:!1});const r=document.getElementById(Se.Terminal);r&&r.addEventListener("touchmove",this.handleTouchMove,{passive:!1});const i=window.document.getElementById(Se.TerminalGame);i&&i.addEventListener("touchmove",this.handleTouchMove,{passive:!1})}removeTouchListeners(){const t=this.terminalElementRef.current;t&&t.removeEventListener("touchmove",this.handleTouchMove);const r=window.document.getElementById(Se.Output);r&&r.removeEventListener("touchmove",this.handleTouchMove);const i=document.getElementById(Se.Terminal);i&&i.removeEventListener("touchmove",this.handleTouchMove);const u=window.document.getElementById(Se.TerminalGame);u&&u.removeEventListener("touchmove",this.handleTouchMove)}getDistanceBetweenTouches(t){const r=t[0],i=t[1];return Math.sqrt(Math.pow(i.pageX-r.pageX,2)+Math.pow(i.pageY-r.pageY,2))}toggleVideo=()=>(this.isShowVideo=!this.isShowVideo,this.webCam?.toggleVideo(this.isShowVideo),this.isShowVideo);render(){const{terminalSize:t}=this.state,r=t?t.width:800;return Y.jsx(fr.Consumer,{children:i=>(this.context=i,Y.jsxs("div",{className:"terminal-container",children:[Y.jsx(yo,{ref:this.outputRef,elements:this.state.outputElements,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd}),Y.jsx(Do,{ref:this.terminalGameRef,canvasHeight:this.state.canvasHeight,canvasWidth:r,isInPhraseMode:this.state.isInPhraseMode,heroActionType:this.state.heroAction,zombie4ActionType:this.state.zombie4Action,onSetHeroAction:this.setHeroAction,onSetZombie4Action:this.setZombie4Action,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,phrasesAchieved:this.state.phrasesAchieved}),this.state.isInPhraseMode&&this.state.phraseValue&&Y.jsx(So,{ref:this.nextCharsDisplayRef,onTimerStatusChange:this.handleTimerStatusChange,commandLine:this.state.commandLine,isInPhraseMode:this.state.isInPhraseMode,newPhrase:this.state.phraseValue,onPhraseSuccess:this.handlePhraseSuccess}),this.state.lastTypedCharacter&&Y.jsx(rr,{displayChar:this.state.lastTypedCharacter}),Array.isArray(this.state.nextAchievement?.phrase)&&ks&&Y.jsx(ks,{achievement:this.state.nextAchievement,isInTutorial:this.state.isInTutorial,includeReturn:!0}),Y.jsx(mo,{ref:this.adapterRef,terminalElement:this.terminalElementRef.current,terminalElementRef:this.terminalElementRef,terminalFontSize:this.currentFontSize,onAddCharacter:this.handleCharacter,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd}),Y.jsx("video",{ref:this.videoElementRef,id:"terminal-video",hidden:!this.isShowVideo})]}))})}}Rr.contextType=fr;const ph=e=>{const[t]=ae.useState([]),r=ae.useCallback((_,s,c)=>{const d=e.handTermRef.current;if(!d)return console.error("CommandProvider: handTermRef.current is NULL"),{status:404,message:"CommandProvider: handTermRef.current is NULL"};const f=co.getCommand(_);return f?{status:200,message:f.execute(_,s,c,d).message}:{status:404,message:`CommandProvider: Command not found: ${_}`}},[]),i=ae.useCallback(_=>{const s=e.handTermRef.current;if(!s)return console.error("CommandProvider: handTermRef.current is NULL"),"CommandProvider: handTermRef.current is NULL";_&&s.writeOutput(_.toString())},[]),u=ae.useCallback(()=>{const _=e.handTermRef.current;if(!_)return console.error("CommandProvider: handTermRef.current is NULL"),"CommandProvider: handTermRef.current is NULL";_.clearCommandHistory("clear")},[]),p=ae.useMemo(()=>({commandHistory:t,executeCommand:r,appendToOutput:i,clearOuput:u}),[t,r]);return Y.jsx(fr.Provider,{value:p,children:e.children})},Ne=Ae.api.BaseUrl,xt={headers:{"Content-Type":"application/json"},withCredentials:!0},_h=()=>{const[e,t]=ae.useState(!1);ae.useEffect(()=>{},[]);const r=async()=>{try{await le.get(`${Ne}${Ae.api.CheckSession}`,xt),t(!0)}catch(n){console.error("Session check failed:",n),t(!1)}},i=async(n,l,o)=>{if(!n||!l||!o)throw new Error("All fields are required");try{await le.post(`${Ne}${Ae.api.SignUp}`,{username:n,password:l,email:o},xt)}catch(a){throw console.error("Signup failed:",a),a}},u=async()=>{let n={status:200,error:[]};const l=localStorage.getItem("AccessToken"),o=localStorage.getItem("RefreshToken"),a=localStorage.getItem("ExpiresAt");if(l||n.error.push("No access token found"),o||n.error.push("No refresh token found"),(!a||isNaN(parseInt(a)))&&n.error.push("No expiry time found"),n.status!==200||!l||!o||!a)return n.status=401,n;const g=new Date().getTime()>parseInt(a);if(!l||g)try{const b=await le.post(`${Ne}${Ae.api.RefreshToken}`,{refreshToken:o},xt);return localStorage.setItem("AccessToken",b.data.AccessToken),p(b.data.ExpiresIn),console.log("Token refreshed successfully"),n.status=200,n}catch(b){return console.error("Token refresh failed:",b),t(!1),n}return n},p=n=>{const l=_(n);l&&localStorage.setItem("ExpiresAt",l)},_=n=>{const l=parseInt(n);return isNaN(l)?null:(new Date().getTime()+l*1e3).toString(10)},s=async()=>{const n=await u();if(n.status!==200)return n;const l=localStorage.getItem("AccessToken");if(!l)throw new Error("No access token found");return{status:200,error:[],data:{...xt,headers:{...xt.headers,Authorization:`Bearer ${l}`}}}};return{isLoggedIn:e,login:async(n,l)=>{if(!n||!l)throw new Error("All fields are required");try{const o=await le.post(`${Ne}${Ae.api.SignIn}`,{username:n,password:l});return console.log("Login successful:",o.data),t(!0),localStorage.setItem("AccessToken",o.data.AccessToken),localStorage.setItem("RefreshToken",o.data.RefreshToken),localStorage.setItem("IdToken",o.data.IdToken),localStorage.setItem("SignedInAs",n),p(o.data.ExpiresIn),{data:o.data,status:200,error:[]}}catch{return{status:401,error:["Login failed"],data:null}}},logout:async()=>{try{await le.get(`${Ne}${Ae.api.SignOut}`),t(!1)}catch(n){throw console.error("Logout failed:",n),n}},signUp:i,getUser:async()=>{try{const n=await s();return n.status!==200?n:{data:(await le.get(`${Ne}${Ae.api.GetUser}`,n.data)).data,status:200,error:[]}}catch(n){return{status:401,error:["Error fetching current user",n.message],data:null}}},checkSession:r,changePassword:async(n,l)=>{try{await le.post(`${Ne}${Ae.api.ChangePassword}`,{oldPassword:n,newPassword:l})}catch(o){throw console.error("Password change failed:",o),o}},setUser:async n=>{try{const l=await s();await le.post(`${Ne}${Ae.api.SetUser}`,{profile:n},l.data)}catch(l){console.error("Error setting user profile:",l)}},saveLog:async(n,l,o="json")=>{try{const a=await s();return await le.post(`${Ne}${Ae.api.SaveLog}`,{key:n,content:l,extension:o},a.data),{status:200,data:null,error:[]}}catch(a){return console.error("Error saving log:",a),{status:404,data:null,error:["Error saving log"]}}},getLog:async(n,l=10)=>{try{const o=await s(),a={key:n,limit:l};return{status:200,data:(await le.get(`${Ne}${Ae.api.GetLog}`,{headers:o.data.headers,params:a})).data,error:[]}}catch(o){return{status:404,error:["Error fetching log",o.message],data:null}}},listLog:async()=>{try{const n=await s();return(await le.get(`${Ne}${Ae.api.ListLog}`,n.data)).data}catch(n){return console.error("Error fetching log:",n),null}}}},gh=()=>{const e=pe.createRef(),[t,r]=pe.useState(0),i=ae.useRef(null);ae.useEffect(()=>{const p=u();r(p);const _=s=>{i.current&&i.current.adapterRef.current&&s.target.id!==Se.Terminal&&(s.stopPropagation(),window.scrollTo(0,window.screen.height),i.current.adapterRef.current.focusTerminal(),(s instanceof MouseEvent||s instanceof TouchEvent&&s.touches.length===1)&&(i.current.adapterRef.current.focusTerminal(),setTimeout(()=>{i.current&&i.current.adapterRef.current&&i.current.adapterRef.current.focusTerminal()},1e3)))};return document.body.addEventListener("click",_),document.body.addEventListener("touchstart",_),()=>{document.body.removeEventListener("click",_)}},[]);const u=()=>e.current?.clientWidth??0;return ae.useEffect(()=>{const p=()=>{const _=u();r(_)};return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)}),Y.jsx(ph,{handTermRef:i,children:Y.jsx("div",{ref:e,children:Y.jsx(Rr,{ref:i,auth:_h(),terminalWidth:t})})})};export{gh as default};
